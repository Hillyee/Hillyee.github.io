{"meta":{"title":"Hillyee-blog","subtitle":"","description":"","author":"Hillyee","url":"https://hillyee.github.io","root":"/"},"pages":[{"title":"Categories","date":"2022-04-04T05:24:16.895Z","updated":"2022-04-04T05:24:16.895Z","comments":false,"path":"categories/index.html","permalink":"https://hillyee.github.io/categories/index.html","excerpt":"","text":""},{"title":"About","date":"2022-04-07T09:20:54.207Z","updated":"2022-04-07T09:20:54.207Z","comments":false,"path":"about/index.html","permalink":"https://hillyee.github.io/about/index.html","excerpt":"","text":"ğŸ™ˆğŸ™‰ğŸ™ŠğŸµğŸ’ æ™®é€šäºŒæœ¬å¤§ä¸‰èœèœ æ­£åœ¨åŠªåŠ›å­¦å‰ç«¯ å¯ä»¥ä¸€èµ·äº¤æµå­¦ä¹ å–” ğŸ˜Š wechat: yuzibbing ä¸è¦é€ƒé¿å›°éš¾çš„ä¸œè¥¿ ä¸è¦æ€• ğŸ˜« ç›¸ä¿¡è‡ªå·± æˆ‘å¯ä»¥ï¼ï¼ï¼ğŸ¤"},{"title":"Tags","date":"2022-04-04T05:24:25.480Z","updated":"2022-04-04T05:24:25.480Z","comments":false,"path":"tags/index.html","permalink":"https://hillyee.github.io/tags/index.html","excerpt":"","text":""},{"title":"Repositories","date":"2022-03-30T05:15:58.514Z","updated":"2022-03-30T05:15:58.514Z","comments":false,"path":"repository/index.html","permalink":"https://hillyee.github.io/repository/index.html","excerpt":"","text":""}],"posts":[{"title":"æ‰‹å†™promise","slug":"æ‰‹å†™promise","date":"2022-04-17T15:24:47.000Z","updated":"2022-04-17T15:28:55.348Z","comments":true,"path":"2022/04/17/æ‰‹å†™promise/","link":"","permalink":"https://hillyee.github.io/2022/04/17/%E6%89%8B%E5%86%99promise/","excerpt":"","text":"æ‰‹å†™Promise Promiseè§„èŒƒ https://promisesaplus.com/ PromiseA+è§„èŒƒ A+è§„èŒƒåªæœ‰thenæ–¹æ³• Promise ç±»è®¾è®¡ class MyPromise &#123;&#125; function MyPromise() &#123;&#125; ä¸¤ç§æ–¹å¼ï¼Œæˆ‘é€‰ç¬¬ä¸€ç§ æ„é€ å‡½æ•°constructorè®¾è®¡ å®ç°ï¼š è®©executorå‡½æ•°æ‰§è¡Œèµ·æ¥ å®šä¹‰çŠ¶æ€å¸¸é‡ å®šä¹‰resolveï¼Œrejectå›è°ƒï¼Œæ‰§è¡Œçš„æ—¶å€™æ”¹å˜çŠ¶æ€ const STATUE_PENDING = &#x27;pending&#x27;const STATUE_FULFILLED = &#x27;fulfilled&#x27;const STATUS_REJECTED = &#x27;rejected&#x27;class MyPromise &#123; constructor(executor) &#123; // ä¿å­˜çŠ¶æ€ä¸å€¼ this.status = STATUE_PENDING // ç”±äºåé¢çš„thenæ–¹æ³•å¯èƒ½ä¼šç”¨åˆ°è¿™äº›å‚æ•°å€¼ï¼Œéœ€è¦ä¿å­˜èµ·æ¥ this.value = undefined this.reason = undefined // å®šä¹‰resolveå›è°ƒ const resolve = (value) =&gt; &#123; // æ”¹å˜çŠ¶æ€å¹¶ä¿å­˜å€¼ this.status = STATUE_FULFILLED this.value = value console.log(&quot;resolveæ‰§è¡Œ&quot;, value); &#125; // å®šä¹‰rejectå›è°ƒ const reject = (reason) =&gt; &#123; // æ”¹å˜çŠ¶æ€å¹¶ä¿å­˜å€¼ this.status = STATUS_REJECTED this.reason = reason console.log(&quot;rejectæ‰§è¡Œ&quot;, reason); &#125; executor(resolve, reject) &#125;&#125;const promise = new MyPromise((resolve, reject) =&gt; &#123; console.log(&quot;pending~&quot;); resolve(&quot;111&quot;) reject(&quot;222&quot;)&#125;) ä¸ºäº†ä¸è®©resolveï¼Œrejectå›è°ƒå¯ä»¥åŒæ—¶æ‰§è¡Œï¼Œæˆ‘ä»¬éœ€è¦åŠ ä¸€ä¸ªåˆ¤æ–­ï¼Œåªæœ‰çŠ¶æ€ä¸ºpendingçš„æ—¶å€™æ‰æ‰§è¡Œå›è°ƒ const resolve = (value) =&gt; &#123; if (this.status === STATUE_PENDING) &#123; // åŠ ä¸€ä¸ªåˆ¤æ–­ this.status = STATUE_FULFILLED this.value = value console.log(&quot;resolveæ‰§è¡Œ&quot;, value); &#125;&#125;const reject = (reason) =&gt; &#123; if (this.status === STATUE_PENDING) &#123; // åŠ ä¸€ä¸ªåˆ¤æ–­ this.status = STATUS_REJECTED this.reason = reason console.log(&quot;rejectæ‰§è¡Œ&quot;, reason); &#125;&#125; then æ–¹æ³•çš„å®ç° ç®€å•å®ç° thenæ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯æˆåŠŸæ—¶çš„å›è°ƒonFulfilledï¼Œå¤±è´¥æ—¶çš„å›è°ƒonRejected æŠŠå›è°ƒä¿å­˜åˆ°å½“å‰çš„promiseå®ä¾‹ï¼Œå¹¶åœ¨å¯¹åº”çš„resolveï¼Œrejectå›è°ƒæ—¶æ‰§è¡Œ class MyPromise &#123; constructor(executor) &#123; this.status = STATUE_PENDING this.value = undefined this.reason = undefined const resolve = (value) =&gt; &#123; if (this.status === STATUE_PENDING) &#123; this.status = STATUE_FULFILLED this.value = value console.log(&quot;resolveæ‰§è¡Œ&quot;, value); this.onFulfilled(this.value) // åœ¨è¿™é‡Œæ‰§è¡Œ &#125; &#125; const reject = (reason) =&gt; &#123; if (this.status === STATUE_PENDING) &#123; this.status = STATUS_REJECTED this.reason = reason console.log(&quot;rejectæ‰§è¡Œ&quot;, reason); this.onRejected(this.reason) // åœ¨è¿™é‡Œæ‰§è¡Œ &#125; &#125; executor(resolve, reject) &#125; then(onFulfilled, onRejected) &#123; this.onFulfilled = onFulfilled // ä¿å­˜æ–¹æ³• this.onRejected = onRejected // ä¿å­˜æ–¹æ³• &#125;&#125;const promise = new MyPromise((resolve, reject) =&gt; &#123; console.log(&quot;pending~&quot;); resolve(&quot;111&quot;) reject(&quot;222&quot;)&#125;)promise.then(res =&gt; &#123; console.log(&quot;res: &quot;, res);&#125;, err =&gt; &#123; console.log(&quot;err: &quot;, err);&#125;) è¿™æ—¶å€™æˆ‘ä»¬ä¼šå‘ç°ï¼ŒæŠ¥é”™äº†ï¼šthis.onFulfilled is not a function ä¸ºä»€ä¹ˆï¼Ÿï¼Ÿ æˆ‘ä»¬æ‹ä¸€æ‹ä»£ç çš„æ‰§è¡Œè¿‡ç¨‹å°±å¯ä»¥å‘ç°ï¼Œå½“æ‰§è¡Œresolve(&quot;111&quot;) çš„æ—¶å€™ï¼Œéƒ½è¿˜æ²¡æœ‰åˆ°thené‚£ä¸€æ­¥ï¼Œä¹Ÿå°±æ˜¯è¯´è¿˜æ²¡æ‰§è¡Œthenæ–¹æ³•ï¼Œé‚£ä¹ˆæ€ä¹ˆå¯èƒ½ä¼šæœ‰ onFulfilled, onRejected æ–¹æ³•å‘¢ï¼ è¿™æ—¶å€™æˆ‘ä»¬å°±ç”¨åˆ°äº†ä¸€ä¸ªæ–¹æ³•ï¼šqueueMicrotask() MDNï¼šhttps://developer.mozilla.org/en-US/docs/Web/API/queueMicrotask ç®€å•æ¥è¯´ï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥æŠŠæˆ‘ä»¬ä¼ å…¥çš„æ–¹æ³•åŠ å…¥åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œè®©å®ƒå»¶è¿Ÿåˆ°å½“å‰ä¸»çº¿ç¨‹çš„ä»»åŠ¡æ‰§è¡Œå®Œä¹‹åå†æ‰§è¡Œ æ‰€ä»¥å¯ä»¥åœ¨resolveæ–¹æ³•æ‰§è¡Œçš„æ—¶å€™ï¼Œå…ˆä¸æ‰§è¡ŒonFulfilledï¼ŒæŠŠå®ƒåŠ å…¥åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œæ¥ç€å°±ä¼šç»§ç»­æ‰§è¡Œä¸‹é¢çš„thenæ–¹æ³•ï¼Œè¿™æ—¶å€™å°±æœ‰onFulfilled, onRejected æ–¹æ³•äº†ï¼Œæœ€åä¸»çº¿ç¨‹ä»»åŠ¡æ‰§è¡Œå®Œï¼Œå†æ‰§è¡Œå¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ onFulfilledï¼Œï¼Œï¼ˆrejectåŒç†ï¼‰ const resolve = (value) =&gt; &#123; if (this.status === STATUE_PENDING) &#123; queueMicrotask(() =&gt; &#123; // åŠ å…¥åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ— this.status = STATUE_FULFILLED this.value = value this.onFulfilled(this.value) &#125;) &#125;&#125;const reject = (reason) =&gt; &#123; if (this.status === STATUE_PENDING) &#123; queueMicrotask(() =&gt; &#123; // åŠ å…¥åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ— this.status = STATUS_REJECTED this.reason = reason this.onRejected(this.reason) &#125;) &#125;&#125; ä½†æ˜¯è¿™ä¸ªæ—¶å€™åˆå‡ºç°äº†ä¸€ä¸ªé—®é¢˜ï¼Œresolveå’Œrejectå¯ä»¥åŒæ—¶è°ƒç”¨äº† å› ä¸ºæˆ‘ä»¬æ‰§è¡Œresolveçš„å®ç°ï¼ŒåŠ å…¥åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œå› æ­¤çŠ¶æ€æ²¡æœ‰è¢«æ”¹å˜ï¼Œä¾ç„¶æ˜¯pending æ¥ç€æ‰§è¡Œrejectï¼Œåˆ¤æ–­çŠ¶æ€æ˜¯pendingï¼Œæ‰€ä»¥ä¹ŸåŠ å…¥åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—äº† è§£å†³ï¼šåœ¨æ‰§è¡Œå¾®ä»»åŠ¡çš„ä»£ç ä¸€å¼€å§‹åŠ å…¥ä¸€ä¸ªåˆ¤æ–­ï¼Œå¦‚æœçŠ¶æ€å·²ç»ä¸æ˜¯pendingäº†ï¼Œç›´æ¥returnå‡ºå»ï¼Œåœæ­¢æ‰§è¡Œ const resolve = (value) =&gt; &#123; if (this.status === STATUE_PENDING) &#123; queueMicrotask(() =&gt; &#123; if (this.status !== STATUE_PENDING) return // æ·»åŠ åˆ¤æ–­ this.status = STATUE_FULFILLED this.value = value this.onFulfilled(this.value) &#125;) &#125;&#125;const reject = (reason) =&gt; &#123; if (this.status === STATUE_PENDING) &#123; queueMicrotask(() =&gt; &#123; if (this.status !== STATUE_PENDING) return // æ·»åŠ åˆ¤æ–­ this.status = STATUS_REJECTED this.reason = reason this.onRejected(this.reason) &#125;) &#125;&#125; å½“ç„¶ï¼Œæœ‰äººå¯èƒ½ä¼šè¯´æŠŠçŠ¶æ€æ”¹å˜æ”¾åˆ°å¾®ä»»åŠ¡å¤–é¢ä¸å°±è¡Œäº†å—ï¼Ÿ ä¸è¡Œï¼ï¼è¿™æ ·åœ¨åé¢å®ç°é“¾å¼è°ƒç”¨ä¼šå‡ºç°é—®é¢˜ ä½ åé¢å¯ä»¥è¯•ä¸€ä¸‹ï¼Œå¤šä¸ªthenæ‰§è¡Œå’Œé“¾å¼è°ƒç”¨ä¸€èµ·çš„æ—¶å€™ï¼Œæ‰§è¡Œé¡ºåºæ˜¯æœ‰é—®é¢˜çš„ è‡³äºä¸ºä»€ä¹ˆï¼Œé‚£å°±è‡ªå·±æ‹ä¸€æ‹æ•´ä¸ªä»£ç çš„æ‰§è¡Œé¡ºåºå­ åŒæ—¶è°ƒç”¨å¤šä¸ªthençš„å®ç° ä¸Šé¢çš„å®ç°æ˜¯ä¸èƒ½åŒæ—¶è°ƒç”¨å¤šä¸ªthençš„ promise.then(res =&gt; &#123; console.log(&quot;res: &quot;, res);&#125;, err =&gt; &#123; console.log(&quot;err: &quot;, err);&#125;)promise.then(res =&gt; &#123; console.log(&quot;res2: &quot;, res);&#125;, err =&gt; &#123; console.log(&quot;err2: &quot;, err);&#125;) åé¢çš„thenä¼šè¦†ç›–å‰é¢çš„ï¼Œå› æ­¤åªä¼šæ‰§è¡Œ res2 æˆ–è€… err2 å®ç°æ€è·¯ï¼šæˆ‘ä»¬éœ€è¦æŠŠthenä¼ å…¥çš„å›è°ƒä¿å­˜åˆ°ä¸€ä¸ªæ•°ç»„ï¼Œåˆ°æ—¶å€™ä¸€èµ·æ‰§è¡Œ class MyPromise &#123; constructor(executor) &#123; this.status = STATUE_PENDING this.value = undefined this.reason = undefined this.onFulfilledCallbacks = [] // å®šä¹‰æ•°ç»„å­˜æ”¾æˆåŠŸçš„å›è°ƒ this.onRejectedCallbacks = [] // å®šä¹‰æ•°ç»„å­˜æ”¾å¤±è´¥çš„å›è°ƒ const resolve = (value) =&gt; &#123; if (this.status === STATUE_PENDING) &#123; queueMicrotask(() =&gt; &#123; // åŠ å…¥åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ— if (this.status !== STATUE_PENDING) return this.status = STATUE_FULFILLED this.value = value // ç”¨forEachéå†æ‰§è¡Œæ•°ç»„ä¸­çš„å›è°ƒ this.onFulfilledCallbacks.forEach(fn =&gt; &#123; fn(this.value) &#125;) &#125;) &#125; &#125; const reject = (reason) =&gt; &#123; if (this.status === STATUE_PENDING) &#123; queueMicrotask(() =&gt; &#123; // åŠ å…¥åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ— if (this.status !== STATUE_PENDING) return this.status = STATUS_REJECTED this.reason = reason // ç”¨forEachéå†æ‰§è¡Œæ•°ç»„ä¸­çš„å›è°ƒ this.onRejectedCallbacks.forEach(fn =&gt; &#123; fn(this.reason) &#125;) &#125;) &#125; &#125; executor(resolve, reject) &#125; then(onFulfilled, onRejected) &#123; this.onFulfilledCallbacks.push(onFulfilled) // ä¿å­˜åˆ°æ•°ç»„ this.onRejectedCallbacks.push(onRejected) &#125;&#125;const promise = new MyPromise((resolve, reject) =&gt; &#123; console.log(&quot;pending~&quot;); resolve(&quot;111&quot;) reject(&quot;222&quot;)&#125;)promise.then(res =&gt; &#123; console.log(&quot;res: &quot;, res);&#125;, err =&gt; &#123; console.log(&quot;err: &quot;, err);&#125;)promise.then(res =&gt; &#123; console.log(&quot;res2: &quot;, res);&#125;, err =&gt; &#123; console.log(&quot;err2: &quot;, err);&#125;) å»¶è¿Ÿè°ƒç”¨then è¿˜æœ‰ä¸€ç§æƒ…å†µï¼šresolveæˆ–rejectæ‰§è¡Œå®Œä¹‹åï¼Œå»¶è¿Ÿæ‰§è¡Œthen const promise = new MyPromise((resolve, reject) =&gt; &#123; console.log(&quot;pending~&quot;); resolve(&quot;111&quot;) // reject(&quot;222&quot;)&#125;)setTimeout(() =&gt; &#123; promise.then(res =&gt; &#123; console.log(&quot;res3: &quot;, res); &#125;, err =&gt; &#123; console.log(&quot;err3: &quot;, err); &#125;)&#125;, 1000) setTimeout ä¼šåœ¨ä¸»çº¿ç¨‹çš„ä»»åŠ¡æ‰§è¡Œå®Œï¼Œå¹¶ä¸”å¾®ä»»åŠ¡é˜Ÿåˆ—ä¹Ÿæ‰§è¡Œå®Œåæ‰æ‰§è¡Œ æ‹ä¸€æ‹æ‰§è¡Œé¡ºåºï¼š é¦–å…ˆä¸»çº¿ç¨‹ resolve(&quot;111&quot;)æ‰§è¡Œï¼Œå…ˆæ”¹å˜çŠ¶æ€ä¸ºfulfilledï¼Œä¿å­˜valueï¼Œç„¶ååœ¨å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­åŠ å…¥ä¸€ä¸ªä»»åŠ¡ ç„¶åç»§ç»­å¾€ä¸‹ï¼ŒsetTimeout è¢«åŠ å…¥åˆ°å®ä»»åŠ¡é˜Ÿåˆ—ï¼Œå¹¶æœªæ‰§è¡Œthen ä¸»çº¿ç¨‹ä»»åŠ¡æ‰§è¡Œå®Œï¼Œæ‰§è¡Œå¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼Œéå†æ•°ç»„ä¸­çš„å‡½æ•°å¹¶æ‰§è¡Œï¼Œä½†æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå‰é¢thenæ²¡æœ‰æ‰§è¡Œï¼Œæ•°ç»„ä¸­å¹¶æ²¡æœ‰å¯¹åº”å›è°ƒï¼Œæ‰€ä»¥æ²¡æœ‰æ‰§è¡Œ æ¥ç€æ‰§è¡Œå®ä»»åŠ¡é˜Ÿåˆ—ä¸­setTimeoutï¼Œä¹Ÿå°±æ˜¯thenæ–¹æ³•è¢«æ‰§è¡Œï¼Œ è¿™ä¸ªæ—¶å€™æ‰æŠŠå›è°ƒåŠ å…¥æ•°ç»„ã€‚ã€‚ã€‚ä»»åŠ¡ç»“æŸ å› æ­¤å¯ä»¥æƒ³åˆ°å®ç°æ€è·¯ï¼šåœ¨thenæ–¹æ³•ä¸­åŠ å…¥åˆ¤æ–­ï¼Œå¦‚æœå½“å‰çŠ¶æ€æ˜¯ç¡®å®šçš„ï¼Œï¼ˆfulfilledæˆ–rejectedï¼‰ï¼Œé‚£ä¹ˆç›´æ¥æ‰§è¡Œè¿™ä¸ªå›è°ƒï¼Œä¸ç”¨æ·»åŠ åˆ°æ•°ç»„ then(onFulfilled, onRejected) &#123; if (this.status === STATUE_FULFILLED &amp;&amp; onFulfilled) &#123; onFulfilled(this.value) &#125; if (this.status === STATUS_REJECTED &amp;&amp; onRejected) &#123; onRejected(this.reason) &#125; if (this.status === STATUE_PENDING) &#123; this.onFulfilledCallbacks.push(onFulfilled) this.onRejectedCallbacks.push(onRejected) &#125;&#125; é“¾å¼è°ƒç”¨then thenéœ€è¦è¿”å›ä¸€ä¸ªpromiseï¼Œåé¢æ‰èƒ½ç»§ç»­è°ƒç”¨then å¹¶ä¸”ä¸‹ä¸€æ¬¡çš„thenæ˜¯åœ¨ä¸Šæ¬¡å›è°ƒæ‰§è¡Œå®Œä¹‹åæ‰æ‰§è¡Œçš„ï¼Œè€Œä¸”éœ€è¦æ‹¿åˆ°ä¸Šæ¬¡onFulfilled/onRejected æ‰§è¡Œå®Œä¹‹åçš„ç»“æœï¼Œå†å»æ‰§è¡Œresolveï¼Œreject then(onFulfilled, onRejected) &#123; if (this.status === STATUE_FULFILLED &amp;&amp; onFulfilled) &#123; onFulfilled(this.value) &#125; if (this.status === STATUS_REJECTED &amp;&amp; onRejected) &#123; onRejected(this.reason) &#125; if (this.status === STATUE_PENDING) &#123; this.onFulfilledCallbacks.push(onFulfilled) this.onRejectedCallbacks.push(onRejected) &#125; return new MyPromise((resolve, reject) =&gt; &#123; resolve() // è¿™é‡Œéœ€è¦æ‹¿åˆ°ä¸Šæ¬¡å›è°ƒçš„ç»“æœå¹¶ä¸”ä¼ è¿›å» reject() &#125;)&#125; ç°åœ¨æœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æ€ä¹ˆæ‹¿åˆ°ä¸Šæ¬¡æ‰§è¡Œçš„ç»“æœå€¼ï¼Ÿ æ€è·¯ï¼šæŠŠä¸Šé¢é‚£ä¸€å¨ä»£ç æ”¾åˆ°newé‡Œé¢æ‰§è¡Œï¼Œè¿™æ ·å°±è®©é‡Œè¾¹å…·å¤‡äº†æ‹¿åˆ°è¿”å›ç»“æœçš„èƒ½åŠ› then(onFulfilled, onRejected) &#123; return new MyPromise((resolve, reject) =&gt; &#123; if (this.status === STATUE_FULFILLED &amp;&amp; onFulfilled) &#123; // æ¯”å¦‚è¿™é‡Œå°±å¯ä»¥æ‹¿åˆ°ç»“æœ const value = onFulfilled(this.value) // ç„¶åå†æ‰§è¡Œ(è¿™é‡Œå·²ç»æ˜¯ä¸‹ä¸€ä¸ªpromiseçš„resolveäº†) resolve(value) &#125; if (this.status === STATUS_REJECTED &amp;&amp; onRejected) &#123; const reason = onRejected(this.reason) // æ³¨æ„è¿™é‡Œè°ƒç”¨çš„åº”è¯¥æ˜¯resolveï¼Œé™¤éä¸Šä¸€æ¬¡çš„é”™è¯¯å›è°ƒå‡½æ•°æŠ›å‡ºäº†é”™è¯¯ resolve(reason) &#125; if (this.status === STATUE_PENDING) &#123; this.onFulfilledCallbacks.push(onFulfilled) this.onRejectedCallbacks.push(onRejected) &#125; &#125;)&#125; å› ä¸ºå³ä½¿æˆ‘ä»¬ä¸é“¾å¼è°ƒç”¨ï¼Œé‡Œé¢çš„ä»£ç è¿˜æ˜¯ä¼šæ‰§è¡Œçš„ï¼Œæˆ‘ä»¬åªæ˜¯æƒ³æ‹¿åˆ°æƒ³è¦çš„ç»“æœï¼Œå¹¶ä¸”åœ¨æŸä¸ªæ—¶æœºè°ƒç”¨ resolve, reject ä¸¤ç§æƒ…å†µéƒ½è°ƒç”¨resolveï¼Ÿé‚£ä»€ä¹ˆæ—¶å€™è°ƒç”¨rejectå‘¢ï¼Ÿ æˆ‘ä»¬çŸ¥é“ï¼Œåªæœ‰åœ¨ä¸Šæ¬¡çš„thenä¸­æŠ›å‡ºå¼‚å¸¸äº†ï¼Œä¸‹æ¬¡æ‰ä¼šæ‰§è¡Œreject æ‰€ä»¥æˆ‘ä»¬å†æ”¹è¿›ä¸€ä¸‹ï¼šä½¿ç”¨tryâ€¦catch then(onFulfilled, onRejected) &#123; return new MyPromise((resolve, reject) =&gt; &#123; if (this.status === STATUE_FULFILLED &amp;&amp; onFulfilled) &#123; try &#123; const value = onFulfilled(this.value) resolve(value) &#125; catch (err) &#123; reject(err) &#125; &#125; if (this.status === STATUS_REJECTED &amp;&amp; onRejected) &#123; try &#123; const reason = onRejected(this.reason) resolve(reason) &#125; catch (err) &#123; reject(err) &#125; &#125; if (this.status === STATUE_PENDING) &#123; this.onFulfilledCallbacks.push(onFulfilled) this.onRejectedCallbacks.push(onRejected) &#125; &#125;)&#125; ä¸Šé¢éƒ½æ˜¯åœ¨çŠ¶æ€å·²ç»ç¡®å®šä¹‹åçš„æƒ…å†µï¼Œæˆ‘ä»¬çŸ¥é“åœ¨çŠ¶æ€ä¸ºpendingçš„æ—¶å€™ï¼Œæˆ‘ä»¬æ˜¯æŠŠå›è°ƒä¿å­˜åˆ°æ•°ç»„ï¼Œç„¶ååœ¨ä¸Šé¢çš„resolveã€rejectä¸­éå†æ•°ç»„æ‰§è¡Œçš„ this.onFulfilledCallbacks.forEach(fn =&gt; &#123; let value = fn(this.value) // åœ¨è¿™é‡Œæ‰§è¡Œçš„&#125;) é‚£è¿™ä¸ªæ‰§è¡Œç»“æœæ€ä¹ˆæ‹¿åˆ°å‘¢ç„¶åä¼ ç»™ä¸‹é¢çš„resolveã€rejectå‘¢ï¼Ÿ è§£å†³æ–¹æ¡ˆï¼šæ”¹è¿›æˆ‘ä»¬æ·»åŠ åˆ°æ•°ç»„çš„æ–¹å¼ if (this.status === STATUE_PENDING) &#123; this.onFulfilledCallbacks.push(() =&gt; &#123; onFulfilled() &#125;) this.onRejectedCallbacks.push(() =&gt; &#123; onRejected() &#125;) &#125; æˆ‘ä»¬ä¸ç›´æ¥æŠŠå›è°ƒæ·»åŠ åˆ°æ•°ç»„ï¼Œè€Œæ˜¯ä½¿ç”¨ä¸€ä¸ªå‡½æ•°åŒ…è£¹èµ·æ¥ï¼Œé‚£ä¹ˆåˆ°æ—¶ä¸Šé¢éå†æ‰§è¡Œçš„å°±æ˜¯è¿™ä¸ªåŒ…è£¹çš„å‡½æ•°ï¼Œç„¶åæˆ‘ä»¬åœ¨è¿™é‡Œå†…éƒ¨æ‰§è¡ŒonFulfilledï¼Œå°±å¯ä»¥åœ¨è¿™é‡Œæ‹¿åˆ°onFulfilledçš„æ‰§è¡Œç»“æœ if (this.status === STATUE_PENDING) &#123; this.onFulfilledCallbacks.push(() =&gt; &#123; const value = onFulfilled(this.value) resolve(value) &#125;) this.onRejectedCallbacks.push(() =&gt; &#123; const reason = onRejected(this.reason) resolve(reason) &#125;) &#125; åŒç†ï¼Œtryâ€¦catchæ”¹è¿›ä¸€ä¸‹ if (this.status === STATUE_PENDING) &#123; this.onFulfilledCallbacks.push(() =&gt; &#123; try &#123; const value = onFulfilled(this.value) resolve(value) &#125; catch (err) &#123; reject(err) &#125; &#125;) this.onRejectedCallbacks.push(() =&gt; &#123; try &#123; const reason = onRejected(this.reason) resolve(reason) &#125; catch (err) &#123; reject(err) &#125; &#125;) &#125; æµ‹è¯•çš„æ—¶å€™å‘ç°ï¼Œæœ‰ä¸€ç§æƒ…å†µæˆ‘ä»¬æ²¡æœ‰å¤„ç† const promise = new MyPromise((resolve, reject) =&gt; &#123; console.log(&quot;pending~&quot;); // resolve(&quot;111&quot;) // reject(&quot;222&quot;) throw new Error(&quot;error message&quot;)&#125;) æ”¹è¿›ï¼Œåœ¨ executor é‚£é‡ŒåŠ tryâ€¦catchï¼Œå¦‚æœæŠ›å‡ºäº†å¼‚å¸¸ç›´æ¥æ‰§è¡Œreject try &#123; executor(resolve, reject)&#125; catch (err) &#123; reject(err)&#125; æµ‹è¯•ï¼š const promise = new MyPromise((resolve, reject) =&gt; &#123; console.log(&quot;pending~&quot;); throw new Error(&quot;error message&quot;)&#125;)promise.then(res =&gt; &#123; console.log(&quot;res: &quot;, res); return &quot;aaa&quot;&#125;, err =&gt; &#123; console.log(&quot;err: &quot;, err); // æ‰§è¡Œè¿™é‡Œ return &quot;bbb&quot;&#125;).then(res =&gt; &#123; console.log(&quot;res2: &quot;, res); // ç„¶åæ¥åˆ°è¿™é‡Œ&#125;, err =&gt; &#123; console.log(&quot;err2: &quot;, err);&#125;) æµ‹è¯•æ²¡é—®é¢˜ï¼ï¼ å·¥å…·å‡½æ•° åˆ°è¿™é‡Œthenæ–¹æ³•åŸºæœ¬å°±å®ç°å®Œäº†ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°å¾ˆå¤š tryâ€¦catchçš„é‡å¤ä»£ç  æˆ‘ä»¬å¯ä»¥åšä¸€ä¸ªæŠ½å–ï¼Œå®šä¹‰ä¸€ä¸ªå·¥å…·å‡½æ•° function execFunctionWithCatchError(exeFn, value, resolve, reject) &#123; try &#123; const result = exeFn(value) resolve(result) &#125; catch (err) &#123; reject(err) &#125;&#125; ç„¶åä¼˜åŒ–thenæ–¹æ³•ï¼š then(onFulfilled, onRejected) &#123; return new MyPromise((resolve, reject) =&gt; &#123; if (this.status === STATUE_FULFILLED &amp;&amp; onFulfilled) &#123; // try &#123; // const value = onFulfilled(this.value) // resolve(value) // &#125; catch (err) &#123; // reject(err) // &#125; execFunctionWithCatchError(onFulfilled, this.value, resolve, reject) &#125; if (this.status === STATUS_REJECTED &amp;&amp; onRejected) &#123; execFunctionWithCatchError(onRejected, this.reason, resolve, reject) &#125; if (this.status === STATUE_PENDING) &#123; this.onFulfilledCallbacks.push(() =&gt; &#123; execFunctionWithCatchError(onFulfilled, this.value, resolve, reject) &#125;) this.onRejectedCallbacks.push(() =&gt; &#123; execFunctionWithCatchError(onRejected, this.reason, resolve, reject) &#125;) &#125; &#125;)&#125; catch æ–¹æ³•çš„å®ç° catchæ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯å¤±è´¥çš„å›è°ƒï¼Œå› ä¸ºcatchå®é™…ä¸Šå°±ç›¸å½“äºè¯­æ³•ç³–ï¼Œè€Œä¸”ä¹Ÿæ˜¯è¿”å›ä¸€ä¸ªæ–°çš„promiseï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥è°ƒç”¨then catch(onRejected) &#123; return this.then(undefined, onRejected)&#125; æµ‹è¯•ï¼š const promise = new MyPromise((resolve, reject) =&gt; &#123; console.log(&quot;pending~&quot;); // resolve(111) reject(222)&#125;)promise.then(res =&gt; &#123; console.log(&quot;res: &quot;, res); return &quot;aaa&quot;&#125;).catch(err =&gt; &#123; console.log(&quot;catch&quot;, err);&#125;) é¢ï¼ŒæŠ¥é”™äº† åˆ«æ€¥ï¼Œåˆ†æåŸå› ã€‚ æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿä¸€ä¸‹ï¼Œæœ¬æ¥æˆ‘ä»¬çš„å¤±è´¥å›è°ƒåº”è¯¥æ˜¯åœ¨ç¬¬ä¸€ä¸ªthenä¸­ä¼ å…¥çš„ï¼Œæ˜¯ä½œä¸ºç¬¬ä¸€ä¸ªpromiseçš„å¤±è´¥çš„å›è°ƒçš„ promise.then(res =&gt; &#123; console.log(&quot;res: &quot;, res); return &quot;aaa&quot;&#125;, err =&gt; &#123; console.log(&quot;catch&quot;, err);&#125;).catch() ä½†æ˜¯ç°åœ¨æˆ‘ä»¬å†™åˆ°catché‡Œé¢ï¼Œæ„å‘³ç€è¿™ä¸ªcatchä¼ å…¥çš„å›è°ƒæ˜¯è¢«åŠ å…¥åˆ°ä¸€ä¸ªæ–°çš„promiseä¸­ï¼Œä½œä¸ºæ–°çš„promiseçš„å¤±è´¥çš„å›è°ƒäº†ï¼Œæ‰€ä»¥æ‰§è¡Œä¸åˆ°è¿™ä¸ªå›è°ƒäº† promise1 -&gt; undefined promise2 -&gt; err ={} é‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆæ ·è®©promise1æ‰§è¡Œåˆ°err ={} å‘¢ï¼Ÿï¼Ÿ å®ç°æ€è·¯ï¼šå‡å¦‚è¯´promise1çš„å¤±è´¥å›è°ƒæ²¡æœ‰å€¼ï¼Œæˆ‘ä»¬ç›´æ¥æŠ›å‡ºå»ï¼Œè¿™æ ·å°±ä¼šæ¥åˆ°promise2ä¸­å¤±è´¥çš„å›è°ƒäº† promise1 -&gt; err =&gt; {throw err} // æŠ›å‡ºå» promise2 -&gt; err ={} // å°±ä¼šæ‰§è¡Œåˆ°è¿™é‡Œ è¿˜æœ‰ä¸€ä¸ªåœ°æ–¹æ˜¯ï¼Œæ—¢ç„¶onFulfilledæˆ–onRejectedå¯èƒ½ä¼šä¼ è¿›æ¥undefinedï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ€å¥½åŠ ä¸Šä¸€ä¸ªåˆ¤æ–­ then(onFulfilled, onRejected) &#123; const defaultOnRejected = err =&gt; &#123; throw err &#125; // æ·»åŠ éƒ¨åˆ† onRejected = onRejected || defaultOnRejected return new MyPromise((resolve, reject) =&gt; &#123; if (this.status === STATUE_FULFILLED &amp;&amp; onFulfilled) &#123; execFunctionWithCatchError(onFulfilled, this.value, resolve, reject) &#125; if (this.status === STATUS_REJECTED &amp;&amp; onRejected) &#123; execFunctionWithCatchError(onRejected, this.reason, resolve, reject) &#125; if (this.status === STATUE_PENDING) &#123; if (onFulfilled) this.onFulfilledCallbacks.push(() =&gt; &#123; execFunctionWithCatchError(onFulfilled, this.value, resolve, reject) &#125;) if (onRejected) this.onRejectedCallbacks.push(() =&gt; &#123; execFunctionWithCatchError(onRejected, this.reason, resolve, reject) &#125;) &#125; &#125;)&#125; finally æ–¹æ³•çš„å®ç° æ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œæ— è®ºæˆåŠŸæˆ–å¤±è´¥ï¼Œæœ€åéƒ½ä¼šæ‰§è¡Œ ä¹Ÿå°±æ˜¯è¯´ï¼ŒæˆåŠŸä¸å¤±è´¥çš„å›è°ƒéƒ½æ˜¯ä½ ä¼ å…¥çš„é‚£ä¸ªå‡½æ•° // finallyfinally(onFinally) &#123; return this.then(() =&gt; &#123; onFinally() &#125;, () =&gt; &#123; onFinally() &#125;)&#125; ä½†æ˜¯è¿˜ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ const promise = new MyPromise((resolve, reject) =&gt; &#123; console.log(&quot;pending~&quot;); resolve(111) // è°ƒç”¨resolveæœ‰é—®é¢˜ // reject(222) è°ƒç”¨rejectæ²¡é—®é¢˜&#125;)promise.then(res =&gt; &#123; console.log(&quot;res: &quot;, res); // åœˆ1&#125;).catch(err =&gt; &#123; console.log(&quot;catch&quot;, err);// åœˆ2&#125;).finally(() =&gt; &#123; console.log(&#x27;finally&#x27;); // åœˆ3&#125;) åˆ†æï¼šæ‹ä¸€æ‹ å¦‚æœä¸Šé¢æ˜¯resolveçš„è¯ï¼Œé‚£ä¹ˆå°±ä¼šæ‰§è¡Œåœˆ1ï¼Œç„¶åæ¥åˆ°promise2çš„æˆåŠŸå›è°ƒ promise1ï¼šæˆåŠŸå›è°ƒæ˜¯ åœˆ1ï¼Œå¤±è´¥å›è°ƒæ˜¯æˆ‘ä»¬é»˜è®¤çš„reject promise2ï¼šæ²¡æœ‰æˆåŠŸå›è°ƒï¼Œå¤±è´¥å›è°ƒæ˜¯åœˆ2ï¼Œ â€‹ æ²¡æœ‰æˆåŠŸå›è°ƒï¼Œè¿™æ—¶å€™å°±ä¼šå‡ºé”™äº†ï¼Œåé¢ä¹Ÿä¸ä¼šç»§ç»­æ‰§è¡Œäº†ï¼Œå› æ­¤è¦ç»™é»˜è®¤çš„æˆåŠŸå›è°ƒ value =&gt; { return value } ç„¶åæ‰ä¼šæ‰§è¡Œfinallyçš„ç¬¬ä¸€ä¸ªå›è°ƒ then(onFulfilled, onRejected) &#123; const defaultOnRejected = err =&gt; &#123; throw err &#125; onRejected = onRejected || defaultOnRejected // æ·»åŠ éƒ¨åˆ† const defaultOnFulfilled = value =&gt; &#123; return value &#125; onFulfilled = onFulfilled || defaultOnFulfilled // æ¥åˆ°è¿™é‡Œå°±å¯ä»¥ä¿è¯ onRejectedï¼ŒonFulfilled æ˜¯æœ‰å€¼çš„äº†ï¼Œæ‰€ä»¥ä¸‹é¢çš„åˆ¤æ–­ä¹Ÿå¯ä»¥ä¸è¦äº† return new MyPromise((resolve, reject) =&gt; &#123; if (this.status === STATUE_FULFILLED) &#123; // æ”¹äº†è¿™é‡Œ execFunctionWithCatchError(onFulfilled, this.value, resolve, reject) &#125; if (this.status === STATUS_REJECTED) &#123; // æ”¹äº†è¿™é‡Œ execFunctionWithCatchError(onRejected, this.reason, resolve, reject) &#125; if (this.status === STATUE_PENDING) &#123; if (onFulfilled) this.onFulfilledCallbacks.push(() =&gt; &#123; execFunctionWithCatchError(onFulfilled, this.value, resolve, reject) &#125;) if (onRejected) this.onRejectedCallbacks.push(() =&gt; &#123; execFunctionWithCatchError(onRejected, this.reason, resolve, reject) &#125;) &#125; &#125;)&#125; resolve reject ç±»æ–¹æ³•çš„å®ç° resolve ç±»æ–¹æ³•æœ¬è´¨å°±æ˜¯newäº†ä¸€ä¸ª promiseï¼Œç„¶åç›´æ¥è°ƒç”¨resolve rejectåŒç† static resolve(value) &#123; return new MyPromise((resolve) =&gt; resolve(value))&#125;static reject(reason) &#123; return new MyPromise((resolve, reject) =&gt; reject(reason))&#125; æµ‹è¯•ï¼š MyPromise.resolve(123).then(res =&gt; &#123; console.log(res); // 123&#125;) all æ–¹æ³•çš„å®ç° allæ–¹æ³•æ¥æ”¶ä¸€ä¸ªpromiseæ•°ç»„ï¼ŒåŒæ ·è¿”å›ä¸€ä¸ªpromise å…³é”®æ€è·¯ï¼šä»€ä¹ˆæ—¶å€™è¦æ‰§è¡Œresolve, ä»€ä¹ˆæ—¶å€™è¦æ‰§è¡Œreject static all(promises) &#123; return new MyPromise((resolve, reject) =&gt; &#123; const values = [] // å®šä¹‰ç»“æœæ•°ç»„ promises.forEach(promise =&gt; &#123; promise.then(res =&gt; &#123; values.push(res)// å½“ç»“æœçš„ä¸ªæ•°ç­‰äºä¼ å…¥promiseä¸ªæ•°çš„æ—¶å€™ï¼Œè¡¨ç¤ºå·²ç»æ‰§è¡Œå®Œäº†ï¼Œç„¶åå†å›è°ƒresolve if (values.length === promises.length) &#123; resolve(values) &#125; &#125;, err =&gt; &#123; reject(err) // å¤±è´¥ç›´æ¥æ‰§è¡Œå›è°ƒreject &#125;) &#125;) &#125;)&#125; æµ‹è¯•ï¼š const p1 = new MyPromise((resolve) =&gt; &#123; setTimeout(() =&gt; &#123; resolve(&quot;111&quot;) &#125;, 1000);&#125;)const p2 = new MyPromise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; resolve(&quot;222&quot;) // reject(&quot;222&quot;) &#125;, 2000);&#125;)const p3 = new MyPromise((resolve) =&gt; &#123; setTimeout(() =&gt; &#123; resolve(&quot;333&quot;) &#125;, 3000);&#125;)MyPromise.all([p1, p2, p3]).then(res =&gt; &#123; console.log(res); // [&#x27;111&#x27;, &#x27;222&#x27;, &#x27;333&#x27;]&#125;, err =&gt; &#123; console.log(err); // å¦‚æœp2è°ƒç”¨rejectï¼Œå°±ä¼šæ‰§è¡Œè¿™é‡Œï¼Œè¾“å‡º 222&#125;) allSettled æ–¹æ³•çš„å®ç° ä¸allç±»å‹ï¼ŒåŒºåˆ«å°±æ˜¯æ— è®ºæˆåŠŸä¸å¦éƒ½ä¼šæŠŠç»“æœä¿å­˜åˆ°æ•°ç»„ æµ‹è¯•ï¼š const p1 = new MyPromise((resolve) =&gt; &#123; setTimeout(() =&gt; &#123; resolve(&quot;111&quot;) &#125;, 1000);&#125;)const p2 = new MyPromise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; reject(&quot;222&quot;) // reject(&quot;222&quot;) &#125;, 2000);&#125;)const p3 = new MyPromise((resolve) =&gt; &#123; setTimeout(() =&gt; &#123; resolve(&quot;333&quot;) &#125;, 3000);&#125;)MyPromise.allSettled([p1, p2, p3]).then(res =&gt; &#123; console.log(res);&#125;) race æ–¹æ³•çš„å®ç° åªè¦çŠ¶æ€æ”¹å˜å°±æ‰§è¡Œå›è°ƒ static race(promises) &#123; return new MyPromise((resolve, reject) =&gt; &#123; promises.forEach(promise =&gt; &#123; // promise.then(res =&gt; &#123; // resolve(res) // &#125;, err =&gt; &#123; // reject(err) // &#125;) // ä¹Ÿå¯ä»¥è¿™ä¹ˆå†™ promise.then(resolve, reject) &#125;) &#125;)&#125; any æ–¹æ³•çš„å®ç° ç­‰åˆ°ç¬¬ä¸€ä¸ªfulfilledçŠ¶æ€ï¼Œæ‰æ‰§è¡Œresolveå›è°ƒ å¦‚æœå…¨éƒ½æ˜¯rejectedçŠ¶æ€ï¼Œé‚£ä¹ˆæŠ›å‡ºå¼‚å¸¸ static any(promises) &#123; const reasons = [] return new MyPromise((resolve, reject) =&gt; &#123; promises.forEach(promise =&gt; &#123; promise.then(res =&gt; &#123; resolve(res) &#125;, err =&gt; &#123; reasons.push(err) // å½“å…¨éƒ¨promiseæ‰§è¡Œå®Œä¹‹å if (reasons.length === promises.length) &#123; reject(new AggregateError(reasons)) &#125; &#125;) &#125;) &#125;)&#125; æµ‹è¯•å…¨éƒ½æ˜¯rejectçš„æƒ…å†µ const p1 = new MyPromise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; reject(&quot;111&quot;) &#125;, 1000);&#125;)const p2 = new MyPromise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; reject(&quot;222&quot;) &#125;, 2000);&#125;)const p3 = new MyPromise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; reject(&quot;333&quot;) &#125;, 3000);&#125;)MyPromise.any([p1, p2, p3]).then(res =&gt; &#123; console.log(res);&#125;, err =&gt; &#123; console.log(err, err.errors);&#125;) åˆ°æ­¤ï¼Œæ‰‹å†™promiseå°±å·®ä¸å¤šå¤§åŠŸå‘Šæˆå•¦ï¼","categories":[{"name":"ğŸ”«æ·±å…¥JSé«˜çº§è¯­æ³•","slug":"ğŸ”«æ·±å…¥JSé«˜çº§è¯­æ³•","permalink":"https://hillyee.github.io/categories/%F0%9F%94%AB%E6%B7%B1%E5%85%A5JS%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/"}],"tags":[{"name":"promise","slug":"promise","permalink":"https://hillyee.github.io/tags/promise/"}]},{"title":"promiseè¯¦è§£","slug":"promiseè¯¦è§£","date":"2022-04-17T15:22:28.000Z","updated":"2022-04-17T15:24:30.080Z","comments":true,"path":"2022/04/17/promiseè¯¦è§£/","link":"","permalink":"https://hillyee.github.io/2022/04/17/promise%E8%AF%A6%E8%A7%A3/","excerpt":"","text":"Promiseè¯¦è§£ ES6 æ–°å¢ Promise ä»‹ç» Promise æ˜¯å¼‚æ­¥ç¼–ç¨‹çš„ä¸€ç§è§£å†³æ–¹æ¡ˆï¼š ä»è¯­æ³•ä¸Šè®²ï¼Œpromiseæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä»å®ƒå¯ä»¥è·å–å¼‚æ­¥æ“ä½œçš„æ¶ˆæ¯ï¼› ä»æœ¬æ„ä¸Šè®²ï¼Œå®ƒæ˜¯æ‰¿è¯ºï¼Œæ‰¿è¯ºå®ƒè¿‡ä¸€æ®µæ—¶é—´ä¼šç»™ä½ ä¸€ä¸ªç»“æœã€‚ 1.ä¸ºä»€ä¹ˆéœ€è¦æœ‰Promiseï¼Ÿ promiseä¸»è¦è§£å†³çš„é—®é¢˜ï¼š å›è°ƒåœ°ç‹±ï¼Œä»£ç éš¾ä»¥ç»´æŠ¤ï¼Œ å¸¸å¸¸ç¬¬ä¸€ä¸ªçš„å‡½æ•°çš„è¾“å‡ºæ˜¯ç¬¬äºŒä¸ªå‡½æ•°çš„è¾“å…¥è¿™ç§ç°è±¡ promiseå¯ä»¥æ”¯æŒå¤šä¸ªå¹¶å‘çš„è¯·æ±‚ï¼Œè·å–å¹¶å‘è¯·æ±‚ä¸­çš„æ•°æ® è¿™ä¸ªpromiseå¯ä»¥è§£å†³å¼‚æ­¥çš„é—®é¢˜ï¼Œæœ¬èº«ä¸èƒ½è¯´promiseæ˜¯å¼‚æ­¥çš„ è¡¥å……ä¸€ä¸‹ï¼Œä»€ä¹ˆæ˜¯å›è°ƒå‡½æ•°ï¼Ÿ å°±æ˜¯æˆ‘ç»™ä½ ä¼ ä¸€ä¸ªå‡½æ•°ï¼Œä½ åè¿‡æ¥è°ƒç”¨æˆ‘ ä¸€èˆ¬æ¥è¯´æˆ‘ä»¬ä¼šç¢°åˆ°çš„å›è°ƒåµŒå¥—éƒ½ä¸ä¼šå¾ˆå¤šï¼Œä¸€èˆ¬å°±ä¸€åˆ°ä¸¤çº§ï¼Œä½†æ˜¯æŸäº›æƒ…å†µä¸‹ï¼Œå›è°ƒåµŒå¥—å¾ˆå¤šæ—¶ï¼Œä»£ç å°±ä¼šéå¸¸ç¹çï¼Œä¼šç»™æˆ‘ä»¬çš„ç¼–ç¨‹å¸¦æ¥å¾ˆå¤šçš„éº»çƒ¦ï¼Œè¿™ç§æƒ…å†µä¿—ç§°â€”â€”å›è°ƒåœ°ç‹±ã€‚ // å½“å‚æ•°aå¤§äº10ä¸”å‚æ•°fn2æ˜¯ä¸€ä¸ªæ–¹æ³•æ—¶ æ‰§è¡Œfn2function fn1(a, fn2) &#123; if (a &gt; 10 &amp;&amp; typeof fn2 == &#x27;function&#x27;) &#123; fn2() // å›è°ƒå‡½æ•° &#125;&#125;fn1(11, function() &#123; console.log(&#x27;this is a callback&#x27;)&#125;) 2.Promiseæ˜¯ä»€ä¹ˆï¼Ÿæ€ä¹ˆä½¿ç”¨ï¼Ÿ Promise æ˜¯ä¸€ä¸ªç±»ï¼Œå­—é¢æ„æ€ï¼šæ‰¿è¯ºã€æœŸçº¦ é€šè¿‡ new å¯ä»¥åˆ›å»ºä¸€ä¸ª Promise å¯¹è±¡ï¼Œå¹¶ä¸”éœ€è¦ä¼ å…¥å›è°ƒå‡½æ•°ï¼ˆexecutorï¼‰ è¿™ä¸ªå›è°ƒå‡½æ•°ä¼šè¢«ç«‹å³æ‰§è¡Œï¼Œå¹¶ä¸”ä¼šä¼ å…¥å¦å¤–ä¸¤ä¸ªå›è°ƒå‡½æ•° resolveã€reject å½“æˆ‘ä»¬è°ƒç”¨resolveå›è°ƒå‡½æ•°æ—¶ï¼Œä¼šæ‰§è¡ŒPromiseå¯¹è±¡çš„thenæ–¹æ³•ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå½“è°ƒç”¨rejectçš„æ—¶å€™ï¼Œä¼šæ‰§è¡Œç¬¬äºŒä¸ªå›è°ƒ const promise = new Promise((resolve, reject) =&gt; &#123; resolve(&quot;success message&quot;) // reject(&quot;failure&quot;)&#125;)promise.then(res =&gt; &#123; console.log(res);&#125;, err =&gt; &#123; console.log(err);&#125;) Promiseçš„ä¸‰ç§çŠ¶æ€ Promiseä½¿ç”¨è¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒåˆ’åˆ†æˆä¸‰ä¸ªçŠ¶æ€ï¼š pendingï¼šå¾…å®šï¼Œåˆå§‹çŠ¶æ€ï¼Œæ—¢æ²¡æœ‰è¢«å…‘ç°ï¼Œä¹Ÿæ²¡æœ‰è¢«æ‹’ç»ï¼›å½“æ‰§è¡Œexecutorä¸­çš„ä»£ç æ—¶ï¼Œå¤„äºè¯¥çŠ¶æ€ï¼› fulfilledï¼šå·²å…‘ç°ï¼Œ æ„å‘³ç€æ“ä½œæˆåŠŸå®Œæˆï¼›æ‰§è¡Œäº†resolveæ—¶ï¼Œå¤„äºè¯¥çŠ¶æ€ï¼› ï¼ˆä¹Ÿæœ‰çš„åœ°æ–¹å«resolvedçŠ¶æ€ï¼‰ rejectedï¼šå·²æ‹’ç»ï¼Œæ„å‘³ç€æ“ä½œå¤±è´¥ï¼› æ‰§è¡Œäº†rejectæ—¶ï¼Œå¤„äºè¯¥çŠ¶æ€ï¼› new Promise((resolve, reject) =&gt; &#123; // pendingå¾…å®š resolve() // fulfilled(å·²å®Œæˆ) reject() // rejected(å·²æ‹’ç»)&#125;).then(res =&gt; &#123; console.log(res);&#125;, err =&gt; &#123; console.log(err);&#125;) æ³¨æ„ï¼šPromiseçš„çŠ¶æ€ä¸€æ—¦ç¡®å®šï¼Œå°±ä¸å¯æ›´æ”¹ï¼Œåªæœ‰ä¸¤ç§çŠ¶æ€æ”¹å˜ï¼š pending -&gt; fulfilled pending -&gt; rejected å¦å¤–æˆ‘ä»¬å¦‚æœæŠ›å‡ºå¼‚å¸¸ï¼ŒçŠ¶æ€ä¹Ÿæ˜¯rejectedï¼Œä¼šå›è°ƒthençš„ç¬¬äºŒä¸ªå‚æ•° new Promise((resolve, reject) =&gt; &#123; throw new Error(&quot;å¼‚å¸¸&quot;)&#125;).then(res =&gt; &#123; console.log(res);&#125;, err =&gt; &#123; console.log(err); // Error: å¼‚å¸¸&#125;) resolveä¸åŒå€¼çš„åŒºåˆ« resolve(å‚æ•°)ï¼šresolveçš„å‚æ•°ï¼Œä¸‰ç§æƒ…å†µ å‚æ•°æ˜¯æ™®é€šå€¼(æ•°å€¼/å­—ç¬¦ä¸²/æ™®é€šå¯¹è±¡/undefined)ï¼ŒçŠ¶æ€å˜åŒ– pending -&gt; fulfilled å‚æ•°åˆæ˜¯ä¸€ä¸ªPromiseå¯¹è±¡ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–°Promiseä¼šå†³å®šåŸPromiseçš„çŠ¶æ€ const newPromise = new Promise((resolve, reject) =&gt; &#123; resolve(&quot;hahhaha&quot;) // reject()&#125;)new Promise((resolve, reject) =&gt; &#123; resolve(newPromise) // çŠ¶æ€ç”±newPromiseå†³å®š&#125;).then(res =&gt; &#123; console.log(res); // hahhaha&#125;, err =&gt; &#123; console.log(err);&#125;) å‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶ä¸”è¿™ä¸ªå¯¹è±¡æœ‰å®ç°thenæ–¹æ³•ï¼Œé‚£ä¹ˆä¼šæ‰§è¡Œè¯¥thenæ–¹æ³•ï¼Œå¹¶ä¸”æ ¹æ® thenæ–¹æ³•çš„ç»“æœæ¥å†³å®šPromiseçš„çŠ¶æ€ new Promise((resolve, reject) =&gt; &#123; const obj = &#123; then: function(resolve, reject) &#123; resolve(&quot;resolve message&quot;) // reject() &#125; &#125; resolve(obj)&#125;).then(res =&gt; &#123; console.log(res); &#125;, err =&gt; &#123; console.log(err);&#125;) Promiseå¯¹è±¡æ–¹æ³• thenï¼Œcatchï¼Œfinally thenæ–¹æ³• 1. ä¸¤ä¸ªå‚æ•° thenæ–¹æ³•æ˜¯Promiseå¯¹è±¡ä¸Šçš„æ–¹æ³•ï¼Œå®é™…ä¸Šæ˜¯æ”¾åœ¨Promiseçš„åŸå‹ä¸Šçš„ï¼šPromise.prototype.then thenæ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼š fulfilledçš„å›è°ƒå‡½æ•°ï¼šå½“çŠ¶æ€å˜æˆfulfilledæ—¶ä¼šå›è°ƒçš„å‡½æ•° rejectçš„å›è°ƒå‡½æ•°ï¼šå½“çŠ¶æ€å˜æˆrejectæ—¶ä¼šå›è°ƒçš„å‡½æ•° 2. å¤šæ¬¡è°ƒç”¨ åŒä¸€ä¸ªPromiseæ˜¯å¯ä»¥è¢«å¤šæ¬¡è°ƒç”¨thenæ–¹æ³•çš„ï¼Œå½“resolveæ–¹æ³•è¢«å›è°ƒæ—¶ï¼Œæ‰€æœ‰çš„thenæ–¹æ³•ä¼ å…¥çš„å›è°ƒå‡½æ•°éƒ½ä¼šè¢«è°ƒç”¨ const promise = new Promise((resolve, reject) =&gt; &#123; resolve(&quot;success&quot;)&#125;)// æ³¨æ„è¿™ä¸æ˜¯é“¾å¼è°ƒç”¨promise.then(res1 =&gt; &#123; console.log(res1); // success&#125;)promise.then(res2 =&gt; &#123; console.log(res2); // success&#125;)promise.then(res3 =&gt; &#123; console.log(res3); // success&#125;) 3. thençš„è¿”å›å€¼ thenæ–¹æ³•æœ¬èº«æ˜¯æœ‰è¿”å›å€¼çš„ï¼Œå®ƒçš„è¿”å›å€¼æ˜¯Promise å¦‚æœæˆ‘ä»¬thençš„ç¬¬ä¸€ä¸ªå›è°ƒè¿”å›çš„æ˜¯ä¸€ä¸ªæ™®é€šå€¼(æ•°å€¼/å­—ç¬¦ä¸²/æ™®é€šå¯¹è±¡/undefined), é‚£ä¹ˆè¿™ä¸ªæ™®é€šçš„å€¼ä¼šè¢«ä½œä¸ºä¸€ä¸ªæ–°çš„Promiseçš„resolveå€¼ const promise = new Promise((resolve, reject) =&gt; &#123; resolve(&quot;success&quot;)&#125;)let newPromise = promise.then(res =&gt; &#123; return &quot;aaa&quot; &#125;)console.log(newPromise); æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿›è¡Œé“¾å¼è°ƒç”¨ promise.then(res =&gt; &#123; return &quot;aaa&quot; &#125;).then(res =&gt; &#123; console.log(res); // &quot;aaa&quot; return &quot;bbb&quot;&#125;).then(res =&gt; &#123; console.log(res); // &quot;bbb&quot;&#125;) å¦‚æœè¿”å›çš„æ˜¯ä¸€ä¸ªPromise é‚£ä¹ˆè¿™ä¸ªPromiseä¼šå†³å®šä¸‹ä¸€ä¸ªthenè¿”å›çš„promiseçš„çŠ¶æ€ promise.then(res =&gt; &#123; return new Promise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; resolve(1111) &#125;, 3000) // reject(&#x27;err&#x27;) &#125;)&#125;).then(res =&gt; &#123; console.log(res); // 3ç§’åæ‰“å° 1111&#125;, err =&gt; &#123; console.log(err);&#125;) å¦‚æœè¿”å›çš„æ˜¯ä¸€ä¸ªå¯¹è±¡, å¹¶ä¸”è¯¥å¯¹è±¡å®ç°äº†thenæ–¹æ³• promise.then(res =&gt; &#123; return &#123; then: function(resolve, reject) &#123; resolve(2222) &#125; &#125;&#125;).then(res =&gt; &#123; console.log(res) // 222&#125;) å…¶å®ä¸€æ ·çš„ï¼Œæ—¢ç„¶thenè¿”å›ä¸€ä¸ªpromiseï¼Œé‚£å°±è·Ÿå‰é¢ä¸€æ ·çš„å¤„ç†ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥ç»§ç»­é“¾å¼è°ƒç”¨thenå»å¤„ç†ï¼Œè‡ªå·±å¤šå°è¯•å„ç§æƒ…å†µçœ‹çœ‹å°±éƒ½å¯ä»¥ç†è§£äº† catchæ–¹æ³• catchæ–¹æ³•ä¹Ÿæ˜¯Promiseå¯¹è±¡ä¸Šçš„ä¸€ä¸ªæ–¹æ³•ï¼šå®ƒä¹Ÿæ˜¯æ”¾åœ¨Promiseçš„åŸå‹ä¸Šçš„ Promise.prototype.catch() catchæ–¹æ³•ä¼ å…¥é”™è¯¯ï¼ˆæ‹’ç»ï¼‰æ•è·çš„å›è°ƒå‡½æ•° catchä¹Ÿå¯ä»¥å¤šæ¬¡è°ƒç”¨ æˆ‘ä»¬å¯ä»¥æŠŠcatchæ–¹æ³•ç†è§£ä¸º then æ–¹æ³•çš„è¯­æ³•ç³– const promise = new Promise((resolve, reject) =&gt; &#123; reject(&quot;reject message&quot;)&#125;)promise.catch(err =&gt; &#123; console.log(err);&#125;)// ç­‰ä»·äºpromise.then(undefined, err =&gt; &#123; console.log(err);&#125;) æ³¨æ„ä¸‹é¢ä¸¤ç§æƒ…å†µï¼Œcatchçš„å¤„ç† const promise = new Promise((resolve, reject) =&gt; &#123; reject(&quot;err message&quot;) // å¦‚æœè¿™é‡Œè°ƒç”¨reject,ä¹Ÿå°±æ˜¯è¿™ä¸ªpromiseçš„çŠ¶æ€æ˜¯rejected&#125;)promise.then(res =&gt; &#123; return new Promise((resolve, reject) =&gt; &#123; reject(&quot;reject2 message&quot;) &#125;)&#125;).catch(err =&gt; &#123; console.log(err); // err message&#125;) const promise = new Promise((resolve, reject) =&gt; &#123; resolve(&quot;aaa&quot;) // å¦‚æœè¿™é‡Œè°ƒç”¨resolve,fulfilledçŠ¶æ€&#125;)promise.then(res =&gt; &#123; // å…ˆè°ƒç”¨ then çš„ç¬¬ä¸€ä¸ªå›è°ƒ return new Promise((resolve, reject) =&gt; &#123; reject(&quot;reject2 message&quot;) // thenè¿”å›çš„promiseçš„çŠ¶æ€æ˜¯rejected &#125;)&#125;).catch(err =&gt; &#123; console.log(err); // reject2 message catchå¯ä»¥æ•è·åˆ°&#125;) æ‰€ä»¥è¯´catchä¼šå¤„ç†é¦–æ¬¡å‡ºç°æ‹’ç»çŠ¶æ€çš„Promise catchæ–¹æ³•ä¹Ÿæ˜¯ä¼šè¿”å›ä¸€ä¸ªPromiseå¯¹è±¡çš„ï¼Œæ‰€ä»¥catchæ–¹æ³•åé¢æˆ‘ä»¬å¯ä»¥ç»§ç»­è°ƒç”¨thenæ–¹æ³•æˆ–è€…catchæ–¹æ³• const promise = new Promise((resolve, reject) =&gt; &#123; reject(&quot;111&quot;)&#125;)promise.then(res=&gt;&#123; console.log(res);&#125;).catch(err =&gt; &#123; console.log(err); // &quot;111&quot; return &quot;222&quot; // è¿™ä¸ªcatchè¿”å›çš„promiseçš„çŠ¶æ€ä¸º fulfilled&#125;).then(res=&gt;&#123; console.log(res); // 222&#125;).catch(err =&gt; &#123; console.log(err);&#125;) finallyæ–¹æ³• finallyæ˜¯åœ¨ES9ï¼ˆES2018ï¼‰ä¸­æ–°å¢çš„ä¸€ä¸ªç‰¹æ€§ï¼šæ— è®ºPromiseå¯¹è±¡å˜æˆfulfilledè¿˜æ˜¯rejectçŠ¶æ€ï¼Œæœ€ç»ˆéƒ½ä¼šè¢«æ‰§è¡Œï¼Œæ‰€ä»¥finallyä¹Ÿä¸éœ€è¦æ¥æ”¶å‚æ•° promise.then(res=&gt;&#123; console.log(res);&#125;).catch(err =&gt; &#123; console.log(err); &#125;).finally(() =&gt; &#123; console.log(&quot;finally&quot;); // &quot;finally&quot;&#125;) finally ä¹Ÿä¼šè¿”å›ä¸€ä¸ªpromiseï¼Œä½†æ˜¯ä¸€èˆ¬æˆ‘ä»¬ä¸ä¼šç»§ç»­å†åé¢åšå¤„ç†äº† Promiseç±»æ–¹æ³• ä¹Ÿå°±æ˜¯ç›´æ¥é€šè¿‡Promiseè°ƒç”¨çš„æ–¹æ³•ï¼Œä¸éœ€è¦åˆ›å»ºå®ä¾‹ Promise.resolve ç›´æ¥æŠŠæŸä¸ªå†…å®¹è½¬æˆPromiseæ¥ä½¿ç”¨ Promise.resolveçš„ç”¨æ³•ç›¸å½“äºnew Promiseï¼Œå¹¶ä¸”æ‰§è¡Œresolveæ“ä½œ Promise.resolve(&quot;hello&quot;)// ç­‰ä»·äºnew Promise((resolve) =&gt; &#123; resolve(&quot;hello&quot;)&#125;) resolveçš„å‚æ•°è·Ÿå‰é¢ä¸€æ ·çš„ä¸‰ç§ï¼Œæ™®é€šçš„å€¼ï¼ŒPromiseï¼Œæœ‰thenæ–¹æ³•çš„obj Promise.reject ä¼šå°†Promiseå¯¹è±¡çš„çŠ¶æ€è®¾ç½®ä¸ºrejectçŠ¶æ€ Promise.reject(&quot;hello&quot;)// ç­‰ä»·äºnew Promise((resolve, reject) =&gt; &#123; reject(&quot;hello&quot;)&#125;) æ³¨æ„ï¼šPromise.rejectæ— è®ºä¼ å…¥çš„å‚æ•°æ˜¯ä»€ä¹ˆå½¢æ€ï¼Œéƒ½æ˜¯ä¼šç›´æ¥ä½œä¸ºrejectçŠ¶æ€çš„å‚æ•° const promise = Promise.reject(new Promise((resolve, reject) =&gt; &#123; resolve(&quot;123&quot;)&#125;))promise.then(res =&gt; &#123; console.log(&quot;res:&quot;, res)&#125;).catch(err =&gt; &#123; console.log(&quot;err:&quot;, err) // err: Promise &#123;&lt;fulfilled&gt;: &#x27;123&#x27;&#125;&#125;) Promise.all å°†å¤šä¸ªPromiseåŒ…è£¹åœ¨ä¸€èµ·å½¢æˆä¸€ä¸ªæ–°çš„Promiseï¼Œæ–°çš„PromiseçŠ¶æ€ç”±åŒ…è£¹çš„æ‰€æœ‰Promiseå…±åŒå†³å®šï¼š å½“æ‰€æœ‰çš„PromiseçŠ¶æ€å˜æˆ fulfilled çŠ¶æ€æ—¶ï¼Œæ–°çš„PromiseçŠ¶æ€ä¸ºfulfilledï¼Œå¹¶ä¸”ä¼šå°†æ‰€æœ‰Promiseçš„è¿”å›å€¼ç»„æˆä¸€ä¸ªæ•°ç»„ const p1 = new Promise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; resolve(111) &#125;, 1000)&#125;)const p2 = new Promise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; resolve(222) &#125;, 2000)&#125;)const p3 = new Promise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; resolve(333) &#125;, 3000)&#125;)Promise.all([p1, p2, p3]).then(res =&gt; &#123; console.log(res); // [ 111, 222, 333 ]&#125;).catch(err =&gt; &#123; console.log(err);&#125;) å½“æœ‰ä¸€ä¸ªPromiseçŠ¶æ€ä¸ºrejectæ—¶ï¼Œæ–°çš„PromiseçŠ¶æ€ä¸ºrejectï¼Œå¹¶ä¸”ä¼šå°†ç¬¬ä¸€ä¸ªrejectçš„è¿”å›å€¼ä½œä¸ºå‚æ•° ...const p2 = new Promise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; reject(222) &#125;, 2000)&#125;)...Promise.all([p1, p2, p3]).then(res =&gt; &#123; console.log(res); &#125;).catch(err =&gt; &#123; console.log(err); // 222&#125;) Promise.allSettled ES11ï¼ˆES2022ï¼‰æ–°å¢ è¯¥æ–¹æ³•ä¼šåœ¨æ‰€æœ‰çš„Promiseéƒ½æœ‰ç»“æœï¼ˆæ— è®ºæ˜¯fulfilledè¿˜æ˜¯rejectï¼‰åæ‰ä¼šæœ‰æœ€ç»ˆçš„çŠ¶æ€ï¼Œå¹¶ä¸”è¿”å›çš„Promiseçš„çŠ¶æ€ä¸€å®šæ˜¯fulfilled const p1 = new Promise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; resolve(111) &#125;, 1000)&#125;)const p2 = new Promise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; reject(222) &#125;, 2000)&#125;)const p3 = new Promise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; resolve(333) &#125;, 3000)&#125;)Promise.allSettled([p1, p2, p3]).then(res =&gt; &#123; console.log(&quot;res:&quot;, res); // æ‰§è¡Œçš„æ˜¯è¿™é‡Œ&#125;).catch(err =&gt; &#123; console.log(&quot;err:&quot;, err);&#125;) æ‰“å°çš„ç»“æœæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå­˜æ”¾æ¯ä¸€ä¸ªPromiseçš„ç»“æœ statusï¼šçŠ¶æ€ï¼Œvalueï¼šå€¼ Promise.race raceï¼šç«èµ›ï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥ç†è§£ä¸ºPromiseçš„ç«èµ› åªè¦æœ‰ä¸€ä¸ªPromiseå˜æˆfulfilledçŠ¶æ€, é‚£ä¹ˆå°±ç»“æŸï¼Œå¹¶ä½¿ç”¨è¿™ä¸ªpromiseçš„ç»“æœ const p1 = new Promise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; resolve(111) &#125;, 1000)&#125;)const p2 = new Promise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; reject(222) &#125;, 500) // å…ˆæ‰§è¡Œå®Œ&#125;)const p3 = new Promise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; resolve(333) &#125;, 3000)&#125;)Promise.race([p1, p2, p3]).then(res =&gt; &#123; console.log(&quot;res:&quot;, res); &#125;).catch(err =&gt; &#123; console.log(&quot;err:&quot;, err); // err: 222&#125;) Promise.any ES12æ–°å¢ï¼Œå’Œraceæ–¹æ³•ç±»ä¼¼ anyæ–¹æ³•ä¼šç­‰åˆ°ç¬¬ä¸€ä¸ªfulfilledçŠ¶æ€ï¼Œæ‰ä¼šå†³å®šæ–°Promiseçš„çŠ¶æ€ å¦‚æœæ‰€æœ‰çš„Promiseéƒ½æ˜¯rejectçš„ï¼Œé‚£ä¹ˆä¼šæŠ¥ä¸€ä¸ªAggregateErrorçš„é”™è¯¯ const p1 = new Promise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; reject(111) &#125;, 1000)&#125;)const p2 = new Promise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; reject(222) &#125;, 2000) &#125;)Promise.any([p1, p2]).then(res =&gt; &#123; console.log(&quot;res:&quot;, res); &#125;).catch(err =&gt; &#123; console.log(&quot;err:&quot;, err); // err: 222&#125;)// è¾“å‡ºï¼š// err: AggregateError: All promises were rejected// err.errorså¯ä»¥æ‹¿åˆ°å…¨éƒ¨é”™è¯¯ä¿¡æ¯","categories":[{"name":"ğŸ”«æ·±å…¥JSé«˜çº§è¯­æ³•","slug":"ğŸ”«æ·±å…¥JSé«˜çº§è¯­æ³•","permalink":"https://hillyee.github.io/categories/%F0%9F%94%AB%E6%B7%B1%E5%85%A5JS%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/"}],"tags":[{"name":"js","slug":"js","permalink":"https://hillyee.github.io/tags/js/"},{"name":"promise","slug":"promise","permalink":"https://hillyee.github.io/tags/promise/"}]},{"title":"é¢è¯•é¢˜â€”JSç¯‡ä¹‹ä»£ç è¾“å‡ºç»“æœæ˜¯ä»€ä¹ˆ","slug":"é¢è¯•é¢˜-â€”-JSç¯‡ä¹‹ä»£ç è¾“å‡ºç»“æœæ˜¯ä»€ä¹ˆ","date":"2022-04-15T13:12:15.000Z","updated":"2022-04-15T17:11:21.938Z","comments":true,"path":"2022/04/15/é¢è¯•é¢˜-â€”-JSç¯‡ä¹‹ä»£ç è¾“å‡ºç»“æœæ˜¯ä»€ä¹ˆ/","link":"","permalink":"https://hillyee.github.io/2022/04/15/%E9%9D%A2%E8%AF%95%E9%A2%98-%E2%80%94-JS%E7%AF%87%E4%B9%8B%E4%BB%A3%E7%A0%81%E8%BE%93%E5%87%BA%E7%BB%93%E6%9E%9C%E6%98%AF%E4%BB%80%E4%B9%88/","excerpt":"","text":"åŒ…å«ç±»å‹åˆ¤æ–­ã€ä½œç”¨åŸŸã€thisæŒ‡å‘ã€åŸå‹ã€äº‹ä»¶å¾ªç¯ç­‰çŸ¥è¯†ç‚¹ è¯·é—®ä¸‹é¢çš„ä»£ç è¾“å‡ºç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ ç¬¬1é¢˜ let a = 1function b(a) &#123; a = 2 console.log(a)&#125;b(a)console.log(a) ç­”æ¡ˆï¼š2 1 ç¬¬2é¢˜ function a (b = c, c = 1) &#123; console.log(b, c)&#125;a() æŠ¥é”™ï¼šCannot access â€˜câ€™ before initialization ç¬¬3é¢˜ let a = b = 10;(function()&#123; let a = b = 20 &#125;)()console.log(a)console.log(b) ç­”æ¡ˆï¼š10ã€20 ç¬¬4é¢˜ var a = &#123;n:1&#125;var b = aa.x = a = &#123;n:2&#125;console.log(a.x)console.log(b.x) ç­”æ¡ˆï¼šundefinedã€{n: 2} ç¬¬5é¢˜ var arr = [0, 1, 2]arr[10] = 10console.log(arr.filter(function (x) &#123; return x === undefined&#125;)) ç­”æ¡ˆï¼š[ ] ç¬¬6é¢˜ var name = &#x27;World&#x27;;(function () &#123; if (typeof name === &#x27;undefined&#x27;) &#123; var name = &quot;Jack&quot; console.info(&#x27;Goodbye &#x27; + name) &#125; else &#123; console.info(&#x27;Hello &#x27; + name) &#125;&#125;)() ç­”æ¡ˆï¼šGoodbye Jack ç¬¬7é¢˜ console.log(1 + NaN)console.log(&quot;1&quot; + 3)console.log(1 + undefined)console.log(1 + null)console.log(1 + &#123;&#125;)console.log(1 + [])console.log([] + &#123;&#125;) ç­”æ¡ˆï¼šNaNã€13ã€NaNã€1ã€1[object Object]ã€1ã€[object Object] ç¬¬8é¢˜ var a=&#123;&#125;, b=&#123;key:&#x27;b&#x27;&#125;, c=&#123;key:&#x27;c&#x27;&#125;a[b]=123a[c]=456console.log(a[b]) ç­”æ¡ˆï¼š456 ç¬¬9é¢˜ var out = 25var inner = &#123; out: 20, func: function () &#123; var out = 30 return this.out &#125;&#125;;console.log((inner.func, inner.func)())console.log(inner.func())console.log((inner.func)())console.log((inner.func = inner.func)()) ç­”æ¡ˆï¼š25ã€20ã€20ã€25 ç¬¬10é¢˜ let &#123;a,b,c&#125; = &#123; c:3, b:2, a:1 &#125;console.log(a, b, c) ç­”æ¡ˆï¼š1ã€2ã€3 ç¬¬11é¢˜ console.log(Object.assign([1, 2, 3], [4, 5])) [4, 5, 3] ç¬¬12é¢˜ var x=1switch(x++)&#123; case 0: ++x case 1: ++x case 2: ++x&#125;console.log(x) ç­”æ¡ˆï¼š4 ç¬¬13é¢˜ console.log(typeof undefined == typeof NULL)console.log(typeof function () &#123;&#125; == typeof class &#123;&#125;) ç­”æ¡ˆï¼štrueã€true ç¬¬14é¢˜ var count = 0console.log(typeof count === &quot;number&quot;)console.log(!!typeof count === &quot;number&quot;) ç­”æ¡ˆï¼štrueã€false ç¬¬15é¢˜ &quot;use strict&quot;a = 1var a = 2console.log(window.a)console.log(a) ç­”æ¡ˆï¼š2ã€2 ç¬¬16é¢˜ var i = 1function b() &#123; console.log(i)&#125;function a() &#123; var i = 2 b()&#125;a() ç­”æ¡ˆï¼š1 ç¬¬17é¢˜ var obj = &#123; name: &#x27;abc&#x27;, fn: () =&gt; &#123; console.log(this.name) &#125;&#125;;obj.name = &#x27;bcd&#x27;obj.fn() ç­”æ¡ˆï¼šundefined ç¬¬18é¢˜ const obj = &#123; a: &#123; a: 1 &#125;&#125;;const obj1 = &#123; a: &#123; b: 1 &#125;&#125;;console.log(Object.assign(obj, obj1)) ç­”æ¡ˆï¼š{a: {b: 1}} ç¬¬19é¢˜ console.log(a)var a = 1var getNum = function() &#123; a = 2&#125;function getNum() &#123; a = 3&#125;console.log(a)getNum()console.log(a) ç­”æ¡ˆï¼šundefinedã€1ã€2 ç¬¬20é¢˜ var scope = &#x27;global scope&#x27;function a()&#123; function b()&#123; console.log(scope) &#125; return b var scope = &#x27;local scope&#x27;&#125;a()() ç­”æ¡ˆï¼šundefined ç¬¬21é¢˜ function fn ()&#123; console.log(this) &#125;var arr = [fn]arr[0]() ç­”æ¡ˆï¼šæ‰“å°å‡ºarræ•°ç»„æœ¬èº« ç¬¬22é¢˜ var a = 1function a()&#123;&#125;console.log(a)var bfunction b()&#123;&#125;console.log(b)function b()&#123;&#125;var bconsole.log(b) ç­”æ¡ˆï¼š1ã€bå‡½æ•°æœ¬èº«ã€bå‡½æ•°æœ¬èº« ç¬¬23é¢˜ function Foo() &#123; getName = function () &#123; console.log(1) &#125; return this&#125;Foo.getName = function () &#123; console.log(2)&#125;Foo.prototype.getName = function () &#123; console.log(3)&#125;var getName = function () &#123; console.log(4)&#125;function getName() &#123; console.log(5)&#125;//è¯·å†™å‡ºä»¥ä¸‹è¾“å‡ºç»“æœï¼šFoo.getName()getName()Foo().getName()getName()new Foo.getName()new Foo().getName()new new Foo().getName() ç­”æ¡ˆï¼š2ã€4ã€1ã€1ã€2ã€3ã€3 ç¬¬24é¢˜ const person = &#123; address: &#123; country:&quot;china&quot;, city:&quot;hangzhou&quot; &#125;, say: function () &#123; console.log(`it&#x27;s $&#123;this.name&#125;, from $&#123;this.address.country&#125;`) &#125;, setCountry:function (country) &#123; this.address.country=country &#125;&#125;const p1 = Object.create(person)const p2 = Object.create(person)p1.name = &quot;Matthew&quot;p1.setCountry(&quot;American&quot;)p2.name = &quot;Bob&quot;p2.setCountry(&quot;England&quot;)p1.say()p2.say() ç­”æ¡ˆï¼šitâ€™s Matthew, from England itâ€™s Bob, from England ç¬¬25é¢˜ setTimeout(function() &#123; console.log(1)&#125;, 0)new Promise(function(resolve) &#123; console.log(2) for( var i=0 ; i&lt;10000 ; i++ ) &#123; i == 9999 &amp;&amp; resolve() &#125; console.log(3)&#125;).then(function() &#123; console.log(4)&#125;)console.log(5) ç­”æ¡ˆï¼š2ã€3ã€5ã€4ã€1 ç¬¬26é¢˜ æ³¨ï¼šprocessæ˜¯Node.jsæä¾›çš„ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒä»£è¡¨å½“å‰Node.jsè¿›ç¨‹ console.log(&#x27;1&#x27;);setTimeout(function() &#123; console.log(&#x27;2&#x27;); process.nextTick(function() &#123; console.log(&#x27;3&#x27;); &#125;); new Promise(function(resolve) &#123; console.log(&#x27;4&#x27;); resolve(); &#125;).then(function() &#123; console.log(&#x27;5&#x27;); &#125;);&#125;); process.nextTick(function() &#123; console.log(&#x27;6&#x27;);&#125;);new Promise(function(resolve) &#123; console.log(&#x27;7&#x27;); resolve();&#125;).then(function() &#123; console.log(&#x27;8&#x27;);&#125;);setTimeout(function() &#123; console.log(&#x27;9&#x27;); process.nextTick(function() &#123; console.log(&#x27;10&#x27;); &#125;) new Promise(function(resolve) &#123; console.log(&#x27;11&#x27;); resolve(); &#125;).then(function() &#123; console.log(&#x27;12&#x27;) &#125;);&#125;) ç­”æ¡ˆï¼š1ã€7ã€6ã€8ã€2ã€4ã€9ã€11ã€3ã€10ã€5ã€12 1-26 æ¥æºï¼šhttps://mp.weixin.qq.com/s/fks9SuTSY0ivUfPn6G-TOw","categories":[{"name":"ğŸ˜£é¢è¯•é¢˜-jsç¯‡","slug":"ğŸ˜£é¢è¯•é¢˜-jsç¯‡","permalink":"https://hillyee.github.io/categories/%F0%9F%98%A3%E9%9D%A2%E8%AF%95%E9%A2%98-js%E7%AF%87/"}],"tags":[{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"https://hillyee.github.io/tags/%E9%9D%A2%E8%AF%95/"},{"name":"js","slug":"js","permalink":"https://hillyee.github.io/tags/js/"}]},{"title":"é¢è¯•é¢˜â€”JSç¯‡ä¹‹ä»£ç è¾“å‡ºç»“æœæ˜¯ä»€ä¹ˆ","slug":"é¢è¯•é¢˜â€”JSç¯‡ä¹‹ä»£ç è¾“å‡ºç»“æœæ˜¯ä»€ä¹ˆ","date":"2022-04-15T13:12:15.000Z","updated":"2022-04-15T17:08:20.905Z","comments":true,"path":"2022/04/15/é¢è¯•é¢˜â€”JSç¯‡ä¹‹ä»£ç è¾“å‡ºç»“æœæ˜¯ä»€ä¹ˆ/","link":"","permalink":"https://hillyee.github.io/2022/04/15/%E9%9D%A2%E8%AF%95%E9%A2%98%E2%80%94JS%E7%AF%87%E4%B9%8B%E4%BB%A3%E7%A0%81%E8%BE%93%E5%87%BA%E7%BB%93%E6%9E%9C%E6%98%AF%E4%BB%80%E4%B9%88/","excerpt":"","text":"åŒ…å«ç±»å‹åˆ¤æ–­ã€ä½œç”¨åŸŸã€thisæŒ‡å‘ã€åŸå‹ã€äº‹ä»¶å¾ªç¯ç­‰çŸ¥è¯†ç‚¹ è¯·é—®ä¸‹é¢çš„ä»£ç è¾“å‡ºç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ ç¬¬1é¢˜ let a = 1function b(a) &#123; a = 2 console.log(a)&#125;b(a)console.log(a) ç­”æ¡ˆï¼š2 1 ç¬¬2é¢˜ function a (b = c, c = 1) &#123; console.log(b, c)&#125;a() æŠ¥é”™ï¼šCannot access â€˜câ€™ before initialization ç¬¬3é¢˜ let a = b = 10;(function()&#123; let a = b = 20 &#125;)()console.log(a)console.log(b) ç­”æ¡ˆï¼š10ã€20 ç¬¬4é¢˜ var a = &#123;n:1&#125;var b = aa.x = a = &#123;n:2&#125;console.log(a.x)console.log(b.x) ç­”æ¡ˆï¼šundefinedã€{n: 2} ç¬¬5é¢˜ var arr = [0, 1, 2]arr[10] = 10console.log(arr.filter(function (x) &#123; return x === undefined&#125;)) ç­”æ¡ˆï¼š[ ] ç¬¬6é¢˜ var name = &#x27;World&#x27;;(function () &#123; if (typeof name === &#x27;undefined&#x27;) &#123; var name = &quot;Jack&quot; console.info(&#x27;Goodbye &#x27; + name) &#125; else &#123; console.info(&#x27;Hello &#x27; + name) &#125;&#125;)() ç­”æ¡ˆï¼šGoodbye Jack ç¬¬7é¢˜ console.log(1 + NaN)console.log(&quot;1&quot; + 3)console.log(1 + undefined)console.log(1 + null)console.log(1 + &#123;&#125;)console.log(1 + [])console.log([] + &#123;&#125;) ç­”æ¡ˆï¼šNaNã€13ã€NaNã€1ã€1[object Object]ã€1ã€[object Object] ç¬¬8é¢˜ var a=&#123;&#125;, b=&#123;key:&#x27;b&#x27;&#125;, c=&#123;key:&#x27;c&#x27;&#125;a[b]=123a[c]=456console.log(a[b]) ç­”æ¡ˆï¼š456 ç¬¬9é¢˜ var out = 25var inner = &#123; out: 20, func: function () &#123; var out = 30 return this.out &#125;&#125;;console.log((inner.func, inner.func)())console.log(inner.func())console.log((inner.func)())console.log((inner.func = inner.func)()) ç­”æ¡ˆï¼š25ã€20ã€20ã€25 ç¬¬10é¢˜ let &#123;a,b,c&#125; = &#123; c:3, b:2, a:1 &#125;console.log(a, b, c) ç­”æ¡ˆï¼š1ã€2ã€3 ç¬¬11é¢˜ console.log(Object.assign([1, 2, 3], [4, 5])) [4, 5, 3] ç¬¬12é¢˜ var x=1switch(x++)&#123; case 0: ++x case 1: ++x case 2: ++x&#125;console.log(x) ç­”æ¡ˆï¼š4 ç¬¬13é¢˜ console.log(typeof undefined == typeof NULL)console.log(typeof function () &#123;&#125; == typeof class &#123;&#125;) ç­”æ¡ˆï¼štrueã€true ç¬¬14é¢˜ var count = 0console.log(typeof count === &quot;number&quot;)console.log(!!typeof count === &quot;number&quot;) ç­”æ¡ˆï¼štrueã€false ç¬¬15é¢˜ &quot;use strict&quot;a = 1var a = 2console.log(window.a)console.log(a) ç­”æ¡ˆï¼š2ã€2 ç¬¬16é¢˜ var i = 1function b() &#123; console.log(i)&#125;function a() &#123; var i = 2 b()&#125;a() ç­”æ¡ˆï¼š1 ç¬¬17é¢˜ var obj = &#123; name: &#x27;abc&#x27;, fn: () =&gt; &#123; console.log(this.name) &#125;&#125;;obj.name = &#x27;bcd&#x27;obj.fn() ç­”æ¡ˆï¼šundefined ç¬¬18é¢˜ const obj = &#123; a: &#123; a: 1 &#125;&#125;;const obj1 = &#123; a: &#123; b: 1 &#125;&#125;;console.log(Object.assign(obj, obj1)) ç­”æ¡ˆï¼š{a: {b: 1}} ç¬¬19é¢˜ console.log(a)var a = 1var getNum = function() &#123; a = 2&#125;function getNum() &#123; a = 3&#125;console.log(a)getNum()console.log(a) ç­”æ¡ˆï¼šundefinedã€1ã€2 ç¬¬20é¢˜ var scope = &#x27;global scope&#x27;function a()&#123; function b()&#123; console.log(scope) &#125; return b var scope = &#x27;local scope&#x27;&#125;a()() ç­”æ¡ˆï¼šundefined ç¬¬21é¢˜ function fn ()&#123; console.log(this) &#125;var arr = [fn]arr[0]() ç­”æ¡ˆï¼šæ‰“å°å‡ºarræ•°ç»„æœ¬èº« ç¬¬22é¢˜ var a = 1function a()&#123;&#125;console.log(a)var bfunction b()&#123;&#125;console.log(b)function b()&#123;&#125;var bconsole.log(b) ç­”æ¡ˆï¼š1ã€bå‡½æ•°æœ¬èº«ã€bå‡½æ•°æœ¬èº« ç¬¬23é¢˜ function Foo() &#123; getName = function () &#123; console.log(1) &#125; return this&#125;Foo.getName = function () &#123; console.log(2)&#125;Foo.prototype.getName = function () &#123; console.log(3)&#125;var getName = function () &#123; console.log(4)&#125;function getName() &#123; console.log(5)&#125;//è¯·å†™å‡ºä»¥ä¸‹è¾“å‡ºç»“æœï¼šFoo.getName()getName()Foo().getName()getName()new Foo.getName()new Foo().getName()new new Foo().getName() ç­”æ¡ˆï¼š2ã€4ã€1ã€1ã€2ã€3ã€3 ç¬¬24é¢˜ const person = &#123; address: &#123; country:&quot;china&quot;, city:&quot;hangzhou&quot; &#125;, say: function () &#123; console.log(`it&#x27;s $&#123;this.name&#125;, from $&#123;this.address.country&#125;`) &#125;, setCountry:function (country) &#123; this.address.country=country &#125;&#125;const p1 = Object.create(person)const p2 = Object.create(person)p1.name = &quot;Matthew&quot;p1.setCountry(&quot;American&quot;)p2.name = &quot;Bob&quot;p2.setCountry(&quot;England&quot;)p1.say()p2.say() ç­”æ¡ˆï¼šitâ€™s Matthew, from England itâ€™s Bob, from England ç¬¬25é¢˜ setTimeout(function() &#123; console.log(1)&#125;, 0)new Promise(function(resolve) &#123; console.log(2) for( var i=0 ; i&lt;10000 ; i++ ) &#123; i == 9999 &amp;&amp; resolve() &#125; console.log(3)&#125;).then(function() &#123; console.log(4)&#125;)console.log(5) ç­”æ¡ˆï¼š2ã€3ã€5ã€4ã€1 ç¬¬26é¢˜ æ³¨ï¼šprocessæ˜¯Node.jsæä¾›çš„ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒä»£è¡¨å½“å‰Node.jsè¿›ç¨‹ console.log(&#x27;1&#x27;);setTimeout(function() &#123; console.log(&#x27;2&#x27;); process.nextTick(function() &#123; console.log(&#x27;3&#x27;); &#125;); new Promise(function(resolve) &#123; console.log(&#x27;4&#x27;); resolve(); &#125;).then(function() &#123; console.log(&#x27;5&#x27;); &#125;);&#125;); process.nextTick(function() &#123; console.log(&#x27;6&#x27;);&#125;);new Promise(function(resolve) &#123; console.log(&#x27;7&#x27;); resolve();&#125;).then(function() &#123; console.log(&#x27;8&#x27;);&#125;);setTimeout(function() &#123; console.log(&#x27;9&#x27;); process.nextTick(function() &#123; console.log(&#x27;10&#x27;); &#125;) new Promise(function(resolve) &#123; console.log(&#x27;11&#x27;); resolve(); &#125;).then(function() &#123; console.log(&#x27;12&#x27;) &#125;);&#125;) ç­”æ¡ˆï¼š1ã€7ã€6ã€8ã€2ã€4ã€9ã€11ã€3ã€10ã€5ã€12 1-26 æ¥æºï¼šhttps://mp.weixin.qq.com/s/fks9SuTSY0ivUfPn6G-TOw","categories":[{"name":"ğŸ˜£é¢è¯•é¢˜-jsç¯‡","slug":"ğŸ˜£é¢è¯•é¢˜-jsç¯‡","permalink":"https://hillyee.github.io/categories/%F0%9F%98%A3%E9%9D%A2%E8%AF%95%E9%A2%98-js%E7%AF%87/"}],"tags":[{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"https://hillyee.github.io/tags/%E9%9D%A2%E8%AF%95/"},{"name":"js","slug":"js","permalink":"https://hillyee.github.io/tags/js/"}]},{"title":"å­¦ä¹ TypeScript","slug":"å­¦ä¹ TypeScript","date":"2022-04-15T11:22:29.000Z","updated":"2022-04-15T11:24:46.813Z","comments":true,"path":"2022/04/15/å­¦ä¹ TypeScript/","link":"","permalink":"https://hillyee.github.io/2022/04/15/%E5%AD%A6%E4%B9%A0TypeScript/","excerpt":"","text":"TypeScriptåˆè¯† JavaScriptæ²¡æœ‰ç±»å‹æ£€æµ‹ï¼Œè¿™ä¼šè®©æˆ‘ä»¬çš„ä»£ç ä¸å®‰å…¨ï¼ŒTSå¯ä»¥å¾ˆå¥½çš„è§£å†³è¿™ä¸ªé—®é¢˜ TSç®€ä»‹ Typescriptæ˜¯æ‹¥æœ‰ç±»å‹çš„JavaScriptè¶…é›† JavaScriptæ‰€æ‹¥æœ‰çš„ç‰¹æ€§ï¼ŒTSå…¨éƒ¨éƒ½æ”¯æŒï¼Œå¹¶ä¸”åœ¨è¯­è¨€å±‚é¢ä¸Šæ·»åŠ äº†ç±»å‹çº¦æŸï¼Œè¿˜åŠ ä¸Šä¸€äº›è¯­æ³•çš„æ‰©å±• TSçš„ç¼–è¯‘ç¯å¢ƒ TSæœ€ç»ˆè¿˜æ˜¯ä¼šè¢«ç¼–è¯‘æˆJSä»£ç è¿è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ­å»ºå¯¹åº”çš„ç¯å¢ƒ åœ¨ç”µè„‘ä¸Šå®‰è£…Typescriptï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡TypeScriptçš„Compilerå°†å…¶ç¼–è¯‘æˆJavaScript å…¨å±€å®‰è£…ï¼šnpm install typescript -g æŸ¥çœ‹ç‰ˆæœ¬ï¼štsc --version TSçš„è¿è¡Œç¯å¢ƒ è¿è¡Œçš„ä¸¤ä¸ªæ­¥éª¤ï¼š tsc xxx.ts æŠŠtsæ–‡ä»¶ç¼–è¯‘æˆJSä»£ç  åœ¨æµè§ˆå™¨æˆ–Nodeç¯å¢ƒä¸‹è¿è¡ŒJSä»£ç  å¦‚æœæ¯æ¬¡éƒ½è¦åšè¿™ä¸¤ä¸ªæ­¥éª¤ï¼Œé‚£å°±å¤ªéº»çƒ¦äº† æœ‰ä»€ä¹ˆç®€åŒ–çš„æ–¹å¼å‘¢ï¼Ÿ ç¬¬ä¸€ç§ï¼šé€šè¿‡webpackï¼Œé…ç½®æœ¬åœ°çš„TSç¼–è¯‘ç¯å¢ƒå’Œå¼€å¯ä¸€ä¸ªæœ¬åœ°æœåŠ¡ï¼Œå¯ä»¥ç›´æ¥è¿è¡Œåœ¨æµè§ˆå™¨ä¸Š ç¬¬äºŒç§ï¼šé€šè¿‡ts-nodeåº“ï¼Œä¸ºTSçš„è¿è¡Œæä¾›æ‰§è¡Œç¯å¢ƒ å®‰è£… ts-nodeï¼šnpm install ts-node -g å¦å¤– ts-nodeéœ€è¦å®‰è£…ä¾èµ– tslib å’Œ @types/node ä¸¤ä¸ªåŒ… npm install tslib @types/node -g ç„¶åå¯ä»¥ç›´æ¥é€šè¿‡ ts-node æ¥è¿è¡Œ TS çš„ä»£ç ï¼š ts-node xxx.ts å˜é‡çš„å£°æ˜ å®šä¹‰çš„æ—¶å€™ç»™æ ‡è¯†ç¬¦åŠ ç±»å‹ï¼š var/let/const æ ‡è¯†ç¬¦: æ•°æ®ç±»å‹ = èµ‹å€¼ ä½†æ˜¯ var ä¸æ¨èä½¿ç”¨ å¦å¤–æ³¨æ„ string å’Œ String çš„åŒºåˆ« stringæ˜¯TypeScriptä¸­å®šä¹‰çš„å­—ç¬¦ä¸²ç±»å‹ï¼ŒStringæ˜¯ECMAScriptä¸­å®šä¹‰çš„ä¸€ä¸ªåŒ…è£…ç±» let message: string = &quot;abc&quot;console.log(message);const name: string = &#x27;xxx&#x27; ç±»å‹æ¨æ–­ï¼ˆæ¨å¯¼ï¼‰ï¼Œå°±æ˜¯è¯´æˆ‘ä»¬ç¬¬ä¸€æ¬¡ç»™å˜é‡èµ‹å€¼çš„æ—¶å€™ï¼Œä¼šæ ¹æ®è¿™ä¸ªèµ‹å€¼çš„å†…å®¹ï¼Œè‡ªåŠ¨æ¨æ–­å˜é‡çš„ç±»å‹ let num = 2 // è‡ªåŠ¨ç±»å‹æ¨æ–­ä¸ºnumberç±»å‹num = &quot;123&quot; // æŠ¥é”™ æ¨èï¼šå¦‚æœå¯ä»¥è‡ªåŠ¨æ¨å¯¼å‡ºå˜é‡çš„ç±»å‹çš„æ—¶å€™ï¼Œä¸åŠ ç±»å‹ ä¸ç¡®å®šç±»å‹çš„æ—¶å€™ï¼Œè¦è‡ªå·±åŠ ä¸Šç±»å‹ æ•°æ®ç±»å‹ æˆ‘ä»¬å¸¸è¯´TSæ˜¯JSçš„ä¸€ä¸ªè¶…é›† JSç±»å‹ TSå’ŒJSéƒ½æœ‰çš„æ•°æ®ç±»å‹ numberç±»å‹ TS å’Œ JSä¸€æ · let num: number = 123num = 222// num = &quot;123&quot; // æŠ¥é”™// TS ä¹Ÿæ”¯æŒè¿›åˆ¶let num1: number = 100let num2: number = 0b100let num3: number = 0o100let num4: number = 0x100console.log(num1, num2, num3, num4); // 100 4 64 256 booleanç±»å‹ trueã€false let flag: boolean = truelet flag: boolean = trueflag = falseflag = 20 &gt; 30 stringç±»å‹ let message: string = &quot;hello&quot;message = &#x27;hello ts&#x27;// åŒæ ·ä¹Ÿæ”¯æŒES6çš„æ¨¡æ¿å­—ç¬¦ä¸²const info = `hi $&#123;message&#125;`console.log(info); // hi hello ts Arrayç±»å‹ å›ºå®šæ•°ç»„é‡Œé¢å­˜æ”¾çš„æ•°æ®ç±»å‹ const name1: string[] = [] // æ¨è// name1.push(1) // æŠ¥é”™const name2: Array&lt;string&gt; = [] // ä¸æ¨è(react jsxä¸­æ˜¯æœ‰å†²çª) Objectç±»å‹ const info:object = &#123; // åœ¨è¿™é‡Œè®¾ç½®äº†objectç±»å‹ name: &quot;xxx&quot;, age: 18&#125;info[&quot;name&quot;] = &quot;kkk&quot;console.log(info[&quot;age&quot;]); è®¾ç½®äº†objectç±»å‹ä¸èƒ½è·å–æ•°æ®ä¹Ÿä¸èƒ½è®¾ç½®æ•°æ® å¦‚æœå»æ‰äº†:objectå°±å¯ä»¥è·å–ï¼Œå¹¶ä¸”é‡Œé¢çš„å±æ€§ç±»å‹ä¹Ÿæœ‰æ¨æ–­ const info = &#123; name: &quot;xxx&quot;, age: 18&#125;info[&quot;name&quot;] = 123 // æŠ¥é”™console.log(info[&quot;age&quot;]) // 18 Symbolç±»å‹ è·Ÿ JS ä¸€æ ·ï¼Œä¸»è¦ç”¨äºè®¾ç½®å”¯ä¸€å±æ€§å let title1: symbol = Symbol(&quot;title&quot;)// title1 = 2 // numberèµ‹å€¼ç»™symbolç±»å‹,æŠ¥é”™let title2 = Symbol(&quot;title&quot;) // æ¨æ–­const info = &#123; [title1]: &quot;xxx&quot;, [title2]: &quot;kkk&quot;&#125; Null å’Œ Undefinedç±»å‹ nullï¼š let n1: null = nulln1 = 123 // number -&gt; null æŠ¥é”™let n2 = null // æ¨æ–­æ˜¯ anyç±»å‹n2 = 123 // ä¸æŠ¥é”™ åŒç†ï¼šundefinedï¼š let n3: undefined = undefinedn3 = 123 // æŠ¥é”™let n4 = undefinedn4 = 123 TypeScriptç±»å‹ anyç±»å‹ anyè¡¨ç¤ºä»»æ„ç±»å‹ åœ¨ä¸ç¡®å®šå˜é‡ç±»å‹çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨anyç±»å‹ï¼Œä½†æ˜¯ä¸€æ—¦ä½¿ç”¨äº†ï¼Œæ„å‘³ç€æˆ‘ä»¬å¯ä»¥å¯¹anyç±»å‹çš„å˜é‡è¿›è¡Œä»»ä½•çš„æ“ä½œï¼ŒåŒ…æ‹¬èµ‹å€¼ä»»ä½•ç±»å‹çš„å€¼ï¼›è·å–ä¸å­˜åœ¨çš„å±æ€§ã€æ–¹æ³• éå¸¸ä¸å®‰å…¨ï¼Œä¸æ¨èä½¿ç”¨ let message: any = &quot;hello&quot;message = 123message = truemessage = &#123;&#125;message.split(&quot; &quot;) unknownç±»å‹ ç”¨äºæè¿°ç±»å‹ä¸ç¡®å®šçš„å˜é‡ unknownç±»å‹åªèƒ½èµ‹å€¼ç»™anyå’Œunknownç±»å‹ function foo() &#123; return &quot;abc&quot;&#125;function bar() &#123; return 123&#125;let flag = truelet result: unknown // å¦‚æœä½¿ç”¨anyå°±ä¸ä¼šæŠ¥é”™äº†if (flag) &#123; result = foo()&#125; else &#123; result = bar()&#125;// é¿å…æ‹¿åˆ°ç»“æœä¹‹åä¹±ç”¨let message: string = result // ä¸èƒ½å°†ç±»å‹â€œunknownâ€åˆ†é…ç»™ç±»å‹â€œstringâ€console.log(result); voidç±»å‹ voidé€šå¸¸æ¥æŒ‡å®šä¸€ä¸ªå‡½æ•°æ²¡æœ‰è¿”å›å€¼çš„ï¼Œé‚£ä¹ˆå®ƒçš„è¿”å›å€¼å°±æ˜¯voidç±»å‹ å¦å¤–ï¼Œè¿™ä¸ªå‡½æ•°å¯ä»¥è¿”å› nullï¼Œundefined ä¸€èˆ¬éƒ½ä¸å†™çš„ï¼Œå› ä¸ºæ²¡æœ‰è¿”å›å€¼é»˜è®¤æ¨æ–­å°±æ˜¯void function sum(num1: number, num2: number): void &#123; console.log(num1 + num2); // è¿™é‡Œå†™ä¸å†™voidéƒ½ä¸€æ ·çš„&#125;sum(20, 30) neverç±»å‹ è¡¨ç¤ºæ°¸è¿œä¸ä¼šå‘ç”Ÿå€¼çš„ç±»å‹ neverè¡¨ç¤ºå‡½æ•°ç”¨äºæ‰§è¡Œä¸åˆ°è¿”å›å€¼é‚£ä¸€æ­¥ï¼ˆæŠ›å‡ºå¼‚å¸¸æˆ–æ­»å¾ªç¯ï¼‰çš„è¿”å›å€¼ç±»å‹ è€Œvoidæ˜¯å‡½æ•°æ²¡æœ‰è¿”å›å€¼ï¼Œå¯ä»¥è¿”å›nullï¼Œundefined function foo() &#123; // æ­»å¾ªç¯ while(true) &#123; &#125;&#125;function bar() &#123; throw new Error() // æŠ›å‡ºå¼‚å¸¸&#125; never æœ‰ä»€ä¹ˆåº”ç”¨åœºæ™¯ï¼Ÿ // function handleMessage(message: string | number ) &#123;function handleMessage(message: string | number | boolean ) &#123; switch (typeof message) &#123; case &#x27;string&#x27;: console.log(&#x27;stringæ–¹å¼å¤„ç†message&#x27;); break case &#x27;number&#x27;: console.log(&#x27;numberæ–¹å¼å¤„ç†message&#x27;); break case &#x27;boolean&#x27;: console.log(&#x27;booleanæ–¹å¼å¤„ç†message&#x27;); break default: // é»˜è®¤ä¸ä¼šæ‰§è¡Œåˆ°è¿”å›å€¼é‚£ä¸€æ­¥,æ‰€ä»¥å¦‚æœä½ æ²¡æœ‰å¯¹åº”çš„å¤„ç†é€»è¾‘,å°±ä¼šæŠ¥é”™ const check: never = message &#125;&#125;handleMessage(&quot;abc&quot;)handleMessage(123)// è¿™æ—¶å€™æœ‰äººæƒ³è¦ä¼ å…¥ booleanç±»å‹handleMessage(true)// ä½†å‘ç°æŠ¥é”™äº†, ç„¶åå°±ç»™å‡½æ•°å‚æ•°åŠ ä¸Šbooleanç±»å‹// ç„¶åå°±ä¸æŠ¥é”™äº†,ä½†æ˜¯å‡½æ•°é‡Œé¢å¹¶æ²¡æœ‰å¤„ç†booleanå‚æ•°çš„é€»è¾‘,ä»–å¹¶ä¸çŸ¥é“// å¦‚æœ, åŠ ä¸Šdefaulté‚£ä¸€æ®µ,å°±ä¼šæŠ¥é”™// è¿™æ—¶å€™è¿™ä¸ªäººå°±çŸ¥é“é‡Œé¢éœ€è¦æœ‰booleançš„å¤„ç†é€»è¾‘,ç„¶åå°±å»åŠ ä¸Š tupleç±»å‹ tuple æ˜¯å…ƒç»„ç±»å‹ï¼Œå…ƒç»„ä¸­æ¯ä¸ªå…ƒç´ éƒ½æœ‰è‡ªå·±ç‰¹å®šçš„ç±»å‹ï¼Œæ ¹æ®ç´¢å¼•å€¼è·å–åˆ°çš„å€¼å¯ä»¥ç¡®å®šå¯¹åº”çš„ç±»å‹ const info: [string, number, number] = [&quot;xxx&quot;, 18, 1.88]const name = info[0]console.log(name.length); // 3 è€Œæ•°ç»„é€šå¸¸å»ºè®®å­˜æ”¾ç›¸åŒç±»å‹çš„å€¼ tupleåº”ç”¨åœºæ™¯ tupleé€šå¸¸å¯ä»¥ä½œä¸ºè¿”å›çš„å€¼ï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™ä¼šéå¸¸çš„æ–¹ä¾¿ function useState&lt;T&gt;(state: T) &#123; let currentState = state const changeState = (newState: T) =&gt; &#123; currentState = newState &#125; const info: [string, number] = [&#x27;xxx&#x27;, 18] const tuple: [T, (newState: T) =&gt; void] = [currentState, changeState] return tuple&#125;const [counter, setCounter] = useState(10)setCounter(1000)const [title, setTitle] = useState(&quot;abc&quot;)const [flag, setFlag] = useState(true) å‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼ç±»å‹ // ä¸€èˆ¬å¯ä»¥ä¸å†™è¿”å›å€¼çš„ç±»å‹ï¼Œä¼šè‡ªåŠ¨æ¨æ–­// function sum(num1: number, num2: number): number &#123;function sum(num1: number, num2: number) &#123; return num1 + num2&#125;sum(123, 321) åŒ¿åå‡½æ•°çš„å‚æ•° const names = [&quot;aaa&quot;, &quot;bbb&quot;, &quot;ccc&quot;]// æˆ‘ä»¬å¹¶æ²¡æœ‰æŒ‡å®šitemçš„ç±»å‹// ä½†æ˜¯TypeScriptä¼šæ ¹æ®forEachå‡½æ•°çš„ç±»å‹ä»¥åŠæ•°ç»„çš„ç±»å‹æ¨æ–­å‡ºitemçš„ç±»å‹, è¿™ä¸ªæ—¶å€™å¯ä»¥ä¸æ·»åŠ çš„ç±»å‹æ³¨è§£names.forEach(function(item) &#123; console.log(item.split(&quot;&quot;));&#125;); å¯¹è±¡ç±»å‹ å¦‚æœæˆ‘ä»¬å¸Œæœ›é™å®šä¸€ä¸ªå‡½æ•°æ¥æ”¶çš„å‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ function printPoint(point: &#123;x: number, y: number&#125;) &#123; console.log(point.x); console.log(point.y);&#125;printPoint(&#123;x: 123, y: 321&#125;) è”åˆç±»å‹ function printId(id: number | string) &#123; // id å¯ä»¥æ˜¯number ä¹Ÿå¯ä»¥æ˜¯ stringç±»å‹&#125; ä½¿ç”¨è”åˆç±»å‹ function printID(id: number | string) &#123; // ä½¿ç”¨è”åˆç±»å‹çš„å€¼æ—¶ï¼Œéœ€è¦ç‰¹åˆ«çš„å°å¿ƒ // narrowï¼šç¼©å° if (typeof id === &#x27;string&#x27;) &#123; // ç¡®å®šidæ˜¯stringç±»å‹ console.log(id.toUpperCase()); &#125; else &#123; &#125;&#125; å¯é€‰ç±»å‹ å¯¹è±¡ç±»å‹ä¹Ÿå¯ä»¥æŒ‡å®šå“ªäº›å±æ€§æ˜¯å¯é€‰çš„ï¼Œå¯ä»¥åœ¨å±æ€§åé¢åŠ ä¸€ä¸ª? function printPoint(point: &#123;x: number, y:number, z?:number&#125;) &#123;&#125; é‚£ä¹ˆè¿™ä¸ªå±æ€§å¯ä¼ å¯ä¸ä¼  å¦å¤–ï¼Œå¯é€‰ç±»å‹å¯ä»¥çœ‹åšæ˜¯ç±»å‹å’Œundefinedçš„è”åˆç±»å‹ function foo(message?: string) &#123; console.log(message);&#125;foo() // ä»€ä¹ˆéƒ½ä¸ä¼ å®é™…ä¸Šå°±æ˜¯ä»£è¡¨undefinedfoo(undefined) ç±»å‹åˆ«å æˆ‘ä»¬å¯ä»¥ç»™å¯¹è±¡ç±»å‹èµ·ä¸€ä¸ªåˆ«åï¼Œæ–¹é¢æˆ‘ä»¬åç»­ä½¿ç”¨ ç”¨åˆ°äº†å…³é”®å­— type type IDType = string | numbertype PointType = &#123; x: number y: number z?: number&#125;function printID(id: IDType) &#123;&#125;function printPoint(point: PointType) &#123;&#125; ç±»å‹æ–­è¨€ as å°†ç±»å‹è½¬æ¢ä¸ºæ›´å…·ä½“çš„ç±»å‹ æœ¬æ¥ä¸åŠ ç±»å‹æ–­è¨€çš„è¯ï¼ŒTSåªä¼šæŠŠelæ¨æ–­ä¸ºHTMLElementç±»å‹ const el = document.getElementById(&quot;xxx&quot;) as HTMLImageElementel.src = &quot;urlåœ°å€&quot; æ¡ˆä¾‹2ï¼šPerson æ˜¯ Student çš„çˆ¶ç±» function sayHello(p: Person) &#123; // ä¸æ–­è¨€çš„è¯ä¼šæŠ¥é”™ï¼šç±»å‹â€œPersonâ€ä¸Šä¸å­˜åœ¨å±æ€§â€œstudyingâ€ (p as Student).studying()&#125; éç©ºç±»å‹æ–­è¨€! ! ç”¨äºç¡®å®šæŸä¸ªæ ‡è¯†ç¬¦æ˜¯æœ‰å€¼çš„ï¼Œè·³è¿‡ ts åœ¨ç¼–è¯‘é˜¶æ®µæ—¶å¯¹å®ƒçš„æ£€æµ‹ // message å¯ä»¥æ˜¯string/undefinedfunction foo(message?: string) &#123; // å½“ç„¶å¯ä»¥ç›´æ¥ifåˆ¤æ–­ // if(message) &#123; // &#125; // ä½†æ˜¯ï¼æ›´ç®€æ´ console.log(message!.length);&#125; å¯é€‰é“¾ å®é™…ä¸Šæ˜¯ ES11 å¢åŠ çš„ç‰¹æ€§ ?. æ“ä½œç¬¦ï¼Œä½œç”¨æ˜¯å½“å¯¹è±¡çš„å±æ€§ä¸å­˜åœ¨æ—¶ï¼Œä¼šçŸ­è·¯ï¼Œç›´æ¥è¿”å›undefinedï¼Œå¦‚æœå­˜åœ¨ï¼Œé‚£ä¹ˆæ‰ä¼šç»§ç»­æ‰§è¡Œ type Person = &#123; name: string, friend?: &#123; f1?: &#123; name: string &#125; &#125;&#125;const info:Person = &#123; name: &#x27;xxx&#x27;,&#125;// console.log(info.friend.f1); // friendä¸å­˜åœ¨,å–ä¸åˆ°f1,æŠ¥é”™console.log(info.friend?.f1); // undefined, ä¸æŠ¥é”™// info.friendå­˜åœ¨å—ï¼Ÿå­˜åœ¨å†ç»§ç»­å–f1 ?? å’Œ !! è¿ç®—ç¬¦ ?? æ˜¯ ES11æ–°å¢çš„ç‰¹æ€§ **ç©ºå€¼åˆå¹¶æ“ä½œç¬¦ ?? **ï¼Œæ˜¯ä¸€ä¸ªé€»è¾‘æ“ä½œç¬¦ï¼Œå½“æ“ä½œç¬¦çš„å·¦ä¾§æ˜¯ null æˆ–è€… undefined æ—¶ï¼Œè¿”å›å…¶å³ä¾§æ“ä½œæ•°ï¼Œ å¦åˆ™è¿”å›å·¦ä¾§æ“ä½œæ•° const message = nullconst res = message ?? &quot;123&quot; console.log(res); // &quot;123&quot; !!æ“ä½œç¬¦ï¼Œå°†ä¸€ä¸ªå…¶ä»–ç±»å‹è½¬æ¢æˆbooleanç±»å‹ï¼Œç±»å‹Boolean(å˜é‡) const message = &quot;&quot;let flag1 = Boolean(message)let flag2 = !!messageconsole.log(flag1); // falseconsole.log(flag2); // false å­—é¢é‡ç±»å‹ å­—é¢é‡ä¹Ÿå¯ä»¥å½“åšç±»å‹ let msg:&quot;hello&quot; = &quot;hello&quot; // ä½†æ˜¯msgçš„å€¼åªèƒ½æ˜¯&quot;hello&quot;msg = &quot;asd&quot; // æŠ¥é”™ é‚£æœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿå¯ä»¥å°†å¤šä¸ªç±»å‹è”åˆåœ¨ä¸€èµ· type Alignment = &#x27;left&#x27; | &#x27;right&#x27; | &#x27;center&#x27;function changeAlign(align: Alignment) &#123; console.log(&#x27;ä¿®æ”¹æ–¹å‘:&#x27;, align);&#125;changeAlign(&quot;center&quot;) // åªèƒ½ä¼ å…¥å®šä¹‰çš„ä¸‰ä¸ªå­—é¢é‡ç±»å‹ å­—é¢é‡æ¨ç† ä¸‹é¢çš„ä»£ç ï¼Œé»˜è®¤æƒ…å†µä¸‹info è¿›è¡Œç±»å‹æ¨æ–­çš„æ—¶å€™ï¼Œmethodæ˜¯stringç±»å‹ åŠ ä¸Šas const åï¼Œmethodså°±æ˜¯&quot;GET&quot;å­—é¢é‡ç±»å‹ const info = &#123; url: &quot;https://hillyee.github.io&quot;, method: &quot;GET&quot;&#125; as const // åŠ ä¸Šas const åï¼Œmethodså°±æ˜¯&quot;GET&quot;å­—é¢é‡ç±»å‹function request(url: string, method: &quot;GET&quot; | &quot;POST&quot;) &#123; console.log(url, method);&#125;request(info.url, info.method) // https://hillyee.github.io GET// é»˜è®¤ï¼šç±»å‹â€œstringâ€çš„å‚æ•°ä¸èƒ½èµ‹ç»™ç±»å‹â€œ&quot;GET&quot; | &quot;POST&quot;â€çš„å‚æ•°ã€‚ ç±»å‹ç¼©å° Type Narrowing ç±»å‹ç¼©å° å¯ä»¥é€šè¿‡ç±»ä¼¼äº typeof padding === â€œnumberâ€ çš„åˆ¤æ–­è¯­å¥ï¼Œæ¥æ”¹å˜TypeScriptçš„æ‰§è¡Œè·¯å¾„ åœ¨ç»™å®šçš„æ‰§è¡Œè·¯å¾„ä¸­ï¼Œç¼©å°æ¯”å£°æ˜æ—¶æ›´å°çš„ç±»å‹ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¹‹ä¸º ç¼©å° è€Œæˆ‘ä»¬ç¼–å†™çš„typeof padding === &quot;number å¯ä»¥ç§°ä¹‹ä¸ºç±»å‹ä¿æŠ¤ å¸¸è§çš„ç±»å‹ä¿æŠ¤ï¼š typeof type IDType = number | stringfunction printID(id: IDType) &#123; // è¿™å¤–é¢ä½¿ç”¨idæ˜¯ IDtype ç±»å‹ if (typeof id === &#x27;string&#x27;) &#123; // è¿™é‡Œé¢ç¡®è®¤idæ˜¯stringç±»å‹ console.log(id.toUpperCase()); &#125; else &#123; // ç¡®è®¤æ˜¯numberç±»å‹ &#125;&#125; å¹³ç­‰ç¼©å°ï¼ˆ=== == !== !=/switchï¼‰ type Direction = &quot;left&quot; | &quot;right&quot; | &quot;top&quot; | &quot;bottom&quot;function printDirection(direction: Direction) &#123; // 1.ifåˆ¤æ–­ // if (direction === &#x27;left&#x27;) &#123; // console.log(direction) // &#125; else if () // 2.switchåˆ¤æ–­ switch (direction) &#123; case &#x27;left&#x27;: console.log(direction) break; // case ... &#125;&#125; instanceof class Student &#123;&#125;class Teacher &#123;&#125;function work(p: Student | Teacher) &#123; if (p instanceof Student) &#123; &#125; else &#123; &#125;&#125; in å±æ€§æ˜¯å¦å­˜åœ¨æŸå¯¹è±¡ä¸Š type Fish = &#123; swimming: () =&gt; void&#125;type Dog = &#123; running: () =&gt; void&#125;function walk(animal: Fish | Dog) &#123; if (&#x27;swimming&#x27; in animal) &#123; &#125; else &#123; animal.running() &#125;&#125;const fish:Fish = &#123; swimming() &#123;&#125;&#125;walk(fish) TSå‡½æ•°ç±»å‹ å®šä¹‰å¸¸é‡æ—¶ï¼Œç¼–å†™å‡½æ•°çš„ç±»å‹ (num1: number, num2: number) =&gt; number å°±æ˜¯ä¸€ä¸ªå‡½æ•°ç±»å‹ï¼Œå¹¶æ¥æ”¶ä¸¤ä¸ªå‚æ•°num1ï¼Œnum2ï¼Œå¹¶ä¸”éƒ½æ˜¯numberç±»å‹ type AddFnType = (num1: number, num2: number) =&gt; numberconst add: AddFnType = (a1: number, a2: number) =&gt; &#123; return a1 + a2&#125; å‡½æ•°ä½œä¸ºå‚æ•°æ—¶ï¼Œåœ¨å‚æ•°ä¸­å¦‚ä½•ç¼–å†™ç±»å‹ï¼Ÿ function foo() &#123;&#125;type FooFnType = () =&gt; voidfunction bar(fn: FooFnType) &#123; fn()&#125;bar(foo) å‚æ•°çš„å¯é€‰ç±»å‹ function foo(x: number, y?: number) &#123;&#125; // yå¯é€‰ é»˜è®¤å‚æ•° function foo(x: number, y: number = 6) &#123;&#125; å‰©ä½™å‚æ•° å°†ä¸€ä¸ªä¸å®šæ•°é‡çš„å‚æ•°æ”¾åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ function sum(...nums: number[]) &#123; let total = 0 for (const num of nums) &#123; total += num &#125; return total&#125; thisç±»å‹ å½“thisä¸ç¡®å®šçš„æ—¶å€™ï¼Œé€šå¸¸TSä¼šè¦æ±‚æˆ‘ä»¬æ˜ç¡®çš„æŒ‡å®šthisçš„ç±»å‹ å¦‚æœä¸æŒ‡å®šçš„è¯ï¼Œéå¸¸ä¸å®‰å…¨ï¼Œå› ä¸ºæœ‰å¯èƒ½ç›´æ¥è°ƒç”¨å‡½æ•°æˆ–è€…é€šè¿‡åˆ«çš„å¯¹è±¡æ¥è°ƒç”¨å‡½æ•° type thisType = &#123; name: string &#125;function eating(this: thisType, message: string) &#123; console.log(this); console.log(this.name + &quot; eating&quot;, message);&#125;const info = &#123; name: &quot;xxx&quot;, eating: eating&#125;// éšå¼ç»‘å®šinfo.eating(&quot;asd&quot;) // thisæ˜¯info// æ˜¾å¼ç»‘å®šeating.call(&#123;name: &quot;kkk&quot;&#125;, &quot;hehehe&quot;)// &#123; name: &#x27;kkk&#x27; &#125;// kkk eating hehehe å‡½æ•°çš„é‡è½½ å‡½æ•°çš„é‡è½½åœ¨å®é™…å¼€å‘ä¹Ÿä¸æ˜¯å¿…é¡»è¦ç”¨çš„ï¼Œå¦‚æœæœ¬æ¥å¯ä»¥ç”¨è”åˆç±»å‹ç®€å•å®ç°çš„è¯ï¼Œä¼˜å…ˆé€‰æ‹©è”åˆç±»å‹ ä¾‹å¦‚æœ‰ä¸€ä¸ªéœ€æ±‚ï¼Œå¸Œæœ›å¯¹å­—ç¬¦ä¸²å’Œæ•°å­—ç±»å‹è¿›è¡Œç›¸åŠ  function add(a1: number | string, a2: number | string) &#123; if (typeof a1 === &quot;number&quot; &amp;&amp; typeof a2 === &quot;number&quot;) &#123; return a1 + a2 &#125; else if (typeof a1 === &quot;string&quot; &amp;&amp; typeof a2 === &quot;string&quot;) &#123; return a1 + a2 &#125; // return a1 + a2 // TS ä¼šæŠŠ string | number å½“åšæ˜¯ä¸€ä¸ªç±»å‹ // è¿ç®—ç¬¦â€œ+â€ä¸èƒ½åº”ç”¨äºç±»å‹â€œstring | numberâ€å’Œâ€œstring | numberâ€&#125;add(10, 20) ä»¥ä¸Šé€šè¿‡è”åˆç±»å‹çš„æ–¹å¼å®ç°æœ‰ä¸¤ä¸ªç¼ºç‚¹ï¼š è¿›è¡Œå¾ˆå¤šçš„é€»è¾‘åˆ¤æ–­ï¼ˆç±»å‹ç¼©å°ï¼‰ è¿”å›å€¼çš„ç±»å‹ä¾ç„¶ä¸ç¡®å®š å‡½æ•°çš„é‡è½½æ˜¯ä»€ä¹ˆï¼Ÿ å‡½æ•°çš„åç§°ç›¸åŒï¼Œä½†æ˜¯å‚æ•°ä¸åŒçš„å‡ ä¸ªå‡½æ•°å°±æ˜¯å‡½æ•°çš„é‡è½½ï¼Œå¹¶ä¸”æ˜¯æ²¡æœ‰å‡½æ•°æ‰§è¡Œä½“çš„ // æ„æˆå‡½æ•°é‡è½½function add(num1: number, num2: number):numberfunction add(num1: string, num2: string):string// å‡½æ•°çš„å®ç°// å¦‚æœæœ‰å‡½æ•°é‡è½½ï¼Œæ‰§è¡Œä½“æ˜¯ä¸èƒ½ç›´æ¥è¢«è°ƒç”¨çš„function add(num1: any, num2: any): any &#123; // å¦‚æœæ˜¯ string å°±è¿”å›é•¿åº¦ç›¸åŠ  if (typeof num1 === &#x27;string&#x27; &amp;&amp; typeof num2 === &quot;string&quot;) &#123; return num1.length + num2.length &#125; return num1 + num2&#125;const res1 = add(10, 20) // å…ˆæ‰¾åˆ°å‡½æ•°çš„å£°æ˜ å†æ‰¾æ‰§è¡Œä½“const res2 = add(&quot;aaa&quot;, &quot;bbb&quot;)console.log(res1); // 30console.log(res2); // 6// add(&#123;name: &quot;xxx&quot;&#125;, &#123;age: 18&#125;) ä»¥ä¸Šæ¡ˆä¾‹ç¡®å®ä½¿ç”¨å‡½æ•°é‡è½½å®ç°æ›´æ–¹ä¾¿ï¼Œæ‰€ä»¥å¯ä»¥é€‰æ‹©å‡½æ•°é‡è½½ TSç±»çš„ä½¿ç”¨ è¿™éƒ¨åˆ†ï¼Œå®é™…å¼€å‘ä¸­ç›¸å¯¹ç”¨çš„å°‘ä¸€ç‚¹ï¼Œæ‰€ä»¥ç¬”è®°æš‚æ—¶è®°çš„æ¯”è¾ƒç²—ç³™ ç±»çš„å®šä¹‰ class Person &#123; name: string age: number constructor(name: string, age: number) &#123; this.name = name this.age = age &#125; eating() &#123;&#125;&#125; ç±»çš„ç»§æ‰¿ extends super å…³é”®å­— class Person &#123; name: string age: number constructor(name: string, age: number) &#123; this.name = name this.age = age &#125; eating() &#123;&#125;&#125;class Student extends Person &#123; sno: number constructor(name: string, age: number, sno: number) &#123; super(name, age) this.sno = sno &#125;&#125; ç±»çš„å¤šæ€ ä¸åŒçš„æ•°æ®ç±»å‹è¿›è¡ŒåŒä¸€ä¸ªæ“ä½œï¼Œè¡¨ç°å‡ºä¸åŒçš„è¡Œä¸ºï¼Œå°±æ˜¯å¤šæ€çš„ä½“ç° ç±»çš„æˆå‘˜ä¿®é¥°ç¬¦ public å…±æœ‰çš„ï¼Œé»˜è®¤ç¼–å†™çš„å±æ€§å°±æ˜¯public private ä»…åœ¨åŒä¸€ç±»ä¸­å¯è§ class Person &#123; private _name: string = &quot;&quot; constructor(name: string) &#123; this._name = name &#125; // è®¿é—®å™¨setter/getter set name(newName) &#123; this._name = newName &#125; // getter get name() &#123; return this._name &#125;&#125; å…¶ä¸­ setter/getter æ˜¯è®¿é—®å™¨å±æ€§ï¼Œè¿™æ ·å¤–ç•Œå°±å¯ä»¥å­˜å‚¨ const p = new Person(&quot;xxx&quot;)p.name // ä¼šè°ƒç”¨getè®¿é—®å™¨p.name = &quot;kkk&quot; // set protected ä»…åœ¨ç±»è‡ªèº«åŠå­ç±»ä¸­å¯è§ã€å—ä¿æŠ¤çš„å±æ€§å’Œæ–¹æ³• åªè¯»å±æ€§readonly åªè¯»å±æ€§æ˜¯å¯ä»¥åœ¨æ„é€ å™¨ä¸­èµ‹å€¼, èµ‹å€¼ä¹‹åå°±ä¸å¯ä»¥ä¿®æ”¹ å±æ€§æœ¬èº«ä¸èƒ½è¿›è¡Œä¿®æ”¹, ä½†æ˜¯å¦‚æœå®ƒæ˜¯å¯¹è±¡ç±»å‹, å¯¹è±¡ä¸­çš„å±æ€§æ˜¯å¯ä»¥ä¿®æ”¹ class Person &#123; readonly name: string age?: number constructor(name: string) &#123; this.name = name &#125;&#125; const p = new Person(&quot;xxx&quot;)p.name = &#x27;kkk&#x27; // æŠ¥é”™ é™æ€æˆå‘˜ é€šè¿‡å…³é”®å­—staticæ¥å®šä¹‰ï¼Œç›´æ¥é€šè¿‡ç±»è°ƒç”¨ class Student &#123; static time: string = &quot;20:00&quot; static attendClass() &#123; console.log(&#x27;å»ä¸Šè¯¾&#x27;); &#125;&#125;console.log(Student.time);Student.attendClass() æŠ½è±¡ç±»abstract æŠ½è±¡ç±»ï¼š ä»¥abstract å£°æ˜çš„ç±»æ˜¯æŠ½è±¡ç±» æŠ½è±¡ç±»å’Œå…¶ä»–ç±»åŒºåˆ«ä¸å¤§ï¼Œä½†æ˜¯ä¸èƒ½è¢«å®ä¾‹åŒ–ï¼ˆä¸èƒ½é€šè¿‡newè°ƒç”¨ï¼‰ æŠ½è±¡ç±»å°±æ˜¯ä¸“é—¨ç”¨æ¥è¢«ç»§æ‰¿çš„ç±» æŠ½è±¡æ–¹æ³•ï¼šæ²¡æœ‰å…·ä½“å®ç°ï¼ˆæ²¡æœ‰æ–¹æ³•ä½“ï¼‰ï¼ŒæŠ½è±¡æ–¹æ³•å¿…é¡»å­˜åœ¨äºæŠ½è±¡ç±»ä¸­ function makeArea(shape: Shape) &#123; return shape.getArea()&#125;abstract class Shape &#123; abstract getArea(): number&#125;class Rectangle extends Shape &#123; private width: number private height: number constructor(width: number, height: number) &#123; super() this.width = width this.height = height &#125; // é‡å†™æ–¹æ³• getArea()&#123; return this.width * this.height &#125;&#125;const rectangle = new Rectangle(20, 30) makeArea(rectangle) ç±»çš„ç±»å‹ ç±»æœ¬èº«å¯ä»¥ä½œä¸ºä¸€ä¸ªç±»å‹ class Person &#123; name: string = &#x27;123&#x27;&#125;const p = new Person()const p1: Person = &#123; // p1çš„ç±»å‹æ˜¯Personç±»ï¼Œæ‰€ä»¥å¿…é¡»è¦ä¼ name name: &#x27;xxx&#x27;&#125; TSæ¥å£çš„ä½¿ç”¨ é™¤äº†å¯ä»¥é€šè¿‡typeå¼€å£°æ˜ä¸€ä¸ªå¯¹è±¡ç±»å‹ï¼Œè¿˜å¯ä»¥é€šè¿‡æ¥å£æ¥å£°æ˜ interface Point &#123; x: number y: number&#125; å¦å¤–ï¼Œæ¥å£ä¸­ä¹Ÿå¯ä»¥å®šä¹‰å¯é€‰å±æ€§ï¼Œåªè¯»å±æ€§ interface IInfoType &#123; readonly name: string age?: number&#125; ç´¢å¼•ç±»å‹ interface IndexLanguage &#123; [index: number]: string&#125;const frontLanguage: IndexLanguage = &#123; 0: &quot;HTML&quot;, 1: &quot;CSS&quot;, 2: &quot;JavaScript&quot;, 3: &quot;Vue&quot;&#125; å‡½æ•°ç±»å‹ ç”¨è¿‡æ¥å£interfaceæ¥å®šä¹‰å‡½æ•°ç±»å‹ interface CalcFunc &#123; (num1: number, num2: number):number&#125;const add: CalcFunc = (num1, num2) =&gt; &#123; return num1 + num2&#125; å½“ç„¶è¿˜æ˜¯æ¨èä½¿ç”¨ç±»å‹åˆ«åæ¥å®šä¹‰å‡½æ•° type CalcFunc = (num1: number, num2: number) =&gt; number æ¥å£ç»§æ‰¿ æ¥å£å’Œç±»ä¸€æ ·å¯ä»¥è¿›è¡Œç»§æ‰¿ interface ISwim &#123; swimming: () =&gt; void&#125;interface IRunning &#123; running: () =&gt; void&#125;interface IPerson extends ISwim, IRunning &#123;&#125;const action: IPerson = &#123; swimming() &#123;&#125;, running() &#123;&#125;&#125; æ¥å£çš„å®ç° implements ç”¨äºæŒ‡å®š class æ»¡è¶³æŸä¸ªæ¥å£ï¼Œè€Œä¸”ç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ ä¸æ˜¯å¾ˆæ‡‚ é¢å‘æ¥å£å¼€å‘ interface ISwim &#123; swimming: () =&gt; void&#125;interface IRun &#123; running: () =&gt; void&#125;class Person implements ISwim, IRun &#123; swimming() &#123;&#125; running() &#123;&#125;&#125;function swim(swimmer: ISwim) &#123; swimmer.swimming()&#125;const p = new Person()swim(p) äº¤å‰ç±»å‹ ä¸€ç§ç±»å‹åˆå¹¶ï¼Œè¡¨ç¤ºéœ€è¦æ»¡è¶³å¤šä¸ªç±»å‹çš„æ¡ä»¶ type MyType = number &amp; string interface å’Œ type åŒºåˆ« interfaceå¯ä»¥é‡å¤å¯¹æŸä¸ªæ¥å£æ¥å®šä¹‰å±æ€§å’Œæ–¹æ³• è€Œtypeå®šä¹‰çš„æ˜¯åˆ«åï¼Œåˆ«åæ˜¯ä¸èƒ½é‡å¤çš„ å­—é¢é‡èµ‹å€¼ interface IPerson &#123; name: string age: number height: number&#125;function printInfo(person: IPerson) &#123; console.log(person);&#125;// printInfo(&#123;// name: &quot;xxx&quot;,// age: 18,// height: 1.88,// address: &quot;å¹¿å·å¸‚&quot; // æŠ¥é”™// &#125;)const info = &#123; // å®šä¹‰å­—é¢é‡ name: &quot;why&quot;, age: 18, height: 1.88, address: &quot;å¹¿å·å¸‚&quot;&#125;printInfo(info) // å†èµ‹å€¼å°±ä¸ä¼šæŠ¥é”™ è¿™æ˜¯å› ä¸ºTypeScriptåœ¨å­—é¢é‡ç›´æ¥èµ‹å€¼çš„è¿‡ç¨‹ä¸­ï¼Œä¸ºäº†è¿›è¡Œç±»å‹æ¨å¯¼ä¼šè¿›è¡Œä¸¥æ ¼çš„ç±»å‹é™åˆ¶ã€‚ ä½†æ˜¯ä¹‹åå¦‚æœæˆ‘ä»¬æ˜¯å°†ä¸€ä¸ª å˜é‡æ ‡è¯†ç¬¦èµ‹å€¼ç»™å…¶ä»–çš„å˜é‡æ—¶ï¼Œä¼šè¿›è¡Œfreshnessæ“¦é™¤æ“ä½œ TSæšä¸¾ç±»å‹ æšä¸¾å…¶å®å°±æ˜¯å°†ä¸€ç»„å¯èƒ½å‡ºç°çš„å€¼ï¼Œä¸€ä¸ªä¸ªåˆ—ä¸¾å‡ºæ¥ï¼Œå®šä¹‰åœ¨ä¸€ä¸ªç±»å‹ä¸­ï¼Œè¿™ä¸ªç±»å‹å°±æ˜¯æšä¸¾ç±»å‹ æšä¸¾å…è®¸å¼€å‘è€…å®šä¹‰ä¸€ç»„å‘½åå¸¸é‡ï¼Œå¸¸é‡å¯ä»¥æ˜¯æ•°å­—ã€å­—ç¬¦ä¸²ç±»å‹ å®šä¹‰æšä¸¾ç±»å‹çš„å…³é”®å­—ï¼šenum enum Direction &#123; LEFT, RIGHT, TOP, BOTTOM&#125;function turnDirection(direction: Direction) &#123; switch (direction) &#123; case Direction.LEFT: console.log(&quot;æ”¹å˜è§’è‰²çš„æ–¹å‘å‘å·¦&quot;) break; case Direction.RIGHT: console.log(&quot;æ”¹å˜è§’è‰²çš„æ–¹å‘å‘å³&quot;) break; case Direction.TOP: console.log(&quot;æ”¹å˜è§’è‰²çš„æ–¹å‘å‘ä¸Š&quot;) break; case Direction.BOTTOM: console.log(&quot;æ”¹å˜è§’è‰²çš„æ–¹å‘å‘ä¸‹&quot;) break; default: const foo: never = direction; break; &#125;&#125; TSæ³›å‹ éå¸¸é‡è¦ï¼ åŸºæœ¬ä½¿ç”¨ ç®€å•æ¥è¯´å°±æ˜¯ï¼Œç±»å‹å‚æ•°åŒ– ç±»å‹å†³å®šåœ¨è°ƒç”¨å‡½æ•°çš„æ—¶å€™ åŸºæœ¬ä½¿ç”¨ï¼šå¤šåŠ ä¸€ä¸ª&lt;Type&gt;å‚æ•°æ¥æ¥æ”¶ç±»å‹ function sum&lt;Type&gt;(num1: Type):Type &#123; return num1&#125;sum&lt;number&gt;(10)sum&lt;string&gt;(&quot;123&quot;)sum&lt;&#123;name: string&#125;&gt;(&#123;name: &#x27;xxx&#x27;&#125;) è¿˜æœ‰ä¸€ç§è°ƒç”¨æ–¹å¼ï¼Œç±»å‹æ¨å¯¼ sum(50) // é‚£ä¹ˆç±»å‹Typeå°±æ˜¯å­—é¢é‡50 å¦å¤–ï¼Œè¿˜å¯ä»¥ä¼ å…¥å¤šä¸ªç±»å‹ function foo&lt;T, E, O&gt;(arg1: T, arg2: E, arg3: O, ...args: T[]) &#123;// ...args: T[] æ˜¯å‰©ä½™å‚æ•°,æ”¾åˆ°ä¸€ä¸ªæ•°ç»„ï¼Œåªèƒ½é€‰æ‹©å‰é¢&lt;&gt;å®šä¹‰çš„ç±»å‹,&#125;foo&lt;number, string, boolean&gt;(10, &quot;aaa&quot;, true) å¼€å‘æ—¶å¸¸ç”¨çš„åç§°ï¼š Tï¼šTypeçš„ç¼©å†™ï¼Œç±»å‹ Kã€Vï¼škeyå’Œvalueçš„ç¼©å†™ï¼Œé”®å€¼å¯¹ Eï¼šElementçš„ç¼©å†™ï¼Œå…ƒç´  Oï¼šObjectçš„ç¼©å†™ï¼Œå¯¹è±¡ æ³›å‹æ¥å£ å®šä¹‰æ¥å£ä¸­ä½¿ç”¨æ³›å‹ interface IPerson&lt;T&gt; &#123; name: T&#125;const p:IPerson&lt;string&gt; = &#123; name: &#x27;xx&#x27;,&#125; æ³›å‹ç±» å®šä¹‰ç±»ä½¿ç”¨æ³›å‹ class Person&lt;T1, T2&gt; &#123; name: T1 age: T2 constructor(name: T1, age: T2) &#123; this.name = name this.age = age &#125;&#125;// ç±»å‹æ¨æ–­let p1 = new Person(&quot;kkk&quot;, 20)// è‡ªå·±å®šä¹‰ç±»å‹let p2 = new Person&lt;string, number&gt;(&#x27;xxx&#x27;, 18)let p3:Person&lt;string, number&gt; = new Person(&quot;aaa&quot;, 21) æ³›å‹çº¦æŸ ç»™ç±»å‹å‚æ•°ä¸€ç‚¹çº¦æŸ å…³é”®å­— extends interface ILength &#123; length: number&#125;function getLength&lt;T extends ILength&gt;(arg: T) &#123; return arg.length&#125;// ä¼ å…¥çš„å‚æ•°å¿…é¡»æœ‰lengthå±æ€§getLength(&quot;aaa&quot;)getLength([&quot;aaa&quot;, &quot;bbb&quot;])getLength(&#123;length: 100&#125;) TSå…¶ä»–å†…å®¹ æ¨¡å—åŒ–å¼€å‘ TSæœ‰ä¸¤ç§æ–¹å¼æ§åˆ¶ä½œç”¨åŸŸ æ¨¡å—åŒ– æ”¯æŒES Moduleï¼ŒCommonJS å‘½åç©ºé—´namespace æ˜¯å°†ä¸€ä¸ªæ¨¡å—å†…éƒ¨å†è¿›è¡Œä½œç”¨åŸŸçš„åˆ’åˆ†ï¼Œé˜²æ­¢ä¸€äº›å‘½å å†²çªçš„é—®é¢˜ // ä¸ºäº†å…¶ä»–æ–‡ä»¶èƒ½ä½¿ç”¨ï¼Œè¿™é‡Œè¿˜è¦å¯¼å‡ºexport namespace time &#123; // å†…éƒ¨è¦exportå¯¼å‡ºï¼Œæ‰èƒ½åœ¨è¿™ä¸ªtsæ¨¡å—ä¸­ä½¿ç”¨ export function format(time: string) &#123; return &quot;2022-4-13&quot; &#125; // å…¶ä»–çš„é€»è¾‘ export let name: string = &quot;aaa&quot;&#125;export namespace price &#123; function format(price: number) &#123; return &quot;99.99&quot; &#125;&#125; TSæ—©æœŸçš„ä¸œè¥¿ï¼Œä¸ªäººè¿˜æ˜¯é€‰æ‹©æ¨¡å—åŒ– ç±»å‹çš„æŸ¥æ‰¾ åœ¨ä¹‹å‰ï¼Œæˆ‘ä»¬é™¤äº†è‡ªå·±ç¼–å†™ç±»å‹ï¼Œè¿˜æœ‰ç”¨åˆ°ä¸€äº›å…¶ä»–çš„ç±»å‹ï¼Œæ¯”å¦‚è¯´ document.getElementById(&quot;image&quot;) as HTMLImageElement HTMLImageElement ç±»å‹æ¥è‡ªå“ªé‡Œå‘¢ï¼Ÿ é¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“ä¸€ç§tsæ–‡ä»¶ï¼š.d.tsä¸ºåç¼€åçš„æ–‡ä»¶ è¿™ç§æ–‡ä»¶æ˜¯ç”¨æ¥åšç±»å‹çš„å£°æ˜çš„ï¼ˆdeclareï¼‰ã€‚å®ƒä»…ä»…ç”¨æ¥åšç±»å‹æ£€æµ‹ï¼Œå‘Šè¯‰typescriptæˆ‘ä»¬æœ‰å“ªäº›ç±»å‹ è¿™ç§æ–‡ä»¶æ˜¯ä¸éœ€è¦è½¬æˆjsæ–‡ä»¶æ¥è¿è¡Œçš„ é‚£ä¹ˆtypescriptä¼šåœ¨å“ªé‡ŒæŸ¥æ‰¾æˆ‘ä»¬çš„ç±»å‹å£°æ˜å‘¢ï¼Ÿ æœ‰ä¸‰ç§ï¼š å†…ç½®ç±»å‹å£°æ˜ typescriptè‡ªå¸¦çš„ï¼Œå¸®åŠ©æˆ‘ä»¬å†…ç½®äº†JSè¿è¡Œæ—¶çš„ä¸€äº›æ ‡å‡†åŒ–APIçš„å£°æ˜æ–‡ä»¶ æ¯”å¦‚å¦‚Mathã€Dateç­‰å†…ç½®ç±»å‹ï¼Œä¹ŸåŒ…æ‹¬DOM APIï¼Œæ¯”å¦‚Windowã€Documentç­‰ å†…ç½®ç±»å‹å£°æ˜é€šå¸¸åœ¨æˆ‘ä»¬å®‰è£…typescriptç¯å¢ƒä¸­ä¼šå¸¦æœ‰ github:https://github.com/microsoft/TypeScript/tree/main/lib å¤–éƒ¨å®šä¹‰ç±»å‹å£°æ˜ é€šå¸¸æ˜¯æˆ‘ä»¬ä½¿ç”¨ä¸€äº›åº“æ—¶ï¼Œéœ€è¦çš„ä¸€äº›ç±»å‹å£°æ˜ è¿™äº›åº“æœ‰ä¸¤ç§ç±»å‹å£°æ˜æ–¹å¼ åœ¨è‡ªå·±åº“ä¸­è¿›è¡Œç±»å‹å£°æ˜ï¼ˆç¼–å†™.d.tsæ–‡ä»¶ï¼‰ï¼Œæ¯”å¦‚axios é€šè¿‡ç¤¾åŒºçš„ä¸€ä¸ªå…¬æœ‰åº“DefinitelyTypedå­˜æ”¾ç±»å‹å£°æ˜æ–‡ä»¶ githubé“¾æ¥ï¼š è¯¥åº“çš„GitHubåœ°å€ï¼šhttps://github.com/DefinitelyTyped/DefinitelyTyped/ è¯¥åº“æŸ¥æ‰¾å£°æ˜å®‰è£…æ–¹å¼çš„åœ°å€ï¼šhttps://www.typescriptlang.org/dt/search?search= æ¯”å¦‚æˆ‘ä»¬éœ€è¦å®‰è£…reactçš„ç±»å‹å£°æ˜ï¼Œå°±å¯ä»¥å»æŸ¥æ‰¾å®‰è£…æ–¹å¼ è‡ªå®šä¹‰ç±»å‹å£°æ˜ æ¯”å¦‚æˆ‘ä»¬ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹åº“æ˜¯ä¸€ä¸ªçº¯çš„JavaScriptåº“ï¼Œæ²¡æœ‰å¯¹åº”çš„å£°æ˜æ–‡ä»¶ï¼›æ¯”å¦‚lodash è¿™æ—¶å€™æˆ‘ä»¬è¦è‡ªå·±å£°æ˜ç±»å‹æ–‡ä»¶ï¼š ä»»æ„ä¸€ä¸ªé¡¹ç›®æ–‡ä»¶å¤¹ä¸‹å®šä¹‰.d.ts æ–‡ä»¶ï¼Œtsä¼šè‡ªå·±æ‰¾åˆ°çš„ å£°æ˜æ¨¡å—å…³é”®å­—ï¼šdeclare // å£°æ˜æ¨¡å—declare module &#x27;lodash&#x27; &#123; export function join(arr: any[]): void&#125; å£°æ˜å˜é‡-å‡½æ•°-ç±» åœ¨.d.ts æ–‡ä»¶ä¸­å£°æ˜ declare let myName: stringdeclare let myAge: number// åªæ˜¯å£°æ˜ç±»å‹, ä¸éœ€è¦æ‰§è¡Œä½“declare function myFoo(): voiddeclare class Person &#123; name: string age: number constructor(name: string, age: number)&#125; åœ¨å…¶ä»–åœ°æ–¹ä½¿ç”¨ï¼š let myName = &quot;xxx&quot;let myAge = 18function myFoo() &#123;&#125;function Person(name, age) &#123; this.name = name this.age = age&#125;let p = new Person(&quot;xxx&quot;, 18) å£°æ˜æ¨¡å— å£°æ˜æ¨¡å—çš„è¯­æ³•: declare module â€˜æ¨¡å—åâ€™ {}ã€‚ åœ¨å£°æ˜æ¨¡å—çš„å†…éƒ¨ï¼Œå¯ä»¥é€šè¿‡exportå¯¼å‡ºå¯¹åº”åº“çš„ç±»ã€å‡½æ•°ç­‰ declare module &#x27;lodash&#x27; &#123; export function join(arr: any[]): void&#125; å£°æ˜æ–‡ä»¶ æ–‡ä»¶ä¼šè¢«å½“æˆæ¨¡å—ä½¿ç”¨ï¼Œç„¶åå°±å¯ä»¥å¼•å…¥ declare module &#x27;*.jpg&#x27;declare module &#x27;*.jepg&#x27;declare module &#x27;*.png&#x27; åœ¨åˆ«çš„åœ°æ–¹importä½¿ç”¨ import img from &#x27;./img/xxx.jpg&#x27; å£°æ˜å‘½åç©ºé—´ æ¯”å¦‚åœ¨index.htmlä¸­ç›´æ¥å¼•å…¥jQuery ç„¶ååœ¨å£°æ˜æ–‡ä»¶ä¸­ï¼ˆ.d.tsï¼‰ declare namespace $ &#123; export function ajax(settings: any):any&#125; ç„¶åå°±å¯ä»¥åœ¨åˆ«çš„æ–‡ä»¶ä½¿ç”¨ $.ajax(&#123;...&#125;)","categories":[{"name":"æ·±å…¥Vue3+Typescriptå­¦ä¹ âš¡","slug":"æ·±å…¥Vue3-Typescriptå­¦ä¹ âš¡","permalink":"https://hillyee.github.io/categories/%E6%B7%B1%E5%85%A5Vue3-Typescript%E5%AD%A6%E4%B9%A0%E2%9A%A1/"}],"tags":[{"name":"-TS","slug":"TS","permalink":"https://hillyee.github.io/tags/TS/"}]},{"title":"é¢è¯•é¢˜â€”JSæ‰‹å†™ç¯‡","slug":"é¢è¯•é¢˜â€”JSæ‰‹å†™ç¯‡","date":"2022-04-14T02:11:41.000Z","updated":"2022-04-14T02:12:34.299Z","comments":true,"path":"2022/04/14/é¢è¯•é¢˜â€”JSæ‰‹å†™ç¯‡/","link":"","permalink":"https://hillyee.github.io/2022/04/14/%E9%9D%A2%E8%AF%95%E9%A2%98%E2%80%94JS%E6%89%8B%E5%86%99%E7%AF%87/","excerpt":"","text":"å®ç°instanceof instanceof è¿ç®—ç¬¦ç”¨äºæ£€æµ‹æ„é€ å‡½æ•°çš„ prototype å±æ€§æ˜¯å¦å‡ºç°åœ¨æŸä¸ªå®ä¾‹å¯¹è±¡çš„åŸå‹é“¾ä¸Šã€‚ Object.getPrototypeOf() æ–¹æ³•è¿”å›æŒ‡å®šå¯¹è±¡çš„åŸå‹ï¼ˆå†…éƒ¨[[Prototype]]å±æ€§çš„å€¼ï¼‰ è¦æ‡‚åŸå‹å’ŒåŸå‹é“¾ function myInstanceof(target, origin) &#123; // åŸºæœ¬æ•°æ®ç±»å‹ç›´æ¥è¿”å›false if (typeof target !== &#x27;object&#x27; || target === null) return false // æ‹¿åˆ° target çš„__proto__ let proto = Object.getPrototypeOf(target) // protoä¸ä¸ºnullå°±ç»§ç»­ while(proto) &#123; // æ‰¾åˆ°ç›¸åŒçš„åŸå‹å¯¹è±¡ if (proto == origin.prototype) return true // ç»§ç»­æ²¿ç€åŸå‹é“¾æ‰¾ proto = Object.getPrototypeOf(proto) &#125; return false&#125;console.log(myInstanceof(&quot;111&quot;, String)); //falseconsole.log(myInstanceof(new String(&quot;111&quot;), String));//trueclass People &#123;&#125;class Student extends People &#123;&#125; const stu = new Student();console.log(stu instanceof People); // trueconsole.log(stu instanceof Student); // true JSå¦‚ä½•å®ç°ç»§æ‰¿ï¼Ÿ æ–¹å¼1ï¼šå€ŸåŠ©åŸå‹é“¾ // çˆ¶ç±»function Person() &#123; this.name = &#x27;pName&#x27; this.age = 18 this.friends = []&#125;Person.prototype.sayHello = function() &#123; console.log(&#x27;Hello&#x27;);&#125;// å­ç±»function Student() &#123; this.height = 1.88&#125;let p = new Person() // è·å¾—Personç±»çš„å±æ€§æ–¹æ³•console.log(p);// æˆ‘ä»¬è®©Studentçš„åŸå‹æŒ‡å‘pStudent.prototype = plet stu = new Student()console.log(stu.name); // pNamestu.sayHello() // Hello// å¯è§æˆ‘ä»¬å·²ç»æ‹¿åˆ°äº†çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³• è¿™ç§å®ç°æ–¹æ³•å­˜åœ¨çš„é—®é¢˜ï¼š 1.å½“æˆ‘ä»¬æ‰“å°å®ä¾‹stuçš„æ—¶å€™ï¼Œç»§æ‰¿çš„å±æ€§ä¸èƒ½ç›´è§‚çœ‹åˆ°ï¼Œåªèƒ½åœ¨__proto__å±æ€§ä¸­çœ‹åˆ° console.log(stu)// Student &#123;height: 1.88&#125; 2.å¦å¤–ï¼Œå¦‚æœæˆ‘ä»¬åˆ›å»ºä¸¤ä¸ªå®ä¾‹å¯¹è±¡ï¼Œå¹¶æ”¹å˜friendså±æ€§ stu1.friends.push(&#x27;aaa&#x27;)console.log(stu2.friends); // [&#x27;aaa&#x27;] æ˜æ˜æ”¹å˜çš„æ˜¯stu1çš„å±æ€§ï¼Œä¸ºä»€ä¹ˆstu2ä¹Ÿå˜äº†ï¼Ÿ å› ä¸ºæˆ‘ä»¬å®ƒä»¬çš„éšå¼åŸå‹æŒ‡å‘çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œp 3.å‰é¢å®ç°çš„è¿‡ç¨‹éƒ½æ²¡æœ‰ä¼ é€’å‚æ•° æ–¹å¼2ï¼šå€ŸåŠ©æ„é€ å‡½æ•° ä½¿ç”¨callè°ƒç”¨æ„é€ å‡½æ•°ï¼Œä¼ å…¥çš„thisä¸ºå½“å‰å®ä¾‹ï¼Œå¹¶ä¸”å¯ä»¥æŠŠå‚æ•°ä¼ ç»™çˆ¶ç±»å¤„ç† // çˆ¶ç±»function Person(name, age) &#123; this.name = name this.age = age this.friends = []&#125;Person.prototype.sayHello = function() &#123; console.log(&#x27;Hello&#x27;);&#125;// å­ç±»function Student(name, age, height) &#123; Person.call(this, name, age) // è¿™é‡Œå¯ä»¥è·å¾—çˆ¶ç±»çš„å±æ€§ this.height = height&#125;let p = new Person() // ä¾ç„¶éœ€è¦è¿™é‡Œæ¥è·å¾—æ–¹æ³•Student.prototype = plet stu1 = new Student(&#x27;aaa&#x27;, 18, 1.78)let stu2 = new Student(&#x27;bbb&#x27;, 20, 1.88)stu1.friends.push(&#x27;aaa&#x27;)console.log(stu1);console.log(stu2);stu1.sayHello() // Hello æ„é€ å‡½æ•°çš„æ–¹æ³•å¯ä»¥è§£å†³åŸå‹é“¾æ–¹å¼çš„é—®é¢˜ï¼Œä½†æ˜¯ä¾ç„¶å­˜åœ¨å¼Šç«¯ Person è‡³å°‘è¢«è°ƒç”¨ä¸¤æ¬¡ï¼ˆä¸€å¼€å§‹new Personä¸€æ¬¡ï¼Œåé¢Person.callåˆä¼šè°ƒç”¨Personï¼‰ stuçš„åŸå‹å¯¹è±¡ä¸Šä¼šå¤šå‡ºä¸€äº›å±æ€§, ä½†æ˜¯è¿™äº›å±æ€§æ˜¯æ²¡æœ‰å­˜åœ¨çš„å¿…è¦ï¼ˆnew Personçš„æ—¶å€™çš„ï¼‰ æ–¹å¼3ï¼šå¯„ç”Ÿç»„åˆå¼ç»§æ‰¿(æœ€ç»ˆæ–¹æ¡ˆ) **Object.create()**æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œä½¿ç”¨ç°æœ‰çš„å¯¹è±¡æ¥æä¾›æ–°åˆ›å»ºçš„å¯¹è±¡çš„__proto__ã€‚ Object.create(XXX) ä¹Ÿå°±æ˜¯ä¼ å…¥çš„å¯¹è±¡XXXï¼Œä½œä¸ºæ–°å¯¹è±¡çš„åŸå‹ // çˆ¶ç±»function Person(name, age, friends) &#123; this.name = name this.age = age this.friends = friends&#125;Person.prototype.sayHello = function() &#123; console.log(&#x27;Hello&#x27;);&#125;// å­ç±»function Student(name, age, friends, height) &#123; // è·å–çˆ¶ç±»ä¸­çš„å±æ€§å’Œæ–¹æ³• Person.call(this, name, age, friends) this.height = height&#125;// å†è·å–ä¸€ä»½çˆ¶ç±»çš„prototypeä¸­çš„å±æ€§å’Œæ–¹æ³•Student.prototype = Object.create(Person.prototype)Student.prototype.constructor = Studentlet stu = new Student(&#x27;aaa&#x27;, 18, [&#x27;fre1&#x27;], 1.88)console.log(stu); å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°è£…ä¸€ä¸ªæ–¹æ³•æ¥ç»§æ‰¿çˆ¶ç±»prototypeä¸­çš„å±æ€§å’Œæ–¹æ³• function inheritPrototype(SubType, SuperType) &#123; SubType.prototype = Object.create(SuperType.prototype) // å½“ç„¶å­ç±»çš„prototypeè¿˜éœ€è¦æœ‰constructoræŒ‡å‘å­æ„é€ å‡½æ•°æœ¬èº« Object.defineProperty(SubType.prototype, &quot;constructor&quot;, &#123; enumerable: false, configurable: true, writable: true, value: SubType &#125;)&#125;...inheritPrototype(Student, Person) JSæŸ¯é‡ŒåŒ–å®ç° è¦æ±‚ï¼Œä¼ å…¥ä¸€ä¸ªå‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªæŸ¯é‡ŒåŒ–çš„å‡½æ•° æ€è·¯ï¼šå½“å·²ç»ä¼ å…¥çš„å‚æ•° å¤§äºç­‰äº æ‰€éœ€è¦çš„å‚æ•°æ—¶ï¼Œå°±æ‰§è¡Œå‡½æ•° æ²¡æœ‰è¾¾åˆ°ä¸ªæ•°æ—¶ï¼Œéœ€è¦è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œç»§ç»­æ¥æ”¶é›†å‚æ•°ï¼Œæ¥æ”¶åˆ°å‚æ•°åï¼Œé€’å½’è°ƒç”¨curriedæ¥æ£€æŸ¥å‡½æ•°çš„ä¸ªæ•°æ˜¯å¦è¾¾åˆ° function myCurrying(fn) &#123; function curried(...args) &#123; // å½“å·²ç»ä¼ å…¥çš„å‚æ•° å¤§äºç­‰äº éœ€è¦çš„å‚æ•°æ—¶, å°±æ‰§è¡Œå‡½æ•° if (args.length &gt;= fn.length) &#123; // fn() return fn.apply(this, args) &#125; else &#123; // æ²¡æœ‰è¾¾åˆ°ä¸ªæ•°æ—¶, éœ€è¦è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°,ç»§ç»­æ¥æ¥æ”¶å‚æ•° function curried2(...args2) &#123; // æ¥æ”¶åˆ°å‚æ•°å, éœ€è¦é€’å½’è°ƒç”¨curriedæ¥æ£€æŸ¥å‡½æ•°çš„ä¸ªæ•°æ˜¯å¦è¾¾åˆ° return curried.apply(this, [...args, ...args2]) &#125; return curried2 &#125; &#125; // è¿”å›ä¸€ä¸ªæŸ¯é‡ŒåŒ–çš„å‡½æ•° return curried&#125;function add1(x, y, z) &#123; return x + y + z&#125;var curryAdd = myCurrying(add1)console.log(curryAdd(10, 20, 30));console.log(curryAdd(10)(20, 30));console.log(curryAdd(10)(20)(30));","categories":[{"name":"ğŸ˜£é¢è¯•é¢˜-jsç¯‡","slug":"ğŸ˜£é¢è¯•é¢˜-jsç¯‡","permalink":"https://hillyee.github.io/categories/%F0%9F%98%A3%E9%9D%A2%E8%AF%95%E9%A2%98-js%E7%AF%87/"}],"tags":[{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"https://hillyee.github.io/tags/%E9%9D%A2%E8%AF%95/"},{"name":"js","slug":"js","permalink":"https://hillyee.github.io/tags/js/"}]},{"title":"Proxy-Reflect-å“åº”å¼åŸç†","slug":"Proxy-Reflect-å“åº”å¼åŸç†","date":"2022-04-11T09:03:22.000Z","updated":"2022-04-11T09:06:05.734Z","comments":true,"path":"2022/04/11/Proxy-Reflect-å“åº”å¼åŸç†/","link":"","permalink":"https://hillyee.github.io/2022/04/11/Proxy-Reflect-%E5%93%8D%E5%BA%94%E5%BC%8F%E5%8E%9F%E7%90%86/","excerpt":"","text":"Proxy ç›‘å¬å¯¹è±¡çš„æ“ä½œ å¦‚æœæˆ‘ä»¬å¸Œæœ›ç›‘å¬ä¸€ä¸ªå¯¹è±¡ä¸­çš„å±æ€§è¢«è®¾ç½®æˆ–è·å–çš„è¿‡ç¨‹ åœ¨ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ Object.defineProperty çš„å­˜å‚¨å±æ€§æè¿°ç¬¦ï¼ˆget setï¼‰æ¥ç›‘å¬åˆ° const obj = &#123; name: &#x27;xxx&#x27;, age: 18&#125;Object.keys(obj).forEach(key =&gt; &#123; let value = obj[key] Object.defineProperty(obj, key, &#123; get: function() &#123; console.log(`ç›‘å¬åˆ°objå¯¹è±¡çš„$&#123;key&#125;å±æ€§è¢«è®¿é—®äº†`); return value &#125;, set: function(newValue) &#123; console.log(`ç›‘å¬åˆ°objå¯¹è±¡çš„$&#123;key&#125;å±æ€§è¢«è®¾ç½®å€¼`); value = newValue &#125; &#125;)&#125;)obj.name = &#x27;asd&#x27;console.log(obj.name); ä½†æ˜¯å¦‚æœæˆ‘ä»¬æƒ³è¦ç›‘å¬æ›´åŠ ä¸°å¯Œçš„æ“ä½œï¼Œæ¯”å¦‚è¯´æ–°å¢å±æ€§ã€åˆ é™¤å±æ€§ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•æ˜¯æ— èƒ½ä¸ºåŠ›çš„ è€Œä¸”æˆ‘ä»¬è¦çŸ¥é“ï¼Œè¿™ä¸ªæ–¹æ³•çš„å­˜å‚¨æè¿°ç¬¦è®¾è®¡çš„åˆè¡·ä¹Ÿä¸æ˜¯ä¸ºäº†ç›‘å¬ä¸€ä¸ªå®Œæ•´çš„å¯¹è±¡çš„ Proxyçš„åŸºæœ¬ä½¿ç”¨ è¿™ä¹Ÿæ˜¯æˆ‘ä»¬ç›‘å¬å¯¹è±¡æ“ä½œçš„ç¬¬äºŒç§æ–¹å¼ åœ¨ ES6 ä¸­ï¼Œæ–°å¢äº†Proxyç±»ï¼Œç”¨äºå¸®åŠ©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªä»£ç† å¦‚æœæˆ‘ä»¬å¸Œæœ›ç›‘å¬ä¸€ä¸ªå¯¹è±¡çš„ç›¸å…³æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæ ¹æ®è¿™ä¸ªå¯¹è±¡åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡ï¼ˆProxyå¯¹è±¡ï¼‰ã€‚ ç„¶åå¯¹è¯¥å¯¹è±¡çš„æ‰€æœ‰æ“ä½œï¼Œæˆ‘ä»¬éƒ½é€šè¿‡ä»£ç†å¯¹è±¡å®Œæˆï¼Œå› ä¸ºè¿™ä¸ªä»£ç†å¯¹è±¡å¯ä»¥å¸®æˆ‘ä»¬ç›‘å¬æˆ‘ä»¬å¯¹åŸå¯¹è±¡è¿›è¡Œçš„æ“ä½œ æ€ä¹ˆæ¥ä½¿ç”¨è¿™ä¸ªProxyä»£ç†å‘¢ï¼Ÿ const obj = &#123; name: &#x27;xxx&#x27;, age: 18&#125;const objProxy = new Proxy(obj, &#123; // è·å–å€¼æ—¶çš„æ•è·å™¨ // target:åŸå¯¹è±¡, key:å±æ€§ get: function(target, key) &#123; console.log(`ç›‘å¬åˆ°å¯¹è±¡çš„$&#123;key&#125;å±æ€§è¢«è®¿é—®äº†`, target); return target[key] &#125;, // è®¾ç½®å€¼çš„æ•è·å™¨ set: function(target, key, newValue) &#123; console.log(`ç›‘å¬åˆ°å¯¹è±¡çš„$&#123;key&#125;å±æ€§è¢«è®¾ç½®å€¼`, target); target[key] = newValue &#125;, // ç›‘å¬inçš„æ•è·å™¨ has: function(target, key) &#123; console.log(`ç›‘å¬åˆ°å¯¹è±¡çš„$&#123;key&#125;å±æ€§inæ“ä½œ`, target); return key in target &#125;, // ç›‘å¬deleteçš„æ•è·å™¨ deleteProperty: function(target, key) &#123; console.log(`ç›‘å¬åˆ°å¯¹è±¡çš„$&#123;key&#125;å±æ€§deleteæ“ä½œ`, target); delete target[key] &#125;&#125;)console.log(objProxy.name);// ç›‘å¬åˆ°å¯¹è±¡çš„nameå±æ€§è¢«è®¿é—®äº† &#123;name: &#x27;xxx&#x27;, age: 18&#125;// xxxobjProxy.name = &#x27;kkk&#x27;// ç›‘å¬åˆ°å¯¹è±¡çš„nameå±æ€§è¢«è®¾ç½®å€¼ &#123;name: &#x27;xxx&#x27;, age: 18&#125;console.log(obj.name); // kkkconsole.log(&quot;name&quot; in objProxy); // truedelete objProxy.name ä¸ºä»€ä¹ˆæˆ‘ä»¬å¯¹ä»£ç†å¯¹è±¡åšå‡ºçš„æ”¹å˜ï¼ŒåŸå¯¹è±¡ä¹Ÿæ˜¯ä¼šå˜çš„ï¼Ÿ å› ä¸ºæˆ‘ä»¬è®¾ç½®å€¼çš„æ—¶å€™ï¼Œå°±æ˜¯ç›´æ¥å¯¹åŸå¯¹è±¡è®¾ç½®çš„ï¼Œtarget[key] = newValue Proxyæ‰€æœ‰æ•è·å™¨ æœ‰13ä¸ªæ•è·å™¨ Proxy å¯¹å‡½æ•°çš„ç›‘å¬ï¼š function foo() &#123;&#125;const fooProxy = new Proxy(foo, &#123; apply: function(target, thisArg, arrArray) &#123; console.log(&quot;å¯¹fooå‡½æ•°è¿›è¡Œäº†applyè°ƒç”¨&quot;); return target.apply(thisArg, arrArray) &#125;, construct: function(target, arrArray, newTarget) &#123; console.log(&quot;å¯¹fooå‡½æ•°è¿›è¡Œäº†newè°ƒç”¨&quot;); return new target(...arrArray) &#125;&#125;)fooProxy.apply(&#123;&#125;, [&#x27;aaa&#x27;,&#x27;bbb&#x27;])new fooProxy(&quot;ddd&quot;, &quot;fff&quot;) Reflect ç®€å•ä»‹ç» Reflectæ˜¯ä»€ä¹ˆï¼Ÿ ES6 æ–°å¢çš„ä¸€ä¸ªAPIï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå­—é¢æ„æ€æ˜¯åå°„ æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ ä¸»è¦æ˜¯æä¾›äº†å¾ˆå¤šæ“ä½œJavaScriptå¯¹è±¡çš„æ–¹æ³•ï¼Œæœ‰ç‚¹åƒObjectä¸­æ“ä½œå¯¹è±¡çš„æ–¹æ³• æ¯”å¦‚ï¼šReflect.getPrototype(target) ç±»ä¼¼äº Object.getPrototype(target) é‚£æœ‰Objectå¯ä»¥åšè¿™äº›æ“ä½œï¼Œä¸ºä»€ä¹ˆè¿˜è¦æ–°å¢ Reflect å¯¹è±¡å‘¢ï¼Ÿ å› ä¸ºåœ¨æ—©æœŸçš„ ECMA è§„èŒƒä¸­æ²¡æœ‰è€ƒè™‘åˆ°è¿™ç§å¯¹ å¯¹è±¡æœ¬èº« çš„æ“ä½œå¦‚ä½•è®¾è®¡ä¼šæ›´åŠ è§„èŒƒï¼Œæ‰€ä»¥å°†è¿™äº›APIæ”¾åœ¨ Object ä¸Š ä½†æ˜¯Objectä½œä¸ºä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œè¿™äº›æ“ä½œæ”¾åˆ°å®ƒèº«ä¸Šå¹¶ä¸åˆé€‚ å¦å¤–è¿˜åŒ…å«ä¸€äº›ç±»ä¼¼äº inã€deleteæ“ä½œç¬¦ï¼ŒReflectè®©åŸæœ¬çš„å‘½ä»¤å¼å˜æˆå‡½æ•°å¼ .has ()ç­‰ æ‰€ä»¥åœ¨ES6ä¸­æ–°å¢äº†Reflectï¼Œè®©æˆ‘ä»¬è¿™äº›æ“ä½œéƒ½é›†ä¸­åˆ°äº†Reflectå¯¹è±¡ä¸Š Objectå’ŒReflectå¯¹è±¡ä¹‹é—´çš„APIå…³ç³» MDN https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Reflect/Comparing_Reflect_and_Object_methods Reflectå¸¸è§æ–¹æ³• è·ŸProxyä¸€ä¸€å¯¹åº”çš„ï¼Œä¹Ÿæ˜¯13ä¸ª Reflect å’Œ Proxy ä¸€èµ·ä½¿ç”¨ æˆ‘ä»¬å¯ä»¥å¯¹å‰é¢Proxyæ¡ˆä¾‹ä¸­ï¼Œå¯¹åŸå¯¹è±¡çš„æ“ä½œéƒ½ä¿®æ”¹ä¸ºReflectæ¥æ“ä½œ const obj = &#123; name: &#x27;xxx&#x27;, age: 18&#125;const objProxy = new Proxy(obj, &#123; get(target, key, receiver) &#123; console.log(&quot;get---------&quot;) // return target[key] // ä¸ç›´æ¥ä¿®æ”¹åŸå¯¹è±¡äº† return Reflect.get(target, key) &#125;, set(target, key, newValue, receiver) &#123; console.log(&quot;set---------&quot;) // target[key] = newValue // å¯ä»¥æ‹¿åˆ°è®¾ç½®æˆåŠŸä¸å¦çš„ç»“æœ,ä¸€ä¸ªå¸ƒå°”å€¼ const result = Reflect.set(target, key, newValue) // ç„¶åå°±å¯ä»¥æ ¹æ®ç»“æœåšä¸€äº›æ“ä½œ if (result) &#123; &#125; else &#123;&#125; &#125;&#125;)objProxy.name = &#x27;kkk&#x27;console.log(objProxy.name); // kkk Receiverå‚æ•°çš„ä½œç”¨ è®¿é—®å™¨è¿˜æœ‰ä¸€ä¸ªå‚æ•° receiver ä½œç”¨ï¼šå¦‚æœæˆ‘ä»¬çš„æºå¯¹è±¡æœ‰setterï¼Œgetterçš„è®¿é—®å™¨å±æ€§ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡receiveræ¥æ”¹å˜é‡Œé¢çš„this const obj = &#123; _name: &quot;xxx&quot;, age: 18, get name() &#123; return this._name // æ”¹å˜è¿™é‡Œçš„this &#125;, set name(newValue) &#123; this._name = newValue &#125;&#125;const objProxy = new Proxy(obj, &#123; get(target, key, receiver) &#123; // receiveræ˜¯åˆ›å»ºå‡ºæ¥çš„ä»£ç†å¯¹è±¡ console.log(receiver === objProxy); console.log(&#x27;getæ–¹æ³•è¢«è®¿é—®&#x27;, key, receiver); return Reflect.get(target, key, receiver) &#125;, set(target, key, newValue, receiver) &#123; let res = Reflect.set(target, key, newValue, receiver) console.log(&#x27;setæˆåŠŸ&#x27;, res); &#125;&#125;)objProxy.name = &#x27;kkk&#x27;console.log(objProxy.name); æ”¹å˜thisï¼Œè®©å®ƒæŒ‡å‘ä»£ç†å¯¹è±¡ åˆå¯¹ä»£ç†å¯¹è±¡æœ‰æ“ä½œï¼Œæ‰€ä»¥æ•è·äº†ä¸¤æ¬¡ Reflectä¸­çš„construct å¾ˆå°‘å¾ˆå°‘ç”¨åˆ°å­ï¼ŒryfES6æ–‡æ¡£ï¼š Reflect.construct(target, args) ç­‰åŒäºnew target(...args)ï¼Œè¿™æä¾›äº†ä¸€ç§ä¸ä½¿ç”¨newï¼Œæ¥è°ƒç”¨æ„é€ å‡½æ•°çš„æ–¹æ³•ã€‚ åº”ç”¨åœºæ™¯ï¼Œç›´æ¥çœ‹ä¾‹å­ function Student(name, age) &#123; this.name = name this.age = age&#125;function Teacher() &#123;&#125;// æ‰§è¡ŒStudentå‡½æ•°ä¸­çš„å†…å®¹ï¼Œä½†æ˜¯åˆ›å»ºå‡ºæ¥çš„å¯¹è±¡æ˜¯Teacherå¯¹è±¡const teacher = Reflect.construct(Student, [&quot;xxx&quot;, 18], Teacher)console.log(teacher);// Teacher &#123;name: &#x27;xxx&#x27;, age: 18&#125;console.log(teacher.__proto__ === Teacher.prototype);// true å“åº”å¼åŸç† ä»€ä¹ˆæ˜¯å“åº”å¼ å…ˆçœ‹ä¸€æ®µä»£ç ï¼š let m = 100// ä¸€æ®µä»£ç console.log(m);console.log(m * 2);console.log(m + 100);m = 200 å½“ m å‘ç”Ÿæ”¹å˜çš„æ—¶å€™ï¼Œä¸Šé¢ä¾èµ–mçš„ä¸€æ®µä»£ç è‡ªåŠ¨é‡æ–°æ‰§è¡Œ è¿™ç§å¯ä»¥è‡ªåŠ¨å“åº”æ•°æ®å˜é‡çš„ä»£ç æœºåˆ¶ï¼Œæˆ‘ä»¬å°±ç§°ä¹‹ä¸ºå“åº”å¼çš„ å®ç°å“åº”å¼ å“åº”å¼å‡½æ•°è®¾è®¡ä¸å°è£… é¦–å…ˆï¼Œéœ€è¦é‡æ–°æ‰§è¡Œçš„ä»£ç å¯èƒ½æœ‰å¾ˆå¤šè¡Œï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°†è¿™äº›ä»£ç æ”¾åˆ°ä¸€ä¸ªå‡½æ•°ä¸­ å½“æ•°æ®å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œæˆ‘ä»¬è®©è¿™ä¸ªå‡½æ•°æ‰§è¡Œ // å¯¹è±¡çš„å“åº”å¼const obj = &#123; name: &#x27;xxx&#x27;, age: 18&#125;// ä¾èµ–objçš„ä»£ç function objFn() &#123; console.log(&#x27;objå˜äº†&#x27;);&#125;obj.name = &#x27;kkk&#x27;// å½“æ•°æ®å‘ç”Ÿå˜åŒ–çš„æ—¶å€™,å‡½æ•°å†æ¬¡æ‰§è¡ŒobjFn() è¿™æ˜¯æˆ‘ä»¬ç®€å•çš„æ€æƒ³ï¼Œå¦‚æœæˆ‘ä»¬æœ‰å¤šä¸ªå“åº”å¼å‡½æ•°éœ€è¦å†æ¬¡æ‰§è¡Œå‘¢ï¼Ÿ é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°è£…ä¸€ä¸ªå‡½æ•°ï¼ŒæŠŠè¿™äº›å“åº”å¼å‡½æ•°éƒ½æ”¶é›†èµ·æ¥ // å°è£…ä¸€ä¸ªå“åº”å¼çš„å‡½æ•°// æŠŠå“åº”å¼å‡½æ•°æ”¶é›†åˆ°æ•°ç»„ä¸­ // æ”¹let reactiveFns = []function watchFn(fn) &#123; reactiveFns.push(fn)&#125;// å¯¹è±¡çš„å“åº”å¼const obj = &#123; name: &#x27;xxx&#x27;, age: 18&#125;// æˆ‘ä»¬æŠŠéœ€è¦å“åº”å¼çš„å‡½æ•°ä¼ å…¥watchFnwatchFn(function() &#123; // æ”¹ console.log(&#x27;objå˜äº†&#x27;);&#125;)watchFn(function() &#123; console.log(&#x27;nameå˜äº†&#x27;);&#125;)obj.name = &#x27;kkk&#x27;// å½“æ•°æ®å‘ç”Ÿå˜åŒ–çš„æ—¶å€™,æ‰§è¡Œæ”¶é›†çš„å“åº”å¼å‡½æ•°reactiveFns.forEach(fn =&gt; &#123; // æ”¹ fn()&#125;) å“åº”å¼ä¾èµ–çš„æ”¶é›† ç›®å‰æˆ‘ä»¬æ”¶é›†çš„ä¾èµ–å…¨éƒ½æ”¾åˆ°ä¸€ä¸ªæ•°ç»„æ¥ä¿å­˜ï¼Œè¿™å­˜åœ¨å¾ˆå¤§çš„é—®é¢˜ã€‚ å®é™…å¼€å‘ä¸­æˆ‘ä»¬éœ€è¦ç›‘å¬å¾ˆå¤šå¯¹è±¡çš„å“åº”å¼ï¼Œè¿™äº›å¯¹è±¡éœ€è¦ç›‘å¬çš„å±æ€§ä¹Ÿä¸æ­¢ä¸€ä¸ªï¼Œå®ƒä»¬éƒ½ä¼šæœ‰å¯¹åº”çš„å“åº”å¼å‡½æ•° æ‰€ä»¥æˆ‘ä»¬è¦è®¾è®¡ä¸€ä¸ªç±»ï¼Œè¿™ä¸ªç±»ç”¨äºç®¡ç†æŸä¸€ä¸ªå¯¹è±¡çš„æŸä¸€ä¸ªå±æ€§çš„æ‰€æœ‰å“åº”å¼å‡½æ•° class Depend &#123; // æ”¹ constructor() &#123; this.reactiveFns = [] &#125; addDepend(reactiveFn) &#123; this.reactiveFns.push(reactiveFn) &#125; // é€šçŸ¥æ‰§è¡Œä¾èµ– notify() &#123; this.reactiveFns.forEach(fn =&gt; &#123; fn() &#125;) &#125;&#125;const depend = new Depend() // æ”¹function watchFn(fn) &#123; depend.addDepend(fn)&#125;// å¯¹è±¡çš„å“åº”å¼const obj = &#123; name: &#x27;xxx&#x27;, age: 18&#125;watchFn(function() &#123; console.log(&#x27;objçš„nameå˜äº†&#x27;, obj.name);&#125;)watchFn(function() &#123; console.log(&#x27;nameå˜äº†&#x27;, obj.name);&#125;)obj.name = &#x27;kkk&#x27;// å½“æ•°æ®å‘ç”Ÿå˜åŒ–çš„æ—¶å€™,æ‰§è¡Œæ”¶é›†çš„å“åº”å¼å‡½æ•°depend.notify() // æ”¹ è‡ªåŠ¨ç›‘å¬å¯¹è±¡å˜åŒ– ç°åœ¨æˆ‘ä»¬æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œæ•°æ®å‘ç”Ÿæ”¹å˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ˜¯æ‰‹åŠ¨å»è°ƒç”¨notify()è®©ä¾èµ–å‡½æ•°æ‰§è¡Œçš„ æˆ‘ä»¬éœ€è¦è‡ªåŠ¨ç›‘å¬å¯¹è±¡å˜åŒ– æ³¨æ„ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä»£ç†å¯¹è±¡ä¹‹åï¼Œå¯¹åŸå¯¹è±¡çš„æ“ä½œéƒ½é€šè¿‡ä»£ç†å¯¹è±¡å®Œæˆäº† class Depend &#123; constructor() &#123; this.reactiveFns = [] &#125; addDepend(reactiveFn) &#123; this.reactiveFns.push(reactiveFn) &#125; // é€šçŸ¥æ‰§è¡Œä¾èµ– notify() &#123; this.reactiveFns.forEach(fn =&gt; &#123; fn() &#125;) &#125;&#125;const depend = new Depend()function watchFn(fn) &#123; depend.addDepend(fn)&#125;// å¯¹è±¡çš„å“åº”å¼const obj = &#123; name: &#x27;xxx&#x27;, age: 18&#125;// è‡ªåŠ¨ç›‘å¬å¯¹è±¡çš„å±æ€§å˜åŒ–const objProxy = new Proxy(obj, &#123; // æ”¹ get(target, key, receiver) &#123; return Reflect.get(target, key, receiver) &#125;, set(target, key, newValue, receiver) &#123; Reflect.set(target, key, newValue, receiver) depend.notify() // åœ¨è¿™é‡Œæ‰§è¡Œ &#125;&#125;)watchFn(function() &#123; console.log(&#x27;objçš„nameå˜äº†&#x27;, objProxy.name);&#125;)watchFn(function() &#123; console.log(&#x27;nameå˜äº†&#x27;, objProxy.name);&#125;)// å¯¹ä»£ç†å¯¹è±¡æ“ä½œobjProxy.name = &#x27;kkk&#x27; // æ”¹ Vue3 ç”¨çš„Proxyï¼ŒVue2ç”¨Object.defineProperty() ç›‘å¬ ä¾èµ–æ”¶é›†çš„ç®¡ç† æˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥ï¼Œä¸Šé¢åªåˆ›å»ºäº†ä¸€ä¸ªdependå¯¹è±¡æ¥ç®¡ç†obj.nameå˜åŒ–éœ€è¦ç›‘å¬çš„å“åº”å¼å‡½æ•° å¦‚æœæˆ‘ä»¬æœ‰å¤šä¸ªå¯¹è±¡ï¼Œéœ€è¦ç›‘å¬ä¸åŒçš„å±æ€§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ€ä¹ˆæ ·æ¥ç®¡ç†ä¸åŒå¯¹è±¡çš„ä¸åŒä¾èµ–å…³ç³»å‘¢ï¼Ÿ ä¾èµ–æ”¶é›†çš„æ•°æ®ç»“æ„ï¼Œè¿™é‡Œå¿…é¡»è¦ç†æ¸…æ¥šè¿™ç§ç»“æ„çš„è®¾è®¡ï¼Œæˆ‘ä»¬ç”¨åˆ°äº† Mapï¼ŒWeakMap ä¼ªä»£ç ï¼šç»“æ„å¤§æ¦‚å°±æ˜¯è¿™æ ·å­ const obj1Map = new Map()obj1Map.set(&quot;name&quot;, &quot;nameçš„æ‰€æœ‰depend&quot;)obj1Map.set(&quot;age&quot;, &quot;ageçš„æ‰€æœ‰depend&quot;)const obj2Map = new Map()obj2Map.set(&quot;height&quot;, &quot;heightçš„æ‰€æœ‰depend&quot;)let targetMap = new WeakMap()targetMap(obj1, obj1Map)targetMap(obj2, obj2Map)// å½“æ•°æ®å˜åŒ–obj1.name = &#x27;&#x27;// æ‹¿åˆ°obj1çš„nameå±æ€§çš„æ‰€æœ‰ä¾èµ–// æ ¹æ®å¯¹è±¡æ‹¿å¯¹åº”çš„map,å†æ ¹æ®å±æ€§æ‹¿ä¾èµ–å‡½æ•°const depend = targetMap.get(obj).get(&quot;name&quot;) å…·ä½“ä»£ç å®ç°ï¼š å…ˆåˆ›å»ºä¸€ä¸ªweakMapï¼Œå¹¶å°è£…ä¸€ä¸ªè·å–dependçš„å‡½æ•° class Depend &#123; constructor() &#123; this.reactiveFns = [] &#125; addDepend(reactiveFn) &#123; this.reactiveFns.push(reactiveFn) &#125; // é€šçŸ¥æ‰§è¡Œä¾èµ– notify() &#123; this.reactiveFns.forEach(fn =&gt; &#123; fn() &#125;) &#125;&#125;// å°è£…ä¸€ä¸ªå“åº”å¼çš„å‡½æ•° const depend = new Depend()function watchFn(fn) &#123; depend.addDepend(fn)&#125;// å°è£…ä¸€ä¸ªè·å–dependçš„å‡½æ•° // æ”¹const targetMap = new WeakMap()function getDepends(target, key) &#123; // æ ¹æ®å¯¹è±¡è·å–map let map = targetMap.get(target) // å¦‚æœæ²¡æœ‰è·å–åˆ°map,è¯´æ˜è¿™ä¸ªå¯¹è±¡æ˜¯ç¬¬ä¸€æ¬¡æ·»åŠ ä¾èµ– // æˆ‘ä»¬è¦ç»™è¿™ä¸ªå¯¹è±¡æ–°å»ºä¸€ä¸ªmap if (!map) &#123; map = new Map() targetMap.set( target, map) &#125; // æ ¹æ®keyè·å–ä¾èµ– let depend = map.get(key) if (!depend) &#123; depend = new Depend() map.set(key, depend) &#125; return depend&#125;// å¯¹è±¡çš„å“åº”å¼const obj = &#123; name: &#x27;xxx&#x27;, age: 18&#125;// è‡ªåŠ¨ç›‘å¬å¯¹è±¡çš„å±æ€§å˜åŒ–const objProxy = new Proxy(obj, &#123; get(target, key, receiver) &#123; return Reflect.get(target, key, receiver) &#125;, set(target, key, newValue, receiver) &#123; Reflect.set(target, key, newValue, receiver) // æ•è·è·å–å€¼çš„æ“ä½œ,è·å–ä¾èµ–,ç„¶åæ‰§è¡Œ const depend = getDepends(target, key) // æ”¹ depend.notify() // åœ¨è¿™é‡Œæ‰§è¡Œ &#125;&#125;)watchFn(function() &#123; console.log(&#x27;objçš„nameå˜äº†&#x27;, objProxy.name);&#125;)watchFn(function() &#123; console.log(&#x27;nameå˜äº†&#x27;, objProxy.name);&#125;)// å¯¹ä»£ç†å¯¹è±¡æ“ä½œobjProxy.name = &#x27;kkk&#x27; ç°åœ¨æˆ‘ä»¬æ‰§è¡Œä¼šå‘ç°ï¼Œæ ¹æœ¬æ²¡æœ‰å®ç°å“åº”å¼ï¼Œä¸ºä»€ä¹ˆï¼Ÿ å› ä¸ºæˆ‘ä»¬åœ¨watchFnæ·»åŠ ä¾èµ–å‡½æ•°çš„æ—¶å€™ï¼Œä¸ç®¡ä¸‰ä¸ƒäºŒåä¸€ï¼Œå…¨éƒ½æ·»åŠ åˆ°ä¸€ä¸ªdependé‡Œé¢äº† æ‰€ä»¥å½“æˆ‘ä»¬è·å–ä¾èµ–çš„æ—¶å€™ï¼Œæ ¹æœ¬æ— æ³•æ ¹æ®å¯¹è±¡ï¼Œkeyæ¥æ­£ç¡®çš„è·å–å¯¹åº”keyçš„ä¾èµ–å‡½æ•° é‚£ä¹ˆæ­£ç¡®çš„ä¾èµ–åº”è¯¥åœ¨å“ªé‡Œæ”¶é›†å‘¢ï¼Ÿ åº”è¯¥åœ¨æˆ‘ä»¬è°ƒç”¨Proxyçš„getæ•è·å™¨çš„æ—¶å€™ã€‚å½“æˆ‘ä»¬ç¬¬ä¸€æ¬¡è·å–å±æ€§å€¼çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±åº”è¯¥å¯¹è¿™ä¸ªkeyæ”¶é›†å®ƒè‡ªå·±çš„ä¾èµ– å¦å¤–ï¼Œå½“æˆ‘ä»¬åœ¨geté‡Œé¢æ·»åŠ ä¾èµ–çš„æ—¶å€™å‡ºç°ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æ€ä¹ˆæ‹¿åˆ°è¿™ä¸ªå“åº”å‡½æ•°å‘¢ï¼Ÿ å®šä¹‰ä¸€ä¸ªå…¨å±€çš„å˜é‡ activeReactiveFn class Depend &#123; constructor() &#123; this.reactiveFns = [] &#125; addDepend(reactiveFn) &#123; this.reactiveFns.push(reactiveFn) &#125; // é€šçŸ¥æ‰§è¡Œä¾èµ– notify() &#123; this.reactiveFns.forEach(fn =&gt; &#123; fn() &#125;) &#125;&#125;// å°è£…ä¸€ä¸ªå“åº”å¼çš„å‡½æ•°let activeReactiveFn = nullfunction watchFn(fn) &#123; // æ”¹ï¼ï¼ activeReactiveFn = fn fn() // ç”¨åŸæ•°æ®å…ˆæ‰§è¡Œä¸€æ¬¡å‡½æ•°, æ”¶é›†ä¾èµ– activeReactiveFn = null&#125;// å°è£…ä¸€ä¸ªè·å–dependçš„å‡½æ•°const targetMap = new WeakMap()function getDepends(target, key) &#123; // æ ¹æ®å¯¹è±¡è·å–map let map = targetMap.get(target) // å¦‚æœæ²¡æœ‰è·å–åˆ°map,è¯´æ˜è¿™ä¸ªå¯¹è±¡æ˜¯ç¬¬ä¸€æ¬¡æ·»åŠ ä¾èµ– // æˆ‘ä»¬è¦ç»™è¿™ä¸ªå¯¹è±¡æ–°å»ºä¸€ä¸ªmap if (!map) &#123; map = new Map() targetMap.set( target, map) &#125; // æ ¹æ®keyè·å–ä¾èµ– let depend = map.get(key) if (!depend) &#123; depend = new Depend() map.set(key, depend) &#125; return depend&#125;// å¯¹è±¡çš„å“åº”å¼let obj = &#123; name: &#x27;xxx&#x27;, age: 18&#125;// è‡ªåŠ¨ç›‘å¬å¯¹è±¡çš„å±æ€§å˜åŒ–const objProxy = new Proxy(obj, &#123; get: function(target, key, receiver) &#123; // æ ¹æ®target,keyè·å–å¯¹åº”çš„depend // æ”¹ï¼ const depend = getDepends(target, key) // ç»™dependå¯¹è±¡ä¸­æ·»åŠ å“åº”å¼å‡½æ•° depend.addDepend(activeReactiveFn) return Reflect.get(target, key, receiver) &#125;, set: function(target, key, newValue, receiver) &#123; Reflect.set(target, key, newValue, receiver) // æ•è·è·å–å€¼çš„æ“ä½œ,è·å–ä¾èµ–,ç„¶åæ‰§è¡Œ const depend = getDepends(target, key) depend.notify() // åœ¨è¿™é‡Œæ‰§è¡Œ &#125;&#125;)watchFn(function() &#123; console.log(&#x27;objçš„name&#x27;, objProxy.name);&#125;)watchFn(function() &#123; console.log(&#x27;name&#x27;, objProxy.name);&#125;)watchFn(function() &#123; console.log(&#x27;age&#x27;, objProxy.age);&#125;)console.log(&#x27;----------ä¿®æ”¹å‰---&#x27;);objProxy.name = &#x27;kkk&#x27;// objProxy.age = 20 ä¸€ä¸ªæ³¨æ„çš„åœ°æ–¹ï¼šåœ¨watchFn()å‡½æ•°é‡Œé¢ï¼Œæˆ‘ä»¬ä¼šå…ˆè°ƒç”¨ä¸€æ¬¡ä¼ å…¥çš„å‡½æ•°ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ å› ä¸ºè¿™ä¸ªå‡½æ•°å¦‚æœæœ‰å¯¹æŸä¸ªå±æ€§æœ‰getçš„æ“ä½œçš„è¯ï¼Œæˆ‘ä»¬å°±èƒ½æ•è·åˆ°ï¼Œè€Œæˆ‘ä»¬åœ¨geté‡Œé¢è¿›è¡Œæ”¶é›†ä¾èµ–çš„æ“ä½œï¼Œå°±å¯ä»¥æ”¶é›†åˆ°è¿™ä¸ªå±æ€§çš„ä¾èµ–äº† å¯¹ Depend é‡æ„ ç°åœ¨ä¾ç„¶å­˜åœ¨é—®é¢˜ï¼š å¦‚æœå‡½æ•°ä¸­ç”¨åˆ°äº†ä¸¤æ¬¡keyï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿™ä¸ªå‡½æ•°å°±ä¼šè¢«æ”¶é›†ä¸¤æ¬¡ï¼Œå³é‡å¤æ”¶é›†äº†ä¾èµ–ï¼Œåé¢æˆ‘ä»¬æ‰§è¡Œdependé‡Œé¢çš„å‡½æ•°çš„æ—¶å€™ï¼Œå°±ä¼šé‡å¤æ‰§è¡Œè¿™ä¸ªå‡½æ•° watchFn(function() &#123; console.log(&#x27;name&#x27;, objProxy.name); console.log(&#x27;name22&#x27;, objProxy.name);&#125;)console.log(&#x27;----------ä¿®æ”¹å‰---&#x27;);objProxy.name = &#x27;kkk&#x27; â€‹ è§£å†³æ–¹æ³•ï¼šä½¿ç”¨Setæ¥ä¿å­˜ä¾èµ–å‡½æ•°ï¼ˆSetå…ƒç´ ä¸é‡å¤ï¼‰ è¿˜æœ‰ä¸€ä¸ªå¯ä»¥ä¼˜åŒ–çš„åœ°æ–¹ï¼šæˆ‘ä»¬å¹¶ä¸å¸Œæœ›å°†æ·»åŠ  activeReactiveFn æ–¹æ³•æ”¾åœ¨geté‡Œé¢ï¼Œå› ä¸ºè¿™æ˜¯å±äº Depend ç±»çš„è¡Œä¸º ä¿®æ”¹åï¼š // ä¿å­˜å½“å‰éœ€è¦æ”¶é›†çš„å“åº”å¼å‡½æ•°let activeReactiveFn = null // æ”¹ï¼class Depend &#123; constructor() &#123; this.reactiveFns = new Set() // æ”¹ï¼ &#125; depend() &#123; if (activeReactiveFn) &#123; this.reactiveFns.add(activeReactiveFn) // æ”¹ï¼ &#125; &#125; notify() &#123; this.reactiveFns.forEach(fn =&gt; &#123; fn() &#125;) &#125;&#125;// å°è£…ä¸€ä¸ªå“åº”å¼çš„å‡½æ•°function watchFn(fn) &#123; activeReactiveFn = fn fn() // ç”¨åŸæ•°æ®å…ˆæ‰§è¡Œä¸€æ¬¡å‡½æ•°, æ”¶é›†ä¾èµ– activeReactiveFn = null&#125;// å°è£…ä¸€ä¸ªè·å–dependçš„å‡½æ•°const targetMap = new WeakMap()function getDepends(target, key) &#123; let map = targetMap.get(target) if (!map) &#123; map = new Map() targetMap.set( target, map) &#125; // æ ¹æ®keyè·å–ä¾èµ– let depend = map.get(key) if (!depend) &#123; depend = new Depend() map.set(key, depend) &#125; return depend&#125;// å¯¹è±¡çš„å“åº”å¼let obj = &#123; name: &#x27;xxx&#x27;, age: 18&#125;// è‡ªåŠ¨ç›‘å¬å¯¹è±¡çš„å±æ€§å˜åŒ–const objProxy = new Proxy(obj, &#123; get: function(target, key, receiver) &#123; // æ ¹æ®target,keyè·å–å¯¹åº”çš„depend const depend = getDepends(target, key) // ç»™dependå¯¹è±¡ä¸­æ·»åŠ å“åº”å¼å‡½æ•° depend.depend() // æ”¹ï¼ return Reflect.get(target, key, receiver) &#125;, set: function(target, key, newValue, receiver) &#123; Reflect.set(target, key, newValue, receiver) const depend = getDepends(target, key) depend.notify() // åœ¨è¿™é‡Œæ‰§è¡Œ &#125;&#125;)watchFn(function() &#123; console.log(&#x27;name&#x27;, objProxy.name); console.log(&#x27;name22&#x27;, objProxy.name);&#125;)console.log(&#x27;----------ä¿®æ”¹å‰---&#x27;);objProxy.name = &#x27;kkk&#x27; å¯¹è±¡çš„å“åº”å¼æ“ä½œ æœ€åä¸€ä¸ªé—®é¢˜ï¼Œå‰é¢æˆ‘ä»¬éƒ½æ˜¯å¯¹ä¸€ä¸ªå¯¹è±¡ï¼ˆobjï¼‰å®ç°å“åº”å¼ï¼Œé‚£ä¹ˆå¦‚æœæ˜¯å¤šä¸ªå¯¹è±¡å‘¢ï¼Ÿ æ‰€ä»¥æˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªå‡½æ•°reactiveï¼Œé’ˆå¯¹æ‰€æœ‰çš„å¯¹è±¡éƒ½å¯ä»¥å˜æˆå“åº”å¼å¯¹è±¡ ä¹Ÿå°±æ˜¯å®ç°å¤šä¸ªå¯¹è±¡çš„å“åº”å¼ // ä¿å­˜å½“å‰éœ€è¦æ”¶é›†çš„å“åº”å¼å‡½æ•°let activeReactiveFn = null class Depend &#123; constructor() &#123; this.reactiveFns = new Set() &#125; depend() &#123; if (activeReactiveFn) &#123; this.reactiveFns.add(activeReactiveFn) &#125; &#125; notify() &#123; this.reactiveFns.forEach(fn =&gt; &#123; fn() &#125;) &#125;&#125;// å°è£…ä¸€ä¸ªå“åº”å¼çš„å‡½æ•°function watchFn(fn) &#123; activeReactiveFn = fn fn() // ç”¨åŸæ•°æ®å…ˆæ‰§è¡Œä¸€æ¬¡å‡½æ•°, æ”¶é›†ä¾èµ– activeReactiveFn = null&#125;// å°è£…ä¸€ä¸ªè·å–dependçš„å‡½æ•°const targetMap = new WeakMap()function getDepends(target, key) &#123; let map = targetMap.get(target) if (!map) &#123; map = new Map() targetMap.set( target, map) &#125; // æ ¹æ®keyè·å–ä¾èµ– let depend = map.get(key) if (!depend) &#123; depend = new Depend() map.set(key, depend) &#125; return depend&#125;// æ¥æ”¶ä¸€ä¸ªå¯¹è±¡ï¼Œè¿”å›ä¸€ä¸ªå“åº”å¼å¯¹è±¡ // æ”¹ï¼ï¼ï¼function reactive(obj) &#123; return new Proxy(obj, &#123; get: function(target, key, receiver) &#123; // æ ¹æ®target,keyè·å–å¯¹åº”çš„depend const depend = getDepends(target, key) // ç»™dependå¯¹è±¡ä¸­æ·»åŠ å“åº”å¼å‡½æ•° depend.depend() // æ”¹ï¼ return Reflect.get(target, key, receiver) &#125;, set: function(target, key, newValue, receiver) &#123; Reflect.set(target, key, newValue, receiver) const depend = getDepends(target, key) depend.notify() // åœ¨è¿™é‡Œæ‰§è¡Œ &#125; &#125;)&#125;// æŠŠéœ€è¦å“åº”å¼çš„å¯¹è±¡ä¼ åˆ°reactiveå‡½æ•°let obj = reactive(&#123; // æ”¹ï¼ï¼ name: &#x27;xxx&#x27;, age: 18&#125;)let info = reactive(&#123; // æ”¹ï¼ï¼ height: 1.88&#125;)watchFn(function() &#123; // æ³¨æ„è¿™é‡Œ å› ä¸ºreactiveè¿”å›çš„å°±æ˜¯ä»£ç†å¯¹è±¡ï¼Œæˆ‘ä»¬ç”¨objæ¥æ”¶ï¼Œobjå°±æ˜¯å“åº”å¼çš„äº†,æ‰€ä»¥ç›´æ¥å¯¹objæ“ä½œ console.log(&#x27;name&#x27;, obj.name); console.log(&#x27;name22&#x27;, obj.name);&#125;)watchFn(function() &#123; console.log(&#x27;height&#x27;, info.height);&#125;)console.log(&#x27;--------------ä¿®æ”¹å‰---&#x27;);info.height = 1.78obj.name = &#x27;kkk&#x27; åˆ°æ­¤ï¼æˆ‘ä»¬çš„å“åº”å¼å°±å®ç°å®Œæˆäº† Vue2å“åº”å¼åŸç† å‰é¢æ‰€å®ç°çš„å“åº”å¼çš„ä»£ç ï¼Œå…¶å®æ˜¯Vue3ä¸­çš„å“åº”å¼åŸç† Vue3ä¸»è¦æ˜¯é€šè¿‡Proxyæ¥ç›‘å¬æ•°æ®çš„å˜åŒ–ä»¥åŠæ”¶é›†ç›¸å…³ çš„ä¾èµ–çš„ è€ŒVue2æ˜¯é€šè¿‡Object.defineProerty çš„æ–¹å¼æ¥å®ç°å¯¹è±¡å±æ€§çš„ç›‘å¬ function reactive(obj) &#123; Object.keys(obj).forEach(key =&gt; &#123; let value = obj[key] Object.defineProperty(obj, key, &#123; get() &#123; const depend = getDepends(obj, key) depend.depend() return value &#125;, set(newValue) &#123; const depend = getDepends(obj, key) value = newValue depend.notify() &#125; &#125;) &#125;) return obj&#125; åœ¨ä¼ å…¥å¯¹è±¡çš„æ—¶å€™ï¼Œéå†æ‰€æœ‰çš„keyï¼Œå¹¶ä¸”é€šè¿‡å±æ€§å­˜å‚¨æè¿°ç¬¦æ¥ç›‘å¬å±æ€§çš„è·å–å’Œä¿®æ”¹ï¼Œ å…¶ä»–çš„é€»è¾‘å’Œå‰é¢Vue3çš„å“åº”å¼å®ç°æ˜¯ä¸€è‡´çš„","categories":[{"name":"ğŸ”«æ·±å…¥JSé«˜çº§è¯­æ³•","slug":"ğŸ”«æ·±å…¥JSé«˜çº§è¯­æ³•","permalink":"https://hillyee.github.io/categories/%F0%9F%94%AB%E6%B7%B1%E5%85%A5JS%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/"}],"tags":[{"name":"js","slug":"js","permalink":"https://hillyee.github.io/tags/js/"}]},{"title":"10_ES6-ES12çŸ¥è¯†ç‚¹","slug":"10_ES6-ES12çŸ¥è¯†ç‚¹","date":"2022-04-10T02:57:25.000Z","updated":"2022-04-10T02:58:37.509Z","comments":true,"path":"2022/04/10/10_ES6-ES12çŸ¥è¯†ç‚¹/","link":"","permalink":"https://hillyee.github.io/2022/04/10/10_ES6-ES12%E7%9F%A5%E8%AF%86%E7%82%B9/","excerpt":"","text":"ES6 å­—é¢é‡çš„å¢å¼º å±æ€§ï¼ˆProperty Shorthandï¼‰ã€æ–¹æ³•ï¼ˆMethod Shorthandï¼‰çš„ç®€å†™ï¼Œè®¡ç®—å±æ€§åï¼ˆComputed Property Namesï¼‰ var name = &#x27;fks&#x27;var age = 20var obj = &#123; // 1. å±æ€§çš„ç®€å†™ // name: name name, age, // 2. æ–¹æ³•çš„ç®€å†™ // foo: function() &#123;&#125;, foo() &#123; console.log(this); &#125;, // obj.foo() thisæ˜¯obj // è¿™æ˜¯ä¸ä¸€æ ·çš„ // foo: () =&gt; &#123;&#125; // thisæ˜¯å…¨å±€ // 3.è®¡ç®—å±æ€§å [name + 123]: &#x27;hahahah&#x27;&#125;obj.foo()console.log(obj); // &#123; name: &#x27;fks&#x27;, age: 20, foo: [Function: foo], fks123: &#x27;hahahah&#x27; &#125; è§£æ„Destructuring è§£æ„æ•°ç»„ var names = [&quot;asd&quot;, &#x27;fgd&#x27;, &#x27;dkb&#x27;]// æœ¬æ¥æ ¹æ®ç´¢å¼•æ‹¿å€¼// var item1 = names[0]// var item2 = names[1]// var item3 = names[2]// è§£æ„var [item1, item2, item3] = namesconsole.log(item1, item2, item3);// è§£æ„åé¢çš„å…ƒç´ var [ , , itemz] = namesconsole.log(itemz);// è§£æ„ä¸€ä¸ªå…ƒç´ ï¼Œåé¢çš„å…ƒç´ æ”¾åˆ°ä¸€ä¸ªæ–°æ•°ç»„var [itemx, ...newNames] = namesconsole.log(itemx, newNames) // asd [ &#x27;fgd&#x27;, &#x27;dkb&#x27; ]// è§£æ„çš„é»˜è®¤å€¼var [itema, itemb, itemc, itemd = &quot;ddd&quot;] = namesconsole.log(itemd); è§£æ„å¯¹è±¡ æ ¹æ®keyè§£æ„ var obj = &#123; name: &#x27;asd&#x27;, age: 20, height: 1.88&#125;// ä¸è§„å®šé¡ºåºï¼Œåªæ ¹æ®keyæ¥è§£æ„var &#123;age, name&#125; = objconsole.log(age, name); // 20 asd// å¯ä»¥å¯¹keyæ–°å‘½åvar &#123; name: newName &#125; = objconsole.log(newName);// å¯ä»¥è®¾ç½®é»˜è®¤å€¼,å¦‚æœå±æ€§ä¸å­˜åœ¨,ä¼šä½¿ç”¨é»˜è®¤å€¼var &#123; address: newAddress = &#x27;å¹¿å·&#x27; &#125; = objconsole.log(newAddress); // å¹¿å·// åœ¨å‡½æ•°å‚æ•°ä¸­è§£æ„function foo(&#123;name, age&#125;) &#123; console.log(name, age);&#125;foo(obj) // asd 20 let/const let/constä½¿ç”¨ let å£°æ˜ä¸€ä¸ªå˜é‡ const å£°æ˜ä¸€ä¸ªå¸¸é‡ã€è¡¡é‡ï¼ˆconstantï¼‰ var foo = &#x27;foo&#x27;let bar = &#x27;bar&#x27; //å®šä¹‰å˜é‡const baz = &#x27;baz&#x27; // å¸¸é‡// æ³¨æ„1ï¼šconst æœ¬è´¨ä¸Šæ˜¯ä¼ é€’çš„å€¼ä¸å¯ä»¥ä¿®æ”¹ï¼Œå¦‚æœä¼ é€’çš„æ˜¯ä¸€ä¸ªå¼•ç”¨ç±»å‹ï¼ˆå†…å­˜åœ°å€ï¼‰ï¼Œæ˜¯å¯ä»¥é€šè¿‡å¼•ç”¨æ‰¾åˆ°å¯¹åº”çš„å¯¹è±¡å»ä¿®æ”¹å†…éƒ¨çš„å±æ€§å€¼çš„const obj = &#123; name: &#x27;aaa&#x27;&#125;obj.name = &#x27;bbb&#x27; //å¯ä»¥æ”¹obj = &#123;&#125; // ä¸å¯ä»¥æ”¹ TypeError: Assignment to constant variable. // let / const å®šä¹‰çš„å˜é‡åæ˜¯ä¸å¯ä»¥é‡å¤å®šä¹‰çš„let foo = &#x27;foo&#x27;let foo = &#x27;foo2&#x27; // Identifier &#x27;foo&#x27; has already been declared let/constä½œç”¨åŸŸæå‡ ä½¿ç”¨letå£°æ˜çš„å˜é‡ï¼Œåœ¨å£°æ˜ä¹‹å‰è®¿é—®ä¼šæŠ¥é”™ console.log(foo);var foo = &#x27;foo&#x27;console.log(bar); // å£°æ˜ä¹‹å‰è®¿é—®ä¼šæŠ¥é”™// åœ¨è¿™é‡Œbarå·²ç»è¢«åˆ›å»ºå‡ºæ¥äº†let bar = &#x27;bar&#x27; // Reference(å¼•ç”¨)Error: Cannot access &#x27;bar&#x27; before initialization é‚£ä¹ˆæ˜¯ä¸æ˜¯æ„å‘³ç€fooå˜é‡åªæœ‰åœ¨ä»£ç æ‰§è¡Œé˜¶æ®µæ‰ä¼šåˆ›å»ºå‘¢ï¼Ÿ äº‹å®ä¸Šå¹¶ä¸æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹ECMA262å¯¹ let å’Œ const çš„æè¿° è¿™äº›å˜é‡ä¼šè¢«åˆ›å»ºåœ¨åŒ…å«ä»–ä»¬çš„è¯æ³•ç¯å¢ƒè¢«å®ä¾‹åŒ–çš„æ—¶å€™ï¼Œä½†æ˜¯æ˜¯ä¸å¯ä»¥è®¿é—®å®ƒä»¬çš„ï¼Œç›´åˆ°è¯æ³•ç»‘å®šè¢«æ±‚å€¼ é‚£ let/constæœ‰æ²¡æœ‰ä½œç”¨åŸŸæå‡å‘¢ï¼Ÿ ä½œç”¨åŸŸæå‡ï¼šåœ¨å£°æ˜å˜é‡çš„ä½œç”¨åŸŸä¸­ï¼Œå¦‚æœè¿™ä¸ªå˜é‡å¯ä»¥åœ¨å£°æ˜ä¹‹å‰è¢«è®¿é—®ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç§°ä¹‹ä¸ºä½œç”¨åŸŸæå‡ æ‰€ä»¥è¢«åˆ›å»ºå‡ºæ¥äº†ï¼Œä½†ä¸èƒ½è¢«è®¿é—®ï¼Œä¸èƒ½ç§°ä¹‹ä¸ºä½œç”¨åŸŸæå‡ æ€»ç»“ï¼šletã€constæ²¡æœ‰è¿›è¡Œä½œç”¨åŸŸæå‡ï¼Œä½†æ˜¯ä¼šåœ¨è§£æé˜¶æ®µè¢«åˆ›å»ºå‡ºæ¥ã€ let/constå˜é‡ä¿å­˜ let / const åœ¨å…¨å±€å£°æ˜å˜é‡ä¿å­˜åœ¨å“ªé‡Œäº†ï¼Ÿ var foo = &#x27;foo&#x27;console.log(window.foo); // foolet bar = &#x27;bar&#x27;console.log(window.bar); // undefined æ‰€ä»¥ä¸åœ¨window let, const æ˜¯ä¸ä¼šç»™windowæ·»åŠ ä»»ä½•å±æ€§çš„ æœ€æ–°çš„ECMAæ ‡å‡†ä¸­å¯¹æ‰§è¡Œä¸Šä¸‹æ–‡çš„æè¿° ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å£°æ˜çš„å˜é‡å’Œç¯å¢ƒè®°å½•æ˜¯è¢«æ·»åŠ åˆ°å˜é‡ç¯å¢ƒä¸­çš„ï¼ˆåœ¨ä¸€ä¸ªå¯¹è±¡ä¿å­˜ï¼‰ ä½†æ˜¯æ ‡å‡†æ²¡æœ‰è§„å®šè¿™ä¸ªå¯¹è±¡æ˜¯ windowå¯¹è±¡æˆ–è€…æ˜¯å…¶ä»–å¯¹è±¡ æ‰€ä»¥JSå¼•æ“åœ¨è§£æçš„æ—¶å€™ï¼Œä¼šæœ‰è‡ªå·±çš„å®ç° æ¯”å¦‚v8ä¸­å…¶å®æ˜¯é€šè¿‡VariableMapçš„ä¸€ä¸ªhashmapæ¥å®ç°å®ƒä»¬çš„å­˜å‚¨çš„ é‚£ä¹ˆwindowå¯¹è±¡å‘¢ï¼Ÿ windowå¯¹è±¡æ˜¯æ—©èµ·çš„GOå¯¹è±¡ï¼Œåœ¨æœ€æ–°çš„å®ç°ä¸­å…¶å®æ˜¯æµè§ˆå™¨æ·»åŠ çš„å…¨å±€å¯¹è±¡ï¼Œå¹¶ä¸” ä¸€ç›´ä¿æŒäº†windowå’Œvarä¹‹é—´å€¼çš„ç›¸ç­‰æ€§ å—çº§ä½œç”¨åŸŸ var çš„å—çº§ä½œç”¨åŸŸ ES5ä¸­ï¼ŒJSåªä¼šå½¢æˆä¸¤ä¸ªä½œç”¨åŸŸï¼šå…¨å±€ä½œç”¨åŸŸå’Œå‡½æ•°ä½œç”¨åŸŸ var æ²¡æœ‰å—çº§ä½œç”¨åŸŸ ES5ä¸­æ”¾åˆ°ä¸€ä¸ªä»£ç ä¸­å®šä¹‰çš„å˜é‡ï¼Œå¤–é¢æ˜¯å¯ä»¥è®¿é—®çš„ &#123; var foo = &quot;foo&quot;&#125;console.log(foo); // foo let / const çš„å—çº§ä½œç”¨åŸŸ ES6ä¸­æ–°å¢äº†å—çº§ä½œç”¨åŸŸï¼Œé€šè¿‡letã€constã€functionã€class å£°æ˜çš„æ ‡è¯†ç¬¦æ˜¯å…·å¤‡å—çº§ä½œç”¨åŸŸçš„é™åˆ¶çš„ æ³¨æ„å‡½æ•°ï¼ŒæŸäº›å¼•æ“ä¼šå¯¹å‡½æ•°çš„å£°æ˜è¿›è¡Œç‰¹æ®Šå¤„ç†ï¼Œå…è®¸åƒvaré‚£æ ·æå‡ &#123; let foo = &quot;aaa&quot; function demo() &#123; console.log(&#x27;demo function&#x27;); &#125; class Person &#123;&#125;&#125;// console.log(foo); // ReferenceError: foo is not defined\\// å¯¹äºå‡½æ•°,ä¸åŒçš„æµè§ˆå™¨æœ‰ä¸åŒå®ç°,(å¤§éƒ¨åˆ†æµè§ˆå™¨ä¸ºäº†å…¼å®¹ä»¥å‰çš„ä»£ç .è®©functionæ²¡æœ‰å—çº§ä½œç”¨åŸŸ) æ‰€ä»¥è¿™é‡Œå¯ä»¥è®¿é—®demo// demo() // demo function å¯ä»¥è®¿é—®var p = new Person() // ReferenceError: Person is not defined if/switch/for è¯­å¥çš„ä»£ç å°±æ˜¯å—çº§ä½œç”¨åŸŸ // ifè¯­å¥çš„ä»£ç å°±æ˜¯å—çº§ä½œç”¨åŸŸif (true) &#123; let foo = &#x27;foo&#x27;&#125;console.log(foo); // ä¸èƒ½è®¿é—®// switchswitch (color) &#123; case &quot;red&quot;: let bar = &quot;bar&quot;&#125;console.log(bar); // ä¸èƒ½è®¿é—®// forfor (var i = 0; i &lt; 6; i++) &#123;&#125;// å¾ªç¯æ‰§è¡Œç»“æŸ, å…¨å±€ä¸­ i æ˜¯ 6console.log(i); // 6 // å¦‚æœç”¨letfor(let j = 0; j &lt; 6; j++) &#123;&#125;// å¾ªç¯ç»“æŸå, å…¨å±€ä¸­å¹¶ä¸èƒ½è®¿é—®jconsole.log(j); // j is not defined å—çº§ä½œç”¨åŸŸçš„åº”ç”¨åœºæ™¯ ä¸€ä¸ªå¾ªç¯æ‰“å°çš„é—®é¢˜ // æ³¨æ„setTimeoutæ˜¯å®ä»»åŠ¡,å¾ªç¯ç»“æŸåæ‰æ‰§è¡Œfor (var i = 0; i &lt; 6; i++) &#123; setTimeout(() =&gt; &#123; console.log(i); // æ‰“å° 6 ä¸ª 6,æ‰“å°çš„æ˜¯å…¨å±€çš„ i &#125;)&#125;// ä¸€ç§è§£å†³æ–¹æ³•ï¼Œç«‹å³æ‰§è¡Œå‡½æ•°for (var i = 0; i &lt; 6; i++) &#123; (function(i) &#123; // æ‰“å°çš„æ—¶å€™å¾€ä¸Šå±‚ä½œç”¨åŸŸæŸ¥æ‰¾,æ‰¾è¿™é‡Œçš„i setTimeout(() =&gt; &#123; console.log(i); // 0 1 2 3 4 5 &#125;) &#125;)(i)&#125;// å¦‚æœç”¨let,ä¸€æ¬¡å¾ªç¯ä¸€ä¸ªå—,äº’ä¸å½±å“for(let j = 0; j &lt; 6; j++) &#123; setTimeout(() =&gt; &#123; console.log(j); // 0 1 2 3 4 5 &#125;)&#125; constæ³¨æ„çš„åœ°æ–¹ å› ä¸ºæœ‰ i++ï¼Œç¬¬äºŒæ¬¡å¾ªç¯éœ€è¦ç”¨åˆ°ç¬¬ä¸€æ¬¡å¾ªç¯çš„iå»++ï¼Œconstå®šä¹‰çš„æ˜¯å¸¸é‡ï¼Œæ˜¯ä¸å¯ä»¥æ”¹å˜çš„ for (const i = 0; i &lt; 3; i++) &#123; console.log(i);&#125;// TypeError: Assignment to constant variable. ä½†æ˜¯ES6æ–°å¢çš„ forâ€¦ofå¯ä»¥ for (const item of names) &#123; console.log(item);&#125; æ¯æ¬¡éƒ½ä¼šæœ‰ä¸€ä¸ªæ–°çš„const itemï¼Œåœ¨ä¸åŒçš„å—çº§ä½œç”¨åŸŸä¸­ æš‚æ—¶æ€§æ­»åŒº åœ¨ä¸€ä¸ªä»£ç ä¸­ï¼Œä½¿ç”¨letã€constå£°æ˜çš„å˜é‡ï¼Œåœ¨å£°æ˜ä¹‹å‰éƒ½æ˜¯ä¸å¯ä»¥è®¿é—®çš„ è¿™ç§ç°è±¡ç§°ä¹‹ä¸ºæš‚æ—¶æ€§æ­»åŒº function foo() &#123; console.log(bar); // ä¸å¯è®¿é—® let bar = &#x27;abc&#x27;&#125;foo() å…³äºå­—ç¬¦ä¸² æ¨¡æ¿å­—ç¬¦ä¸² ä½¿ç”¨ï¼š const name = &#x27;sfa&#x27;const age = 18const message = `my name is $&#123;name&#125;, age is $&#123;age&#125;`console.log(message); // my name is sfa, age is 18 ${}é‡Œé¢ä¹Ÿå¯ä»¥æ˜¯è¡¨è¾¾å¼ï¼Œä¹Ÿå¯ä»¥æ˜¯å‡½æ•° const str = `age is $&#123;age * 2&#125;`const str2 = `double age is $&#123;doubleAge()&#125;` æ ‡ç­¾å­—ç¬¦ä¸² åº”è¯¥å¾ˆå°‘ç”¨åˆ° // ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ¨¡å—å­—ç¬¦ä¸²ä¸­çš„æ•´ä¸ªå­—ç¬¦ä¸²ï¼Œä½†æ˜¯è¢«åˆ‡æˆå¤šå—æ”¾åˆ°ä¸€ä¸ªæ•°ç»„function foo(m, n, x) &#123; console.log(m, n, x); // [ &#x27;Hello&#x27;, &#x27;World&#x27;, &#x27;aaa&#x27; ] yuzi 18&#125;// å¯ä»¥è¿™æ ·å»è°ƒç”¨ä¸€ä¸ªå‡½æ•°// foo``// å½“ç„¶ä¹Ÿå¯ä»¥ä¼ å‚const name = &#x27;yuzi&#x27;const age = 18foo`Hello$&#123;name&#125;World$&#123;age&#125;aaa` å…³äºå‡½æ•° å‡½æ•°çš„é»˜è®¤å‚æ•° å¦‚æœæ²¡æœ‰ä¼ å‚ï¼Œå°±ä¼šç”¨é»˜è®¤å‚æ•° function foo(m = &#x27;aaa&#x27;, n = &#x27;bbb&#x27;) &#123; console.log(m, n);&#125; é»˜è®¤å‚æ•°ä¹Ÿå¯ä»¥æ˜¯å¯¹è±¡ï¼Œå¹¶ä¸”å¯ä»¥å¯¹å¯¹è±¡è§£æ„ï¼Œæœ‰ä¸¤ç§è§£æ„æ–¹å¼ function foo(&#123;name, age&#125; = &#123;name: &#x27;asd&#x27;, age: 18&#125;) &#123; console.log(name, age);&#125;function foo2(&#123;name = &#x27;asd&#x27;, age = 18&#125; = &#123;&#125;) &#123;&#125; å¦å¤–æ³¨æ„ï¼šé»˜è®¤å½¢å‚æœ€å¥½æ”¾åˆ°æœ€å function bar(x, y, z = 30) &#123; console.log(x, y, z)&#125; // è·å– å‡½æ•°çš„lengthå€¼çš„æ—¶å€™ï¼Œåªè·å–é»˜è®¤å½¢å‚ä¹‹å‰çš„å‚æ•°ä¸ªæ•°console.log(bar.length); // 2 å‡½æ•°çš„å‰©ä½™å‚æ•° å‰©ä½™å‚æ•°å¿…é¡»æ”¾åˆ°æœ€å function foo(a, b, ...args) &#123; console.log(a, b, args); // 1 2 [ 3, 4, 5, 6 ]&#125;foo(1,2,3,4,5,6) ç®­å¤´å‡½æ•°çš„è¡¥å…… æ²¡æœ‰è‡ªå·±çš„thisï¼Œæ²¡æœ‰arguments æ²¡æœ‰æ˜¾å¼åŸå‹ï¼Œæ‰€ä»¥ä¸èƒ½ä½œä¸ºæ„é€ å‡½æ•°ï¼Œä¸èƒ½ä½¿ç”¨newåˆ›å»ºå¯¹è±¡ var bar = () =&gt; &#123; console.log(this, arguments); &#125;const b = new bar() // TypeError: bar is not a constructor å±•å¼€è¯­æ³•â€¦ const names = [&#x27;aaa&#x27;,&#x27;bbb&#x27;,&#x27;ccc&#x27;]const name2 = &#x27;kkk&#x27;function foo(x, y, z) &#123; console.log(x, y, z);&#125;// 1. å‡½æ•°è°ƒç”¨æ—¶ä½¿ç”¨foo(...names) // aaa bbb ccc// 2. æ„é€ æ•°ç»„æ—¶const newNames = [...names, ...name2]console.log(newNames);// [ &#x27;aaa&#x27;, &#x27;bbb&#x27;, &#x27;ccc&#x27;, &#x27;k&#x27;, &#x27;k&#x27;, &#x27;k&#x27; ]// æ³¨æ„è¿™é‡ŒæŠŠå­—ç¬¦ä¸²å±•å¼€äº†// 3.æ„å»ºå¯¹è±¡å­—é¢é‡æ—¶ ES2018(ES9)const info = &#123;name: &#x27;ggg&#x27;, height: 1.88&#125;// æ‹·è´infoçš„å±æ€§ï¼Œå¹¶ä¸”å¯ä»¥æ·»åŠ æ–°çš„å±æ€§const obj = &#123;...info, address: &#x27;å¹¿å·å¸‚&#x27;&#125;console.log(obj)// &#123; name: &#x27;ggg&#x27;, height: 1.88, address: &#x27;å¹¿å·å¸‚&#x27; &#125; æ³¨æ„ï¼šå±•å¼€è¿ç®—ç¬¦å…¶å®æ˜¯ä¸€ç§æµ…æ‹·è´ ç®€å•æ¥è¯´å°±æ˜¯ï¼Œæ‹·è´çš„åœ°å€ï¼ŒæŒ‡å‘çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡ const info = &#123; name: &#x27;fff&#x27;, hobby: &#123; h1: &#x27;study&#x27;, h2: &#x27;swim&#x27; &#125;&#125;const newInfo = &#123;...info&#125;newInfo.hobby.h1 = &#x27;sss&#x27;console.log(info.hobby.h1); // sss åŸæ¥çš„infoä¹Ÿæ”¹äº† è¡¨ç¤ºæ•°å€¼çš„æ–¹æ³•(è¿›åˆ¶) obå¼€å¤´(binary)ï¼šäºŒè¿›åˆ¶ï¼Œ0oå¼€å¤´(octonary)ï¼šå…«è¿›åˆ¶ï¼Œ0xå¼€å¤´(hexadecimal)ï¼šåå…­è¿›åˆ¶ const num1 = 100 // åè¿›åˆ¶const num2 = 0b100 // äºŒè¿›åˆ¶const num3 = 0o100 // å…«è¿›åˆ¶const num4 = 0x100 // åå…­è¿›åˆ¶console.log(num1, num2, num3, num4); // 100 4 64 256 å¦å¤–ï¼Œå¤§çš„æ•°å€¼æœ‰ä¸€ä¸ªè¿æ¥ç¬¦ï¼Œä¾¿äºé˜…è¯»(ES2021 ES12) const num = 10_000_000_000_000console.log(num); // 10000000000000 Symbolçš„ä½¿ç”¨ ä¸»è¦æ˜¯ç”¨æ¥åˆ›å»ºç‹¬ä¸€æ— äºŒçš„keyå€¼ï¼Œæ³¨æ„ä½¿ç”¨çš„æ—¶å€™ä¸è¦ç”¨new åˆ›å»ºSymbol const s1 = Symbol()const s2 = Symbol() // s1,s2æ˜¯ä¸ä¸€æ ·çš„console.log(s1 === s2); // false// ES2019(ES10)ä¸­, Symbolè¿˜æœ‰ä¸€ä¸ªæè¿°(description)// ä¾¿äºæ ‡è®°æ˜¯å“ªä¸ªsymbolï¼Œå°±åƒæ˜¯æ ‡ç­¾const s3 = Symbol(&#x27;aaa&#x27;)console.log(s3); // Symbol(aaa)// å¯ä»¥æ‹¿åˆ°è¿™ä¸ªæè¿°console.log(s3.description); // &#x27;aaa&#x27; åœ¨å¯¹è±¡ä¸­ä½œä¸ºkeyä½¿ç”¨ const obj = &#123; [s1]: &#x27;yyy&#x27;, [s2]: &#x27;mmm&#x27;&#125;// è·å–å±æ€§å€¼console.log(obj[s1]); // &#x27;yyy&#x27;// æ–°å¢å±æ€§å€¼obj[s3] = &#x27;kkk&#x27;// ä¹Ÿå¯ä»¥Object.defineProperty()æ–¹æ³•æ·»åŠ å±æ€§Object.defineProperty(obj, s4, &#123;&#125;) æ³¨æ„ï¼šè·å–å±æ€§å€¼çš„æ—¶å€™ä¸èƒ½é€šè¿‡ . è¯­æ³•è·å–ï¼Œå› ä¸º . åé¢çš„æ˜¯ä¼šè¢«å½“åšå­—ç¬¦ä¸² obj.s1ï¼Œé‚£ä¹ˆå°±ä¼šå»æ‰¾objä¸Škeyä¸ºâ€™s1â€™è¿™ä¸ªå±æ€§å€¼ ä½¿ç”¨Symbolä½œä¸ºkeyçš„å±æ€§åï¼Œåœ¨éå†çš„æ—¶å€™æ˜¯è·å–ä¸åˆ°çš„ console.log(Object.keys(obj)); // []console.log(Object.getOwnPropertyNames(obj)); // [] å¦‚æœæƒ³è¦è·å–çš„è¯å¯ä»¥ä½¿ç”¨ Object.getOwnPropertySymbols()æ–¹æ³• const sKeys = Object.getOwnPropertySymbols(obj)console.log(sKeys); // [ Symbol(), Symbol(), Symbol(aaa) ] æ€ä¹ˆè®©ä¸¤ä¸ªSymbolç›¸ç­‰ï¼Ÿ Symbol.for(key) æ–¹æ³•ä¼šæ ¹æ®ç»™å®šçš„é”® keyï¼Œæ¥ä»è¿è¡Œæ—¶çš„ symbol æ³¨å†Œè¡¨ä¸­æ‰¾åˆ°å¯¹åº”çš„ symbol æ³¨æ„è¿™è·Ÿ Symbol(â€˜aaaâ€™) æ ‡ç­¾æ˜¯ä¸ä¸€æ ·çš„å“¦ // ä¹Ÿå°±æ˜¯ç»™symbolä¸€ä¸ªkeyconst sa = Symbol.for(&quot;aaa&quot;)const sb = Symbol.for(&quot;aaa&quot;)console.log(sa === sb); // true æ ¹æ® symbolå€¼è·å–key Symbol.keyFor(sym) æ–¹æ³•ç”¨æ¥è·å–å…¨å±€symbol æ³¨å†Œè¡¨ä¸­ä¸æŸä¸ª symbol å…³è”çš„é”® const key = Symbol.keyFor(sa)console.log(key); // aaa Set æ–°å¢çš„ä¸€ç§æ•°æ®ç»“æ„ï¼ˆå­˜å‚¨æ•°æ®çš„æ–¹å¼ï¼‰ æ˜¯é›†åˆï¼Œé‡Œé¢çš„å…ƒç´ ä¸é‡å¤ åˆ›å»ºsetå’Œæ·»åŠ å…ƒç´  // 1. åˆ›å»ºconst set = new Set()// æ·»åŠ å…ƒç´ set.add(10)set.add(20)set.add(30)console.log(set); // Set(3) &#123; 10, 20, 30 &#125;// ä¸é‡å¤set.add(10)console.log(set);// Set(3) &#123; 10, 20, 30 &#125; æ³¨æ„æ·»åŠ å¯¹è±¡æ—¶å€™çš„ä¸€ç§æƒ…å†µï¼Œå› ä¸ºæ·»åŠ çš„å¯¹è±¡çš„åœ°å€æ˜¯ä¸ä¸€æ ·çš„ set.add(&#123;&#125;)set.add(&#123;&#125;)console.log(set); // &#123; &#123;&#125;, &#123;&#125; &#125;// ä»¥ä¸‹æ·»åŠ çš„æ‰æ˜¯åŒä¸€ä¸ªå¯¹è±¡const obj = &#123;&#125;set.add(obj)set.add(obj)console.log(set); // &#123; &#123;&#125; &#125; æœ€å¸¸è§çš„åº”ç”¨ï¼šå¯¹æ•°ç»„å»é‡ // å»é‡(æŠŠæ•°ç»„æ”¾è¿›é›†åˆ)const arr = [10, 20, 30, 40, 10, 20]const arrSet = new Set(arr)console.log(arrSet); // Set(4) &#123; 10, 20, 30, 40 &#125; Setçš„å±æ€§ set.size è¿”å›å…ƒç´ ä¸ªæ•° Setçš„æ–¹æ³• add() æ·»åŠ å…ƒç´ clear() æ¸…ç©ºé›†åˆå…ƒç´ delete(x) åˆ é™¤æŸå…ƒç´ has(x) æ˜¯å¦åŒ…å«xå…ƒç´ éå†ï¼šforEacharrSet.forEach(item =&gt; &#123; console.log(item);&#125;)for (const item of arrSet) &#123; console.log(item);&#125; WeakSet ç”¨çš„å¾ˆå°‘ï¼Œå¯¹äºWeakSetçš„åº”ç”¨æˆ‘å°±ä¸çº ç»“äº† WeakSetè·Ÿsetçš„åŒºåˆ«ï¼šWeakSetåªèƒ½å­˜æ”¾å¯¹è±¡ç±»å‹ WeakSetå¯¹å…ƒç´ çš„å¼•ç”¨æ˜¯å¼±å¼•ç”¨ï¼Œå¦‚æœæ²¡æœ‰å…¶ä»–å¼•ç”¨å¯¹æŸä¸ªå¯¹è±¡è¿›è¡Œå¼•ç”¨ï¼Œé‚£ä¹ˆGCå¯ä»¥å¯¹è¯¥å¯¹è±¡è¿›è¡Œå›æ”¶ å¦å¤–ï¼ŒWeakSetä¸èƒ½éå†ï¼Œå› ä¸ºWeakSetåªæ˜¯å¯¹å¯¹è±¡çš„å¼±å¼•ç”¨ï¼Œå¦‚æœæˆ‘ä»¬éå†è·å–åˆ°å…¶ä¸­çš„å…ƒç´ é‚£ä¹ˆæœ‰å¯èƒ½é€ æˆå¯¹è±¡ä¸èƒ½æ­£å¸¸é”€æ¯ï¼Œæ‰€ä»¥å­˜å‚¨åˆ°WeakSetä¸­çš„å¯¹è±¡æ˜¯æ²¡åŠæ³•è·å–çš„ const weakSet = new WeakSet()weakSet.add(&#123;name: &#x27;asd&#x27;&#125;, &#123;&#125;) &#123; åœ°å€1, åœ°å€2 &#125; å¼±å¼•ç”¨console.log(weakSet); // WeakSet &#123; &lt;items unknown&gt; &#125; æˆ‘å¯¹å¼±å¼•ç”¨çš„ç†è§£ å…³äºå¼ºå¼•ç”¨å¼±å¼•ç”¨çš„ä¸€ç¯‡æ–‡ç« ï¼šhttps://juejin.cn/post/6993101968545677319#heading-21 Map ä¸€ç§æ•°æ®ç»“æ„ï¼Œé”®å€¼å¯¹çš„å½¢å¼ï¼Œå¹¶ä¸”é”®å¯ä»¥æ˜¯å¯¹è±¡ æ™®é€šå¯¹è±¡çš„é”®ä¸èƒ½æ˜¯å¯¹è±¡ï¼Ÿä¸èƒ½ const obj1 = &#123; name: &#x27;aaa&#x27; &#125;const obj2 = &#123; name: &#x27;bbb&#x27; &#125;const info = &#123; [obj1]: &#x27;qqq&#x27;, [obj2]: &#x27;kkk&#x27;&#125;console.log(info);// &#123; &#x27;[object Object]&#x27;: &#x27;kkk&#x27; &#125;// è¿™ä¸‹æ‡‚äº†å§ï¼Œè¿™ä¸ªé”®ä¼šè¢«è½¬æˆå­—ç¬¦ä¸²&#x27;[object Object]&#x27;,keyé‡å¤äº†ï¼Œå€¼è¦†ç›–äº† æ€ä¹ˆä½¿ç”¨Mapï¼Ÿ // ä½¿ç”¨const map = new Map()// æ·»åŠ é”®å€¼map.set(obj1, &#x27;aaa&#x27;)map.set(obj2, &#x27;bbb&#x27;)map.set(1, &#x27;ccc&#x27;)console.log(map);// æ‰“å°// Map(3) &#123;// &#123; name: &#x27;aaa&#x27; &#125; =&gt; &#x27;aaa&#x27;,// &#123; name: &#x27;bbb&#x27; &#125; =&gt; &#x27;bbb&#x27;,// 1 =&gt; &#x27;ccc&#x27;// &#125;// å¦ä¸€ç§æ·»åŠ ,æŠŠé”®å€¼å¯¹æ”¾åˆ°æ•°ç»„const map2 = new Map([[obj1, &#x27;aaa&#x27;], [obj2, &#x27;bbb&#x27;]])console.log(map2);// Map(2) &#123; &#123; name: &#x27;aaa&#x27; &#125; =&gt; &#x27;aaa&#x27;, &#123; name: &#x27;bbb&#x27; &#125; =&gt; &#x27;bbb&#x27; &#125; æœ‰ä»€ä¹ˆå±æ€§å’Œæ–¹æ³•ï¼Ÿ å±æ€§ï¼šsizeï¼šè¿”å›mapå¯¹è±¡çš„æˆå‘˜æ•°é‡ æ–¹æ³•ï¼š set(key, value) ï¼šæ·»åŠ ï¼Œè®¾ç½®é”®å€¼ï¼Œè¿”å›æ•´ä¸ªMapå¯¹è±¡ get(key)ï¼šæ ¹æ®keyè·å–å€¼ has(key)ï¼šæ˜¯å¦å­˜åœ¨æŸä¸€ä¸ªkeyï¼Œè¿”å›å¸ƒå°”å€¼ delete(key)ï¼šåˆ é™¤ä¸€ä¸ªé”®å€¼å¯¹ï¼Œè¿”å›å¸ƒå°”å€¼ clear()ï¼šæ¸…ç©ºå…ƒç´  éå† forEach() // éå†map.forEach((item, key) =&gt; &#123; console.log(item, key);&#125;)// for..oféå†æ³¨æ„for (const item of map) &#123; // console.log(item); // è¿™é‡ŒæŠŠä¸€ä¸ªé”®å€¼å¯¹æ”¾åˆ°ä¸€ä¸ªæ•°ç»„äº† // [ &#123; name: &#x27;bbb&#x27; &#125;, &#x27;bbb&#x27; ] // æ‰€ä»¥å¯ä»¥æ ¹æ®ç´¢å¼•å€¼åˆ†åˆ«æ‹¿ key, value console.log(item[0], item[1]);&#125;// æˆ–è€…è¿›è¡Œè§£æ„for (const [key, value] of map) &#123; console.log(key, value);&#125; WeakMap å’ŒMapæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ WeakMapçš„keyåªèƒ½ä½¿ç”¨å¯¹è±¡ WeakMapçš„keyå¯¹å¯¹è±¡çš„å¼•ç”¨æ˜¯å¼±å¼•ç”¨ï¼Œå¦‚æœæ²¡æœ‰å…¶ä»–å¼•ç”¨å¼•ç”¨è¿™ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆGCå¯ä»¥å›æ”¶ å¸¸è§æ–¹æ³•ï¼š set(key, value)ï¼šæ·»åŠ é”®å€¼ï¼Œè¿”å›æ•´ä¸ªå¯¹è±¡ get(key)ï¼šæ ¹æ®keyè·å–å€¼ has(key)ï¼šæ˜¯å¦åŒ…å«æŸä¸ªkeyï¼Œè¿”å›å¸ƒå°”å€¼ delete(key)ï¼šæ ¹æ®keyåˆ é™¤é”®å€¼å¯¹ï¼Œè¿”å›å¸ƒå°”å€¼ WeakMapä¸èƒ½éå† const obj = &#123; name: &#x27;asd&#x27;&#125;const weakMap = new WeakMap()weakMap.set(obj, &#x27;123&#x27;)console.log(weakMap); // WeakMap &#123; &lt;items unknown&gt; &#125; å“åº”å¼åŸç†ä¸­çš„WeakMapä½¿ç”¨ å¯ä»¥çœ‹çœ‹Vue3çš„å“åº”å¼åŸç†ï¼Œä¹‹å‰å®ç°mini-vueçš„æ—¶å€™å®ç°è¿‡å“åº”å¼ç³»ç»Ÿ ç®€å•çš„æ€æƒ³å°±æ˜¯ï¼š åˆ›å»ºä¸€ä¸ªWeakMap, keyæ˜¯obj1ï¼Œå€¼æ˜¯ä¸€ä¸ªMapç»“æ„, è¿™ä¸ªMapï¼Œé”®æ˜¯å¯¹è±¡çš„å±æ€§ï¼Œå€¼æ˜¯æœ‰ä¾èµ–è¿™ä¸ªå±æ€§çš„å‡½æ•°ï¼Œ å½“è¿™ä¸ªå±æ€§å‘ç”Ÿä»€ä¹ˆæ”¹å˜çš„æ—¶å€™ï¼Œå°±æ‰§è¡Œè¿™ä¸ªå±æ€§æ‰€æœ‰ä¾èµ–çš„å‡½æ•° ä¸€ä¸ªç®€å•çš„å“åº”å¼æ¨¡æ‹Ÿå®ç° // åº”ç”¨åœºæ™¯ï¼ˆvue3å“åº”å¼åŸç†ï¼‰const obj1 = &#123; name: &#x27;qwe&#x27;, age: 20 &#125;function obj1NameFn1() &#123; console.log(&#x27;obj1NameFn1è¢«æ‰§è¡Œ&#x27;);&#125;function obj1NameFn2() &#123; console.log(&#x27;obj1NameFn2è¢«æ‰§è¡Œ&#x27;);&#125;function obj1AgeFn1() &#123; console.log(&quot;obj1AgeFn1&quot;)&#125;function obj1AgeFn2() &#123; console.log(&quot;obj1AgeFn2&quot;)&#125;// 1.åˆ›å»ºWeakMapconst weakMap = new WeakMap()// 2.æ”¶é›†ä¾èµ–ç»“æ„// 2.1.å¯¹obj1æ”¶é›†çš„æ•°æ®ç»“æ„const obj1Map = new Map()obj1Map.set(&#x27;name&#x27;, [obj1NameFn1, obj1NameFn2])obj1Map.set(&#x27;age&#x27;, [obj1AgeFn1, obj1AgeFn2])weakMap.set(obj1, obj1Map)// å¦‚æœobj1.nameå‘ç”Ÿæ”¹å˜obj1.name = &#x27;ggg&#x27;const targetMap = weakMap.get(obj1)const fns = targetMap.get(&quot;name&quot;)fns.forEach(fn =&gt; &#123; fn()&#125;); ES7 Array Includes åˆ¤æ–­æ•°ç»„ä¸­æ˜¯å¦åŒ…å«æŸä¸ªå…ƒç´  åœ¨ä¹‹å‰æˆ‘ä»¬ç»å¸¸ä½¿ç”¨ indexOf() åˆ¤æ–­ï¼Œè¯¥æ–¹æ³•è¿”å›å…ƒç´ æ‰€åœ¨çš„ç´¢å¼•å€¼ï¼Œæ²¡æœ‰å°±è¿”å›-1 const names = [&#x27;aaa&#x27;, &#x27;bbb&#x27;, &#x27;ccc&#x27;, &#x27;ddd&#x27;]if (names.indexOf(&#x27;bbb&#x27;) !== -1) &#123; console.log(&#x27;åŒ…å«bbbå…ƒç´ &#x27;);&#125; ES7 æ–°å¢ Includes æ–¹æ³• if (names.includes(&#x27;bbb&#x27;)) &#123; console.log(&#x27;åŒ…å«bbbå…ƒç´ &#x27;);&#125; å¯¹äº NaNçš„å¤„ç†ï¼ŒindexOf()ä¸èƒ½åˆ¤æ–­ï¼Œincludeså¯ä»¥ const names = [&#x27;aaa&#x27;, &#x27;bbb&#x27;, &#x27;ccc&#x27;, &#x27;ddd&#x27;, NaN]console.log(names.indexOf(NaN)); // -1console.log(names.includes(NaN)); // true æŒ‡æ•°çš„è¿ç®—æ–¹æ³• // åœ¨ä¹‹å‰,æŒ‡æ•°è¿ç®—é€šè¿‡ Math.pow()const res1 = Math.pow(3, 3) // ES7æ–°å¢ï¼š**const res2 = 3 ** 3console.log(res1, res2); // 27 27 ES8 Object.values ä¹‹å‰æˆ‘ä»¬å¯ä»¥é€šè¿‡ Object.keys()æ¥è·å–ä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰keyï¼ŒES8æä¾›Object.values() è·å–æ‰€æœ‰å€¼ const obj = &#123; name: &#x27;aaa&#x27;, age: 18&#125;console.log(Object.keys(obj)); // [ &#x27;name&#x27;, &#x27;age&#x27; ]console.log(Object.values(obj)); // [ &#x27;aaa&#x27;, 18 ]// ç”¨çš„éå¸¸å°‘console.log(Object.values([&#x27;aaa&#x27;, &#x27;bbb&#x27;, &#x27;ccc&#x27;]));console.log(Object.values(&#x27;asd&#x27;)); // [ &#x27;a&#x27;, &#x27;s&#x27;, &#x27;d&#x27; ] Object.entries è·å–åˆ°ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­å­˜æ”¾å¯æšä¸¾å±æ€§çš„é”®å€¼å¯¹æ•°ç»„ const obj = &#123; name: &#x27;asdf&#x27;, age: 20&#125;const objEntries = Object.entries(obj)console.log(objEntries); // [ [ &#x27;name&#x27;, &#x27;asdf&#x27; ], [ &#x27;age&#x27;, 20 ] ]// ç„¶åå¯ä»¥ç»§ç»­éå†è¿™ä¸ªæ•°ç»„ï¼Œè·å¾—å±æ€§,å€¼objEntries.forEach(item =&gt; &#123; console.log(item[0], item[1]);&#125;)console.log(Object.entries([&#x27;aaa&#x27;,&#x27;bbb&#x27;,&#x27;ccc&#x27;]));// [ [ &#x27;0&#x27;, &#x27;aaa&#x27; ], [ &#x27;1&#x27;, &#x27;bbb&#x27; ], [ &#x27;2&#x27;, &#x27;ccc&#x27; ] ] ç´¢å¼•å€¼å½“åškeyäº†console.log(Object.entries(&#x27;sdf&#x27;)); // [ [ &#x27;0&#x27;, &#x27;s&#x27; ], [ &#x27;1&#x27;, &#x27;d&#x27; ], [ &#x27;2&#x27;, &#x27;f&#x27; ] ] padStartå’ŒpadEnd æ ¹æ®æ‰€ç»™é•¿åº¦,å’Œå¡«å……å…ƒç´ æ¥å¾€å‰æˆ–å¾€åå¡«å……æ•°ç»„ const message = &quot;hello world&quot;const newMessage = message.padStart(15, &quot;*&quot;).padEnd(20, &#x27;-&#x27;)console.log(newMessage); // ****hello world----- å°æ¡ˆä¾‹ï¼šå‡è®¾è¦å¯¹é“¶è¡Œå¡å·ç”¨*éšè— // æ¡ˆä¾‹const cardNumber = &quot;123456781231548564321&quot;const lastFourCard = cardNumber.slice(-4) const finalCard = lastFourCard.padStart(cardNumber.length, &quot;*&quot;)console.log(finalCard); // *****************4321 slice å¯ä»¥ä¼ å…¥è´Ÿæ•°çš„å“¦ï¼Œ-4ï¼Œå€’æ•°4ä½ Trailing-Commas ES8ï¼Œå…è®¸åœ¨å‡½æ•°å®šä¹‰å’Œè°ƒç”¨æ—¶å¤šåŠ ä¸€ä¸ªé€—å· æ²¡ä»€ä¹ˆï¼Œåæ­£æˆ‘ä»¬å¹³æ—¶ä¹Ÿä¸ä¼šåŠ ã€‚trailingï¼šåé¢çš„ï¼Œcommasï¼šé€—å· function foo(a, b,) &#123;&#125;foo(10, 20,) Object Descriptors ES8ä¸­æ–°å¢å¯¹å¯¹è±¡çš„æ“ä½œï¼ŒObject.getOwnPropertyDescriptors() è·å–ä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰è‡ªèº«å±æ€§çš„æè¿°ç¬¦ const obj = &#123; age: 18&#125;Object.defineProperty(obj, &#x27;name&#x27;, &#123; value: &#x27;hello&#x27;, enumerable: true, writable: true, configurable: false&#125;)console.log(Object.getOwnPropertyDescriptors(obj));// æ‰“å°&#123; age: &#123; value: 18, writable: true, enumerable: true, configurable: true &#125;, name: &#123; value: &#x27;hello&#x27;, writable: true, enumerable: true, configurable: false &#125;&#125; ES8 æ–°å¢async await çš„å‡½æ•°ä½¿ç”¨ï¼Œåé¢å¦å¤–è®° ES9 Async iteratorsï¼šè¿­ä»£å™¨ï¼Œåç»­å¦å¤–ç¬”è®° Object spread operatorsï¼šå¯¹è±¡å±•å¼€è¿ç®—ç¬¦ const newObj = &#123;...obj, age:18&#125; Promise finallyï¼šåç»­Promiseç»Ÿä¸€è®° ES10 flat flatMap flat() æ–¹æ³•ä¼šæŒ‰ç…§ä¸€ä¸ªå¯æŒ‡å®šçš„æ·±åº¦é€’å½’éå†æ•°ç»„ï¼Œå¹¶å°†æ‰€æœ‰å…ƒç´ ä¸éå†åˆ°çš„å­æ•°ç»„ä¸­çš„å…ƒç´ åˆå¹¶ä¸ºä¸€ä¸ªæ–°æ•°ç»„è¿”å› // flatconst nums = [10, 20, [30, 40],[[1, 2],[3, 4]]]const newNums = nums.flat()// é»˜è®¤æ·±åº¦ä¸º1console.log(newNums); // [ 10, 20, 30, 40, [ 1, 2 ], [ 3, 4 ] ]const newNums2 = nums.flat(2) //console.log(newNums2); // [10, 20, 30, 40,1, 2, 3, 4] flatMap() æ–¹æ³•é¦–å…ˆä½¿ç”¨æ˜ å°„å‡½æ•°æ˜ å°„æ¯ä¸ªå…ƒç´ ï¼Œç„¶åå°†ç»“æœå‹ç¼©æˆä¸€ä¸ªæ–°æ•°ç»„ å…ˆè¿›è¡Œmapï¼Œå†flatï¼Œå¹¶ä¸”flatçš„æ·±åº¦ä¸º1 const nums2 = [1,2,3,4,5]const newNums2 = nums2.flatMap(item =&gt; &#123; return item * 2&#125;)console.log(newNums2); // [ 2, 4, 6, 8, 10 ] è¿™æ ·çœ‹èµ·æ¥è·Ÿmapæ²¡ä»€ä¹ˆåŒºåˆ«å‘€ï¼Ÿé‚£flatMapæœ‰ä»€ä¹ˆåº”ç”¨åœºæ™¯å—ï¼Ÿ å¤„ç†è¿™æ ·çš„å­—ç¬¦ä¸²æ•°ç»„ï¼ŒæŠŠå­—ç¬¦ä¸²åˆ†æˆä¸€ä¸ªä¸ªæ”¾åˆ°æ•°ç»„ const message = [&quot;Hello World&quot;, &quot;hello kk&quot;, &quot;my name is xxx&quot;]const words = message.flatMap(item =&gt; &#123; return item.split(&#x27; &#x27;)&#125;)console.log(words);// [&#x27;Hello&#x27;, &#x27;World&#x27;,&#x27;hello&#x27;, &#x27;kk&#x27;,&#x27;my&#x27;,&#x27;name&#x27;,&#x27;is&#x27;,&#x27;xxx&#x27;] Object fromEntries ES8æœ‰Object.entrieså°†ä¸€ä¸ªå¯¹è±¡è½¬æ¢æˆentries ES10æœ‰Object.fromEntries å°†entriesè½¬æ¢æˆå¯¹è±¡ const obj = &#123; name: &#x27;qws&#x27;, age: 18&#125;// ES8 entriesconst entries = Object.entries(obj)console.log(entries); // [ [ &#x27;name&#x27;, &#x27;qws&#x27; ], [ &#x27;age&#x27;, 18 ] ]const newObj = Object.fromEntries(entries)console.log(newObj); // &#123; name: &#x27;qws&#x27;, age: 18 &#125; æœ‰ä»€ä¹ˆåº”ç”¨åœºæ™¯å—ï¼Ÿ å¯ä»¥å¤„ç†queryå‚æ•°ï¼Œæœ€ç»ˆè½¬æ¢æˆå¯¹è±¡ä½¿ç”¨ çœ‹åˆ°é”®å€¼å¯¹çš„æ•°ç»„å¯ä»¥æƒ³åˆ°è¿™ä¸ªæ–¹æ³• const queryString = &#x27;name=xxx&amp;age=18&amp;height=1.88&#x27;const queryParams = new URLSearchParams(queryString)console.log(queryParams);// URLSearchParams &#123; &#x27;name&#x27; =&gt; &#x27;xxx&#x27;, &#x27;age&#x27; =&gt; &#x27;18&#x27;, &#x27;height&#x27; =&gt; &#x27;1.88&#x27; &#125;for (const param of queryParams) &#123; console.log(param);&#125;// æ‰“å°// [ &#x27;name&#x27;, &#x27;xxx&#x27; ]// [ &#x27;age&#x27;, &#x27;18&#x27; ]// [ &#x27;height&#x27;, &#x27;1.88&#x27; ]// ç„¶åå°±å¯ä»¥åˆ©ç”¨fromEntriesè½¬æˆå¯¹è±¡const paramObj = Object.fromEntries(queryParams)console.log(paramObj);// &#123; name: &#x27;xxx&#x27;, age: &#x27;18&#x27;, height: &#x27;1.88&#x27; &#125; trimStart trimEnd å•ç‹¬å»é™¤å‰é¢æˆ–åé¢çš„ç©ºæ ¼ const str = &#x27; hello world &#x27;console.log(str.trim()); // å»é™¤å‰åçš„ç©ºæ ¼console.log(str.trimStart()); // å»é™¤å‰é¢çš„ç©ºæ ¼console.log(str.trimEnd()); // å»é™¤åé¢çš„ç©ºæ ¼ Symbol description s1.description è¿™ä¸ªå±æ€§å¯ä»¥è·å–symbolçš„æè¿°ï¼ˆæ ‡ç­¾ï¼‰ï¼Œå‰é¢symbolçš„ç¬”è®°æœ‰å†™åˆ° Optional catch binding åç»­åœ¨try catchéƒ¨åˆ†ç¬”è®° ES11 BigInt ES11å¼•å…¥çš„æ–°çš„æ•°æ®ç±»å‹ï¼Œç”¨äºè¡¨ç¤ºå¤§çš„æ•´æ•° ä½¿ç”¨ï¼šåŠ ä¸ªnï¼Œæˆ–è€… BigInt(num) // ES11å‰ æœ€å¤§çš„å®‰å…¨æ•´æ•°const maxInt = Number.MAX_SAFE_INTEGERconsole.log(maxInt); // 9007199254740991// è¶…è¿‡è¿™ä¸ªå®‰å…¨æ•´æ•°å°±å¯èƒ½å‡ºç°è¡¨ç¤ºé”™è¯¯console.log(maxInt + 1); // 9007199254740992console.log(maxInt + 2); // 9007199254740992 (é”™äº†)// ES11ä¹‹å: BigIntconst bigInt = 900719925474099100nconsole.log(bigInt + 10n); // 900719925474099110nconsole.log(BigInt(100)); // 100nconsole.log(bigInt + BigInt(100));// ä¹Ÿå¯ä»¥æŠŠbigIntç±»å‹è½¬Numberconsole.log(Number(bigInt)); // 900719925474099100 Nullish Coalescing Operator ç©ºå€¼ åˆå¹¶ è¿ç®— æ–°å¢çš„æ“ä½œç¬¦ï¼š?? å¤„ç†å¦‚æœä¸ºç©ºï¼Œé‚£ä¹ˆä½¿ç”¨é»˜è®¤å€¼çš„åˆ¤æ–­ ä¹‹å‰çš„ || ä¸èƒ½å¾ˆå¥½çš„å¤„ç†ç©ºå­—ç¬¦ä¸²ï¼Œç©ºä¸²è½¬ä¸ºfalseï¼Œæ‰§è¡Œåé¢çš„è¯­å¥ const foo = &quot;&quot;const res1 = foo || &#x27;default value&#x27;const res2 = foo ?? &#x27;default value&#x27;console.log(res1); // default valueconsole.log(res2); // &#x27;&#x27; Optional Chaining å¯é€‰é“¾ï¼šè®©æˆ‘ä»¬çš„ä»£ç åœ¨è¿›è¡Œ null å’Œ undefined åˆ¤æ–­æ—¶æ›´åŠ æ¸…æ™°å’Œç®€æ´ const info = &#123; name: &#x27;xxx&#x27;, // friend: &#123; // f1: &#123; // name: &#x27;mm&#x27; // &#125; // &#125;&#125;// åœ¨ä¹‹å‰ï¼Œå¦‚æœè·å–ä¸å­˜åœ¨çš„å±æ€§å€¼console.log(info.name.friend); // undefined// æˆ‘ä»¬ä¼šåšè¿™æ ·çš„åˆ¤æ–­if (info &amp;&amp; info.friend &amp;&amp; info.friend.f1) &#123; console.log(info.friend.f1.name);&#125;// ES11çš„å¯é€‰é“¾console.log(info.friend?.f1?.name);// info.friendå­˜åœ¨å—?å­˜åœ¨å†ç»§ç»­ .f1console.log(&#x27;å…¶ä»–ä»£ç é€»è¾‘&#x27;); Global This åœ¨ä¹‹å‰æˆ‘ä»¬æƒ³è·å–JSç¯å¢ƒçš„å…¨å±€å¯¹è±¡ï¼Œä¸åŒç¯å¢ƒè·å–çš„æ–¹å¼åˆä¸ä¸€æ · æ¯”å¦‚åœ¨æµè§ˆå™¨ä¸­ï¼Œé€šè¿‡ thisï¼Œwindowæ¥è·å– Nodeä¸­ï¼Œé€šè¿‡globalè·å– æ‰€ä»¥ ES11 ä¸­å¯¹è·å–å…¨å±€å¯¹è±¡è¿›è¡Œç»Ÿä¸€çš„è§„èŒƒï¼šglobalThis // æµè§ˆå™¨ä¸‹console.log(this); // Windowconsole.log(window); // Window// Nodeä¸‹console.log(global);// ES11 å„ç§ç¯å¢ƒè·å–å…¨å±€å¯¹è±¡console.log(globalThis); forâ€¦inæ ‡å‡†åŒ– åœ¨ES11ä¹‹å‰ï¼Œè™½ç„¶å¾ˆå¤šæµè§ˆå™¨æ”¯æŒ forâ€¦in æ¥éå†å¯¹è±¡ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰è¢«ECMAæ ‡å‡†åŒ– ES11ä¸­ï¼Œå¯¹å…¶è¿›è¡Œæ ‡å‡†åŒ–ï¼Œforâ€¦in ç”¨äºéå†å¯¹è±¡çš„ key const obj = &#123; name: &#x27;xxx&#x27;, age: 18&#125;for (key in obj) &#123; console.log(key); // name // age&#125; Dynamic Import åç»­åœ¨ ES Module æ¨¡å—åŒ–ä¸­ç¬”è®° Promise.allSettled åç»­Promiseä¸­ç¬”è®° import meta åç»­åœ¨ ES Module æ¨¡å—åŒ–ä¸­ç¬”è®° ES12 FinalizationRegistry FinalizationRegistryå¯¹è±¡å¯ä»¥è®©ä½ åœ¨å¯¹è±¡è¢«åƒåœ¾å›æ”¶æ—¶è¯·æ±‚ä¸€ä¸ªå›è°ƒ å½“ä¸€ä¸ªåœ¨æ³¨å†Œè¡¨ä¸­æ³¨å†Œçš„å¯¹è±¡è¢«å›æ”¶æ—¶ï¼Œå¯ä»¥è¯·æ±‚åœ¨æŸä¸ªæ—¶é—´ç‚¹ä¸Šè°ƒç”¨ä¸€ä¸ªæ¸…ç†å›è°ƒï¼ˆæ¸…ç†å›è°ƒæœ‰æ—¶è¢«ç§°ä¸º finalizerï¼‰ æ³¨å†Œï¼šregisteræ–¹æ³•ï¼Œæ³¨å†Œä»»ä½•æƒ³è¦æ¸…ç†åæ‰§è¡Œå›è°ƒçš„å¯¹è±¡ï¼Œä¼ å…¥è¯¥å¯¹è±¡ï¼Œå’Œæ‰€å«çš„å€¼ const finalRegistry = new FinalizationRegistry((value) =&gt; &#123; console.log(&quot;æ³¨å†Œåœ¨finalRegistryçš„å¯¹è±¡,æŸä¸ªè¢«é”€æ¯&quot;, value);&#125;)let obj = &#123; name: &#x27;asd&#x27; &#125;let info = &#123; age: 15 &#125;finalRegistry.register(obj, &#x27;obj&#x27;)finalRegistry.register(info, &#x27;val&#x27;)obj = nullinfo = null// æ³¨å†Œåœ¨finalRegistryçš„å¯¹è±¡,æŸä¸ªè¢«é”€æ¯ val// æ³¨å†Œåœ¨finalRegistryçš„å¯¹è±¡,æŸä¸ªè¢«é”€æ¯ obj WeakRefs å¦‚æœæˆ‘ä»¬é»˜è®¤å°†ä¸€ä¸ªå¯¹è±¡èµ‹å€¼ç»™å¦ä¸€ä¸ªå¼•ç”¨ï¼Œé‚£ä¹ˆè¿™ä¸ªå¼•ç”¨æ˜¯å¼ºå¼•ç”¨ å¦‚æœæˆ‘ä»¬å¸Œæœ›æ˜¯å¼±å¼•ç”¨ï¼Œå¯ä»¥ä½¿ç”¨ WeakRef æ³¨æ„è¿™é‡Œæœ‰ä¸€ä¸ª deref æ–¹æ³•è·å–å¼±å¼•ç”¨çš„å€¼ const finalRegistry = new FinalizationRegistry((value) =&gt; &#123; console.log(&quot;æ³¨å†Œåœ¨finalRegistryçš„å¯¹è±¡,æŸä¸ªè¢«é”€æ¯&quot;, value);&#125;)let obj = &#123; name: &#x27;asd&#x27; &#125;let info = new WeakRef(obj)finalRegistry.register(obj, &#x27;obj&#x27;)// obj = null// æ³¨å†Œåœ¨finalRegistryçš„å¯¹è±¡,æŸä¸ªè¢«é”€æ¯ obj// é‚£è¿˜èƒ½è·å–infoå—ï¼Ÿ// å› ä¸ºå›æ”¶è¦æ—¶é—´ï¼Œæ‰€ä»¥è¿™é‡Œä¹Ÿåšä¸€ä¸ªå»¶è¿Ÿæ‰è·å–å±æ€§å€¼setTimeout(() =&gt; &#123; console.log(info.name); // undefined(ä¸èƒ½è¿™æ ·è·å–) console.log(info.deref()?.name); // å¦‚æœåŸå¯¹è±¡objæ²¡æœ‰è¢«é”€æ¯, å¯ä»¥ä½¿ç”¨deref()æ¥è·å– // å¦‚æœè¢«é”€æ¯äº†,è·å–åˆ°çš„æ˜¯ undefined&#125;, 10000); logical assignment operators logicalï¼šé€»è¾‘çš„ å‡ ä¸ªé€»è¾‘èµ‹å€¼è¿ç®—ç¬¦ ||=ï¼Œ&amp;&amp;=ï¼ˆå¾ˆå°‘ç”¨ï¼‰ï¼Œ??= å¯è¯»æ€§ä¸æ˜¯å¾ˆå¥½ ||= é€»è¾‘æˆ–èµ‹å€¼è¿ç®— let message = &#x27;&#x27;// message = message || &#x27;default value&#x27;message ||= &#x27;default value&#x27;console.log(message); // default value// ä¹Ÿæ˜¯ä¸èƒ½åˆ¤æ–­ç©ºä¸²çš„ &amp;&amp;= é€»è¾‘ä¸èµ‹å€¼è¿ç®—ï¼ˆå¾ˆå°‘ç”¨ï¼‰ let obj = &#123; name: &#x27;xxx&#x27;&#125;// æœ‰å€¼å–å€¼info = obj &amp;&amp; obj.nameconsole.log(info); // xxxobj &amp;&amp;= obj.name console.log(obj); // xxx ??= é€»è¾‘ç©ºèµ‹å€¼è¿ç®— 0 â€œâ€ æ„Ÿè§‰æ˜¯å¯ä»¥å¡«è¡¥ || ä¸èƒ½å¾ˆå¥½çš„åˆ¤æ–­&quot;&quot; 0 let message = &quot;&quot;let msg = 0message ??= &quot;default value&quot;msg ??= &quot;default val&quot;console.log(message); // &quot;&quot;console.log(msg); // 0 Numeric Separator Numeric æ•°å€¼çš„ Separator åˆ†ç¦»å™¨ å¤§çš„æ•°å€¼æœ‰ä¸€ä¸ªè¿æ¥ç¬¦ _ ï¼Œä¾¿äºé˜…è¯» const num = 10_000_000_000_000console.log(num); // 10000000000000 String.replaceAll å­—ç¬¦ä¸²æ›¿æ¢ï¼Œæ›¿æ¢æ‰€æœ‰åŒ¹é…æ¡ä»¶çš„åœ°æ–¹ const res = &#x27;aabbcc&#x27;.replaceAll(&#x27;b&#x27;, &#x27;.&#x27;);console.log(res);// &#x27;aa..cc&#x27; ä¹‹å‰replaceåªæ¢ç¬¬ä¸€å¤„åŒ¹é…çš„åœ°æ–¹ const res = &#x27;aabbcc&#x27;.replace(&#x27;b&#x27;, &#x27;.&#x27;);console.log(res);// aa.bcc","categories":[{"name":"ğŸ”«æ·±å…¥JSé«˜çº§è¯­æ³•","slug":"ğŸ”«æ·±å…¥JSé«˜çº§è¯­æ³•","permalink":"https://hillyee.github.io/categories/%F0%9F%94%AB%E6%B7%B1%E5%85%A5JS%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/"}],"tags":[{"name":"ES6","slug":"ES6","permalink":"https://hillyee.github.io/tags/ES6/"}]},{"title":"09_classå®šä¹‰ç±»_ES6","slug":"09_classå®šä¹‰ç±»-ES6","date":"2022-04-08T06:57:33.000Z","updated":"2022-04-08T09:45:23.623Z","comments":true,"path":"2022/04/08/09_classå®šä¹‰ç±»-ES6/","link":"","permalink":"https://hillyee.github.io/2022/04/08/09_class%E5%AE%9A%E4%B9%89%E7%B1%BB-ES6/","excerpt":"","text":"ES6ä¸­ç±»çš„ä½¿ç”¨ è®¤è¯†classå®šä¹‰ç±» æŒ‰ç…§æ„é€ å‡½æ•°çš„å½¢å¼åˆ›å»ºç±»ï¼Œä¸ä»…ä»…å’Œç¼–å†™æ™®é€šçš„å‡½æ•°è¿‡äºç›¸ä¼¼ï¼Œè€Œä¸”ä»£ç å¹¶ä¸å®¹æ˜“ç†è§£ åœ¨ES6(ECMAScript2015)æ–°çš„æ ‡å‡†ä¸­ä½¿ç”¨äº†classå…³é”®å­—æ¥ç›´æ¥å®šä¹‰ç±» ä½†æ˜¯ç±»çš„æœ¬è´¨ä¸Šåªæ˜¯æ„é€ å‡½æ•°ï¼ŒåŸå‹é“¾çš„è¯­æ³•ç³– æœ€ç»ˆè¿˜æ˜¯ä¼šè¢« babel å·¥å…·è½¬æ¢ä¸ºES5çš„ä»£ç  å®šä¹‰ç±»çš„æ–¹å¼ å¯ä»¥å‘ç°ç±»å’Œæ„é€ å‡½æ•°çš„ç‰¹æ€§æ˜¯ä¸€è‡´çš„ // ç±»çš„å£°æ˜class Person &#123;&#125;// ç±»çš„è¡¨è¾¾å¼(ä¸æ€ä¹ˆç”¨)var Student = class &#123;&#125;// ç±»çš„ç‰¹æ€§console.log(Person) // [class Person]console.log(Person.prototype);// &#123;&#125;console.log(Person.prototype.__proto__); // [Object: null prototype] &#123;&#125;console.log(Person.prototype.constructor); // [class Person]console.log(typeof Person); // function// åˆ›å»ºå®ä¾‹var p = new Person()console.log(p.__proto__ === Person.prototype); // true ç±»çš„æ„é€ æ–¹æ³• ä¸€ä¸ªç±»åªèƒ½æœ‰ä¸€ä¸ªæ„é€ å‡½æ•° constructorï¼Œå¦‚æœåŒ…å«å¤šä¸ªä¼šæŠ¥é”™ new çš„æ—¶å€™ï¼š åœ¨å†…å­˜ä¸­åˆ›å»ºä¸€ä¸ªå¯¹è±¡ moni = { } å°†ç±»çš„åŸå‹prototypeèµ‹å€¼ç»™åˆ›å»ºå‡ºæ¥çš„å¯¹è±¡çš„[[prototype]]ï¼Œmoni.__ptoto__ = Person.prototype å°†å¯¹è±¡å¤åˆ¶ç»™å‡½æ•°çš„thisï¼šnewç»‘å®š this = moni æ‰§è¡Œå‡½æ•°ä½“ä¸­çš„ä»£ç  è‡ªåŠ¨è¿”å›åˆ›å»ºå‡ºæ¥çš„å¯¹è±¡ class Person &#123; constructor(name, age) &#123; this.name = name this.age = age &#125;&#125;var p1 = new Person(&quot;kac&quot;, 12)var p2 = new Person(&quot;awe&quot;, 20)console.log(p1, p2);// Person &#123; name: &#x27;kac&#x27;, age: 12 &#125; Person &#123; name: &#x27;awe&#x27;, age: 20 &#125; ç±»ä¸­çš„æ–¹æ³•å®šä¹‰ ä¸‰ç§å®šä¹‰æ–¹æ³• æ™®é€šçš„å®ä¾‹æ–¹æ³•ï¼šå®é™…ä¸Šæ˜¯æ”¾åˆ°åŸå‹ä¸Šçš„ï¼Œå¯ä»¥è¢«å¤šä¸ªå®ä¾‹å…±äº« ç±»çš„è®¿é—®å™¨æ–¹æ³•ï¼šsetterï¼Œgetter ç±»çš„é™æ€æ–¹æ³•ï¼šç›´æ¥ä½¿ç”¨ç±»æ¥è°ƒç”¨çš„æ–¹æ³• Person.xxx()ï¼Œä¸éœ€è¦å€ŸåŠ©å®ä¾‹æ¥è°ƒç”¨ï¼Œä¾‹å¦‚Promise.all()ï¼Œä¹Ÿæ˜¯ç±»æ–¹æ³• ä½¿ç”¨ staticå…³é”®å­—æ¥å®šä¹‰ var names = [&quot;abc&quot;, &quot;cba&quot;, &quot;nba&quot;]class Person &#123; constructor(name, age) &#123; this.name = name this.age = age this._address = &quot;å¹¿å·å¸‚&quot; &#125; // 1.æ™®é€šçš„å®ä¾‹æ–¹æ³• eating() &#123; console.log(this.name + &quot; eating~&quot;); &#125; // 2.ç±»çš„è®¿é—®å™¨æ–¹æ³•ï¼ˆä¸æ€ä¹ˆç”¨ï¼‰ get address() &#123; console.log(&quot;æ‹¦æˆªè®¿é—®æ“ä½œ&quot;); return this._address &#125; set address(newAddress) &#123; console.log(&quot;æ‹¦æˆªè®¾ç½®æ“ä½œ&quot;); this._address = newAddress &#125; // 3.ç±»çš„é™æ€æ–¹æ³•ï¼ˆç±»æ–¹æ³•ï¼‰ï¼šç›´æ¥é€šè¿‡ç±»æ¥è®¿é—®çš„æ–¹æ³• // Person.xxx() static randomPerson() &#123; var nameIndex = Math.floor(Math.random() * names.length) var name = names[nameIndex] var age = Math.floor(Math.random() * 100) return new Person(name, age) &#125;&#125;var p = new Person(&quot;axf&quot;, 18)p.eating() // axf eating~console.log(p.address);p.address = &quot;åŒ—äº¬å¸‚&quot;console.log(p.address);for (var i = 0; i &lt; 50; i++) &#123; console.log(Person.randomPerson());&#125; ç±»çš„ç»§æ‰¿extends ES6ä¸­æ–°å¢äº† extends å…³é”®å­—ï¼Œå¯ä»¥æ–¹ä¾¿çš„å¸®åŠ©æˆ‘ä»¬å®ç°ç»§æ‰¿ superå…³é”®å­—ï¼Œä¸‰ä¸ªä½¿ç”¨ä½ç½®ï¼šå­ç±»çš„æ„é€ å‡½æ•°ã€å®ä¾‹æ–¹æ³•ã€é™æ€æ–¹æ³• å­ç±»çš„æ„é€ å‡½æ•°ï¼šJSå¼•æ“åœ¨è§£æå­ç±»çš„æ—¶å€™å°±æœ‰è¦æ±‚ï¼Œå¦‚æœæˆ‘ä»¬æœ‰å®ç°ç»§æ‰¿ï¼Œé‚£ä¹ˆå­ç±»çš„æ„é€ æ–¹æ³•ä¸­,åœ¨ä½¿ç”¨thisä¹‹å‰,è¦è°ƒç”¨super() å¦åˆ™æŠ¥é”™ ReferenceError: Must call super constructor in derived class before accessing &#x27;this&#x27; or returning from derived constructor å­ç±»å¯ä»¥é‡å†™çˆ¶ç±»çš„æ–¹æ³•ï¼Œåœ¨é‡å†™æ–¹æ³•ä¸­ä½¿ç”¨ super æ¥å¤ç”¨çˆ¶ç±»ä¸­çš„é€»è¾‘ class Person &#123; constructor(name, age) &#123; this.name = name this.age = age &#125; running() &#123; console.log(&#x27;é€»è¾‘1&#x27;); console.log(&#x27;é€»è¾‘2&#x27;); console.log(&#x27;é€»è¾‘3&#x27;); console.log(this.name + &#x27; running~&#x27;); &#125; static staticMethod() &#123; console.log(&#x27;person staticMethod&#x27;); &#125;&#125;class Student extends Person &#123; constructor(name, age, sno) &#123; // åœ¨ä½¿ç”¨thiså‰ï¼Œè¿™é‡Œå¿…é¡»ä½¿ç”¨super() super(name, age) this.sno = sno &#125; // é‡å†™æ–¹æ³•ä¸€èˆ¬å®ä¾‹æ–¹æ³• running() &#123; // å¤ç”¨çˆ¶ç±»ä¸­çš„é€»è¾‘ super.running() console.log(&#x27;é€»è¾‘4&#x27;); console.log(&#x27;é€»è¾‘5&#x27;); console.log(&#x27;é€»è¾‘6&#x27;); console.log(&quot;student &quot; + this.name + &quot; running&quot;); &#125; // é‡å†™çˆ¶ç±»ä¸­çš„é™æ€æ–¹æ³• static staticMethod() &#123; super.staticMethod() console.log(&#x27;student staticMethod&#x27;); &#125;&#125;let p = new Student(&quot;asx&quot;, 12, 111)console.log(p);// p.running()Student.staticMethod() ç»§æ‰¿å†…ç½®ç±» è®©æˆ‘ä»¬çš„ç±»ç»§æ‰¿å†…ç½®ç±»ï¼Œæ¯”å¦‚ï¼šArray è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°Arrayçš„æ–¹æ³•äº† class MyArray extends Array&#123; firstItem() &#123; return this[0] &#125; lastItem() &#123; return this[this.length - 1] &#125;&#125;var arr = new MyArray(1,2,3)console.log(arr.firstItem());console.log(arr.concat([33])) // MyArray(4) [ 1, 2, 3, 33 ] ç±»çš„æ··å…¥(å°‘ç”¨) JavaScript çš„ç±»åªæ”¯æŒå•ç»§æ‰¿ï¼Œä¹Ÿå°±æ˜¯åªèƒ½æœ‰ä¸€ä¸ªçˆ¶ç±» å¦‚æœæƒ³åœ¨ä¸€ä¸ªç±»ä¸­æ·»åŠ æ›´å¤šç›¸ä¼¼çš„åŠŸèƒ½æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ··å…¥ class Person &#123;&#125;// é€šè¿‡å‡½æ•°å»ç»§æ‰¿ä¸€äº›å…¬å…±æ–¹æ³•function mixinRunner(BaseClass) &#123; class NewClass extends BaseClass &#123; running() &#123; console.log(&#x27;I am running~&#x27;); &#125; &#125; return NewClass&#125;function mixinEater(BaseClass) &#123; class NewClass extends BaseClass &#123; eating() &#123; console.log(&#x27;I am eating~&#x27;); &#125; &#125; return NewClass&#125;// ç»§æ‰¿çˆ¶ç±»class Student extends Person &#123;&#125;// var NewStudent = mixinRunner(Student) // è¿”å›ä¸€ä¸ªå·²ç»ç»§æ‰¿äº†runæ–¹æ³•çš„æ–°çš„ç±»// åœ¨ç»§æ‰¿äº†runçš„åŸºç¡€ä¸Šç»§ç»­ç»§æ‰¿eatvar NewStudent = mixinEater(mixinRunner(Student))var stu = new NewStudent()stu.running()stu.eating() JavaScriptä¸­çš„å¤šæ€ ç»´åŸºç™¾ç§‘ï¼šå¤šæ€ï¼ˆè‹±è¯­ï¼špolymorphismï¼‰æŒ‡ä¸ºä¸åŒæ•°æ®ç±»å‹çš„å®ä½“æä¾›ç»Ÿä¸€çš„æ¥å£ï¼Œæˆ–ä½¿ç”¨ä¸€ ä¸ªå•ä¸€çš„ç¬¦å·æ¥è¡¨ç¤ºå¤šä¸ªä¸åŒçš„ç±»å‹ æ€»ç»“ï¼šä¸åŒçš„æ•°æ®ç±»å‹è¿›è¡ŒåŒä¸€ä¸ªæ“ä½œï¼Œè¡¨ç°å‡ºä¸åŒçš„è¡Œä¸ºï¼Œå°±æ˜¯å¤šæ€çš„ä½“ç° æ‰€ä»¥è¯´ï¼ŒJSä¹Ÿæ˜¯æœ‰å¤šæ€çš„ï¼Œè™½ç„¶è·Ÿåˆ«çš„ä¸€äº›é¢å‘å¯¹è±¡è¯­è¨€æœ‰äº›åŒºåˆ« function calcArea(foo) &#123; console.log(foo.getArea());&#125;var obj1 = &#123; name: &quot;sfr&quot;, getArea: function() &#123; return 1000 &#125;&#125;class Person &#123; getArea() &#123; return 100 &#125;&#125;var p = new Person()calcArea(obj1)calcArea(p)// ä»¥ä¸‹ä¹Ÿæ˜¯å¤šæ€çš„ä½“ç°function sum(m, n) &#123; return m + n&#125;sum(20, 30) // ä¸åŒæ•°æ®ç±»å‹ï¼Œä¸åŒå½¢æ€sum(&quot;abc&quot;, &quot;asf&quot;) ES6è½¬ES5 å¯ä»¥åœ¨ babeljs.io ä¸­çœ‹es6é€šè¿‡babelè½¬es5åçš„ä»£ç  æœ‰ç‚¹éš¾åº¦ï¼Œä¸è¦æµ®èºï¼Œæ…¢æ…¢çœ‹ å¯ä»¥æ‰“ debug ä¸€ç‚¹ç‚¹çœ‹ ä¾‹å¦‚ï¼š class Person &#123; constructor(name, age) &#123; this.name = name this.age = age &#125; eating() &#123; console.log(this.name + &quot; eating~&quot;) &#125;&#125;// babelè½¬æ¢&quot;use strict&quot;;function _classCallCheck(instance, Constructor) &#123; if (!(instance instanceof Constructor)) &#123; throw new TypeError(&quot;Cannot call a class as a function&quot;); &#125;&#125;// target: Person.prototype// props: [&#123;key, value&#125;]function _defineProperties(target, props) &#123; for (var i = 0; i &lt; props.length; i++) &#123; var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (&quot;value&quot; in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); &#125;&#125;// Constructor: Person// protoProps: [&#123;key, value&#125;]function _createClass(Constructor, protoProps, staticProps) &#123; if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor;&#125;// /*#__PURE__*/ çº¯å‡½æ•°// webpack å‹ç¼© tree-shaking// è¿™ä¸ªå‡½æ•°æ²¡å‰¯ä½œç”¨var Person = /*#__PURE__*/ (function () &#123; function Person(name, age) &#123; this.name = name; this.age = age; &#125; _createClass(Person, [&#123; key: &quot;eating&quot;, value: function eating() &#123; console.log(this.name + &quot; eating~&quot;); &#125; &#125;]); return Person;&#125;)();","categories":[{"name":"ğŸ”«æ·±å…¥JSé«˜çº§è¯­æ³•","slug":"ğŸ”«æ·±å…¥JSé«˜çº§è¯­æ³•","permalink":"https://hillyee.github.io/categories/%F0%9F%94%AB%E6%B7%B1%E5%85%A5JS%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/"}],"tags":[{"name":"ES6","slug":"ES6","permalink":"https://hillyee.github.io/tags/ES6/"}]},{"title":"å­¦ä¹ Vuex","slug":"å­¦ä¹ Vuex","date":"2022-04-07T03:27:35.000Z","updated":"2022-04-07T04:34:55.638Z","comments":true,"path":"2022/04/07/å­¦ä¹ Vuex/","link":"","permalink":"https://hillyee.github.io/2022/04/07/%E5%AD%A6%E4%B9%A0Vuex/","excerpt":"","text":"Vuexçš„çŠ¶æ€ç®¡ç† vuexä»‹ç» ä»€ä¹ˆæ˜¯çŠ¶æ€ç®¡ç†ï¼Ÿ åº”ç”¨ç¨‹åºçš„å„ç§æ•°æ®ä¿å­˜åˆ°æŸä¸ªä½ç½®è¿›è¡Œç®¡ç† â€‹ stateï¼šæ•°æ® viewï¼šæœ€ç»ˆæ¨¡å—æ¸²æŸ“æˆDOM actionsï¼šä¿®æ”¹stateçš„è¡Œä¸ºäº‹ä»¶ å¤æ‚çš„çŠ¶æ€ç®¡ç† å¤šä¸ªç»„ä»¶å…±äº«çŠ¶æ€ Vuexçš„çŠ¶æ€ç®¡ç† å°†ç»„ä»¶çš„å†…éƒ¨çŠ¶æ€æŠ½ç¦»å‡ºæ¥ Vuexä½¿ç”¨å•ä¸€çŠ¶æ€æ ‘ SSOTï¼šSingle Source of Truthï¼Œå•ä¸€æ•°æ®æº æ¯ä¸ªåº”ç”¨ä»…ä»…åŒ…å«ä¸€ä¸ªstoreå®ä¾‹ å®‰è£… npm install vuex@next ä½¿ç”¨vuex4.xï¼Œéœ€è¦æ·»åŠ nextæŒ‡å®šç‰ˆæœ¬ ä½¿ç”¨ åˆ›å»ºstoreï¼ˆä»“åº“ï¼‰ Vuexå’Œå•çº¯çš„å…¨å±€å¯¹è±¡æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ Vuexçš„çŠ¶æ€å­˜å‚¨æ˜¯å“åº”å¼çš„ ä¸èƒ½ç›´æ¥æ”¹å˜storeä¸­çš„çŠ¶æ€ æ”¹å˜storeä¸­çš„çŠ¶æ€çš„å”¯ä¸€é€”å¾„å°±æ˜¯æäº¤(commit) mutation è¿™æ ·æ–¹ä¾¿æˆ‘ä»¬è·Ÿè¸ªæ¯ä¸€ä¸ªçŠ¶æ€çš„å˜åŒ–ï¼Œä»è€Œè®©æˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡ä¸€äº›å·¥å…·å¸®åŠ©æˆ‘ä»¬æ›´å¥½çš„ç®¡ç†åº”ç”¨çš„çŠ¶æ€ å…·ä½“æ­¥éª¤ï¼š store/index import &#123; createStore &#125; from &#x27;vuex&#x27;// åˆ›å»ºä¸€ä¸ªæ–°çš„storeå®ä¾‹const store = createStore(&#123; state() &#123; return &#123; count: 0 // æ•°æ® &#125; &#125;, mutations: &#123; // æ–¹æ³• increment(state) &#123; state.counter++ &#125;, decrement(state) &#123; state.counter-- &#125; &#125;,&#125;)export default store åœ¨å…¨å±€å°† store å®ä¾‹ä½œä¸ºæ’ä»¶å®‰è£… import store from &#x27;./store/index&#x27;createApp(App).use(store).mount(&#x27;#app&#x27;) ç»„ä»¶ä¸­ä½¿ç”¨store state ä½¿ç”¨storeä¸­çš„stateæ•°æ® åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨ &lt;h2&gt;&#123;&#123;$store.state.count&#125;&#125;&lt;/h2&gt; åœ¨options api ä¸­ä½¿ç”¨ computed: &#123; counter() &#123; return this.$store.state.counter &#125;&#125; åœ¨setupä¸­ä½¿ç”¨ setup() &#123; const store = useStore() const counter = store.state.counter&#125; mapState å¦‚æœéœ€è¦æ‹¿stateä¸­çš„å¤šä¸ªæ•°æ®ï¼Œåœ¨å¯ä»¥å€ŸåŠ©è¾…åŠ©å‡½æ•° mapStateï¼Œ setupä¸­ä½¿ç”¨mapState é»˜è®¤æƒ…å†µä¸‹ï¼ŒVuexæ²¡æœ‰æä¾›éå¸¸æ–¹ä¾¿çš„çš„ä½¿ç”¨mapStateçš„æ–¹å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿›è¡Œäº†ä¸€ä¸ªå‡½æ•°çš„å°è£… &lt;template&gt; &lt;div&gt; &lt;h2&gt;Home: &#123;&#123;sCounter&#125;&#125;&lt;/h2&gt; &lt;h2&gt;Home: &#123;&#123;counter&#125;&#125;&lt;/h2&gt; &lt;h2&gt;Home: &#123;&#123;name&#125;&#125;&lt;/h2&gt; &lt;h2&gt;Home: &#123;&#123;age&#125;&#125;&lt;/h2&gt; &lt;h2&gt;Home: &#123;&#123;height&#125;&#125;&lt;/h2&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;import &#123; mapState, useStore &#125; from &quot;vuex&quot;import &#123; computed &#125; from &#x27;vue&#x27;export default &#123; // options apiä½¿ç”¨mapState computed: &#123; // fullName: function() &#123; return xxx&#125;, ...mapState([&quot;counter&quot;, &quot;name&quot;]) &#125;, setup() &#123; const store = useStore() const sCounter = computed(() =&gt; store.state.counter) // å®é™…ä¸Šæ”¾å…¥mapStateè¿™é‡Œæ‹¿åˆ°çš„æ˜¯è¿™æ ·å½¢å¼çš„ä¸€ä¸ªä¸ªå‡½æ•° // &#123;counter: function(), name: function() ...&#125; const storeStateFns = mapState([&quot;counter&quot;, &quot;name&quot;, &quot;age&quot;, &quot;height&quot;]) // å°è£…ä¸€ä¸ªå‡½æ•°è½¬åŒ–ä¸€ä¸‹,ä¸»è¦æ€æƒ³æ˜¯æŠŠè¿™ä¸€ä¸ªä¸ªçš„å‡½æ•°æ”¾åˆ°computedé‡Œé¢ // å› ä¸ºcomputedå°±æ˜¯ä¼ å…¥ä¸€ä¸ªå‡½æ•°ï¼Œç„¶åä¼šç»™æˆ‘ä»¬è¿”å›ä¸€ä¸ªref // &#123;counter: ref, age: ref, ...&#125; const storeState = &#123;&#125; Object.keys(storeStateFns).forEach(fnKey =&gt; &#123; // å› ä¸ºå†…éƒ¨çš„computedå–æ•°æ®çš„æ—¶å€™æ˜¯é€šè¿‡this.$store... // ä½†æˆ‘ä»¬è¿™é‡Œçš„fnæ²¡æœ‰this, undefined.$store æ˜¯é”™çš„ // ç”¨bindç»™æ¯ä¸ªå‡½æ•°ç»‘å®šthisä¸ºä¸€ä¸ªå¯¹è±¡,é‡Œé¢éœ€è¦æœ‰$storeè¿™ä¸ªå±æ€§ // &#123;$store: store&#125; const fn = storeStateFns[fnKey].bind(&#123; $store: store&#125;) // ç„¶åæŠŠå‡½æ•°ä¸€ä¸ªæ–¹æ³•computed, ä»¥é”®å€¼å¯¹çš„æ–¹å¼å­˜å‚¨èµ·æ¥ storeState[fnKey] = computed(fn) &#125;) return &#123; sCounter, // æœ€ç»ˆåœ¨è¿™é‡Œç”¨å±•å¼€è¿ç®—ç¬¦å±•å¼€ ...storeState &#125; &#125;&#125;&lt;/script&gt; æŠŠå‡½æ•°çš„å°è£…æŠ½ç¦»åˆ° hooks/useState.js import &#123; computed &#125; from &#x27;vue&#x27;import &#123; mapState, useStore &#125; from &#x27;vuex&#x27;export function useState(mapper) &#123; const store = useStore() // è·å–åˆ°å¯¹åº”çš„å¯¹è±¡çš„functions: &#123;name: function, age: function&#125; const storeStateFns = mapState(mapper) // å¯¹æ•°æ®è¿›è¡Œè½¬æ¢ const storeState = &#123;&#125; Object.keys(storeStateFns).forEach(fnKey =&gt; &#123; const fn = storeStateFns[fnKey].bind(&#123; $store: store &#125;) storeState[fnKey] = computed(fn) &#125;) return storeState&#125; æˆ‘ä»¬åœ¨ç»„ä»¶ä½¿ç”¨å°±ä¼šç®€ä¾¿å¾ˆå¤š import &#123; useState &#125; from &#x27;../hooks/useState&#x27;export default &#123; setup() &#123; const storeState = useState([&quot;counter&quot;, &quot;name&quot;, &quot;age&quot;, &quot;height&quot;]) // å½“ç„¶ä¹Ÿå¯ä»¥æ˜¯å¯¹è±¡å½¢å¼(æƒ³è¦é‡å‘½åçš„æ—¶å€™ä½¿ç”¨) const storeState2 = useState(&#123; sCounter: state =&gt; state.counter, sName: state =&gt; state.name &#125;) return &#123; ...storeState, ...storeState2 &#125; &#125;&#125; getters getters çš„åŸºæœ¬ä½¿ç”¨ æŸäº›å±æ€§å¯èƒ½éœ€è¦ç»è¿‡å˜åŒ–åæ‰ä½¿ç”¨ï¼Œï¼ˆå°±åƒstoreä¸­çš„è®¡ç®—å±æ€§ï¼‰ getters ç¬¬äºŒä¸ªå‚æ•° getterså¯ä»¥æ¥æ”¶ç¬¬2ä¸ªå‚æ•°gettersï¼Œä½¿ç”¨gettersæœ¬èº«çš„å±æ€§ getters: &#123; totalPrice(state, getters) &#123; return state.books.reduce((pre, cur) =&gt; &#123; return pre + cur.count * cur.price &#125;, 0) + &quot; &quot; + getters.myName &#125;, myName(state) &#123; return state.name &#125;&#125; getters çš„è¿”å›å‡½æ•° gettersä¸­çš„å‡½æ•°æœ¬èº«ï¼Œå¯ä»¥è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆåœ¨ä½¿ç”¨çš„åœ°æ–¹ç›¸å½“äºå¯ä»¥è°ƒç”¨è¿™ä¸ªå‡½æ•° totalPrice(state) &#123; return (price) =&gt; &#123; let totalPrice = 0 for (const book of state.books) &#123; if (book.price &lt; price) continue totalPrice += book.count * book.price &#125; return totalPrice &#125;&#125;, mapGetters ä¸mapStateç±»ä¼¼ åœ¨setupä¸­ä½¿ç”¨mapGetters å°è£…å¥½çš„ /useGetters import &#123; computed &#125; from &quot;vue&quot;;import &#123; useStore, mapGetters &#125; from &quot;vuex&quot;;export function useGetters(mapper) &#123; const store = useStore() const stateFns = mapGetters(mapper) const state = &#123;&#125; Object.keys(stateFns).forEach(fnKey =&gt; &#123; state[fnKey] = computed(stateFns[fnKey].bind(&#123; $store: store &#125;)) &#125;) return state&#125; ä½¿ç”¨ï¼š setup() &#123; const storeGetters = useGetters([&quot;nameInfo&quot;, &quot;ageInfo&quot;, &quot;heightInfo&quot;]) return &#123; ...storeGetters &#125;&#125; å°è£…useMapper æˆ‘ä»¬å‘ç°å‰é¢ useStateï¼ŒuseGettersçš„é€»è¾‘å¤§éƒ¨åˆ†ç›¸åŒï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°è£…ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œæ ¹æ®ä½¿ç”¨çš„æ—¶å€™çš„ mapStateè¿˜æ˜¯mapGetters æ¥è°ƒç”¨å‡½æ•° import &#123; computed &#125; from &#x27;vue&#x27;import &#123; useStore &#125; from &#x27;vuex&#x27;// mapFn:ä½¿ç”¨çš„mapXXXexport function useMapper(mapper, mapFn) &#123; const store = useStore() const storeStateFns = mapFn(mapper) const storeState = &#123;&#125; Object.keys(storeStateFns).forEach(fnKey =&gt; &#123; const fn = storeStateFns[fnKey].bind(&#123; $store: store &#125;) storeState[fnKey] = computed(fn) &#125;) return storeState&#125; Mutations æ›´æ”¹ Vuex çš„storeä¸­çš„çŠ¶æ€çš„å”¯ä¸€æ–¹æ³•æ˜¯æäº¤mutation mutations åŸºæœ¬ä½¿ç”¨ åœ¨storeä¸­å®šä¹‰æ–¹æ³• mutations: &#123; increment(state) &#123; state.counter++ &#125;, decrement(state) &#123; state.counter-- &#125;&#125; åœ¨setupä¸­commitäº‹ä»¶ï¼Œæäº¤çš„æ˜¯mutationsä¸­çš„æ–¹æ³• import &#123; useStore &#125; from &quot;vuex&quot;setup() &#123; const store = useStore() store.commit(&quot;increment&quot;, xxx) // å¯ä»¥ä¼ å‚æ•°&#125; mutationæºå¸¦æ•°æ® å¾ˆå¤šæ—¶å€™æäº¤mutationä¼šæºå¸¦ä¸€äº›æ•°æ®ï¼Œåœ¨mutationä¸­ç¬¬äºŒä¸ªå‚æ•°å¯ä»¥æ¥æ”¶ mutations: &#123; addNumber(state, payload) &#123; state.counter += payload &#125;&#125; payloadä¹Ÿå¯ä»¥æ˜¯å¯¹è±¡ç±»å‹ æäº¤çš„æ—¶å€™ï¼šå¯ä»¥ç”¨typeï¼ŒæŒ‡å®šæäº¤çš„æ–¹æ³•å $store.commit(&#123; type: &quot;addNumber&quot;, count: 100&#125;) mutations: &#123; addNumber(state, payload) &#123; state.counter += payload.count &#125;&#125; mutation å¸¸é‡ç±»å‹ ä¸»è¦æ˜¯é¢„é˜²ç²—å¿ƒçš„æ—¶å€™ï¼Œcommitçš„æ–¹æ³•åå­—å’Œmutationå®šä¹‰çš„æ–¹æ³•åä¸ä¸€è‡´ å®šä¹‰å¸¸é‡ // mutation-types.js// å®šä¹‰å¸¸é‡export const INCREMENT_N = &quot;INCREMENT_N&quot; storeä¸­ä½¿ç”¨ import &#123; INCREMENT_N &#125; from &#x27;../store/mutation-types&#x27;const store = createStore(&#123; state() &#123;...&#125;, mutations: &#123; [INCREMENT_N](state, payload) &#123; state.counter += payload &#125; &#125; ç»„ä»¶ä¸­æäº¤äº‹ä»¶çš„æ—¶å€™ä½¿ç”¨ import &#123; INCREMENT_N &#125; from &#x27;../store/mutation-types&#x27;export default &#123; setup() &#123; ... store.commit(INCREMENT_N, 10) &#125;&#125; mutationé‡è¦åŸåˆ™ mutation å¿…é¡»æ˜¯åŒæ­¥å‡½æ•° è¿™æ˜¯å› ä¸ºdevtoolå·¥å…·ä¼šè®°å½•mutationçš„æ—¥è®° æ¯ä¸€æ¡mutationè¢«è®°å½•ï¼Œdevtoolséƒ½éœ€è¦æ•æ‰åˆ°å‰ä¸€çŠ¶æ€å’Œåä¸€çŠ¶æ€çš„å¿«ç…§ ä½†æ˜¯åœ¨mutationä¸­æ‰§è¡Œå¼‚æ­¥æ“ä½œï¼Œå°±æ— æ³•è¿½è¸ªåˆ°æ•°æ®çš„å˜åŒ– æ‰€ä»¥Vuexçš„é‡è¦åŸåˆ™ä¸­è¦æ±‚ mutationå¿…é¡»æ˜¯åŒæ­¥å‡½æ•°ï¼› mapMutations æˆ‘ä»¬ä¹Ÿå¯ä»¥å€ŸåŠ©äºè¾…åŠ©å‡½æ•°ï¼Œå¸®åŠ©æˆ‘ä»¬å¿«é€Ÿæ˜ å°„åˆ°å¯¹åº”çš„æ–¹æ³•ä¸­ const mutations = mapMutations([&quot;increment&quot;, &quot;decrement&quot;])const mutations2 = mapMutations(&#123; addNumber: ADD_NUMBER&#125;) actions actionæäº¤mutation actions ç±»ä¼¼äºmutationsï¼Œä½†æ˜¯actionæäº¤çš„æ˜¯mutationï¼Œè€Œä¸æ˜¯ç›´æ¥å˜æ›´çŠ¶æ€ actions å¯ä»¥åŒ…å«ä»»æ„å¼‚æ­¥æ“ä½œ actionsæœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„å‚æ•° contextï¼Œé‡Œé¢æœ‰å¾ˆå¤šå±æ€§ï¼Œæˆ‘ä»¬ç”¨çš„æ—¶å€™é™¤äº†context.xxxä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥è§£æ„å‡ºæ¥ä½¿ç”¨ ä»contextè·å–commitæ–¹æ³•æ¥æäº¤ä¸€ä¸ªmutation actionsçš„åˆ†å‘æ“ä½œï¼ˆè§¦å‘actionsä¸­çš„æ–¹æ³•ï¼‰ åœ¨ç»„ä»¶ä¸­ä½¿ç”¨storeä¸Šçš„dispatchè¿›è¡Œåˆ†å‘ï¼Œå¹¶ä¸”å¯ä»¥ä¼ é€’å‚æ•° // store.jsmutations: &#123; increment(state) &#123; state.counter++ &#125;&#125;,actions: &#123; // 1. å¯ä»¥æ¥æ”¶å‚æ•° incrementAction(context, payload) &#123; console.log(payload) // payloadä¸ºæ¥æ”¶åˆ°çš„å‚æ•° // æ¨¡æ‹Ÿå¼‚æ­¥ï¼š1sä¹‹åå†æäº¤äº‹ä»¶ setTimeout(() =&gt; &#123; context.commit(&quot;increment&quot;) // æäº¤mutation &#125;) &#125;, // 2. context çš„å±æ€§ decrementAction(&#123; commit, dispatch, state, rootState, getters, rootGetters &#125;) &#123; commit(&quot;decrement&quot;) &#125;&#125; // ç»„ä»¶çš„setupä¸­const increment = () =&gt; &#123; // åˆ†å‘actionsï¼Œå¹¶æºå¸¦å‚æ•° store.dispatch(&quot;incrementAction&quot;, &#123;count: 100&#125;)&#125; å¦å¤–ï¼Œä¹Ÿå¯ä»¥ä»¥å¯¹è±¡çš„å½¢å¼è¿›è¡Œåˆ†å‘ // ç»„ä»¶çš„setupä¸­const increment = () =&gt; &#123; store.dispatch(&#123; type: &quot;incrementAction&quot;, count: 100 &#125;)&#125; mapActions actions ä¹Ÿæœ‰å¯¹åº”çš„è¾…åŠ©å‡½æ•° mapActions // è¿™æ ·ç”¨ä¸è¡Œ..const actions = mapActions[&quot;incrementAction&quot;, &quot;decrementAction&quot;]// å¯¹è±¡å†™æ³•(é‡å‘½å)const actions2 = mapActions(&#123; add: &quot;incrementAction&quot;, sub: &quot;decrementAction&quot;&#125;) actionsçš„å¼‚æ­¥æ“ä½œ actionså¾ˆå¤šæ—¶å€™æ˜¯å¼‚æ­¥çš„ï¼Œé‚£ä¹ˆå½“æˆ‘ä»¬ç»„ä»¶æ´¾å‘actionsçš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿæƒ³æ”¶åˆ°ç»“æœï¼Œæ˜¯è¯·æ±‚æˆåŠŸäº†è¿˜æ˜¯å¤±è´¥äº†ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥åœ¨actionså¯¹åº”æ–¹æ³•ä¸­è¿”å› Promiseï¼Œå¹¶å¯¹æˆåŠŸå¤±è´¥åšå¤„ç† actions: &#123; getHomeMultidata(context) &#123; return new Promise((resolve, reject) =&gt; &#123; axios.get(&quot;http://123.207.32.32:8000/home/multidata&quot;).then(res =&gt; &#123; console.log(res); context.commit(&quot;addBannerData&quot;, res.data.data.banner.list) resolve(&quot;okok&quot;) &#125;).catch(err =&gt; &#123; reject(err) &#125;) &#125;) &#125;&#125; onMounted(() =&gt; &#123; const promise = store.dispatch(&quot;getHomeMultidata&quot;) promise.then(res =&gt; &#123; console.log(res); &#125;).catch(err =&gt; &#123; console.log(err); &#125;)&#125;) module moduleçš„åŸºæœ¬ä½¿ç”¨ ä»€ä¹ˆæ˜¯moduleï¼Ÿ ç”±äºä½¿ç”¨å•ä¸€çŠ¶æ€æ ‘ï¼Œåº”ç”¨çš„æ‰€æœ‰çŠ¶æ€éƒ½é›†ä¸­åˆ°ä¸€ä¸ªæ¯”è¾ƒå¤§çš„å¯¹è±¡ï¼Œå½“åº”ç”¨å˜å¾—å¤æ‚æ—¶ï¼Œstoreå¯¹è±¡å°±å˜å¾—ç›¸å½“è‡ƒè‚¿ï¼Œä¸åˆ©äºç®¡ç† æ‰€ä»¥Vuexå…è®¸æˆ‘ä»¬å°†storeåˆ†æ¨¡å— æ¯ä¸ªæ¨¡å—æ‹¥æœ‰è‡ªå·±çš„stateï¼Œmutationï¼Œactionï¼Œgetterï¼Œç”šè‡³æ˜¯åµŒå¥—å­æ¨¡å— ä½¿ç”¨ï¼š æ¨¡å—å†…éƒ¨çš„mutationå’Œgetterçš„ç¬¬ä¸€ä¸ªå‚æ•°stateæ˜¯æ¨¡å—çš„å±€éƒ¨çŠ¶æ€å¯¹è±¡ moduleçš„å‘½åç©ºé—´ é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¨¡å—å†…éƒ¨çš„actionï¼Œmutationä»ç„¶æ˜¯æ³¨å†Œåœ¨å…¨å±€çš„å‘½åç©ºé—´ä¸­çš„ å¦‚æœå¸Œæœ›æ¨¡å—å…·æœ‰æ›´é«˜çš„å°è£…åº¦å’Œå¤ç”¨æ€§ï¼Œå¯ä»¥åœ¨æ¨¡å—ä¸­æ·»åŠ namespaced: true ä½¿æ¨¡å—æ›´ç‹¬ç«‹ ä¹‹åï¼Œå½“æ¨¡å—è¢«æ³¨å†Œåå®ƒçš„æ‰€æœ‰getterã€actionåŠmutationéƒ½ä¼šè‡ªåŠ¨æ ¹æ®æ¨¡å—æ³¨å†Œçš„è·¯å¾„è°ƒæ•´å‘½å moduleä¿®æ”¹æˆ–æ´¾å‘æ ¹ç»„ä»¶ {root: true} actions: &#123; incrementAction(&#123;commit, dispatch,state&#125;) &#123; commit(&quot;rootIncrement&quot;, null, &#123;root: true&#125;) dispatch(&quot;rootIncrementAction&quot;, null, &#123;root: true&#125;) &#125;&#125; moduleçš„è¾…åŠ©å‡½æ•° å†™æ³•ä¸€ï¼šé€šè¿‡å®Œæ•´çš„æ¨¡å—ç©ºé—´åæ¥æŸ¥æ‰¾(ä¸æ˜¯å¾ˆæ¨èä½¿ç”¨) computed: &#123; ...mapState(&#123; homeCounter: state =&gt; state.home.homeCounter, &#125;), ...mapGetters(&#123; doubleHomeCounter: &quot;home/doubleHomeCounter&quot;, &#125;),&#125;, å†™æ³•äºŒï¼šç¬¬ä¸€ä¸ªå‚æ•°å†™æ¨¡å—åï¼Œç¬¬äºŒä¸ªå‚æ•°å†™å±æ€§ computed: &#123; ...mapState(&quot;home&quot;, [&quot;homeCounter&quot;])&#125; å†™æ³•ä¸‰ï¼šcreateNamespacedHelpersè¾…åŠ©å‡½æ•° åˆ›å»ºåŸºäºæŸä¸ªå‘½åç©ºé—´è¾…åŠ©å‡½æ•°ã€‚å®ƒè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡é‡Œæœ‰æ–°çš„ç»‘å®šåœ¨ç»™å®šå‘½åç©ºé—´å€¼ä¸Šçš„ç»„ä»¶ç»‘å®šè¾…åŠ©å‡½æ•° import &#123; createNamespacedHelpers &#125; from &#x27;vuex&#x27;const &#123; mapState, mapGetters&#125; = createNamespacedHelpers(&quot;home&quot;)...mapState([&quot;homeCounter&quot;]) setupä¸­ä½¿ç”¨ ä¿®æ”¹ä¹‹å‰çš„ hooksï¼ŒuseStateï¼ŒuseGettersï¼Œè€ƒè™‘æ¨¡å—çš„æƒ…å†µ import &#123; mapState, createNamespacedHelpers&#125; from &#x27;vuex&#x27;import &#123; useMapper &#125; from &#x27;./useMapper&#x27;export function useState(moduleName, mapper) &#123; let mapperFn = mapState if (typeof moduleName === &#x27;string&#x27; &amp;&amp; moduleName.length &gt; 0) &#123; mapperFn = createNamespacedHelpers(moduleName).mapState &#125; else &#123; mapper = moduleName &#125; return useMapper(mapper, mapperFn)&#125; // useGettersåŒç† import &#123; mapGetters, createNamespacedHelpers &#125; from &quot;vuex&quot;;import &#123; useMapper &#125; from &quot;./useMapper&quot;;export function useGetters(moduleName, mapper) &#123; let mapperFn = mapGetters if (typeof moduleName === &#x27;string&#x27; &amp;&amp; moduleName.length &gt; 0) &#123; mapperFn = createNamespacedHelpers(moduleName).mapGetters &#125; else &#123; mapper = moduleName &#125; return useMapper(mapper, mapperFn)&#125; ä½¿ç”¨ï¼š setup() &#123; const state = useState([&quot;rootCounter&quot;]) const rootGetters = useGetters([&quot;doubleRootCounter&quot;]) const getters = useGetters(&quot;home&quot;, [&quot;doubleHomeCounter&quot;])&#125;","categories":[{"name":"æ·±å…¥Vue3+Typescriptå­¦ä¹ âš¡","slug":"æ·±å…¥Vue3-Typescriptå­¦ä¹ âš¡","permalink":"https://hillyee.github.io/categories/%E6%B7%B1%E5%85%A5Vue3-Typescript%E5%AD%A6%E4%B9%A0%E2%9A%A1/"}],"tags":[{"name":"vue3","slug":"vue3","permalink":"https://hillyee.github.io/tags/vue3/"},{"name":"vuex","slug":"vuex","permalink":"https://hillyee.github.io/tags/vuex/"}]},{"title":"å‰ç«¯äººçš„æ•°æ®ç»“æ„ä¸ç®—æ³•ä¹‹è·¯","slug":"å‰ç«¯äººçš„æ•°æ®ç»“æ„ä¸ç®—æ³•ä¹‹è·¯","date":"2022-04-04T09:25:17.000Z","updated":"2022-04-04T16:02:01.469Z","comments":true,"path":"2022/04/04/å‰ç«¯äººçš„æ•°æ®ç»“æ„ä¸ç®—æ³•ä¹‹è·¯/","link":"","permalink":"https://hillyee.github.io/2022/04/04/%E5%89%8D%E7%AB%AF%E4%BA%BA%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E4%B9%8B%E8%B7%AF/","excerpt":"","text":"å­¦ä¹ èµ„æ–™ [å‰ç«¯ç®—æ³•ä¸æ•°æ®ç»“æ„é¢è¯•ï¼šåº•å±‚é€»è¾‘è§£è¯»ä¸å¤§å‚çœŸé¢˜è®­ç»ƒ] é“¾æ¥ï¼šhttps://juejin.cn/book/6844733800300150797 å¤§çº²ï¼š","categories":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•ğŸ˜¥","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•ğŸ˜¥","permalink":"https://hillyee.github.io/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%F0%9F%98%A5/"}],"tags":[{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"https://hillyee.github.io/tags/%E9%9D%A2%E8%AF%95/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://hillyee.github.io/tags/%E7%AE%97%E6%B3%95/"}]},{"title":"VueRouter","slug":"VueRouter","date":"2022-04-04T09:12:34.000Z","updated":"2022-04-14T06:44:41.752Z","comments":true,"path":"2022/04/04/VueRouter/","link":"","permalink":"https://hillyee.github.io/2022/04/04/VueRouter/","excerpt":"","text":"VueRouterè·¯ç”±ä½¿ç”¨ ç®€å•çš„ä»‹ç»ğŸ˜ è¿™ä¸€éƒ¨åˆ†äº†è§£ã€ç†è§£ä¸€ä¸‹ï¼ŒçŸ¥é“æœ‰å°±è¡Œ åç«¯è·¯ç”±é˜¶æ®µï¼š æœåŠ¡å™¨æ¸²æŸ“å¥½æ•´ä¸ªé¡µé¢ï¼Œå¹¶ä¸”å°†é¡µé¢è¿”å›ç»™å®¢æˆ·ç«¯ ä¸éœ€è¦å•ç‹¬åŠ è½½ä»»ä½•çš„jså’Œcss, å¯ä»¥ç›´æ¥äº¤ç»™æµè§ˆå™¨å±•ç¤º, è¿™æ ·ä¹Ÿæœ‰åˆ©äºSEOçš„ä¼˜åŒ– ä¸åˆ©äºç»´æŠ¤ å‰åç«¯åˆ†ç¦»é˜¶æ®µï¼š åç«¯åªæä¾›APIæ¥è¿”å›æ•°æ®ï¼Œå‰ç«¯é€šè¿‡Ajaxè·å–æ•°æ®ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡JavaScriptå°†æ•°æ®æ¸²æŸ“åˆ°é¡µé¢ä¸­ å‰åç«¯è´£ä»»æ¸…æ™°ï¼Œåç«¯ä¸“æ³¨äºæ•°æ®ä¸Šï¼Œå‰ç«¯ä¸“æ³¨äºäº¤äº’å’Œå¯è§†åŒ–ä¸Š å‰ç«¯è·¯ç”±æ˜¯å¦‚ä½•åšåˆ°URLå’Œå†…å®¹è¿›è¡Œæ˜ å°„å‘¢ï¼Ÿç›‘å¬URLçš„æ”¹å˜ URLçš„hash URLçš„hashä¹Ÿå°±æ˜¯é”šç‚¹(#), æœ¬è´¨ä¸Šæ˜¯æ”¹å˜window.locationçš„hrefå±æ€§ æˆ‘ä»¬å¯ä»¥é€šè¿‡ç›´æ¥èµ‹å€¼location.hashæ¥æ”¹å˜href, ä½†æ˜¯é¡µé¢ä¸å‘ç”Ÿåˆ·æ–° (é¡µé¢ä¸€æ—¦åˆ·æ–°ï¼Œåˆä¼šå‘æœåŠ¡å™¨å‘è¯·æ±‚) &lt;div id=&quot;app&quot;&gt; &lt;a href=&quot;#/home&quot;&gt;home&lt;/a&gt; &lt;a href=&quot;#/about&quot;&gt;about&lt;/a&gt; &lt;div class=&quot;content&quot;&gt;Default&lt;/div&gt;&lt;/div&gt;&lt;script&gt; const contentEl = document.querySelector(&#x27;.content&#x27;) window.addEventListener(&quot;hashchange&quot;, () =&gt; &#123; switch(location.hash) &#123; case &quot;#/home&quot;: contentEl.innerHTML = &quot;Home&quot; break case &quot;#/about&quot;: contentEl.innerHTML = &quot;About&quot; break &#125; &#125;) hashçš„ä¼˜åŠ¿å°±æ˜¯å…¼å®¹æ€§æ›´å¥½ï¼Œåœ¨è€ç‰ˆIEä¸­éƒ½å¯ä»¥è¿è¡Œï¼Œä½†æ˜¯ç¼ºé™·æ˜¯æœ‰ä¸€ä¸ª#ï¼Œæ˜¾å¾—ä¸åƒä¸€ä¸ªçœŸå®çš„è·¯å¾„ HTML5çš„History historyæ¥å£æ˜¯HTML5æ–°å¢çš„, å®ƒæœ‰å…­ç§æ¨¡å¼æ”¹å˜URLè€Œä¸åˆ·æ–°é¡µé¢ï¼š replaceStateï¼šæ›¿æ¢åŸæ¥çš„è·¯å¾„ pushStateï¼šä½¿ç”¨æ–°çš„è·¯å¾„ï¼ˆå‹æ ˆï¼‰ popStateï¼šè·¯å¾„çš„å›é€€ï¼ˆå¼¹æ ˆï¼‰ goï¼šå‘å‰æˆ–å‘åæ”¹å˜è·¯å¾„ go(1)å‰è¿›1æ­¥ï¼Œgo(2)ï¼Œå‰è¿›ä¸¤æ­¥ï¼Œgo(-1)ï¼Œåé€€ä¸€æ­¥ forwardï¼šå‘å‰ä¸€æ­¥ backï¼šåé€€ä¸€æ­¥ &lt;div id=&quot;app&quot;&gt; &lt;a href=&quot;/home&quot;&gt;home&lt;/a&gt; &lt;a href=&quot;/about&quot;&gt;about&lt;/a&gt; &lt;div class=&quot;content&quot;&gt;Default&lt;/div&gt;&lt;/div&gt;&lt;script&gt; const contentEl = document.querySelector(&#x27;.content&#x27;) const changeContent = () =&gt; &#123; switch(location.pathname) &#123; case &quot;/home&quot;: contentEl.innerHTML = &quot;Home&quot; break case &quot;/about&quot;: contentEl.innerHTML = &quot;About&quot; break default: contentEl.innerHTML = &quot;Default&quot;; &#125; &#125; const aEls = document.getElementsByTagName(&quot;a&quot;) for (let aEl of aEls) &#123; aEl.addEventListener(&quot;click&quot;, e =&gt; &#123; e.preventDefault() // é˜»æ­¢é»˜è®¤è¡Œä¸º const href = aEl.getAttribute(&quot;href&quot;) // history.replaceState(&#123;&#125;, &quot;&quot;, href) history.pushState(&#123;&#125;, &quot;&quot;, href) changeContent() &#125;) &#125; window.addEventListener(&quot;popstate&quot;, changeContent)&lt;/script&gt; vue-routerğŸ“± Vue Router æ˜¯ Vue.js çš„å®˜æ–¹è·¯ç”±ï¼Œä¾¿äºæ„å»ºå•é¡µé¢åº”ç”¨ ä½¿ç”¨vue-router å®‰è£… Vue Router npm install vue-router è·¯ç”±çš„ä½¿ç”¨æ­¥éª¤ åˆ›å»ºè·¯ç”±ç»„ä»¶ é…ç½®è·¯ç”±æ˜ å°„ã€åˆ›å»ºè·¯ç”±å¯¹è±¡ import &#123; createRouter, createWebHashHistory, createWebHistory &#125; from &#x27;vue-router&#x27;import Home from &#x27;../pages/Home.vue&#x27;import About from &#x27;../pages/About.vue&#x27;// é…ç½®æ˜ å°„å…³ç³»const routes = [ &#123; path: &#x27;/home&#x27;, component: Home &#125;, &#123; path: &#x27;/about&#x27;, component: About &#125;]// åˆ›å»ºä¸€ä¸ªè·¯ç”±å¯¹è±¡routerconst router = createRouter(&#123; routes, // ä½¿ç”¨è·¯ç”±çš„æ¨¡å¼ï¼Œhash / history history: createWebHistory()&#125;)// æœ€åå¯¼å‡ºexport default router åœ¨å…¨å±€main.jsä¸­æ³¨å†Œè·¯ç”± import router from &#x27;./router&#x27;// æ³¨å†Œè·¯ç”±vue.use(router) ä½¿ç”¨è·¯ç”±ï¼š&lt;router-link&gt; &lt;router-view&gt; è¿™ç§&lt;router-link to&gt;å« å£°æ˜å¼å¯¼èˆª &lt;router-link to=&quot;/home&quot;&gt;é¦–é¡µ&lt;/router-link&gt;&lt;router-link to=&quot;/about&quot;&gt;å…³äº&lt;/router-link&gt;&lt;router-view&gt;&lt;/router-view&gt; è·¯ç”±é‡å®šå‘ å¯¹ â€˜/â€™ è¿™ä¸ªè·¯å¾„ï¼Œé‡å®šå‘åˆ°â€™/homeâ€™ &#123; path: &#x27;/&#x27;, // é‡å®šå‘ redirect: &#x27;/home&#x27;&#125;, è·¯ç”±è¿˜æœ‰å…¶ä»–å±æ€§ nameï¼šç»™æŸä¸ªè·¯ç”±èµ·ç‹¬ä¸€æ— äºŒçš„åå­— metaï¼šé…ç½®ä¸€äº›å‚æ•°ï¼Œè¢«ä¸€èµ·å¸¦åˆ°routerå¯¹è±¡ä¸­ è·¯ç”±æ‡’åŠ è½½ æŠŠä¸åŒè·¯ç”±å¯¹åº”çš„ç»„ä»¶åˆ†å‰²æˆä¸åŒçš„ä»£ç å—ï¼Œç„¶åå½“è·¯ç”±è¢«è®¿é—®çš„æ—¶å€™æ‰åŠ è½½å¯¹åº”ç»„ä»¶ å¥½å¤„ï¼šæé«˜é¦–å±çš„æ¸²æŸ“æ•ˆç‡ å®é™…å°±æ˜¯webpackçš„åˆ†åŒ…ï¼Œè€ŒVue Routeré»˜è®¤å°±æ”¯æŒåŠ¨æ€æ¥å¯¼å…¥ç»„ä»¶ è¿™æ˜¯å› ä¸ºcomponentå¯ä»¥ä¼ å…¥ä¸€ä¸ªç»„ä»¶ï¼Œä¹Ÿå¯ä»¥æ¥æ”¶ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°éœ€è¦è¿”å›ä¸€ä¸ªPromise è€Œimportå‡½æ•°å°±æ˜¯è¿”å›ä¸€ä¸ªPromise ä¸é‡‡ç”¨ç›´æ¥import Home from '../pages/Home.vue'çš„æ–¹å¼ å¦å¤–è¿˜å¯ä»¥å¯¹åˆ†åŒ…å‘½åï¼š/*webpackChunkName: &quot;xxx&quot;*/ &#123; path: &#x27;/home&#x27;, component: () =&gt; import(&quot;../pages/Home.vue&quot;)&#125;,&#123; path: &#x27;/about&#x27;, // è¿˜å¯ä»¥å¯¹åˆ†åŒ…å‘½å component: () =&gt; import(/*webpackChunkName: &quot;ahout-chunk&quot; */&quot;../pages/About.vue&quot;)&#125;, æ‰“åŒ…åçš„æ•ˆæœ router-linkçš„å±æ€§ toï¼šå­—ç¬¦ä¸²ï¼ˆâ€˜/homeâ€™ï¼‰æˆ–è€…å¯¹è±¡ï¼ˆé…ç½®è·¯å¾„+å‚æ•°ï¼‰ replaceï¼šæ›¿ä»£ è®¾ç½® replace å±æ€§çš„è¯ï¼Œå½“ç‚¹å‡»æ—¶ï¼Œä¼šè°ƒç”¨ router.replace()ï¼Œè€Œä¸æ˜¯ router.push() active-classå±æ€§ï¼šå¯ä»¥åœ¨è¿™ä¸ªclassåŠ æ ·å¼å•¥çš„ è®¾ç½®æ¿€æ´»aå…ƒç´ ååº”ç”¨çš„classï¼Œé»˜è®¤æ˜¯router-link-active(ä¸€èˆ¬ ä¸å»ä¿®æ”¹) exact-active-classå±æ€§ é“¾æ¥ç²¾å‡†æ¿€æ´»æ—¶ï¼Œåº”ç”¨äºæ¸²æŸ“çš„ çš„ classï¼Œé»˜è®¤æ˜¯router-link-exact-active åœ¨åµŒå¥—è·¯ç”±ä¸­ï¼Œä¾‹å¦‚æœ‰ä¸€ä¸ªåµŒå¥—è·¯ç”±æ˜¯ï¼š/home/message é‚£ä¹ˆè¿™ä¸ªclassåªä¼šåœ¨messageé‚£ä¸ªå­è·¯ç”±ä¸­ åŠ¨æ€è·¯ç”± åŠ¨æ€ï¼Œå³è¿™ä¸ªè·¯ç”±çš„è·¯å¾„æ˜¯åŠ¨æ€æ”¹å˜çš„ åœ¨Vue Routerä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è·¯å¾„ä¸­ä½¿ç”¨ä¸€ä¸ªåŠ¨æ€å­—æ®µæ¥å®ç°ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºè·¯å¾„å‚æ•° &#123; path: &#x27;/user/:username/id/:id&#x27;, component: () =&gt; import(&quot;../pages/User.vue&quot;)&#125; :username? åŠ ï¼Ÿè¡¨ç¤ºå¯æœ‰å¯æ— ï¼Œå¦åˆ™å¿…é¡»æœ‰ å¦‚ä½•è·å–åŠ¨æ€è·¯ç”±çš„å€¼ï¼Ÿ åœ¨templateä¸­ï¼š$route.params åœ¨createdä¸­ï¼šthis.$route.params åœ¨setupä¸­ï¼šè¦ä½¿ç”¨ vue-routeråº“ç»™æˆ‘ä»¬æä¾›çš„ä¸€ä¸ªhook useRoute import &#123;useRoute&#125; from &#x27;vue-router&#x27;setup() &#123; // ç›´æ¥è°ƒç”¨useRoute()ï¼Œä¼šè¿”å›ä¸€ä¸ªè·¯ç”±å¯¹è±¡ const route = useRoute() console.log(route); console.log(route.params); &#125; NotFound å¯¹äºé‚£äº›æ²¡æœ‰åŒ¹é…åˆ°çš„è·¯ç”±ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šåŒ¹é…åˆ°å›ºå®šçš„æŸä¸ªé¡µé¢ å¯ç¼–å†™ä¸€ä¸ªåŠ¨æ€è·¯ç”±ç”¨äºåŒ¹é…æ‰€æœ‰çš„é¡µé¢ &#123; path: &#x27;/:pathMath(.*)&#x27;, // ç”¨åˆ°æ­£åˆ™ .*åŒ¹é…ä»»æ„å­—ç¬¦0æˆ–å¤šä¸ª component: () =&gt; import(&quot;../pages/NotFound.vue&quot;)&#125; å¯ä»¥é€šè¿‡$route.params.pathMathè·å–ä¼ å…¥çš„å‚æ•° è¿˜æœ‰ä¸€ç§å†™æ³• &#123; path: &#x27;/:pathMath(.*)*&#x27; // è¿™é‡Œå¤šåŠ ä¸€ä¸ª* component: () =&gt; import(&quot;../pages/NotFound.vue&quot;)&#125; åŒºåˆ«åœ¨äºè§£æçš„æ—¶å€™ï¼Œæ˜¯å¦è§£æ /ï¼š æŠŠè·¯å¾„ä¸­çš„/â€¦/ åˆ†æˆä¸€ä¸ªä¸ªçš„ è·¯ç”±çš„åµŒå¥— æŸä¸ªè·¯ç”±é¡µé¢æœ¬èº«ä¹Ÿå­˜åœ¨è·¯ç”±çš„æ¥å›åˆ‡æ¢ é…ç½®å­è·¯ç”±ï¼ŒåŒæ ·åœ¨homeä¸­ä½¿ç”¨router-link,router-view &#123; path: &#x27;/home&#x27;, component: () =&gt; import(&quot;../pages/Home.vue&quot;), children: [ &#123; path: &#x27;message&#x27;, // è¿™é‡Œä¸éœ€è¦/ component: () =&gt; import(&quot;../pages/Message.vue&quot;) &#125;, &#123; path: &#x27;goods&#x27;, component: () =&gt; import(&quot;../pages/Goods.vue&quot;) &#125; ]&#125; ç¼–ç¨‹å¼è·¯ç”± ä¸é€šè¿‡router-linkçš„æ–¹å¼å®ç°è·³è½¬ï¼Œæ¯”å¦‚ç‚¹å‡»çš„æ˜¯ä¸€ä¸ªæŒ‰é’®ç­‰ setup() &#123; // è·å–routerå¯¹è±¡ const router = useRouter() const gotoMessage = () =&gt; &#123; router.push(&#x27;/home/message&#x27;) // å¯ä»¥ç›´æ¥ä¼ å­—ç¬¦ä¸² &#125; const gotoGoods = () =&gt; &#123; router.push(&#123; path: &#x27;/home/goods&#x27; // ä¹Ÿå¯ä»¥æ˜¯å¯¹è±¡ &#125;) &#125;&#125; å¦å¤–è¿˜æœ‰ router.replaceã€router.goã€backã€forward vue2ä¸­ï¼šthis.$router.push query(æŸ¥è¯¢)æ–¹å¼çš„å‚æ•° ä¼ é€’queryå‚æ•°ï¼š router.push(&#123; path: &#x27;/home/goods&#x27;, query:&#123; name: &#x27;hello&#x27;, age: 18 &#125;&#125;) åœ¨å¯¹åº”é¡µé¢ä¸­è·å–queryå‚æ•°ï¼š &lt;h2&gt;&#123;&#123;$route.query.name&#125;&#125;---&#123;&#123;$route.query.age&#125;&#125;&lt;/h2&gt; router-linkçš„v-slot ç”¨åˆ°æŸ¥æ–‡æ¡£å°±å¥½ &lt;!-- v-slotå¯ä»¥æ‹¿åˆ°router-linkç»™æˆ‘ä»¬ä¼ é€’è¿‡æ¥çš„å±æ€§(å¯ä»¥è‡ªå·±å‘½å props)custom:è¡¨ç¤ºè‡ªå®šä¹‰router-linkï¼Œå¤–éƒ¨ä¸ä¼šç»™æˆ‘ä»¬åŒ…è£¹aå…ƒç´ äº†props.navigateï¼šæ‰€ä»¥å½“æˆ‘ä»¬æƒ³ç‚¹å‡»æŸä¸ªå…ƒç´ è·³è½¬çš„æ—¶å€™å¯ä»¥ä½¿ç”¨navigate(å½“ç„¶ç”¨ç¼–ç¨‹å¼å¯¼èˆªä¹Ÿæ˜¯å¯ä»¥çš„)props.routeï¼šè·¯ç”±å¯¹è±¡props.href: è§£æåçš„urlprops: isActive æ˜¯å¦å½“å‰å¤„äºæ´»è·ƒçš„çŠ¶æ€ (true,false)props: isExactActive æ˜¯å¦å½“å‰å¤„äºç²¾ç¡®çš„æ´»è·ƒçŠ¶æ€ --&gt;&lt;router-link to=&quot;/home&quot; v-slot=&quot;props&quot; custom&gt; &lt;button&gt;é¦–é¡µ&lt;/button&gt; &lt;p&gt;href: &#123;&#123;props.href&#125;&#125;&lt;/p&gt; &lt;button @click=&quot;props.navigate&quot;&gt;è·³è½¬home&lt;/button&gt; &lt;p&gt;&#123;&#123;props.route&#125;&#125;&lt;/p&gt; &lt;span :class=&quot;&#123;&#x27;active&#x27;: props.isActive&#125;&quot;&gt;&lt;/span&gt; &lt;span :class=&quot;&#123;&#x27;active&#x27;: props.isActive&#125;&quot;&gt;&#123;&#123;props.isExactActive&#125;&#125;&lt;/span&gt;&lt;/router-link&gt; router-viewçš„v-slot router-viewä¹Ÿæä¾›ç»™æˆ‘ä»¬ä¸€ä¸ªæ’æ§½ï¼Œå¯ä»¥ç”¨äº&lt;transition&gt;å’Œ&lt;keep-alive&gt;ç»„ä»¶æ¥åŒ…è£¹ä½ çš„è·¯ç”±ç»„ä»¶ï¼ˆç”¨äºåŠ åŠ¨ç”»ï¼Œç¼“å­˜ï¼‰ Componentï¼šè¦æ¸²æŸ“çš„ç»„ä»¶ routeï¼šè§£æå‡ºçš„æ ‡å‡†åŒ–è·¯ç”±å¯¹è±¡ &lt;router-view v-slot=&quot;props&quot;&gt; &lt;transition name=&quot;abc&quot;&gt; &lt;!-- å¯ä»¥æ‹¿åˆ°router-viewç»™æˆ‘ä»¬ä¼ è¿‡æ¥çš„ç»„ä»¶ --&gt; &lt;keep-alive&gt; &lt;component :is=&quot;props.Component&quot;&gt;&lt;/component&gt; &lt;/keep-alive&gt; &lt;/transition&gt;&lt;/router-view&gt; åŠ¨æ€æ·»åŠ è·¯ç”± æ¯”å¦‚è¯´æˆ‘ä»¬è¦æ ¹æ®ä¸åŒçš„æƒé™æ¥å†³å®šæ˜¯å¦æ·»åŠ è·¯ç”± è·¯ç”±å¯¹è±¡routerä¸Šæœ‰æ–¹æ³•ï¼šaddRoute()åŠ¨æ€æ·»åŠ è·¯ç”± // å®šä¹‰è¦æ·»åŠ çš„åŠ¨æ€è·¯ç”±ï¼ˆå¯ä»¥å…ˆå®šä¹‰const momentRoute = &#123; path: &#x27;/moment&#x27;, component: () =&gt; import(&quot;../pages/HomeMoment.vue&quot;)&#125;router.addRoute(momentRoute)// ä¹Ÿå¯ä»¥æ·»åŠ çš„æ—¶å€™ä½œä¸ºaddRouteçš„ç¬¬äºŒä¸ªå‚æ•°ï¼‰// ç»™homeåŠ¨æ€æ·»åŠ å­è·¯ç”±cart è·¯å¾„:/home/cartrouter.addRoute(&#x27;home&#x27;, &#123; path: &#x27;cart&#x27;, component: () =&gt; import(&quot;../pages/Cart.vue&quot;)&#125;) åŠ¨æ€åˆ é™¤è·¯ç”± ä¸‰ç§æ–¹å¼ï¼š æ·»åŠ ä¸€ä¸ªåŒåè·¯ç”±ï¼Œç›¸å½“äºè¦†ç›– é€šè¿‡removeRouteæ–¹æ³•ï¼Œä¼ å…¥è·¯ç”±çš„åç§° é€šè¿‡addRouteæ–¹æ³•çš„è¿”å›å€¼å›è°ƒ router.addRoute(&#123;path: &#x27;/about&#x27;, name: &#x27;about&#x27;, component: About&#125;)// æ–¹å¼1router.addRoute(&#123;path: &#x27;/other&#x27;, name: &#x27;about&#x27;, component: Other&#125;)// æ–¹å¼2router.removeRoute(&#x27;about&#x27;)// æ–¹å¼3const removeRoute = router.addRoute(&#123;path: &#x27;/about&#x27;, name: &#x27;about&#x27;, component: About&#125;)removeRoute() è·¯ç”±å…¶ä»–æ–¹æ³•è¡¥å…… router.hasRoute()ï¼šæ£€æŸ¥è·¯ç”±æ˜¯å¦å­˜åœ¨ã€‚ router.getRoutes()ï¼šè·å–ä¸€ä¸ªåŒ…å«æ‰€æœ‰è·¯ç”±è®°å½•çš„æ•°ç»„ è·¯ç”±å¯¼èˆªå®ˆå«ğŸ‘® vue-router æä¾›çš„å¯¼èˆªå®ˆå«ä¸»è¦ç”¨æ¥é€šè¿‡è·³è½¬æˆ–å–æ¶ˆçš„æ–¹å¼å®ˆå«å¯¼èˆª å…¨å±€å‰ç½®å®ˆå«beforeEach åœ¨å¯¼èˆªè§¦å‘æ—¶ä¼šè¢«å›è°ƒ å®ƒæœ‰ä¸¤ä¸ªå‚æ•°ï¼š toï¼šå³å°†è¿›å…¥çš„è·¯ç”±å¯¹è±¡ fromï¼šå³å°†ç¦»å¼€çš„Routeå¯¹è±¡ è¿”å›å€¼ï¼š falseï¼šå–æ¶ˆå½“å‰å¯¼èˆª ä¸è¿”å›æˆ–è€…è¿”å›undefinedï¼šè¿›è¡Œé»˜è®¤å¯¼èˆª è¿”å›ä¸€ä¸ªè·¯ç”±åœ°å€ï¼š è·¯å¾„å­—ç¬¦ä¸²ï¼šâ€˜/homeâ€™ å¯¹è±¡ï¼šç±»ä¼¼äº router.push({path: â€œ/loginâ€, query: â€¦}) å°æ¡ˆä¾‹ï¼šå¦‚æœæ²¡ç™»å½•å°±è·³è½¬åˆ°ç™»å½•é¡µé¢ router.beforeEach((to, from) =&gt; &#123; if (to.path !== &#x27;/login&#x27;) &#123; const token = window.localStorage.getItem(&#x27;token&#x27;) if(!token) &#123; return &quot;/login&quot; &#125; &#125;&#125;) æ›´å¤šå¯¼èˆªå®ˆå«çœ‹å®˜ç½‘ https://router.vuejs.org/zh/guide/advanced/navigation-guards.html å®Œæ•´çš„å¯¼èˆªè§£ææµç¨‹ å…¶ä»–è¡¥å…… historyApiFallback å¼€å‘ä¸­ä¸€ä¸ªéå¸¸å¸¸è§çš„å±æ€§ï¼Œä¸»è¦ä½œç”¨æ˜¯è§£å†³SPAé¡µé¢åœ¨è·¯ç”±è·³è½¬ä¹‹åï¼Œè¿›è¡Œé¡µé¢åˆ·æ–°æ—¶ï¼Œè¿”å›404çš„é”™è¯¯ å¦‚æœè®¾ç½®ä¸ºtrueï¼Œé‚£ä¹ˆåœ¨åˆ·æ–°æ—¶ï¼Œè¿”å›404é”™è¯¯æ—¶ï¼Œä¼šè‡ªåŠ¨è¿”å› index.html çš„å†…å®¹ å› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯å‰ç«¯è·¯ç”±ï¼Œåˆ·æ–°é¡µé¢æ—¶è®¿é—®çš„èµ„æºåœ¨æœåŠ¡ç«¯æ‰¾ä¸åˆ°ï¼Œå› ä¸ºvue-routerè®¾ç½®çš„è·¯å¾„ä¸æ˜¯çœŸå®å­˜åœ¨çš„è·¯å¾„ã€‚ æ³¨ï¼šæˆ‘ä»¬ä½¿ç”¨ vue-cliçš„æ—¶å€™ï¼Œé»˜è®¤å·²ç»å¸®æˆ‘ä»¬è®¾ç½®ä¸ºtrueäº† module.exports = &#123; //... devServer: &#123; historyApiFallback: true, &#125;&#125;; https://webpack.js.org/configuration/dev-server/#devserverhistoryapifallback","categories":[{"name":"æ·±å…¥Vue3+Typescriptå­¦ä¹ âš¡","slug":"æ·±å…¥Vue3-Typescriptå­¦ä¹ âš¡","permalink":"https://hillyee.github.io/categories/%E6%B7%B1%E5%85%A5Vue3-Typescript%E5%AD%A6%E4%B9%A0%E2%9A%A1/"}],"tags":[{"name":"vueè·¯ç”±","slug":"vueè·¯ç”±","permalink":"https://hillyee.github.io/tags/vue%E8%B7%AF%E7%94%B1/"}]},{"title":"éšç¬”âœ","slug":"éšç¬”","date":"2022-04-03T04:57:12.000Z","updated":"2022-04-04T16:06:41.551Z","comments":true,"path":"2022/04/03/éšç¬”/","link":"","permalink":"https://hillyee.github.io/2022/04/03/%E9%9A%8F%E7%AC%94/","excerpt":"","text":"å¾…å®Œå–„â€¦","categories":[{"name":"å…¶ä»–","slug":"å…¶ä»–","permalink":"https://hillyee.github.io/categories/%E5%85%B6%E4%BB%96/"}],"tags":[]},{"title":"å…³äºJSæ•°æ®ç±»å‹","slug":"å…³äºJSæ•°æ®ç±»å‹","date":"2022-04-03T03:09:28.000Z","updated":"2022-04-03T04:32:34.281Z","comments":true,"path":"2022/04/03/å…³äºJSæ•°æ®ç±»å‹/","link":"","permalink":"https://hillyee.github.io/2022/04/03/%E5%85%B3%E4%BA%8EJS%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/","excerpt":"","text":"JS æ•°æ®ç±»å‹è½¬æ¢ ç±»å‹è½¬æ¢å¯ä»¥åˆ†ä¸ºä¸¤ç§ï¼šéšå¼ç±»å‹è½¬æ¢ å’Œ æ˜¾å¼ç±»å‹è½¬æ¢ æ˜¾å¼ï¼šæ¯”å¦‚ Number(value) String(value) â€¦ éšå¼ï¼šå¯¹ä¸åŒç±»å‹çš„å€¼ä½¿ç”¨è¿ç®—ç¬¦æ—¶ï¼Œå€¼å¯ä»¥è‡ªåŠ¨è½¬æ¢ï¼Œæ¯”å¦‚ 1 == null æˆ‘ä»¬éœ€è¦çŸ¥é“ï¼šåœ¨ JS ä¸­åªæœ‰3ä¸­ç±»å‹çš„è½¬æ¢ï¼šè½¬æ¢ä¸º Numberï¼ŒStringï¼ŒBooleanç±»å‹ æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦å¼„æ¸…æ¥šåœ¨ä»€ä¹ˆåœºæ™¯ä¸‹åº”è¯¥è½¬æˆå“ªç§ç±»å‹å°±å¯ä»¥äº† è½¬æ¢ä¸ºboolean æ˜¾å¼ï¼šBoolean() æ–¹æ³•å¯ä»¥ç›´æ¥ç”¨æ¥å°†å€¼è½¬æ¢æˆå¸ƒå°”å‹ Boolean(2) // true éšå¼ï¼šé€šå¸¸åœ¨é€»è¾‘åˆ¤æ–­æˆ–è€…æœ‰é€»è¾‘è¿ç®—ç¬¦æ—¶è¢«è§¦å‘ if(2) &#123;&#125; // é€»è¾‘åˆ¤æ–­!!2 // é€»è¾‘è¿ç®—2 || &#x27;hello&#x27; // é€»è¾‘è¿ç®—let x = &#x27;hello&#x27; &amp;&amp; 123 // x === 123// é€»è¾‘è¿ç®—ç¬¦ï¼ˆæ¯”å¦‚ || å’Œ &amp;&amp;ï¼‰æ˜¯åœ¨å†…éƒ¨åšäº† boolean ç±»å‹è½¬æ¢ï¼Œä½†å®é™…ä¸Šè¿”å›çš„æ˜¯åŸå§‹æ“ä½œæ•°çš„å€¼ booleanç±»å‹è½¬æ¢åªæœ‰ trueï¼Œfalseä¸¤ç§ç»“æœã€‚ é™¤äº† 0ã€NaNã€ç©ºå­—ç¬¦ä¸²ã€nullã€undefinedäº”ä¸ªå€¼æ˜¯falseï¼Œå…¶ä½™éƒ½æ˜¯true é¢å¤–è¡¥å……ï¼š é€»è¾‘æˆ– ||ï¼šä¸€çœŸä¸ºçœŸï¼Œa || bï¼Œåªè¦aä¸ºçœŸå°±è¿”å›açš„æ‰§è¡Œç»“æœï¼Œbä¸æ‰§è¡Œï¼›aä¸ºå‡åˆ™æ‰§è¡Œbï¼Œå¹¶è¿”å›bæ‰§è¡Œåçš„ç»“æœ é€»è¾‘ä¸ &amp;&amp;ï¼šä¸€å‡ä¸ºå‡ï¼Œa &amp;&amp; bï¼Œåªè¦aä¸ºå‡å°±è¿”å›açš„æ‰§è¡Œç»“æœï¼Œbä¸æ‰§è¡Œï¼›aä¸ºçœŸåˆ™æ‰§è¡Œbï¼Œå¹¶è¿”å›bæ‰§è¡Œåçš„ç»“æœ è½¬æ¢ä¸ºä¸ºstring æ˜¾å¼ï¼šString() æ–¹æ³•å¯ä»¥ç”¨æ¥æ˜¾å¼å°†å€¼è½¬ä¸ºå­—ç¬¦ä¸²ã€‚ String([1,2,3]) // &quot;1,2,3&quot;String(&#123;&#125;) // &#x27;[object Object]&#x27;String(true) // &#x27;true&#x27; éšå¼ï¼šéšå¼è½¬æ¢é€šå¸¸åœ¨æœ‰ + è¿ç®—ç¬¦å¹¶ä¸”åªæ˜¯è‡³å°‘æœ‰ä¸€ä¸ªæ“ä½œæ•°æ˜¯ string ç±»å‹æ—¶è¢«è§¦å‘ï¼Œå³å­—ç¬¦ä¸²æ‹¼æ¥ 1 + &#x27;123&#x27; //&quot;1123&quot; 1 + &#123;&#125; // &#x27;1[object Object]&#x27;&#x27;1&#x27; + null // &#x27;1null&#x27; æŠŠå¼•ç”¨ç±»å‹è½¬æ¢ä¸ºStringæ—¶å°±ä¼šè°ƒç”¨Object.prototype.toString(), è¾“å‡ºçš„æ ¼å¼æ˜¯[object å¯¹è±¡çš„ç±»å‹] null ä¸å­—ç¬¦ä¸²æ‹¼æ¥æ—¶nullç›´æ¥è½¬ä¸º â€˜nullâ€™ (å†…éƒ¨çš„å®ç°) è½¬æ¢ä¸ºnumber æ˜¾å¼ï¼šNumber()æ–¹æ³•å¯ä»¥ç”¨æ¥æ˜¾å¼å°†å€¼è½¬æ¢æˆæ•°å­—ç±»å‹ å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—ï¼šç©ºå­—ç¬¦ä¸²å˜ä¸º0ï¼Œå¦‚æœå‡ºç°ä»»ä½•ä¸€ä¸ªéæœ‰æ•ˆæ•°å­—å­—ç¬¦ï¼Œç»“æœéƒ½æ˜¯NaN Number(&quot;&quot;) //0Number(&quot;10px&quot;) //NaNNumber(&quot;10&quot;) //10 å¸ƒå°”è½¬æ¢ä¸ºæ•°å­— Number(true) // 1Number(false) // 0 null å’Œ undefined è½¬æ¢æˆæ•°å­— Number(null) // 0Number(undefined) // NaN Symbolæ— æ³•è½¬æ¢ä¸ºæ•°å­— Number(Symbol()) // Cannot convert a Symbol value to a number BigInt Number(BigInt(10)) // 10Number(10n) // 10 BigInt æ˜¯ä¸€ç§å†…ç½®å¯¹è±¡ï¼Œå®ƒæä¾›äº†ä¸€ç§æ–¹æ³•æ¥è¡¨ç¤ºå¤§äº 2^53 - 1 çš„æ•´æ•°ã€‚BigInt å¯ä»¥è¡¨ç¤ºä»»æ„å¤§çš„æ•´æ•°ã€‚ å¯ä»¥ç”¨åœ¨ä¸€ä¸ªæ•´æ•°å­—é¢é‡åé¢åŠ  n çš„æ–¹å¼å®šä¹‰ä¸€ä¸ª BigInt ï¼Œå¦‚ï¼š10nï¼Œæˆ–è€…è°ƒç”¨å‡½æ•° BigInt()ï¼ˆä½†ä¸åŒ…å« new è¿ç®—ç¬¦ï¼‰å¹¶ä¼ é€’ä¸€ä¸ªæ•´æ•°å€¼æˆ–å­—ç¬¦ä¸²å€¼,å¦‚BigInt(10) å¯¹è±¡è½¬æ¢ä¸ºæ•°å­—ï¼Œä¼šæŒ‰ç…§ä¸‹é¢çš„æ­¥éª¤æ‰§è¡Œ å…ˆè°ƒç”¨å¯¹è±¡çš„ Symbol.toPrimitive è¿™ä¸ªæ–¹æ³•ï¼Œå¦‚æœä¸å­˜åœ¨è¿™ä¸ªæ–¹æ³• MDNï¼šhttps://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Symbol/toPrimitive å†è°ƒç”¨å¯¹è±¡çš„ valueOf() è·å–åŸå§‹å€¼ï¼Œå¦‚æœè·å–çš„å€¼ä¾ç„¶ä¸æ˜¯æ•°å­— valueOf() æ–¹æ³•è¿”å›æŒ‡å®šå¯¹è±¡çš„åŸå§‹å€¼ã€‚ å†è°ƒç”¨å¯¹è±¡çš„ toString() æŠŠå…¶å˜ä¸ºå­—ç¬¦ä¸² æŠŠå¼•ç”¨ç±»å‹è½¬æ¢ä¸ºStringæ—¶å°±ä¼šè°ƒç”¨Object.prototype.toString(), è¾“å‡ºçš„æ ¼å¼æ˜¯[object å¯¹è±¡çš„ç±»å‹] æœ€åå†æŠŠå­—ç¬¦ä¸²åŸºäºNumber()æ–¹æ³•è½¬æ¢ä¸ºæ•°å­— let obj = &#123; name:&#x27;xxx&#x27;&#125;console.log(obj-10) // æ•°å­¦è¿ç®—ï¼šå…ˆæŠŠobjéšå¼è½¬æ¢ä¸ºæ•°å­—ï¼Œå†è¿›è¡Œè¿ç®—//è¿è¡Œæœºåˆ¶obj[Symbol.toPrimitive] //undifined obj.valueof() // &#123;name:xxx&#125;obj.toString() // &#x27;[object Object]&#x27;Number (&quot;[object object]&quot;) // NaNNaN-10 // NaN éšå¼ number çš„éšå¼ç±»å‹è½¬æ¢æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œå› ä¸ºå®ƒå¯ä»¥åœ¨ä¸‹é¢å¤šç§æƒ…å†µä¸‹è¢«è§¦å‘ æ¯”è¾ƒæ“ä½œï¼ˆ&gt;, &lt;, &lt;=, &gt;=ï¼‰ æŒ‰ä½æ“ä½œï¼ˆ| &amp; ^ ~ï¼‰ ç®—æ•°æ“ä½œï¼ˆ- + * / %ï¼‰ï¼Œ æ³¨æ„ï¼šå½“ +å­˜åœ¨ä»»æ„çš„æ“ä½œæ•°æ˜¯ string ç±»å‹æ—¶ï¼Œè½¬æ¢åˆ°stringç±»å‹ä¸ºæ­¢ï¼Œä¸ä¼šè§¦å‘ number ç±»å‹çš„éšå¼è½¬æ¢ ä¸€å…ƒ + æ“ä½œ ä¸€å…ƒå°±æ˜¯åªæœ‰ä¸€ä¸ªæ“ä½œæ•°ï¼Œ+5 +[] +[] --&gt; 0 ç›¸å½“äºNumber([]) +{} --&gt; NaN ç›¸å½“äºString({})=â€˜[object,Object]â€™ï¼›Number(â€˜[object,Object]â€™) --&gt;NaN éœ€è¦æ³¨æ„çš„æƒ…å†µ javascriptä¸­åŠ æ³•ä¼šè§¦å‘3ç§ç±»å‹è½¬æ¢ï¼Œå³å°†å€¼è½¬æ¢ä¸ºåŸå§‹å€¼ï¼Œè½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œè½¬æ¢ä¸ºæ•°å­—ã€‚è¿™åˆšå¥½å¯¹åº”äº†javascriptå¼•æ“å†…éƒ¨çš„è½¬æ¢æ“ä½œï¼šToPrimitive(),toString(),toNumber() &#123;&#125; + [] === 0 // true[] + &#123;&#125; === 0 // false// &#123;&#125; + []ï¼Œå¯¹äºç¼–è¯‘å™¨æ¥è¯´,&#123;&#125;åœ¨å¼€å¤´ï¼Œè¢«è§£ææˆä»£ç å—ï¼Œä¸ä¼šè¿”å›ä»»ä½•å€¼// æ‰€ä»¥&#123;&#125; + []å®é™…ä¸Šå°±æ˜¯ +[]// []é€šè¿‡ToPrimitive(),toString() å˜æˆ &quot;&quot;// æœ€å toNumber() --&gt; 0[] + &#123;&#125; // è¿™é‡Œ&#123;&#125;å°±æ˜¯ä¸€ä¸ªå¯¹è±¡// String([])=&#x27;&#x27; String(&#123;&#125;)=&#x27;[object Object]&#x27; // æœ‰stringç±»å‹ä¸ä¼šè§¦å‘numberè½¬æ¢äº†,ä¸¤è¾¹éƒ½æ˜¯stringç›´æ¥æ‹¼æ¥// æ‰€ä»¥ &#x27;&#x27; + &#x27;[object Object]&#x27; --&gt; &#x27;[object Object]&#x27; æ“ä½œç¬¦ == ä¸¤è¾¹çš„éšå¼è½¬æ¢ å¦‚æœä¸¤è¾¹çš„æ•°æ®ç±»å‹ä¸åŒï¼Œéœ€è¦å…ˆè½¬ä¸ºç›¸åŒç±»å‹å†è¿›è¡Œæ¯”è¾ƒ å¯¹è±¡ == å­—ç¬¦ä¸² [1,2,3] == &#x27;1,2,3&#x27; // true// è½¬ä¸ºå­—ç¬¦ä¸²// [1,2,3].toString() --&gt; &#x27;1,2,3&#x27;&#123;name:&#x27;helo&#x27;&#125; == &quot;&#123;name:&#x27;helo&#x27;&#125;&quot; // false// &#123;name:&#x27;helo&#x27;&#125;.valueOf().toString() --&gt; &#x27;[object Object]&#x27; null/ undefined null == undefined // truenull === undefined // false//null/undefinedå’Œå…¶ä»–ä»»ä½•å€¼éƒ½ä¸ç›¸ç­‰ å¯¹è±¡ == å¯¹è±¡ &#123;&#125; == &#123;&#125; // false æ¯”è¾ƒçš„æ˜¯å †å†…å­˜åœ°å€ï¼Œåœ°å€ç›¸åŒæ‰ç›¸ç­‰ NaN NaN == xxx éƒ½æ˜¯false é™¤äº†ä»¥ä¸Šçš„å››ç§æƒ…å†µï¼Œåªè¦ä¸¤è¾¹ç±»å‹ä¸ä¸€è‡´ï¼Œéƒ½æ˜¯è½¬æ¢ä¸ºæ•°å­—å†è¿›è¡Œæ¯”è¾ƒ æœ€åï¼Œçœ‹é¢˜ï¼š let result = 100 + true + 21.2 + null + undefined + &quot;Tencent&quot; + [] + null + 9 + false å‚è€ƒèµ„æ–™ï¼š https://juejin.cn/post/6956170676327677966 æ•°æ®ç±»å‹çš„åˆ¤æ–­ https://juejin.cn/post/7061588533214969892#heading-29 æŠŠå¼•ç”¨ç±»å‹è½¬æ¢ä¸ºStringæ—¶å°±ä¼šè°ƒç”¨Object.prototype.toString(), è¾“å‡ºçš„æ ¼å¼æ˜¯[object å¯¹è±¡çš„ç±»å‹] Object.prototype.toString.call() æœ‰æ˜¾å¼ç»‘å®šï¼Œ å› æ­¤ Object.prototype.toString.call(xxx)å°±æ˜¯ æ‰¾åˆ°xxxä¸­çš„toStringæ–¹æ³•ï¼Œè¾“å‡ºçš„å¯¹è±¡çš„ç±»å‹å°±æ˜¯æ ¹æ®xxxæ¥çš„ ç¥å¥‡çš„åŠ æ³• https://blog.csdn.net/dk2290/article/details/86534595","categories":[{"name":"JavaScript","slug":"JavaScript","permalink":"https://hillyee.github.io/categories/JavaScript/"}],"tags":[{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"https://hillyee.github.io/tags/%E9%9D%A2%E8%AF%95/"}]},{"title":"08_JSé¢å‘å¯¹è±¡","slug":"08-JSé¢å‘å¯¹è±¡","date":"2022-04-02T08:37:13.000Z","updated":"2022-04-10T05:51:04.487Z","comments":true,"path":"2022/04/02/08-JSé¢å‘å¯¹è±¡/","link":"","permalink":"https://hillyee.github.io/2022/04/02/08-JS%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/","excerpt":"","text":"æ·±å…¥JSé¢å‘å¯¹è±¡ é¢å‘å¯¹è±¡åˆè¯† åˆ›å»ºå¯¹è±¡çš„æ–¹å¼ // æ–¹å¼ä¸€ï¼šé€šè¿‡new Object()åˆ›å»ºvar obj = new Object()obj.name = &quot;hill&quot;obj.age = 18obj.running = function() &#123; console.log(this.name + &quot; is running&quot;);&#125;// æ–¹å¼äºŒï¼šå­—é¢é‡å½¢å¼var info = &#123; name: &#x27;hill&#x27;, age: 18, eating: function() &#123; console.log(this.name + &#x27;is&#x27; + this.age); &#125;&#125; å¯¹å±æ€§çš„æ“ä½œ var obj = &#123; name: &quot;yuzi&quot;, age: 18&#125;// 1.è·å–å±æ€§console.log(obj.name); // yuzi// 2.ç»™å±æ€§èµ‹å€¼obj.name = &quot;jackson&quot;console.log(obj.name); // jackson// 3.åˆ é™¤å±æ€§// delete obj.name// console.log(obj); // &#123;age: 18&#125;// 4.éå†å±æ€§for (var key in obj) &#123; console.log(key); // name age&#125; è¿™ç§ç›´æ¥å®šä¹‰åœ¨å¯¹è±¡å†…éƒ¨æˆ–è€…ç›´æ¥æ·»åŠ åˆ°å¯¹è±¡å†…éƒ¨çš„å±æ€§ï¼Œæˆ‘ä»¬ä¸èƒ½å¯¹å…¶åšå‡ºé™åˆ¶ï¼šæ¯”å¦‚è¿™ä¸ªå±æ€§æ˜¯å¦å¯ä»¥é€šè¿‡deleteåˆ é™¤ï¼Œæ˜¯å¦å¯ä»¥åœ¨for-inéå†çš„æ—¶å€™è¢«éå†å‡ºæ¥ Object.defineProperty() å¦‚æœæˆ‘ä»¬æƒ³è¦å¯¹ä¸€ä¸ªå±æ€§è¿›è¡Œæ¯”è¾ƒç²¾å‡†çš„æ“ä½œæ§åˆ¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å±æ€§æè¿°ç¬¦ é€šè¿‡å±æ€§æè¿°ç¬¦å¯ä»¥ç²¾å‡†çš„æ·»åŠ æˆ–ä¿®æ”¹å¯¹è±¡çš„å±æ€§ å±æ€§æè¿°ç¬¦éœ€è¦ä½¿ç”¨ Object.defineProperty æ¥å¯¹å±æ€§è¿›è¡Œæ·»åŠ æˆ–ä¿®æ”¹ Object.defineProperty() æ–¹æ³•ä¼šç›´æ¥åœ¨ä¸€ä¸ªå¯¹è±¡ä¸Šå®šä¹‰ä¸€ä¸ªæ–°å±æ€§ï¼Œæˆ–è€…ä¿®æ”¹ä¸€ä¸ªå¯¹è±¡çš„ç°æœ‰å±æ€§ï¼Œå¹¶è¿”å›æ­¤å¯¹è±¡ æ¥æ”¶ä¸‰ä¸ªå‚æ•° obj:è¦å®šä¹‰å±æ€§çš„å¯¹è±¡ prop: è¦å®šä¹‰æˆ–ä¿®æ”¹çš„å±æ€§çš„åç§°æˆ–Symbol descriptorï¼šè¦å®šä¹‰æˆ–ä¿®æ”¹çš„å±æ€§æè¿°ç¬¦ ç¬¬ä¸‰ä¸ªå‚æ•°çš„å±æ€§æè¿°ç¬¦åˆ†ä¸ºä¸¤ç±»ï¼š æ•°æ®å±æ€§æè¿°ç¬¦ configurableï¼Œenumerableï¼Œwritableï¼Œvalue // ç›´æ¥åœ¨ä¸€ä¸ªå¯¹è±¡ä¸Šå®šä¹‰æŸä¸ªå±æ€§æ—¶ï¼Œæè¿°ç¬¦çš„é»˜è®¤å€¼ä¸º// value: èµ‹å€¼çš„value// configurable: true// enumerable: true// writable: truevar obj = &#123; name: &#x27;jackson&#x27;, age: 18&#125;Object.defineProperty(obj, &quot;height&quot;, &#123; value: 1.88, // å±æ€§å€¼(é»˜è®¤ä¸º undefined) enumerable: true, // å¯¹åº”å±æ€§æ˜¯å¦å¯ä»¥æšä¸¾(é»˜è®¤ä¸ºfalse) writable: true, // æ˜¯å¦å¯ä»¥ä¿®æ”¹å±æ€§å€¼(é»˜è®¤ä¸ºfalse) configurable: true, // å±æ€§èƒ½å¦è¢«åˆ é™¤(é»˜è®¤ä¸ºfalse),å±æ€§çš„æè¿°ç¬¦èƒ½å¦è¢«æ”¹å˜&#125;)// æšä¸¾for(var key in obj) &#123; console.log(key); // name age height å¯æšä¸¾&#125;console.log(Object.keys(obj)); // [ &#x27;name&#x27;, &#x27;age&#x27;, &#x27;height&#x27; ] å¯æšä¸¾// ä¿®æ”¹å±æ€§å€¼obj.height = 2console.log(obj.height); // 2 å¯ä¿®æ”¹// åˆ é™¤å±æ€§delete obj.heightconsole.log(obj.height); // undefined åˆ é™¤æˆåŠŸ å­˜å–å±æ€§æè¿°ç¬¦ enumerableï¼Œconfigurableï¼Œgetï¼Œset ä¸ç”¨value,writableï¼Œè€Œæ˜¯ç”¨ get,set var obj = &#123; name: &#x27;jackson&#x27;, age: 18, _address: &quot;å¹¿ä¸œ&quot; &#125;// ç§æœ‰å±æ€§ï¼Œjsé‡Œé¢æ˜¯æ²¡æœ‰ä¸¥æ ¼æ„ä¹‰çš„ç§æœ‰å±æ€§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å®é™…ä¸Šä¹Ÿèƒ½ç›´æ¥è®¿é—®ï¼Œä½†æ˜¯åœ¨ç¤¾åŒºäººä»¬çº¦å®š ä¸‹åˆ’çº¿_å¼€å¤´çš„å±æ€§å®šä¹‰ä¸ºç§æœ‰å±æ€§// 1.éšè—æŸä¸€ä¸ªç§æœ‰å±æ€§(address)ä¸å¸Œæœ›ç›´æ¥è¢«å¤–ç•Œä½¿ç”¨å’Œèµ‹å€¼// 2.å¦‚æœæˆ‘ä»¬å¸Œæœ›æˆªè·æŸä¸ªå±æ€§è¢«è®¿é—®å’Œè®¾ç½®å€¼çš„è¿‡ç¨‹æ—¶ï¼Œä¹Ÿä¼šä½¿ç”¨å­˜å‚¨å±æ€§æè¿°ç¬¦Object.defineProperty(obj, &quot;address&quot;, &#123; enumerable: true, // å¯æšä¸¾ configurable: true, // å¯åˆ é™¤ï¼Œå¯ä¿®æ”¹æè¿°ç¬¦ get: function() &#123; console.log(&quot;è·å–äº†ä¸€æ¬¡addressçš„å€¼&quot;) return this._address &#125;, set: function(value) &#123; console.log(&quot;è®¾ç½®äº†addressçš„å€¼&quot;) this._address = value &#125;&#125;)console.log(obj.address); // å¹¿ä¸œ å¯æšä¸¾å±æ€§çš„è¡¥å…… var obj = &#123; name: &quot;why&quot;, age: 18&#125;Object.defineProperty(obj, &quot;address&quot;, &#123; value: &quot;åŒ—äº¬å¸‚&quot;&#125;)console.log(obj)// addresså±æ€§é»˜è®¤æ˜¯ä¸å¯æšä¸¾çš„ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸Šé¢æ˜¯å¯ä»¥çœ‹åˆ°çš„ï¼ˆç¨å¾®æµ…è‰²ä¸€ç‚¹ï¼‰ï¼Œè¿™æ˜¯æµè§ˆå™¨ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬è°ƒè¯•åšçš„å¤„ç† Object.defineProperties() Object.defineProperties() æ–¹æ³•å¯ä»¥ç›´æ¥åœ¨ä¸€ä¸ªå¯¹è±¡ä¸Šå®šä¹‰å¤šä¸ªæ–°çš„å±æ€§ var obj = &#123; _age: 18&#125;Object.defineProperties(obj, &#123; name: &#123; writable: true, value: &#x27;jackson&#x27; &#125;, age: &#123; get: function() &#123; return this._age &#125; &#125;&#125;) å¯¹è±¡æ–¹æ³•è¡¥å……(äº†è§£) è·å–å¯¹è±¡çš„å±æ€§æè¿°ç¬¦ getOwnPropertyDescriptor getOwnPropertyDescriptors ç¦æ­¢å¯¹è±¡æ‰©å±•æ–°å±æ€§ preventExtensionsï¼šç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ æ–°çš„å±æ€§ä¼šå¤±è´¥(åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ä¼šæŠ¥é”™) å¯†å°å¯¹è±¡ï¼Œä¸å…è®¸é…ç½®å’Œåˆ é™¤å±æ€§ï¼šseal å®é™…æ˜¯è°ƒç”¨preventExtensions å¹¶ä¸”å°†ç°æœ‰å±æ€§çš„configurable:false å†»ç»“å¯¹è±¡ï¼Œä¸å…è®¸ä¿®æ”¹ç°æœ‰å±æ€§ï¼šfreeze å®é™…ä¸Šæ˜¯è°ƒç”¨seal å¹¶ä¸”å°†ç°æœ‰å±æ€§çš„writable: false åˆ›å»ºå¤šä¸ªå¯¹è±¡çš„æ–¹å¼ é€šè¿‡æƒ³è¦åˆ›å»ºå¤šä¸ªå¯¹è±¡çš„ç›®çš„ï¼Œæ¥å¼•å‡ºåé¢çš„æ„é€ å‡½æ•° å‰é¢æˆ‘ä»¬é€šè¿‡ new Objectï¼Œå­—é¢é‡çš„æ–¹å¼åˆ›å»ºå¯¹è±¡ï¼Œä½†æ˜¯è¿™ä¸¤ç§æ–¹å¼æœ‰ä¸€ä¸ªå¾ˆå¤§çš„å¼Šç«¯ï¼š åˆ›å»ºåŒæ ·çš„å¯¹è±¡æ—¶ï¼Œéœ€è¦ç¼–å†™é‡å¤ä»£ç  æ¯”å¦‚è¯´å­—é¢é‡ï¼š var p1 = &#123;name: , age: &#125;var p2 = &#123;name: , age: &#125;var p3 = &#123;name: , age: &#125; // å®ƒä»¬æœ‰åŒæ ·çš„å±æ€§æˆ–è€…æ–¹æ³• åˆ›å»ºå¯¹è±¡çš„æ–¹å¼ - å·¥å‚æ¨¡å¼ å·¥å‚æ¨¡å¼å…¶å®æ˜¯ä¸€ç§å¸¸è§çš„è®¾è®¡æ¨¡å¼ é€šå¸¸æˆ‘ä»¬ä¼šæœ‰ä¸€ä¸ªå·¥å‚æ–¹æ³•ï¼Œé€šè¿‡è¯¥å·¥å‚æ–¹æ³•æˆ‘ä»¬å¯ä»¥äº§ç”Ÿæƒ³è¦çš„å¯¹è±¡ å·¥å‚æ–¹æ³•åˆ›å»ºå¯¹è±¡æœ‰ä¸€ä¸ªæ¯”è¾ƒå¤§çš„é—®é¢˜ï¼šæˆ‘ä»¬åœ¨æ‰“å°å¯¹è±¡æ—¶ï¼Œå¯¹è±¡çš„ç±»å‹éƒ½æ˜¯Objectç±»å‹ ä½†æ˜¯ä»æŸäº›è§’åº¦æ¥è¯´ï¼Œè¿™äº›å¯¹è±¡åº”è¯¥æœ‰ä¸€ä¸ªä»–ä»¬å…±åŒçš„ç±»å‹ function createPerson(name, age, height) &#123; var p = &#123;&#125; // å®šä¹‰ä¸€ä¸ªå¯¹è±¡ p.name = name p.age = age p.height = height p.eating = function() &#123; console.log(this.name + &quot;is eating&quot;); &#125; return p // æŠŠå¯¹è±¡è¿”å›&#125;var p1 = createPerson(&quot;å¼ ä¸‰&quot;, 18, 1.88)var p2 = createPerson(&quot;æå››&quot;, 20, 1.98)var p3 = createPerson(&quot;ç‹äº”&quot;, 30, 1.78)// å·¥å‚æ¨¡å¼çš„ç¼ºç‚¹ï¼šè·å–ä¸åˆ°å¯¹è±¡æœ€çœŸå®çš„ç±»å‹console.log(p1, p2, p3); // æˆ‘åªçŸ¥é“ä½ æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä½†æˆ‘ä¸çŸ¥é“ä½ æ˜¯personç±»å‹ è®¤è¯†æ„é€ å‡½æ•° ä»€ä¹ˆæ˜¯æ„é€ å‡½æ•°ï¼Ÿ æ„é€ å‡½æ•°ä¹Ÿç§°ä¹‹ä¸ºæ„é€ å™¨ï¼ˆconstructorï¼‰ï¼Œé€šå¸¸æˆ‘ä»¬åœ¨åˆ›å»ºå¯¹è±¡æ—¶ä¼šè°ƒç”¨çš„å‡½æ•° JavaScript ä¸­ï¼Œå¦‚æœä¸€ä¸ªæ™®é€šçš„å‡½æ•°è¢«ä½¿ç”¨ new æ“ä½œç¬¦æ¥è°ƒç”¨äº†ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°å°±ç§°ä¹‹ä¸ºæ˜¯ä¸€ä¸ªæ„é€ å‡½æ•° æ‰€ä»¥è¯´æ„é€ å‡½æ•°ä¹Ÿæ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œåªä¸è¿‡ç”¨ new å»è°ƒç”¨ï¼Œå°±ç§°ä¸ºæ„é€ å‡½æ•° newä¹Ÿæ˜¯å¯ä»¥è°ƒç”¨å‡½æ•°çš„å–” newæ“ä½œç¬¦ å¦‚æœä¸€ä¸ªå‡½æ•°è¢«ä½¿ç”¨newæ“ä½œç¬¦è°ƒç”¨äº†ï¼Œé‚£ä¹ˆå®ƒä¼šæ‰§è¡Œå¦‚ä¸‹æ“ä½œï¼š åœ¨å†…å­˜ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼ˆç©ºå¯¹è±¡ï¼‰ è¿™ä¸ªå¯¹è±¡å†…éƒ¨çš„ **[[prototype]]**å±æ€§ä¼šè¢«èµ‹å€¼ä¸ºè¯¥æ„é€ å‡½æ•°çš„ prototypeå±æ€§ æ„é€ å‡½æ•°çš„ this ï¼Œä¼šæŒ‡å‘åˆ›å»ºå‡ºæ¥çš„æ–°å¯¹è±¡ æ‰§è¡Œå‡½æ•°çš„å†…éƒ¨ä»£ç  å¦‚æœæ„é€ å‡½æ•°æ²¡æœ‰è¿”å›éç©ºå¯¹è±¡ï¼Œåˆ™è¿”å›åˆ›å»ºå‡ºæ¥çš„æ–°å¯¹è±¡ æ„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡ // è§„èŒƒï¼šæ„é€ å‡½æ•°çš„é¦–å­—æ¯ä¸€èˆ¬æ˜¯å¤§å†™function Person(name, age, height, address) &#123; this.name = name this.age = age this.height = height this.address = address this.eating = function() &#123; console.log(this.name + &quot;is eating&quot;); &#125; this.running = function() &#123; console.log(this.name + &#x27;is running&#x27;); &#125;&#125;var p1 = new Person(&quot;å¼ ä¸‰&quot;, 18, 1.88, &#x27;å¹¿å·&#x27;)var p2 = new Person(&quot;æå››&quot;, 20, 1.78, &#x27;åŒ—äº¬&#x27;)console.log(p1); // Person &#123;...&#125; æ˜¯å¯ä»¥çœ‹è§ç±»å‹çš„console.log(p2); è¿™ä¸ªæ„é€ å‡½æ•°å¯ä»¥ç¡®ä¿æˆ‘ä»¬çš„å¯¹è±¡æ˜¯æœ‰Personçš„ç±»å‹çš„ ä½†æ˜¯ä¹Ÿæœ‰ç¼ºç‚¹ï¼šæˆ‘ä»¬éœ€è¦ç»™æ¯ä¸ªå¯¹è±¡çš„å‡½æ•°å»åˆ›å»ºä¸€ä¸ªå‡½æ•°å¯¹è±¡å®ä¾‹ï¼ˆå¼€è¾Ÿæ–°çš„å†…å­˜ç©ºé—´ï¼‰ å¯¹è±¡çš„åŸå‹ [[prototype]] JavaScript ä¸­ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªç‰¹æ®Šçš„å†…ç½®å±æ€§ [[prototype]]ï¼Œè¿™ä¸ªå±æ€§ç§°ä¹‹ä¸ºå¯¹è±¡çš„åŸå‹ï¼ˆéšå¼åŸå‹ï¼‰ï¼ˆåªè¦æ˜¯å¯¹è±¡ï¼Œå°±ä¼šæœ‰è¿™ä¸ªå†…ç½®å±æ€§ï¼‰ [[prototype]] æŒ‡å‘ä¸€ä¸ªå¯¹è±¡ï¼ˆä¹Ÿå°±æ˜¯è¯´å®ƒä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼‰ é‚£ä¹ˆè¿™ä¸ªå¯¹è±¡æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ å½“æˆ‘ä»¬é€šè¿‡å¼•ç”¨å¯¹è±¡çš„å±æ€§keyæ¥è·å–ä¸€ä¸ªvalueæ—¶ï¼Œå®ƒä¼šè§¦å‘ [[Get]]çš„æ“ä½œ è¿™ä¸ªæ“ä½œä¼šé¦–å…ˆæ£€æŸ¥è¯¥å±æ€§æ˜¯å¦æœ‰å¯¹åº”çš„å±æ€§ï¼Œå¦‚æœæœ‰çš„è¯å°±ä½¿ç”¨å®ƒ å¦‚æœå¯¹è±¡ä¸­æ²¡æœ‰è¯¥å±æ€§ï¼Œ é‚£ä¹ˆä¼šæ²¿ç€å®ƒçš„åŸå‹å»æŸ¥æ‰¾ [[prototype]] å¦‚æœé€šè¿‡å­—é¢é‡ç›´æ¥åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡ä¹Ÿæœ‰[[prototype]]è¿™ä¸ªå±æ€§ å¦‚ä½•æŸ¥çœ‹è¿™ä¸ªå±æ€§å‘¢ var obj = &#123; name: &quot;jackson&quot;&#125;var info = &#123;&#125;// åˆ›å»ºå‡ºæ¥çš„å¯¹è±¡ä¸Šéƒ½æœ‰ [[prototype]]å±æ€§// å¦‚ä½•æŸ¥çœ‹è¿™ä¸ªå±æ€§ï¼Ÿ// æ—©æœŸçš„ECMAæ˜¯æ²¡æœ‰è§„èŒƒå¦‚ä½•å»æŸ¥çœ‹ [[prototype]]// ç»™å¯¹è±¡ä¸­æä¾›äº†ä¸€ä¸ªå±æ€§ __proto__, å¯ä»¥è®©æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹è¿™ä¸ªåŸå‹å¯¹è±¡(æµè§ˆå™¨æä¾›)console.log(obj.__proto__);// [Object: null prototype] &#123;&#125;// ç›¸å½“äº(ä¼ªä»£ç )var obj = &#123;name: &#x27;jackson&#x27;, __proto__: &#123;&#125;&#125;// ES5ä¹‹åæä¾›çš„Object.getPrototypeOf()æŸ¥çœ‹console.log(Object.getPrototypeOf(obj)); // &#123;&#125;// ä¾‹å¦‚æ‰¾ age è¿™ä¸ªå±æ€§ï¼Œè¯¥å¯¹è±¡æœ¬èº«æ²¡æœ‰ï¼Œæ²¿ç€åŸå‹æŸ¥æ‰¾obj.__proto__.age = 18console.log(obj.age); // 18 å‡½æ•°çš„åŸå‹ prototype æ‰€æœ‰çš„å‡½æ•°éƒ½æœ‰ä¸€ä¸ª prototype å±æ€§ï¼ˆæ˜¾å¼åŸå‹ï¼‰ function Foo() &#123;&#125;// å‡½æ•°ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥å®ƒä¹Ÿæ˜¯æœ‰[[prototype]]éšå¼å±æ€§// å¦å¤–ï¼Œå‡½æ•°è¿˜ä¼šå¤šå‡ºæ¥ä¸€ä¸ªæ˜¾å¼åŸå‹å±æ€§ï¼šprototypeconsole.log(Foo.prototype); å†çœ‹å›newæ“ä½œç¬¦å…¶ä¸­çš„ä¸€ä¸ªæ­¥éª¤ï¼š è¿™ä¸ªå¯¹è±¡å†…éƒ¨çš„[[prototype]]å±æ€§ä¼šè¢«èµ‹å€¼ä¸ºè¯¥æ„é€ å‡½æ•°çš„prototypeå±æ€§ ä¹Ÿå°±æ„å‘³ç€æˆ‘ä»¬é€šè¿‡ Foo æ„é€ å‡½æ•°åˆ›å»ºå‡ºçš„æ‰€æœ‰å¯¹è±¡çš„ [[prototype]] éƒ½æŒ‡å‘ Foo.prototype var f1 = new Foo()var f2 = new Foo()console.log(f1.__proto__ === Foo.prototype); // trueconsole.log(f2.__proto__ === Foo.prototype); // true åˆ›å»ºå¯¹è±¡çš„å†…å­˜è¡¨ç° å¯ä»¥çœ‹åˆ°ï¼š æ„é€ å‡½æ•°çš„ prototype å±æ€§æŒ‡å‘è¯¥å‡½æ•°çš„åŸå‹å¯¹è±¡ åŸå‹å¯¹è±¡èº«ä¸Šæœ‰ä¸€ä¸ª constructor å±æ€§æŒ‡å›æ„é€ å‡½æ•°æœ¬èº« newå‡ºæ¥çš„å®ä¾‹å¯¹è±¡ p1ï¼Œp2 å¯¹è±¡èº«ä¸Šæœ‰ __proto__å±æ€§ä¹ŸæŒ‡å‘æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ å‡½æ•°åŸå‹ä¸Šçš„å±æ€§constructor é»˜è®¤æƒ…å†µä¸‹åŸå‹ä¸Šéƒ½ä¼šæ·»åŠ ä¸€ä¸ªå±æ€§å«åšconstructorï¼Œè¿™ä¸ªconstructoræŒ‡å‘å½“å‰çš„å‡½æ•°å¯¹è±¡ function Foo() &#123;&#125;// 1. constructorå±æ€§// Foo.prototypeè¿™ä¸ªå¯¹è±¡ä¸­æœ‰ä¸€ä¸ªconstructorå±æ€§console.log(Foo.prototype); // &#123;&#125; ä¸ºä»€ä¹ˆæ²¡çœ‹åˆ°constructorï¼Ÿ// é‚£æ¢ä¸€ç§æ–¹å¼çœ‹console.log(Object.getOwnPropertyDescriptors(Foo.prototype));//æ‰“å° // &#123;// constructor: &#123;// value: [Function: Foo],// writable: true, // enumerable: false,// configurable: true// &#125;// &#125;// å¯ä»¥çœ‹åˆ°enumerableä¸ºfalseï¼Œæ‰€ä»¥ç¬¬ä¸€ç§æ–¹å¼ä¸èƒ½çœ‹åˆ°constructor// æ—¢ç„¶è¿™æ ·ï¼Œæˆ‘ä»¬èƒ½ä¸èƒ½é‡å†™è¿™ä¸ªå¯¹è±¡çš„å±æ€§constructorå‘¢ï¼Ÿè‚¯å®šå¯ä»¥å‘€Object.defineProperty(Foo.prototype, &quot;constructor&quot;, &#123; enumerable: true, //å¯æšä¸¾ configurable: true, // å¯åˆ é™¤ï¼Œæè¿°ç¬¦å¯ä¿®æ”¹ writable: true, // å¯å†™ value: &#x27;hahahha&#x27;&#125;)// è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å†æ¥ç›´æ¥æ‰“å°ï¼Œå°±å¯ä»¥çœ‹åˆ°constructoräº†(è¢«æˆ‘ä»¬æ”¹æˆå¯æšä¸¾äº†)console.log(Foo.prototype);// &#123; constructor: &#x27;hahahha&#x27; &#125; æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨prototypeä¸Šæ·»åŠ è‡ªå·±çš„å±æ€§ Foo.prototype.name = &quot;jackson&quot;Foo.prototype.age = 18Foo.prototype.eating = function() &#123;&#125;// æˆ‘ä»¬å†newå¯¹è±¡çš„æ—¶å€™ï¼Œè¿™äº›å±æ€§éƒ½å¯ä»¥é€šè¿‡å®ä¾‹çš„åŸå‹__proto__æ‰¾åˆ°var f1 = new Foo()console.log(f1.name); // jacksonconsole.log(f1.__proto__); // æ‰“å°// &#123;// constructor: &#x27;hahahha&#x27;,// name: &#x27;jackson&#x27;,// age: 18,// eating: [Function (anonymous)]// &#125; ç›´æ¥ä¿®æ”¹æ•´ä¸ªprototypeå¯¹è±¡ï¼ˆèµ‹å€¼ï¼Œæ–°å¼€å†…å­˜ç©ºé—´ï¼‰ Foo.prototype = &#123; constructor: Foo, // è®©å®ƒæŒ‡å›æœ¬èº«(ä½†è¿™æ ·å®ƒé»˜è®¤æ˜¯å¯æšä¸¾çš„) name: &quot;jackson&quot;, age: 20&#125;var f1 = new Foo()console.log(f1.name); // &quot;jackson&quot;// ä¸ºäº†å¯ä»¥è‡ªå®šå±æ€§æè¿°ç¬¦,çœŸå®å¼€å‘ä¸­æˆ‘ä»¬å¯ä»¥é€šè¿‡Object.definePropertyæ·»åŠ constructorObject.defineProperty(Foo.prototype, &quot;constructor&quot;, &#123; enumerable: false, configurable: true, writable: true, value: Foo&#125;) åŸæ¥çš„fooå‡½æ•°çš„åŸå‹å¯¹è±¡å› ä¸ºæ²¡æœ‰å¯¹å®ƒçš„å¼•ç”¨ï¼Œä¼šè¢«å›æ”¶çš„ åˆ›å»ºå¯¹è±¡çš„æ–¹å¼ â€” æ„é€ å‡½æ•°å’ŒåŸå‹ç»„åˆ function Person(name, age, address) &#123; this.name = name this.age = age this.address = address // this.fn = function() // ä¸ºäº†ä¸ç»™æ¯ä¸ªå®ä¾‹éƒ½æ–°å¼€å†…å­˜ç©ºé—´ä¿å­˜ç›¸åŒçš„æ–¹æ³•ï¼Œæˆ‘ä»¬ä¸æŠŠå…±åŒçš„æ–¹æ³•å®šä¹‰åœ¨è¿™&#125;// æˆ‘ä»¬å¯ä»¥æŠŠä¸€äº›å…¬å…±çš„æ–¹æ³•ç›´æ¥é€šè¿‡åŸå‹å¯¹è±¡æ·»åŠ Person.prototype.eating = function() &#123; console.log(this.name + &#x27;is eating&#x27;); // è¿™é‡Œçš„thisæ€ä¹ˆæ‰¾åˆ°å®ä¾‹å¯¹è±¡çš„ï¼Ÿ // è°ƒç”¨å‡½æ•°çš„æ—¶å€™éšå¼ç»‘å®šå•Š&#125;Person.prototype.running = function() &#123; console.log(this.name + &#x27;is running&#x27;);&#125;var p1 = new Person(&quot;jackson&quot;, 18, &quot;guangdong&quot;)var p2 = new Person(&quot;yuzi&quot;, 18, &quot;beijing&quot;)p1.eating()p2.eating() JavaScriptä¸­çš„ç±»å’Œå¯¹è±¡ function Person() &#123;&#125; åœ¨ JS ä¸­ï¼ŒPersonåº”è¯¥è¢«ç§°ä¹‹ä¸ºæ˜¯ä¸€ä¸ªæ„é€ å‡½æ•° ä½†æ˜¯ä»å¾ˆå¤šé¢å‘å¯¹è±¡è¯­è¨€çš„å¼€å‘è€…ä¹ æƒ¯ç§°ä¹‹ä¸ºç±»ï¼Œå› ä¸ºç±»å¯ä»¥å¸®æˆ‘ä»¬åˆ›å»ºå‡ºæ¥å®ä¾‹å¯¹è±¡ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ é¢å‘å¯¹è±¡çš„ç‰¹æ€§ - ç»§æ‰¿ é¢å‘å¯¹è±¡æœ‰ä¸‰å¤§ç‰¹æ€§ï¼šå°è£…ã€ç»§æ‰¿ã€å¤šæ€ å°è£…ï¼šæˆ‘ä»¬å‰é¢å°†å±æ€§å’Œæ–¹æ³•å°è£…åˆ°ä¸€ä¸ªç±»ä¸­ï¼Œå¯ä»¥ç§°ä¹‹ä¸ºå°è£…çš„è¿‡ç¨‹ ç»§æ‰¿ï¼šç»§æ‰¿æ˜¯é¢å‘å¯¹è±¡ä¸­éå¸¸é‡è¦çš„ï¼Œä¸ä»…ä»…å¯ä»¥å‡å°‘é‡å¤ä»£ç çš„æ•°é‡ï¼Œä¹Ÿæ˜¯å¤šæ€å‰æï¼ˆçº¯é¢å‘å¯¹è±¡ä¸­ï¼‰ å¤šæ€ï¼šä¸åŒçš„å¯¹è±¡åœ¨æ‰§è¡Œæ—¶è¡¨ç°å‡ºä¸åŒçš„å½¢æ€ JavaScriptåŸå‹é“¾ åŸå‹é“¾çš„ç†è§£ var obj = &#123; name: &quot;jackson&quot;, age: 18&#125;// å½“æˆ‘ä»¬&quot;.&quot;çš„æ—¶å€™å°±æ˜¯[[get]]æ“ä½œ// 1.åœ¨å½“å‰çš„å¯¹è±¡ä¸­æŸ¥æ‰¾å±æ€§// 2.å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œè¿™ä¸ªæ—¶å€™ä¼šå»åŸå‹é“¾(__proto__)å¯¹è±¡ä¸ŠæŸ¥æ‰¾obj.__proto__ = &#123; // address: &quot;å¹¿å·å¸‚&quot;&#125;// åŸå‹é“¾obj.__proto__.__proto__= &#123; // address: &quot;å¹¿å·å¸‚&quot;&#125;obj.__proto__.__proto__.__proto__= &#123; address: &quot;å¹¿å·å¸‚&quot;&#125;console.log(obj.address); // &quot;å¹¿å·å¸‚&quot;// åªè¦åœ¨åŸå‹é“¾ä¸Šéƒ½å¯ä»¥æ‰¾åˆ°çš„ è¿™æ ·ä¸€ç›´å‘ä¸Šæ‰¾çš„è¯ï¼Œé‚£ä¹ˆé¡¶å±‚åŸå‹ç©¶ç«Ÿæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ var obj = &#123;name: &quot;Jackson&quot;&#125;// æ‰¾åˆ°é‚£ä¸€å±‚å¯¹è±¡ä¹‹åä¼šåœæ­¢ç»§ç»­æŸ¥æ‰¾å‘¢ï¼Ÿconsole.log(obj.__proto__); // å¯ä»¥çœ‹åˆ°å­—é¢é‡objçš„åŸå‹æ˜¯ [Object: null prototype] &#123;&#125;// æˆ‘ä»¬ç»§ç»­å¾€ä¸Šçœ‹çœ‹console.log(obj.__proto__.__proto__); // null// æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¯´ [Object: null prototype] &#123;&#125; å°±æ˜¯é¡¶å±‚çš„åŸå‹ é¡¶å±‚å¯¹è±¡æœ‰ä»€ä¹ˆç‰¹åˆ«å—ï¼Ÿè¯¥å¯¹è±¡ä¸Šæœ‰å¾ˆå¤šé»˜è®¤çš„å±æ€§å’Œæ–¹æ³• é¡¶å±‚åŸå‹åˆæ¥è‡ªå“ªé‡Œå‘¢ï¼Ÿä¸‹é¢æˆ‘ä»¬åˆ›å»ºObjectå¯¹è±¡çœ‹çœ‹ // åˆ›å»ºä¸€ä¸ªå¯¹è±¡(è¿™ç§æ–¹å¼ç›¸å½“äºä¸‹é¢ä¸€ç§æ–¹å¼çš„è¯­æ³•ç³–ï¼Œæœ¬è´¨éƒ½æ˜¯åˆ›å»ºä¸€ä¸ªå¯¹è±¡)var obj1 = &#123;&#125; var obj2 = new Object() // åˆ›å»ºäº†ä¸€ä¸ªå¯¹è±¡// åˆ›å»ºå¯¹è±¡çš„è¯ï¼Œå…¶ä¸­æœ‰ä¸€æ­¥æ˜¯ï¼šå°†Objectå‡½æ•°çš„æ˜¾å¼åŸå‹prototypeèµ‹å€¼ç»™å®ä¾‹çš„éšå¼åŸå‹// ç›¸å½“äºè¿™é‡Œ// Object.prototype = obj2.__proto__// å› æ­¤ï¼ˆæˆ‘ä»¬çŸ¥é“è¿™é‡Œobj1/2.__proto__å·²ç»æ˜¯åˆ°é¡¶å±‚äº†ï¼‰console.log(Object.prototype === obj1.__proto__); // trueconsole.log(Object.prototype === obj2.__proto__); // true// Object.prototypeä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆå®ƒåº”è¯¥ä¹Ÿæœ‰ __proto__console.log(Object.prototype.__proto__); // null// å› æ­¤Object.prototypeæŒ‡å‘çš„å·²ç»æ˜¯é¡¶å±‚åŸå‹äº†console.log(Object.getOwnPropertyDescriptors(Object.prototype)) // æœ‰constructor,toStringç­‰å±æ€§å’Œæ–¹æ³• å› æ­¤ï¼ŒåŸå‹é“¾æœ€é¡¶å±‚çš„åŸå‹å¯¹è±¡å°±æ˜¯Objectçš„åŸå‹å¯¹è±¡ ä¹Ÿå°±æ˜¯è¯´ï¼ŒObjectæ˜¯æ‰€æœ‰ç±»çš„çˆ¶ç±» function Person(name) &#123; this.name = name&#125;// çœ‹çœ‹æ„é€ å‡½æ•°Personçš„åŸå‹console.log(Person.prototype);// &#123;&#125; çœ‹ä¸åˆ°ï¼åº”è¯¥æ˜¯ä¸å¯æšä¸¾å§console.log(Object.getOwnPropertyDescriptors(Person.prototype));//è¾“å‡º &#123;constructor: &#123;...&#125;&#125;console.log(Person.prototype.__proto__);//[Object: null prototype] &#123;&#125; é€šè¿‡åŸå‹é“¾å®ç°ç»§æ‰¿ ä¸ºä»€ä¹ˆéœ€è¦æœ‰ç»§æ‰¿ï¼Ÿ å¦‚æœæ²¡æœ‰ç»§æ‰¿ï¼Œæˆ‘ä»¬æƒ³åˆ›å»ºå¤šä¸ªç±»ï¼Œç±»é‡Œé¢çš„å±æ€§å’Œæ–¹æ³•å¾ˆå¤šæ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¼šå†™å¾ˆå¤šé‡å¤çš„ä»£ç ï¼Œæ‰€ä»¥ä¸»è¦æ˜¯ä¸ºäº†ä»£ç çš„å¤ç”¨ // Studentfunction Student(name, age, sno) &#123; this.name = name this.age = age this.sno = sno&#125;Student.prototype.running = function() &#123;&#125;// Teacherfunction Teacher(name, age, title) &#123; this.name = name this.age = age this.title = title&#125;Teacher.prototype.running = function() &#123;&#125; åŸå‹é“¾çš„ç»§æ‰¿æ–¹æ¡ˆ è‡ªå·±ç”»ç”»å›¾æ›´å¥½ç†è§£ // çˆ¶ç±»ï¼šå…¬å…±å±æ€§å’Œæ–¹æ³•function Person() &#123; this.name = &quot;Jackson&quot;, this.friends = []&#125;Person.prototype.eating = function() &#123; console.log(this.name + &quot;is eating&quot;);&#125;// å­ç±»ï¼šç‰¹æœ‰å±æ€§å’Œæ–¹æ³•function Student() &#123; this.sno = 111&#125;// newä¸€ä¸ªpersonvar p = new Person()Student.prototype = p var stu = new Student()// console.log(stu.sno); // 111// console.log(stu.name);// Jackson// stu.eating()// åŸå‹é“¾å®ç°ç»§æ‰¿çš„å¼Šç«¯ï¼š// 1.æ‰“å°stuå¯¹è±¡ï¼Œç»§æ‰¿çš„å±æ€§æ˜¯ä¸èƒ½ç›´è§‚çœ‹åˆ°çš„// console.log(stu); // Person &#123; sno: 111 &#125;// å‰é¢æ˜¾ç¤ºçš„ Person ç±»å‹,å®é™…ä¸Šæ˜¯å®ä¾‹çš„nameå±æ€§ï¼Œæ˜¾ç„¶è¿™é‡Œåº”è¯¥æ˜¯Student// 2.åˆ›å»ºå‡ºæ¥ä¸¤ä¸ªstuå¯¹è±¡var stu1 = new Student()var stu2 = new Student()// è·å–å¼•ç”¨ï¼Œä¿®æ”¹å¼•ç”¨ä¸­çš„å€¼ï¼Œä¼šç›¸äº’å½±å“// å› ä¸ºè¿™ä¸ªfre1è¢«åŠ åˆ°på¯¹è±¡ï¼Œè€Œstu1,stu2çš„__proto__éƒ½æŒ‡å‘pstu1.friends.push(&quot;fre1&quot;)console.log(stu1.friends); // [ &#x27;fre1&#x27; ]console.log(stu2.friends); // [ &#x27;fre1&#x27; ]// 3. åœ¨å‰é¢å®ç°ç±»çš„è¿‡ç¨‹ä¸­éƒ½æ²¡æœ‰ä¼ é€’å‚æ•°var stu3 = new Student(&quot;jeccy&quot;, 112)// ç›´æ¥åœ¨function Student(name,age)&#123;this.name = name this.age = age&#125;ï¼Ÿ// è‚¯å®šä¸è¡Œå•Šï¼Œæˆ‘ä»¬æ˜¯æƒ³è¦æŠŠnameçš„å¤„ç†æ”¾åœ¨Personçš„ å€Ÿç”¨æ„é€ å‡½æ•°å®ç°ç»§æ‰¿ ä½¿ç”¨callè°ƒç”¨æ„é€ å‡½æ•°ï¼Œ // çˆ¶ç±»ï¼šå…¬å…±å±æ€§å’Œæ–¹æ³•function Person(name, age, friends) &#123; this.name = name, this.age = age this.friends = friends&#125;Person.prototype.eating = function() &#123; console.log(this.name + &quot;is eating&quot;);&#125;// å­ç±»ï¼šç‰¹æœ‰å±æ€§å’Œæ–¹æ³•function Student(name, age, friends, sno) &#123; // æˆ‘ä»¬åœ¨è¿™é‡Œè°ƒç”¨Person,å¹¶æŠŠéœ€è¦Personå¤„ç†çš„å‚æ•°ä¼ è¿‡å» // this å°±æ˜¯Studentçš„å®ä¾‹ Person.call(this, name, age, friends) // è¿™é‡Œå¯ä»¥è·å¾—çˆ¶ç±»çš„å±æ€§ this.sno = sno&#125;// newä¸€ä¸ªpersonvar p = new Person() // ä¾ç„¶éœ€è¦è¿™é‡Œæ¥è·å¾—æ–¹æ³•Student.prototype = p // è§£å†³å¼Šç«¯3var stu1 = new Student(&quot;aaa&quot;, 18, [&#x27;fred1&#x27;], 111)console.log(stu1); // Person &#123; name: &#x27;aaa&#x27;, age: 18, friends: [ &#x27;fred1&#x27; ], sno: 111 &#125; è§£å†³å¼Šç«¯1var stu2 = new Student(&quot;vvv&quot;, 20, [&#x27;fred2&#x27;], 112)stu1.friends.push(&quot;hahaha&quot;)console.log(stu1.friends); // [ &#x27;fred2&#x27; ]console.log(stu2.friends); // [ &#x27;fred1&#x27;, &#x27;hahaha&#x27; ]// è§£å†³å¼Šç«¯2 ä½†æ˜¯è¿™ç§æ–¹æ³•ä¾ç„¶å­˜åœ¨å¼Šç«¯ï¼š Person è‡³å°‘è¢«è°ƒç”¨ä¸¤æ¬¡ï¼ˆä¸€å¼€å§‹new Personä¸€æ¬¡ï¼Œåé¢Person.callåˆä¼šè°ƒç”¨Personï¼‰ stuçš„åŸå‹å¯¹è±¡ä¸Šä¼šå¤šå‡ºä¸€äº›å±æ€§, ä½†æ˜¯è¿™äº›å±æ€§æ˜¯æ²¡æœ‰å­˜åœ¨çš„å¿…è¦ï¼ˆnew Personçš„æ—¶å€™çš„ï¼‰ æ³¨æ„ï¼š é‚£ä¹ˆæˆ‘ä»¬æ¢ä¸€ç§è·å¾—çˆ¶ç±»æ–¹æ³•çš„æ–¹æ³•ï¼Œç›´æ¥å°†çˆ¶ç±»åŸå‹èµ‹å€¼ç»™å­ç±»ï¼Ÿ è‚¯å®šæ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºä»¥åç»™æŸä¸ªå­ç±»æ·»åŠ æ–¹æ³•çš„æ—¶å€™ï¼Œä¼šä½¿æ‰€æœ‰çš„å­ç±»éƒ½æœ‰è¯¥æ–¹æ³•ï¼Œæ˜¾ç„¶æ˜¯ä¸è¡Œçš„ å› ä¸ºæ‰€æœ‰å­ç±»çš„prototypeéƒ½æŒ‡å‘åŒä¸€ä¸ªçˆ¶ç±»çš„åŸå‹ åŸå‹å¼ç»§æ‰¿å‡½æ•° - å¯¹è±¡ æˆ‘ä»¬å…ˆå®ç°å¯¹è±¡çš„ç»§æ‰¿ï¼Œåé¢å†æ‰©å±•åˆ°ç±» var obj = &#123; name: &quot;Jackson&quot;, age: 18&#125;// åŸå‹å¼ç»§æ‰¿å‡½æ•°// è¿™ä¸ªå‡½æ•°è¦åšåˆ°çš„æ˜¯ï¼Œä½ ç»™æˆ‘ä¼ å…¥çš„å¯¹è±¡ï¼Œä½œä¸ºæ–°å¯¹è±¡çš„åŸå‹function createObject(o) &#123; var newObj = &#123;&#125; // è¿™ä¸ªæ–¹æ³•æ˜¯æŠŠoè®¾ç½®ä¸ºnewObjçš„åŸå‹ Object.setPrototypeOf(newObj, o) return newObj&#125;// Douglas çš„å®ç°(å½“æ—¶è¿˜æ²¡æœ‰setPrototypeOfè¿™ä¸ªæ–¹æ³•)function createObject2(o) &#123; function Fn() &#123;&#125; Fn.prototype = o var newObj = new Fn() // å› æ­¤ newObj.__proto__ = Fn.prototype = o return newObj&#125;// ç°åœ¨ï¼Œæˆ‘ä»¬æƒ³è¦æ–°å»ºçš„å¯¹è±¡infoçš„åŸå‹æŒ‡å‘objï¼ˆåé¢æ‰©å±•åˆ°ç±»ï¼‰// var info = createObject(obj)// ä½†æ˜¯ æ–°çš„ECMA ç»™æˆ‘ä»¬æä¾›äº†æ–°çš„æ–¹æ³•ï¼šObject.create(obj)// Object.create()æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œä½¿ç”¨ç°æœ‰çš„å¯¹è±¡æ¥æä¾›æ–°åˆ›å»ºçš„å¯¹è±¡çš„__proto__// å®é™…ä¸Šè¿™ä¸ªæ–¹æ³•è·Ÿæˆ‘ä»¬ä¸Šé¢çš„ä¸¤ç§å®ç°æ–¹æ³•å®ç°çš„åŠŸèƒ½æ˜¯ä¸€æ ·çš„var info = Object.create(obj)console.log(info);// å·²ç»å®ç°äº†æˆ‘ä»¬çš„ç›®çš„console.log(info.__proto__); // &#123; name: &#x27;Jackson&#x27;, age: 18 &#125; Object.create() ï¼šhttps://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/create å¯„ç”Ÿå¼ç»§æ‰¿å‡½æ•°ï¼ˆäº†è§£ï¼‰ å¯„ç”Ÿå¼ç»§æ‰¿çš„æ€è·¯æ˜¯ç»“åˆåŸå‹ç±»ç»§æ‰¿å’Œå·¥å‚æ¨¡å¼çš„ä¸€ç§æ–¹å¼ å³åˆ›å»ºä¸€ä¸ªå°è£…ç»§æ‰¿è¿‡ç¨‹çš„å‡½æ•°, è¯¥å‡½æ•°åœ¨å†…éƒ¨ä»¥æŸç§æ–¹å¼æ¥å¢å¼ºå¯¹è±¡ï¼Œæœ€åå†å°†è¿™ä¸ªå¯¹è±¡è¿”å› var personObj = &#123; running: function() &#123; console.log(&#x27;running&#x27;); &#125;&#125;// ç›®çš„ï¼šç»§æ‰¿ personObjé‡Œé¢çš„æ–¹æ³•function createStudent(name) &#123; var stu = Object.create(personObj) stu.name = name stu.studying = function() &#123; console.log(&quot;studying&quot;); &#125; return stu&#125;var stuObj = createStudent(&quot;why&quot;) å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿(æœ€ç»ˆæ–¹æ¡ˆ) åˆ©ç”¨å¯„ç”Ÿå¼ç»§æ‰¿å°†ç»„åˆå¼ç»§æ‰¿çš„ä¸¤ä¸ªé—®é¢˜è§£å†³ é¦–å…ˆæˆ‘ä»¬éœ€è¦æ˜ç¡®ï¼Œå½“æˆ‘ä»¬åœ¨å­ç±»çš„æ„é€ å‡½æ•°ä¸­è°ƒç”¨çˆ¶ç±».call(thisï¼Œå‚æ•°)çš„æ—¶å€™ï¼Œå°±ä¼šå°†çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•å¤åˆ¶ä¸€ä»½åˆ°å­ç±»ä¸­ï¼Œæ‰€ä»¥çˆ¶ç±»æœ¬èº«é‡Œé¢çš„å†…å®¹æˆ‘ä»¬æ˜¯ä¸éœ€è¦çš„ ç„¶åï¼Œæˆ‘ä»¬è¿˜éœ€è¦è·å–åˆ°ä¸€ä»½çˆ¶ç±»çš„åŸå‹å¯¹è±¡ä¸­çš„å±æ€§å’Œæ–¹æ³• // å¦‚æœä¸æƒ³ä½¿ç”¨Object.createè¿™ä¸ªæ–¹æ³•çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰å‰é¢è¯´è¿‡çš„æ–¹æ³•function createObject(o) &#123; function Fn() &#123;&#125; Fn.prototype = o return new Fn()&#125;function inheritPrototype(SubType, SuperType) &#123; // SubType.prototype = Object.create(SuperType.prototype) SubType.prototype = createObject(SuperType.prototype) // å½“ç„¶å­ç±»çš„prototypeè¿˜éœ€è¦æœ‰constructoræŒ‡å‘å­æ„é€ å‡½æ•°æœ¬èº« Object.defineProperty(SubType.prototype, &quot;constructor&quot;, &#123; enumerable: false, configurable: true, writable: true, value: SubType &#125;)&#125;// çˆ¶ç±»function Person(name, age, friends) &#123; this.name = name this.age = age this.friends = friends&#125;Person.prototype.running = function() &#123; console.log(&quot;running~&quot;)&#125;// å­ç±»function Student(name, age, friends, sno) &#123; Person.call(this, name, age, friends) // è·å–ä¸€ä»½Personä¸­çš„å±æ€§å’Œæ–¹æ³• this.sno = sno&#125;// Studentç±»è¿˜éœ€è¦è·å–ä¸€ä»½çˆ¶ç±»çš„prototypeçš„å±æ€§å’Œæ–¹æ³•inheritPrototype(Student, Person)var stu = new Student(&quot;why&quot;, 18, [&quot;kobe&quot;], 111)console.log(stu); // æ‰“å° Student &#123; name: &#x27;why&#x27;,age: 18,friends: [ &#x27;kobe&#x27; ],sno: 111,&#125; JSåŸå‹çš„è¡¥å…… hasOwnProperty åˆ¤æ–­å¯¹è±¡æ˜¯å¦æœ‰æŸä¸ªå±äºè‡ªå·±çš„å±æ€§ï¼Œä¸åŒ…æ‹¬åœ¨åŸå‹ä¸Šçš„ in/ for in æ“ä½œç¬¦ åˆ¤æ–­æŸä¸ªå±æ€§æ˜¯å¦åœ¨æŸä¸ªå¯¹è±¡æˆ–è€…å¯¹è±¡çš„åŸå‹ä¸Š var obj = &#123; name: &#x27;jackson&#x27;, age: 18&#125;// ç¬¬äºŒä¸ªå‚æ•°æ˜¯infoæ·»åŠ å±äºè‡ªå·±çš„å±æ€§var info = Object.create(obj, &#123; address: &#123; value: &quot;åŒ—äº¬&quot;, enumerable: true &#125;&#125;)// hasOwnPropertyconsole.log(info.hasOwnProperty(&quot;address&quot;)); // trueconsole.log(info.hasOwnProperty(&quot;name&quot;)); // false// in æ“ä½œç¬¦: ä¸ç®¡åœ¨å½“å‰å¯¹è±¡è¿˜æ˜¯åŸå‹ä¸­è¿”å›çš„éƒ½æ˜¯trueconsole.log(&quot;address&quot; in info); // trueconsole.log(&quot;name&quot; in info); // true// for in (åŒ…æ‹¬åŸå‹ä¸Šçš„å±æ€§éƒ½å¯ä»¥éå†åˆ°)for(var key in info) &#123; console.log(key); // address name age&#125; instanceof ç”¨äºæ£€æµ‹æ„é€ å‡½æ•°çš„ prototype å±æ€§æ˜¯å¦å‡ºç°åœ¨æŸä¸ªå®ä¾‹å¯¹è±¡çš„åŸå‹é“¾ä¸Š function Person() &#123;&#125;function Student() &#123;&#125;// ä½¿ç”¨å‰é¢çš„å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿inheritPrototype(Student, Person)console.log(Person.prototype.__proto__); // [Object: null prototype] &#123;&#125;var stu = new Student()// stuæ˜¯å¦å‡ºç°åœ¨æ„é€ å‡½æ•° Student çš„åŸå‹é“¾ä¸Šconsole.log(stu instanceof Student); // trueconsole.log(stu instanceof Person); // trueconsole.log(stu instanceof Object); // true isPrototypeOf(äº†è§£) ç”¨äºæ£€æµ‹æŸä¸ªå¯¹è±¡ï¼Œæ˜¯å¦å‡ºç°åœ¨æŸä¸ªå®ä¾‹å¯¹è±¡çš„åŸå‹é“¾ä¸Š var info = Object.create(obj)// objæ˜¯å¦å‡ºç°åœ¨infoçš„åŸå‹é“¾ä¸Šconsole.log(obj.isPrototypeOf(info)) å¯¹è±¡-å‡½æ•°-åŸå‹ä¹‹é—´çš„å…³ç³» var obj = &#123; name: &quot;jackson&quot;&#125;// åªè¦æ˜¯å¯¹è±¡ï¼Œé‡Œé¢å°±ä¼šæœ‰ä¸€ä¸ª__proto__å¯¹è±¡ï¼ˆéšå¼åŸå‹å¯¹è±¡ï¼‰console.log(obj.__proto__);// [Object: null prototype] &#123;&#125;function Foo() &#123;&#125;// æ‰€æœ‰çš„ function xx() &#123;&#125;// æˆ‘ä»¬éƒ½å¯ä»¥è®¤ä¸º xx æ˜¯ new Function åˆ›å»ºå‡ºæ¥çš„// ç›¸å½“äº var xxx = new Function// åªè¦æ˜¯å‡½æ•°ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šæœ‰ä¸€ä¸ªæ˜¾å¼åŸå‹å¯¹è±¡ï¼šFoo.prototype// é‚£ Foo.prototype è¿™ä¸ªå¯¹è±¡åˆæ¥è‡ªå“ªé‡Œå‘¢ï¼Ÿ// åˆ›å»ºå‡½æ•°çš„æ—¶å€™ï¼ŒJSå†…éƒ¨å°±ä¼šåˆ›å»ºä¸€ä¸ªå¯¹è±¡,å¹¶æ·»åŠ åˆ°å‡½æ•°çš„prototypeå±æ€§ä¸­ï¼šFoo.prototype = &#123;constructor: Foo&#125;// Fooä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œåªè¦æ˜¯å¯¹è±¡ï¼Œå°±ä¼šæœ‰éšå¼åŸå‹å¯¹è±¡ Foo.__proto__// Foo.__proto__æ¥è‡ªå“ªé‡Œï¼Ÿ// var Foo = new Function() console.log(Foo.__proto__ === Function.prototype); // true// è€Œ Function.prototypeå¯¹è±¡æ˜¯æˆ‘ä»¬åˆ›å»ºFunctionå‡½æ•°çš„æ—¶å€™åˆ›å»ºå‡ºæ¥çš„// Function.prototype = &#123;constructor: Function&#125;// åˆ›å»ºFunctionå‡½æ•°// function Function() &#123;&#125;// Function.prototype// Function åˆæ˜¯ä¸€ä¸ªå¯¹è±¡// Function.__proto__// å”¯ä¸€ä¸€ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„ä¸œè¥¿console.log(Function.__proto__ === Function.prototype); // true// å¦å¤–è¿˜æœ‰ function Object() &#123;&#125;// Objectä½œä¸ºå‡½æ•°, å°±ä¼šæœ‰Object.prototype// Objectä½œä¸ºå¯¹è±¡, å°±ä¼šæœ‰Object.__proto__// Objectå‡½æ•°æ˜¯Functionåˆ›å»ºå‡ºæ¥çš„ï¼Œæ‰€ä»¥// Objcet.__proto__ === Function.prototype// æœ€åå°±æ˜¯æ¯ä¸ªå‡½æ•°çš„åŸå‹prototypeéƒ½ä¼šæœ‰ä¸€ä¸ªconstructoræŒ‡å›å‡½æ•°æœ¬èº« æœ€å ä¸Šå›¾ï¼","categories":[{"name":"ğŸ”«æ·±å…¥JSé«˜çº§è¯­æ³•","slug":"ğŸ”«æ·±å…¥JSé«˜çº§è¯­æ³•","permalink":"https://hillyee.github.io/categories/%F0%9F%94%AB%E6%B7%B1%E5%85%A5JS%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/"}],"tags":[]},{"title":"07_ä¸¥æ ¼æ¨¡å¼","slug":"07_ä¸¥æ ¼æ¨¡å¼","date":"2022-04-01T16:47:09.000Z","updated":"2022-04-17T15:26:42.730Z","comments":true,"path":"2022/04/02/07_ä¸¥æ ¼æ¨¡å¼/","link":"","permalink":"https://hillyee.github.io/2022/04/02/07_%E4%B8%A5%E6%A0%BC%E6%A8%A1%E5%BC%8F/","excerpt":"","text":"ä¸¥æ ¼æ¨¡å¼ å¦‚ä½•å¼€å¯ä¸¥æ ¼æ¨¡å¼ï¼Ÿ åœ¨æ–‡ä»¶æˆ–è€…å‡½æ•°å¼€å¤´ä½¿ç”¨ â€œuse strictâ€ ä¸¥æ ¼æ¨¡å¼å¸¸è§çš„é™åˆ¶ &quot;use strict&quot;&quot;use strict&quot;// 1.ç¦æ­¢æ„å¤–åˆ›å»ºå…¨å±€å˜é‡// åœ¨å…¨å±€ä¸­ä¸ä½¿ç”¨å…³é”®å­—ç›´æ¥å®šä¹‰å˜é‡message = &quot;hello&quot;message is not defined// 2. ä¸å…è®¸å‡½æ•°æœ‰ç›¸åŒçš„å‚æ•°åç§°function foo(x, y, x) &#123;&#125;// Duplicate parameter name not allowed in this context// 3.ä½¿é™é»˜é”™è¯¯(ä¸æŠ¥é”™ä½†ä¹Ÿæ²¡æœ‰ä»»ä½•æ•ˆæœ)çš„èµ‹å€¼æ“ä½œæŠ›å‡ºå¼‚å¸¸true.name = &quot;abc&quot;NaN = 123var obj = &#123;&#125;Object.defineProperty(obj, &quot;name&quot;, &#123; configurable: false, writable: false, // ä¸å¯å†™ value: &quot;hillyee&quot;&#125;)obj.name = &quot;jenny&quot;// è¯•å›¾åˆ é™¤ä¸å¯åˆ é™¤çš„å±æ€§ï¼ŒæŠ¥é”™delete obj.name// Cannot delete property &#x27;name&#x27; of #&lt;Object&gt;// 4.ä¸å…è®¸ä½¿ç”¨åŸå…ˆçš„å…«è¿›åˆ¶æ ¼å¼var num = 0o123 // å…«è¿›åˆ¶var num2 = 0x123 // åå…­è¿›åˆ¶var num3 = 0b100 // äºŒè¿›åˆ¶ ä¸¥æ ¼æ¨¡å¼ä¸‹çš„this &quot;use strict&quot;// åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œç‹¬ç«‹å‡½æ•°è°ƒç”¨thisé»˜è®¤ç»‘å®šä¸æ˜¯windowï¼Œè€Œæ˜¯undefinedfunction foo() &#123; console.log(this); // undefined&#125;foo()var obj = &#123; name: &quot;hill&quot;, foo: foo&#125;var bar = obj.foobar()// setTimeoutçš„this// å†…éƒ¨ fn.apply(this=window)setTimeout(function() &#123; console.log(this); // window&#125;, 1000)","categories":[{"name":"ğŸ”«æ·±å…¥JSé«˜çº§è¯­æ³•","slug":"ğŸ”«æ·±å…¥JSé«˜çº§è¯­æ³•","permalink":"https://hillyee.github.io/categories/%F0%9F%94%AB%E6%B7%B1%E5%85%A5JS%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/"}],"tags":[]},{"title":"06_çº¯å‡½æ•°-æŸ¯é‡ŒåŒ–-ç»„åˆ","slug":"06_çº¯å‡½æ•°-æŸ¯é‡ŒåŒ–-ç»„åˆ","date":"2022-04-01T16:44:34.000Z","updated":"2022-04-14T02:11:10.836Z","comments":true,"path":"2022/04/02/06_çº¯å‡½æ•°-æŸ¯é‡ŒåŒ–-ç»„åˆ/","link":"","permalink":"https://hillyee.github.io/2022/04/02/06_%E7%BA%AF%E5%87%BD%E6%95%B0-%E6%9F%AF%E9%87%8C%E5%8C%96-%E7%BB%84%E5%90%88/","excerpt":"","text":"çº¯å‡½æ•° - æŸ¯é‡ŒåŒ– - ç»„åˆ çº¯å‡½æ•° ä»€ä¹ˆæ˜¯çº¯å‡½æ•°ï¼Ÿ ç¡®å®šçš„è¾“å…¥ï¼Œä¸€å®šä¼šäº§ç”Ÿç¡®å®šçš„è¾“å‡º å‡½æ•°åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œä¸èƒ½äº§ç”Ÿå‰¯ä½œç”¨ ä»€ä¹ˆæ˜¯å‰¯ä½œç”¨ï¼Ÿ åœ¨æ‰§è¡Œä¸€ä¸ªå‡½æ•°æ—¶ï¼Œé™¤äº†è¿”å›å€¼å‡½æ•°ä¹‹å¤–ï¼Œè¿˜å¯¹è°ƒç”¨å‡½æ•°äº§ç”Ÿäº†é™„åŠ çš„å½±å“ï¼Œæ¯”å¦‚è¯´ä¿®æ”¹äº†å…¨å±€å˜é‡ï¼Œä¿®æ”¹å‚æ•°æˆ–è€…æ”¹å˜å¤–éƒ¨çš„å­˜å‚¨ çº¯å‡½æ•°ä¾‹å­ var names = [&quot;abc&quot;, &quot;cba&quot;, &quot;nba&quot;, &quot;dna&quot;]// sliceåªè¦ç»™å®ƒä¼ å…¥ä¸€ä¸ªstart/end, é‚£ä¹ˆå¯¹äºåŒä¸€ä¸ªæ•°ç»„æ¥è¯´, å®ƒä¼šç»™æˆ‘ä»¬è¿”å›ç¡®å®šçš„å€¼// sliceå‡½æ•°æœ¬èº«å®ƒæ˜¯ä¸ä¼šä¿®æ”¹åŸæ¥çš„æ•°ç»„// æ‰€ä»¥sliceå‡½æ•°æœ¬èº«å°±æ˜¯ä¸€ä¸ªçº¯å‡½æ•°var newNames1 = names.slice(0, 3)console.log(newNames1)// spliceä¸æ˜¯ä¸€ä¸ªçº¯å‡½æ•°var newNames2 = names.splice(2)console.log(newNames2)console.log(names) // [ &#x27;abc&#x27;, &#x27;cba&#x27; ] æ”¹å˜äº†åŸæ•°ç»„ JavaScriptæŸ¯é‡ŒåŒ– ä»€ä¹ˆæ˜¯æŸ¯é‡ŒåŒ–ï¼Ÿ æŠŠæ¥æ”¶å¤šä¸ªå‚æ•°çš„å‡½æ•°å˜æˆæ¥æ”¶ä¸€ä¸ªå•ä¸€å‚æ•°çš„å‡½æ•° â€œå¦‚æœä½ å›ºå®šæŸäº›å‚æ•°ï¼Œä½ å°†å¾—åˆ°æ¥å—ä½™ä¸‹å‚æ•°çš„ä¸€ä¸ªå‡½æ•°â€ åªä¼ é€’ç»™å‡½æ•°ä¸€éƒ¨åˆ†å‚æ•°æ¥è°ƒç”¨å®ƒï¼Œè®©å®ƒè¿”å›ä¸€ä¸ªå‡½æ•°å»å¤„ç†å‰©ä½™çš„å‚æ•°ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¹‹ä¸ºæŸ¯é‡ŒåŒ– æŸ¯é‡ŒåŒ–çš„ç»“æ„ function add(x, y, z) &#123; return x + y + z&#125;var result = add(10, 20, 30)console.log(result); // 60function sum1(x) &#123; return function(y) &#123; return function(z) &#123; return x + y + z &#125; &#125;&#125;var result2 = sum1(10)(20)(30) // 60console.log(result2);// ç®€åŒ–var sum2 = x =&gt; y =&gt; z =&gt; x + y + z æŸ¯é‡ŒåŒ–è®©å‡½æ•°çš„èŒè´£å•ä¸€ æ¯æ¬¡æ¥æ”¶çš„ä¸€ä¸ªå‚æ•°ï¼Œéƒ½åšå®ƒè‡ªå·±çš„é€»è¾‘ å¯ä»¥æ›´å¥½çš„å¤ç”¨å‚æ•°é€»è¾‘ function makeAdder(count) &#123; count = count * count return function(num) &#123; return count + num &#125;&#125;// æ¯”å¦‚è¯´æˆ‘ä»¬æƒ³è¦æ¯æ¬¡çš„countéƒ½æ˜¯5var adder5 = makeAdder(5)adder5(10)adder5(13) æŸ¯é‡ŒåŒ–å‡½æ•°çš„å®ç° function myCurrying(fn) &#123; function curried(...args) &#123; // å½“å·²ç»ä¼ å…¥çš„å‚æ•° å¤§äºç­‰äº éœ€è¦çš„å‚æ•°æ—¶, å°±æ‰§è¡Œå‡½æ•° if (args.length &gt;= fn.length) &#123; // fn() return fn.apply(this, args) &#125; else &#123; // æ²¡æœ‰è¾¾åˆ°ä¸ªæ•°æ—¶, éœ€è¦è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°,ç»§ç»­æ¥æ¥æ”¶å‚æ•° function curried2(...args2) &#123; // æ¥æ”¶åˆ°å‚æ•°å, éœ€è¦é€’å½’è°ƒç”¨curriedæ¥æ£€æŸ¥å‡½æ•°çš„ä¸ªæ•°æ˜¯å¦è¾¾åˆ° return curried.apply(this, [...args, ...args2]) &#125; return curried2 &#125; &#125; // è¿”å›ä¸€ä¸ªæŸ¯é‡ŒåŒ–çš„å‡½æ•° return curried&#125;function add1(x, y, z) &#123; return x + y + z&#125;var curryAdd = myCurrying(add1)console.log(curryAdd(10, 20, 30));console.log(curryAdd(10)(20, 30));console.log(curryAdd(10)(20)(30)); ç»„åˆå‡½æ•° ä»€ä¹ˆæ˜¯ç»„åˆå‡½æ•°ï¼Ÿ ç»„åˆå‡½æ•°æ˜¯åœ¨ JavaScript å¼€å‘è¿‡ç¨‹ä¸­ä¸€ç§å¯¹å‡½æ•°çš„ä½¿ç”¨æŠ€å·§ã€æ¨¡å¼ ç»„åˆå‡½æ•°çš„ä¾‹å­ function double(num) &#123; return num * 2&#125;function square(num) &#123; return num ** 2&#125;var count = 10var result = square((double(count))) å®ç°ç»„åˆå‡½æ•° function hyCompose(...fns) &#123; // å¦‚æœä¸æ˜¯å‡½æ•°,ç›´æ¥æŠ¥é”™ let length = fns.length for (let i = 0; i &lt; length; i++) &#123; if(typeof fns[i] !== &#x27;function&#x27;) &#123; throw new TypeError(&#x27;Expected a function&#x27;) &#125; &#125; // å–å‡ºæ‰€æœ‰çš„å‡½æ•°ä¸€æ¬¡è°ƒç”¨ return function(...args) &#123; let index = 0 let result = length ? fns[index].apply(this, args) : args while(++index &lt; length) &#123; result = fns[index].call(this, result) &#125; return result &#125;&#125;function double(m) &#123; return m * 2&#125;function square(n) &#123; return n ** 2&#125;let newFn = hyCompose(double, square)console.log(newFn(10))","categories":[{"name":"ğŸ”«æ·±å…¥JSé«˜çº§è¯­æ³•","slug":"ğŸ”«æ·±å…¥JSé«˜çº§è¯­æ³•","permalink":"https://hillyee.github.io/categories/%F0%9F%94%AB%E6%B7%B1%E5%85%A5JS%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/"}],"tags":[]},{"title":"05_è®¤è¯†arguments","slug":"05_è®¤è¯†arguments","date":"2022-04-01T16:43:02.000Z","updated":"2022-04-17T15:26:35.850Z","comments":true,"path":"2022/04/02/05_è®¤è¯†arguments/","link":"","permalink":"https://hillyee.github.io/2022/04/02/05_%E8%AE%A4%E8%AF%86arguments/","excerpt":"","text":"è®¤è¯† arguments ä»€ä¹ˆæ˜¯ arguments arguments æ˜¯ä¸€ä¸ªå¯¹åº”äºä¼ é€’ç»™å‡½æ•°çš„å‚æ•°çš„ç±»æ•°ç»„å¯¹è±¡ã€‚(MDN) ç±»æ•°ç»„å¯¹è±¡ï¼Œå°±è¯´æ˜å®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå¯¹è±¡ç±»å‹ ç±»æ•°ç»„è¡¨ç¤ºå®ƒé•¿å¾—åƒæ•°ç»„ï¼Œå¹¶ä¸”æ‹¥æœ‰æ•°ç»„çš„ä¸€äº›ç‰¹æ€§ï¼Œæ¯”å¦‚è¯´ lengthï¼Œå¯ä»¥é€šè¿‡ index è®¿é—® ä½†æ˜¯å´æ²¡æœ‰æ•°ç»„çš„ä¸€äº›æ–¹æ³•ï¼Œæ¯”å¦‚è¯´ forEachï¼Œmap ç­‰ function foo() &#123; // ä¼šå¸®ä½ æ¥æ”¶æ‰€æœ‰ä¼ é€’ç»™å‡½æ•°çš„å‚æ•° console.log(arguments); // [Arguments] &#123; &#x27;0&#x27;: 10, &#x27;1&#x27;: 20, &#x27;2&#x27;: 30 &#125; // è·å–å‚æ•°çš„é•¿åº¦ console.log(arguments.length); // 3 // æ ¹æ®ç´¢å¼•å€¼è·å–æŸä¸€ä¸ªå‚æ•° console.log(arguments[1]); // 20 // è·å–å½“å‰ arguments æ‰€åœ¨çš„å‡½æ•° console.log(arguments.callee); // [Function: foo] // arguments.forEach() æ˜¯ä¸å¯ä»¥çš„&#125;foo(10,20,30) arguments è½¬æˆæ•°ç»„ å¦‚æœæˆ‘ä»¬éœ€è¦éå†é‡Œé¢çš„å‚æ•°å‘¢ï¼Ÿæˆ–è€…è¯´ä½¿ç”¨ä¸€äº›æ•°ç»„çš„æ–¹æ³•å‘¢ï¼Ÿ æ‰€ä»¥åœ¨å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šæŠŠ arguments è½¬æˆæ•°ç»„ ç¬¬ä¸€ç§æ–¹æ³•: è‡ªå·±éå† function foo() &#123; // æˆ‘ä»¬å¯ä»¥é€šè¿‡ç´¢å¼•å€¼æ‹¿åˆ° arguments çš„æ¯ä¸€ä¸ªå€¼ // ç„¶åæ·»åŠ åˆ°æ–°çš„æ•°ç»„ let newArr = [] for (let i = 0; i &lt; arguments.length; i++) &#123; newArr.push(arguments[i]) &#125; console.log(newArr); // [ 10, 20, 30, 40, 50 ]&#125;foo(10, 20, 30, 40, 50) ç¬¬äºŒç§æ–¹æ³•ï¼šArray.prototype.slice function foo() &#123; let newArr = Array.prototype.slice.call(arguments) console.log(newArr); // [1, 2, 3, 4, 5, 6]&#125;foo(1,2,3,4,5,6) Array.prototype.slice.call(arguments) ï¼Ÿä»€ä¹ˆæ„æ€å‘€ï¼Ÿ é¦–å…ˆï¼Œæˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨ slice çš„æ—¶å€™ï¼Œæ˜¯ arr.slice(start, end)ï¼Œé‚£å¦‚æœæ²¡æœ‰è¿™ä¸ªarrå‘¢ï¼Ÿæˆ‘ä»¬æ€ä¹ˆæ‰èƒ½æ‹¿åˆ° slice è¿™ä¸ªæ–¹æ³• æ˜¯ä¸æ˜¯å¯ä»¥åœ¨ Array çš„åŸå‹ä¸Šé¢æ‰¾è¿™ä¸ªæ–¹æ³•ï¼Œæ‰€ä»¥ Array.prototype.slice() é‚£ä¸ºä»€ä¹ˆè¦ç”¨ call æ¥è°ƒç”¨ï¼Ÿ æˆ‘ä»¬å…ˆæ¥æ¨¡æ‹Ÿä¸€ä¸‹ Array ä¸­çš„ slice æ˜¯æ€ä¹ˆå®ç°çš„ Array.prototype.myslice = function(start, end) &#123; // å¦‚æœæˆ‘ä»¬ç›´æ¥ Array.prototype.myslice() è¿™æ ·è°ƒç”¨çš„è¯, this æŒ‡å‘çš„å°±æ˜¯prototypeäº† // è€Œæˆ‘ä»¬å¸Œæœ›çš„æ˜¯, è¿™é‡Œçš„ this æ˜¯æŒ‡å‘è°ƒç”¨ slice è¿™ä¸ªæ–¹æ³•çš„æ•°ç»„ let arr = this start = start || 0 end = end || arr.length let newArray = [] // ä»startåˆ°end(ä¸åŒ…æ‹¬end),æŠŠå…ƒç´ æ·»åŠ åˆ°æ•°ç»„ for (let i = start; i &lt; end; i++) &#123; newArray.push(arr[i]) &#125; return newArray&#125; æ‰€ä»¥ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨ call æ¥æ˜¾å¼ç»‘å®šè¿™ä¸ª thisï¼Œè®©thisæŒ‡å‘æ•°ç»„ let newArr = Array.prototype.myslice.call([1,2,3,4,5,6])console.log(newArr); // [1, 2, 3, 4, 5, 6]// å½“ç„¶å¯ä»¥ä¼ é€’å‚æ•°let newArr2 = Array.prototype.myslice.call([1,2,3,4,5,6], 2, 4)console.log(newArr2); // [3, 4] é‚£è·Ÿæˆ‘ä»¬ arguments æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ Arrayå†…éƒ¨ slice çš„å®ç°åªä¸è¿‡æ˜¯å¯¹ thisï¼Œä¹Ÿå°±æ˜¯éœ€è¦ä½¿ç”¨ slice çš„æ•°ç»„è¿›è¡Œéå†ï¼Œç„¶åæŠŠéœ€è¦çš„éƒ¨åˆ†åŠ å…¥åˆ°æ–°æ•°ç»„ é‚£éå† arguments ä¹Ÿå¯ä»¥å•Šï¼ŒæŠŠå…ƒç´ ä¸€ä¸ªä¸ªåŠ å…¥åˆ°ä¸€ä¸ªæ•°ç»„é‡Œé¢ï¼Œå†æŠŠè¿™ä¸ªæ•°ç»„è¿”å›ï¼Œæœ€åä¸å°±å®ç°äº† arguments è½¬æ•°ç»„äº†å— function foo() &#123; let newArr = Array.prototype.slice.call(arguments) console.log(newArr); // [1, 2, 3, 4, 5, 6] // åŒæ ·é“ç†çš„è¿˜æœ‰ä¸€ç§æ–¹æ³•, æˆ‘ä»¬ç›®çš„å°±æ˜¯æ‹¿åˆ° slice è¿™ä¸ªæ–¹æ³•,å¹¶ä¸”è®© this ç»‘å®š arguments,è®©å†…éƒ¨éå†arguments let newArr2 = [].slice.call(arguments)&#125;foo(1,2,3,4,5,6) å†çœ‹å›è¿™ä¸ªï¼Œåº”è¯¥ç†è§£äº†å§ Array.from (ES6) Array.from() æ–¹æ³•å¯¹ä¸€ä¸ªç±»ä¼¼æ•°ç»„æˆ–å¯è¿­ä»£å¯¹è±¡åˆ›å»ºä¸€ä¸ªæ–°çš„ï¼Œæµ…æ‹·è´çš„æ•°ç»„å®ä¾‹ï¼ˆMDNï¼‰ function foo() &#123; let newArr = Array.from(arguments) console.log(newArr); // [1, 2, 3, 4, 5, 6]&#125;foo(1,2,3,4,5,6) å±•å¼€è¿ç®—ç¬¦ (ES6) function foo() &#123; // å› ä¸ºå±•å¼€è¿ç®—ç¬¦å®é™…ä¸Šä¹Ÿæ˜¯éå†ï¼ŒæŠŠéå†çš„å…ƒç´ ä¸€ä¸ªä¸ªæ”¾åˆ°æ•°ç»„ let newArr = [...arguments] console.log(newArr); // [1, 2, 3, 4, 5, 6]&#125;foo(1,2,3,4,5,6) ç®­å¤´å‡½æ•°æ²¡æœ‰ arguments ç®­å¤´å‡½æ•°æ˜¯ä¸ç»‘å®š arguments çš„ï¼Œå¦‚æœåœ¨ç®­å¤´å‡½æ•°ä¸­ä½¿ç”¨ argumentsï¼Œä¼šå»æ‰¾ä¸Šå±‚ä½œç”¨åŸŸä¸­çš„arguments æ³¨æ„ï¼Œå…¨å±€ä½œç”¨åŸŸæ˜¯æ²¡æœ‰ arguments çš„ var foo = () =&gt; &#123; // æ‰¾ä¸Šå±‚ä½œç”¨åŸŸï¼Œæ‰¾åˆ° window console.log(arguments); // arguments is not defined&#125;foo() function foo() &#123; // arguments æœ‰ 123 console.log(arguments); // Arguments [123] var bar = () =&gt; &#123; console.log(arguments); // Arguments [123] &#125; return bar&#125;var fn = foo(123)fn() é‚£å¦‚æœæƒ³ä¼ é€’å¤šä¸ªå‚æ•°å‘¢ï¼Ÿç”¨ ES6 çš„å‰©ä½™å‚æ•° var foo = (a, b, ...args) =&gt; &#123; console.log(a, b); // 1 2 console.log(args); // [3,4,5,6]&#125;foo(1,2,3,4,5,6)","categories":[{"name":"ğŸ”«æ·±å…¥JSé«˜çº§è¯­æ³•","slug":"ğŸ”«æ·±å…¥JSé«˜çº§è¯­æ³•","permalink":"https://hillyee.github.io/categories/%F0%9F%94%AB%E6%B7%B1%E5%85%A5JS%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/"}],"tags":[]},{"title":"Vue3æºç å­¦ä¹ ","slug":"Vue3æºç å­¦ä¹ ","date":"2022-03-31T11:42:30.000Z","updated":"2022-04-09T11:06:58.213Z","comments":true,"path":"2022/03/31/Vue3æºç å­¦ä¹ /","link":"","permalink":"https://hillyee.github.io/2022/03/31/Vue3%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0/","excerpt":"","text":"Vue3æºç å­¦ä¹  ç¬¬ä¸€æ¬¡è¿™æ ·å­¦ä¹ æºç è¿˜æ˜¯æŒºæœ‰éš¾åº¦çš„ï¼Œå¸Œæœ›åé¢å¯ä»¥æ…¢æ…¢æå‡ï¼Œæœ‰è‡ªå·±é˜…è¯»æºç çš„èƒ½åŠ›å­ 1. çœŸå®çš„DOMæ¸²æŸ“ ä¼ ç»Ÿçš„å‰ç«¯å¼€å‘ä¸­ï¼Œæˆ‘ä»¬æ˜¯ç¼–å†™è‡ªå·±çš„HTMLï¼Œæœ€ç»ˆè¢«æ¸²æŸ“åˆ°æµè§ˆå™¨ä¸Šçš„ï¼Œè¿™ä¸ªè¿‡ç¨‹å¤§æ¦‚æ˜¯ï¼š è§£æ html è½¬åŒ–æˆ DOM æ ‘ï¼Œç„¶åæ¸²æŸ“åˆ°é¡µé¢ 2. è™šæ‹ŸDOM 2.1 æ¸²æŸ“è¿‡ç¨‹ 3. Vue æºç çš„ä¸‰å¤§æ ¸å¿ƒç³»ç»Ÿ Complieræ¨¡å—ï¼šç¼–è¯‘æ¨¡æ¿ç³»ç»Ÿ Runtimeæ¨¡å—ï¼šä¹Ÿå¯ä»¥ç§°ä¹‹ä¸º Rendereræ¨¡å—ï¼ŒçœŸæ­£æ¸²æŸ“çš„æ¨¡å— Reactivityæ¨¡å—ï¼šå“åº”å¼ç³»ç»Ÿ ä¸‰å¤§ç³»ç»ŸååŒå·¥ä½œ 4. å®ç° Mini-Vue mini-vueçš„å®ç°ä¹Ÿæ˜¯ï¼Œåé¢æœ‰æ—¶é—´å¾—å›æ¥é‡æ–°çœ‹çœ‹ åŒ…æ‹¬ä¸‰éƒ¨åˆ†ï¼š æ¸²æŸ“ç³»ç»Ÿæ¨¡å— å¯å“åº”å¼ç³»ç»Ÿæ¨¡å— åº”ç”¨ç¨‹åºå…¥å£æ¨¡å— 4.1 æ¸²æŸ“ç³»ç»Ÿå®ç° åŒ…å«ä¸‰ä¸ªåŠŸèƒ½ï¼š h å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ª VNode å¯¹è±¡ mount å‡½æ•°ï¼Œç”¨äºå°† VNode æŒ‚è½½åˆ° DOM ä¸Š patch å‡½æ•°ï¼Œç”¨äºå¯¹æ¯”ä¸¤ä¸ª VNodeï¼Œå†³å®šå¦‚ä½•å¤„ç†æ–°çš„VNodeï¼ˆdiffï¼‰ hå‡½æ•°ç”Ÿæˆ VNode // ç”Ÿæˆ VNode// ç›´æ¥è¿”å›ä¸€ä¸ª VNodeå¯¹è±¡å³å¯const h = (tag, props, children) =&gt; &#123; return &#123; tag, props, children &#125;&#125; mountå‡½æ•°æŒ‚è½½ vnode // mountå‡½æ•°, æŒ‚è½½VNodeconst mount = (vnode, container) =&gt; &#123; // 1.æ ¹æ®tagåˆ›å»ºHTMLå…ƒç´ ,å¹¶ä¸”å­˜å‚¨åˆ°vnodeçš„elä¸­ const el = vnode.el = document.createElement(vnode.tag) // 2.å¤„ç†propså±æ€§ // 2.1 å¦‚æœä»¥onå¼€å¤´,é‚£ä¹ˆç›‘å¬äº‹ä»¶ // 2.2 æ™®é€šå±æ€§ç›´æ¥é€šè¿‡ setAttribute æ·»åŠ  if (vnode.props) &#123; for (const key in vnode.props) &#123; const value = vnode.props[key] if (key.startsWith(&quot;on&quot;)) &#123; el.addEventListener(key.slice(2).toLowerCase(), value) &#125; else &#123; el.setAttribute(key, value) &#125; &#125; &#125; // 3.å¤„ç†children if (vnode.children) &#123; if (typeof vnode.children === &#x27;string&#x27;) &#123; el.textContent = vnode.children &#125; else &#123; vnode.children.forEach(item =&gt; &#123; mount(item, el) &#125;); &#125; &#125; // 4.å°† elæŒ‚è½½åˆ°containerä¸Š container.appendChild(el)&#125; patchå‡½æ•° - å¯¹æ¯”ä¸¤ä¸ªVNode // patch,å¯¹æ¯”ä¸¤ä¸ª VNodeconst patch = (n1, n2) =&gt; &#123; // 1. tagä¸åŒ,ç›´æ¥åŠ å…¥æ–°çš„èŠ‚ç‚¹ if (n1.tag !== n2.tag) &#123; const n1Elparent = n1.el.parentElement n1Elparent.removeChild(n1.el) mount(n2, n1Elparent) &#125; else &#123; // 1. å–å‡ºelementå¯¹è±¡,å¹¶ä¸”åœ¨n2ä¸­è¿›è¡Œä¿å­˜ const el = n2.el = n1.el // 2. å¤„ç†props const oldProps = n1.props || &#123;&#125; const newProps = n2.props || &#123;&#125; // 2.1 è·å–æ‰€æœ‰çš„newPropsæ·»åŠ åˆ°el for (const key in newProps) &#123; const oldValue = oldProps[key] const newValue = newProps[key] if (newValue !== oldValue) &#123; if (key.startsWith(&quot;on&quot;)) &#123; // å¯¹äº‹ä»¶ç›‘å¬çš„åˆ¤æ–­ el.addEventListener(key.slice(2).toLowerCase(), newValue) &#125; else &#123; el.setAttribute(key, newValue) &#125; &#125; &#125; // 2.2åˆ é™¤æ—§çš„props for(const key in oldProps) &#123; if (key.startsWith(&quot;on&quot;)) &#123; const value = oldProps[key] el.removeEventListener(key.slice(2).toLowerCase(), value) &#125; if (!(key in newProps)) &#123; el.removeAttribute(key) &#125; &#125; // 3.å¤„ç†children const oldChildren = n1.children || [] const newChildren = n2.children || [] if (typeof newChildren === &quot;string&quot;) &#123; // 3.1newChildrenæœ¬èº«æ˜¯ä¸€ä¸ªstring // è¾¹ç•Œæƒ…å†µ å¦‚æœoldChildrenä¹Ÿæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸² if (typeof oldChildren === &quot;string&quot;) &#123; if (newChildren !== oldChildren) &#123; el.textContent = newChildren &#125; &#125; else &#123; el.innerHTML = newChildren &#125; &#125; else &#123; // 3.2 newChildrenæœ¬èº«æ˜¯ä¸€ä¸ªæ•°ç»„ if (typeof oldChildren === &quot;string&quot;) &#123; el.innerHTML = &quot;&quot; newChildren.forEach(item =&gt; &#123; mount(item, el) &#125;) &#125; else &#123; // oldChildren ä¹Ÿæ˜¯æ•°ç»„ // 1. å‰é¢æœ‰ç›¸åŒèŠ‚ç‚¹çš„ const commonLength = Math.min(oldChildren.length, newChildren.length) for (let i = 0; i &lt; commonLength; i++) &#123; patch(oldChildren[i], newChildren[i]) &#125; // 2.å¦‚æœæ–°èŠ‚ç‚¹çš„lengthæ›´é•¿ï¼Œé‚£ä¹ˆå‰©ä½™çš„æ–°èŠ‚ç‚¹è¿›è¡ŒæŒ‚è½½æ“ä½œ if (newChildren.length &gt; oldChildren.length) &#123; newChildren.slice(oldChildren.length).forEach(item =&gt; &#123; mount(item, el) &#125;) &#125; // 3.å¦‚æœæ—§èŠ‚ç‚¹çš„lengthæ›´é•¿ï¼Œé‚£ä¹ˆç§»é™¤å‰©ä½™çš„æ—§èŠ‚ç‚¹è¿›è¡Œ if (newChildren.length &lt; oldChildren.length) &#123; oldChildren.slice(newChildren.length).forEach(item =&gt; &#123; el.removeChild(item.el) &#125;) &#125; &#125; &#125; &#125;&#125; 4.2 å“åº”å¼ç³»ç»Ÿ ä¾èµ–æ”¶é›†ç³»ç»Ÿ + vue2å“åº”å¼ç³»ç»Ÿ class Dep &#123; constructor() &#123; // åªè¦new Dep,å°±ä¼šç»™ä½ æ·»åŠ subscribeså±æ€§ this.subscribers = new Set() // åˆ›å»ºé›†åˆ(é‡Œé¢æ”¾æŸå±æ€§ä¾èµ–çš„å‡½æ•°) &#125; depend() &#123; // æ”¶é›†ä¾èµ– if (activeEffect) &#123; this.subscribers.add(activeEffect) &#125; &#125; notify() &#123; this.subscribers.forEach(effect =&gt; &#123; effect() &#125;) &#125;&#125;let activeEffect = nullfunction watchEffect(effect) &#123; activeEffect = effect effect() // åŸå§‹æ•°æ®å…ˆæ‰§è¡Œä¸€æ¬¡ activeEffect = null&#125;const targetMap = new WeakMap()function getDep(target, key) &#123; // 1.æ ¹æ®å¯¹è±¡(target)å–å‡ºå¯¹åº”çš„Mapå¯¹è±¡ let depsMap = targetMap.get(target) if (!depsMap) &#123; depsMap = new Map() targetMap.set(target, depsMap) &#125; // 2.å–å‡ºå…·ä½“çš„depå¯¹è±¡ let dep = depsMap.get(key) if (!dep) &#123; dep = new Dep() depsMap.set(key, dep) &#125; return dep&#125;// vue2å¯¹rawè¿›è¡Œæ•°æ®åŠ«æŒfunction reactive(raw) &#123; // æ ¹æ®å¯¹è±¡æ‹¿åˆ°æ‰€æœ‰key,ç»„æˆæ•°ç»„ Object.keys(raw).forEach(key =&gt; &#123; // è·å–keyå¯¹åº”çš„ä¾èµ– const dep = getDep(raw, key) let value = raw[key] Object.defineProperty(raw, key, &#123; get() &#123; // ç”¨åˆ°äº†æŸä¸ªkey,è°ƒç”¨get,æ‰€ä»¥å¯ä»¥åœ¨è¿™é‡Œæ”¶é›†ä¾èµ– dep.depend() return value &#125;, set(newValue) &#123; // å½“å±æ€§è¢«é‡æ–°èµ‹å€¼çš„æ—¶å€™,ä¼šè°ƒç”¨set,æ‰€ä»¥åœ¨è¿™é‡Œæ‰§è¡Œè¿™ä¸ªå±æ€§ä¾èµ–çš„å‡½æ•° // raw[key] = newValue ä¸èƒ½è¿™æ ·è®¾ç½®,å¦åˆ™é€’å½’äº†(åˆå¯¹rawæ“ä½œ,åˆåŠ«æŒ,åˆæ¥åˆ°setè¿™é‡Œäº†) if (value !== newValue) &#123; value = newValue dep.notify() &#125; &#125; &#125;) &#125;) return raw&#125;// æµ‹è¯•ä»£ç const info = reactive(&#123; counter: 100, name: &#x27;hillyee&#x27;&#125;)// watchEffect1watchEffect(function () &#123; console.log(info.counter * 2, info.name, &#x27;w1&#x27;);&#125;)// watchEffect2watchEffect(function () &#123; console.log(info.counter * info.counter, &#x27;w2&#x27;);&#125;)// info.counter++ // ä¿®æ”¹æ•°æ®çš„æ—¶å€™,æ‰€æœ‰å¯¹è¿™ä¸ªæ•°æ®æœ‰ä¾èµ–çš„å‡½æ•°éƒ½åº”è¯¥è¢«æ‰§è¡Œä¸€æ¬¡// info.name = &quot;hahahhahah&quot; å“åº”å¼ç³»ç»Ÿ vue3-proxyå®ç° // vue3å¯¹rawè¿›è¡Œæ•°æ®åŠ«æŒfunction reactive(raw) &#123; // Proxy(åŸå¯¹è±¡,ä»£ç†å¯¹è±¡) return new Proxy(raw, &#123; get(target, key) &#123; const dep = getDep(target, key) // è·å–è¯¥å±æ€§çš„ä¾èµ– dep.depend() return target[key] &#125;, set(target, key, newValue) &#123; const dep = getDep(target, key) target[key] = newValue dep.notify() &#125; &#125;)&#125; ä¸ºä»€ä¹ˆ Vue3 é€‰æ‹© Proxy å‘¢ï¼Ÿ Object.definedProperty æ˜¯åŠ«æŒå¯¹è±¡çš„å±æ€§æ—¶ï¼Œå¦‚æœæ–°å¢å…ƒç´ ï¼Œ é‚£ä¹ˆVue2éœ€è¦å†æ¬¡ è°ƒç”¨definedPropertyï¼Œè€Œ Proxy åŠ«æŒçš„æ˜¯æ•´ä¸ªå¯¹è±¡ï¼Œä¸éœ€è¦åšç‰¹æ®Šå¤„ç† ä¿®æ”¹å¯¹è±¡çš„ä¸åŒï¼š ä½¿ç”¨ defineProperty æ—¶ï¼Œæˆ‘ä»¬ä¿®æ”¹åŸæ¥çš„ obj å¯¹è±¡å°±å¯ä»¥è§¦å‘æ‹¦æˆªï¼› è€Œä½¿ç”¨ proxyï¼Œå°±å¿…é¡»ä¿®æ”¹ä»£ç†å¯¹è±¡ï¼Œå³ Proxy çš„å®ä¾‹æ‰å¯ä»¥è§¦å‘æ‹¦æˆªï¼› 4.3 æ¡†æ¶å¤–å±‚ API è®¾è®¡ createApp() ç”¨äºåˆ›å»ºä¸€ä¸ªappå¯¹è±¡ï¼Œè¯¥appå¯¹è±¡æœ‰ä¸€ä¸ªmountæ–¹æ³•ï¼Œå¯ä»¥å°†æ ¹ç»„ä»¶æŒ‚è½½åˆ°æŸä¸€ä¸ªdomå…ƒç´ ä¸Š function createApp(rootComponent) &#123; return &#123; mount(selector) &#123; const container = document.querySelector(selector) let isMounted = false let oldVNode = null watchEffect(function() &#123; if (!isMounted) &#123; // rootComponent.render() è¿”å›æ ¹ç»„ä»¶çš„vnode oldVNode = rootComponent.render() mount(oldVNode, container) isMounted = true &#125; else &#123; const newVNode = rootComponent.render() patch(oldVNode, newVNode) oldVNode = newVNode &#125; &#125;) &#125; &#125;&#125; ä½¿ç”¨æ¡ˆä¾‹â€“è®¡æ•° &lt;body&gt; &lt;div id=&quot;app&quot;&gt;&lt;/div&gt; &lt;script src=&quot;../mini_vue/renderer.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;../mini_vue/reactive.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;./index.js&quot;&gt;&lt;/script&gt; &lt;script&gt; // 1.åˆ›å»ºæ ¹ç»„ä»¶ const App = &#123; data: reactive(&#123; counter: 0 &#125;), render() &#123; return h(&quot;div&quot;, null, [ h(&quot;h2&quot;, null, `å½“å‰è®¡æ•°:$&#123;this.data.counter&#125;`), h(&quot;button&quot;, &#123; onClick: () =&gt; &#123; this.data.counter++ console.log(this.data.counter); &#125; &#125;, &quot;+1&quot;) ]) &#125;, &#125; // 2.æŒ‚è½½æ ¹ç»„ä»¶ const app = createApp(App) app.mount(&#x27;#app&#x27;) &lt;/script&gt;&lt;/body&gt; Vue3æºç é˜…è¯» æ ¹æ®å›¾çš„æµç¨‹ï¼ŒåŠ ä¸Šæºç ï¼Œå¤šçœ‹çœ‹å­ï¼Œç¬¬ä¸€æ¬¡çœ‹æºç ç¡®å®æœ‰ç‚¹åƒåŠ›äº† å…ˆçœ‹ç†Ÿæ‚‰æµç¨‹ï¼Œç„¶åå¯ä»¥ debugger åœ¨æµè§ˆå™¨ä¸Šç®€å•è¿‡ä¸€ä¸‹æ•´ä¸ªæµç¨‹ createApp æºç é˜…è¯»ä¹‹æŒ‚è½½æ ¹ç»„ä»¶ const app = &#123;props: &#123;message: String&#125;instance// 1.å¤„ç†propså’Œattrsinstance.propsinstance.attrs// 2.å¤„ç†slotsinstance.slots// 3.æ‰§è¡Œsetupconst result = setup()instance.setupState = proxyRefs(result);// 4.ç¼–è¯‘template -&gt; compile&lt;template&gt; -&gt; renderå‡½æ•°instance.render = Component.render = renderå‡½æ•°// 5.å¯¹vue2çš„options apiè¿›è¡ŒçŸ¥è¯†data/methods/computed/ç”Ÿå‘½å‘¨æœŸ ç»„ä»¶åŒ–çš„åˆå§‹åŒ– Compileè¿‡ç¨‹ å¯¹äºä¸ä¼šæ”¹å˜çš„é™æ€èŠ‚ç‚¹è¿›è¡Œä½œç”¨äºæå‡ æˆ‘éƒ½æ²¡æ‰¾åˆ°è¿™éƒ¨åˆ†å‡½æ•°ã€‚ã€‚ã€‚ Block Tree åˆ†æ vue3çš„ä¸€ä¸ªä¼˜åŒ–ï¼šå¯¹äºä¸ä¼šæ”¹å˜çš„é™æ€èŠ‚ç‚¹è¿›è¡Œä½œç”¨åŸŸæå‡ï¼Œä»…å¯¹æ–°çš„vnodeè¿›è¡Œåˆ›å»º ç”Ÿå‘½å‘¨æœŸå›è°ƒ templateä¸­æ•°æ®çš„ä½¿ç”¨é¡ºåº å¦‚æœsetupè·Ÿdataä¸­æœ‰åŒä¸€ä¸ªå±æ€§,é¦–å…ˆé€‰æ‹©setupçš„,å†…éƒ¨åšäº†ä¸€ä¸ªåˆ¤æ–­å§","categories":[{"name":"æ·±å…¥Vue3+Typescriptå­¦ä¹ âš¡","slug":"æ·±å…¥Vue3-Typescriptå­¦ä¹ âš¡","permalink":"https://hillyee.github.io/categories/%E6%B7%B1%E5%85%A5Vue3-Typescript%E5%AD%A6%E4%B9%A0%E2%9A%A1/"}],"tags":[{"name":"vue3","slug":"vue3","permalink":"https://hillyee.github.io/tags/vue3/"}]},{"title":"Vue3_compositionAPI","slug":"Vue3-compositionAPI","date":"2022-03-31T08:10:18.000Z","updated":"2022-04-07T04:03:46.875Z","comments":true,"path":"2022/03/31/Vue3-compositionAPI/","link":"","permalink":"https://hillyee.github.io/2022/03/31/Vue3-compositionAPI/","excerpt":"","text":"Composition API 1. setup 1.1 setupå‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼špropsï¼Œcontext propsï¼šå…¶å®å°±æ˜¯çˆ¶ç»„ä»¶ä¼ é€’è¿‡æ¥çš„å±æ€§ï¼Œä½†æ˜¯åœ¨setupå¤–é¢ä¾ç„¶éœ€è¦ç”¨propsæ¥æ”¶ contextï¼šé‡Œé¢åŒ…å«ä¸‰ä¸ªå±æ€§ï¼š attrsï¼šçˆ¶ç»„ä»¶ä¼ é€’è¿‡æ¥çš„æ²¡æœ‰è¢«propæ¥æ”¶çš„å±æ€§ slotsï¼šçˆ¶ç»„ä»¶ä¼ é€’è¿‡æ¥çš„æ’æ§½ emitï¼šå½“ç»„ä»¶å†…éƒ¨éœ€è¦å‘å‡ºäº‹ä»¶çš„æ—¶å€™ç”¨ï¼ˆvue2é‡Œé¢æ˜¯this.$emitï¼Œä½†æ˜¯vue3ä¸­ï¼Œsetupä¸èƒ½è®¿é—®thisï¼‰ 1.2 setup å‡½æ•°çš„è¿”å›å€¼ setup() &#123; let a = 1 return &#123; a &#125;&#125; setupçš„è¿”å›å€¼å¯ä»¥åœ¨æ¨¡æ¿ template ä¸­ä½¿ç”¨ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥ä»£æ›¿data ä½†æ˜¯ç›´æ¥è¿™ä¹ˆè¿”å›å˜é‡ï¼Œæ˜¯æ²¡æœ‰å“åº”å¼çš„ 1.3 setup ä¸å¯ä»¥ä½¿ç”¨ this this å¹¶æ²¡æœ‰æŒ‡å‘å½“å‰ç»„ä»¶å®ä¾‹ åœ¨ setup è¢«è°ƒç”¨ä¹‹å‰ï¼Œdataã€computedã€ç­‰éƒ½æ²¡æœ‰è¢«è§£æ æ‰€ä»¥æ— æ³•åœ¨ setup ä¸­è·å–this 2. reactive API ä¸ºsetupä¸­å®šä¹‰çš„æ•°æ®æä¾›å“åº”å¼çš„ç‰¹æ€§ reactive API ä¼ å…¥çš„ç±»å‹å¿…é¡»æ˜¯å¯¹è±¡æˆ–è€…æ•°ç»„ const state = reactive(&#123; name: &quot;why&quot; // è¿™æ—¶å€™è¿™ä¸ªnameå°±æ˜¯å“åº”å¼çš„&#125;) 3. ref API 3.1 ref API åŸºæœ¬ä½¿ç”¨ å¯ä»¥ä¼ å…¥åŸºæœ¬æ•°æ®ç±»å‹ï¼Œåœ¨å¼€å‘ä¸­æ¨èä½¿ç”¨ refï¼Œä¾¿äºä»£ç çš„æŠ½ç¦»ï¼Œå½“ç„¶å¦‚æœå±æ€§å…³ç³»å¾ˆç´§å¯†çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ reactive ref ä¼šè¿”å›ä¸€ä¸ªå¯å˜çš„å“åº”å¼å¯¹è±¡ const message = ref(&quot;hello world&quot;) åœ¨ template ä¸­å¼•ç”¨ ref çš„å€¼æ—¶ï¼ŒVueä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬è¿›è¡Œè§£åŒ…ï¼Œå°±æ˜¯è¯´æˆ‘ä»¬ä¸éœ€è¦åœ¨æ¨¡æ¿ä¸­ xxx.value æ¥ä½¿ç”¨ ä½†æ˜¯åœ¨ setup å†…éƒ¨ï¼Œå®ƒä¾ç„¶æ˜¯ä¸€ä¸ª ref çš„å¼•ç”¨ï¼Œæ‰€ä»¥è¦ä½¿ç”¨ ref.value 3.2 ref API çš„è¡¥å…… toRefs å’Œ toRef let info = reactive(&#123; name: &#x27;why&#x27;, age: 18&#125;)// å½“æˆ‘ä»¬æƒ³è§£æ„çš„æ—¶å€™// let &#123;name, age&#125; = info // ä¸å†æ˜¯å“åº”å¼çš„äº†// å¦‚æœå¸Œæœ›å“åº”å¼çš„è¯// 1. toRefs: å°† reactive å¯¹è±¡ä¸­æ‰€æœ‰å±æ€§éƒ½è½¬æˆ ref// let &#123;name, age&#125; = toRefs(info)// åªå¸Œæœ›å•ä¸ªå“åº”å¼çš„è¯// 2. toReflet &#123;name&#125; = info // ä¸æ˜¯å“åº”å¼let age = toRef(info, &quot;age&quot;)const change = () =&gt; &#123; age.value++&#125; shallowRefï¼šåˆ›å»ºä¸€ä¸ªè·Ÿè¸ªè‡ªèº« .value å˜åŒ–çš„ refï¼Œä½†ä¸ä¼šä½¿å…¶å€¼ä¹Ÿå˜æˆå“åº”å¼çš„ triggerRefï¼šæ‰‹åŠ¨è§¦å‘å’Œ shallowRef ç›¸å…³è”çš„å‰¯ä½œç”¨ let info = shallowRef(&#123; name: &quot;why&quot;&#125;)const change = () =&gt; &#123; // info.value = &quot;hello&quot; å“åº”å¼ info.value.name = &quot;james&quot; // ä¸æ˜¯å“åº”å¼ // æ‰‹åŠ¨è§¦å‘å’Œ shallowRef ç›¸å…³è”çš„å‰¯ä½œç”¨(å˜æˆå“åº”å¼) triggerRef(info)&#125; customRef è‡ªå®šä¹‰ ref 4. readonly å½“æˆ‘ä»¬å¸Œæœ›æˆ‘ä»¬ç»™å…¶ä»–ç»„ä»¶ä¼ é€’æ•°æ®æ—¶ï¼Œå¸Œæœ›å…¶ä»–ç»„ä»¶åªæ˜¯ä½¿ç”¨æˆ‘ä»¬çš„å†…å®¹ï¼Œä½†æ˜¯ä¸å…è®¸å®ƒä»¬ä¿®æ”¹çš„æ—¶å€™ï¼Œå¯ä»¥ç”¨readonly å®é™…ä¸Šï¼Œreadonly ä¼šè¿”å›åŸç”Ÿå¯¹è±¡çš„åªè¯»ä»£ç†ï¼Œä¹Ÿå°±æ˜¯å®ƒä¾ç„¶æ˜¯ä¸€ä¸ª Proxyï¼Œä½†æ˜¯setæ–¹æ³•è¢«åŠ«æŒ å¼€å‘ä¸­å¸¸è§çš„readonlyæ–¹æ³•ä¼šä¼ å…¥ä¸‰ä¸ªç±»å‹çš„å€¼ æ™®é€šå¯¹è±¡ reactive è¿”å›çš„å¯¹è±¡ ref çš„å¯¹è±¡ readonly ä½¿ç”¨æ—¶ï¼Œreadonly è¿”å›çš„å¯¹è±¡ä¸å…è®¸ä¿®æ”¹ï¼Œä½†æ˜¯ç»è¿‡ readonly å¤„ç†çš„åŸæ¥çš„å¯¹è±¡æ˜¯å¯ä»¥ä¿®æ”¹çš„ const info = &#123; name: &quot;why&quot;&#125;const state = readonly(info)state.name = &quot;aaa&quot; // ä¸å¯ä»¥info.name = &quot;aaa&quot; // å¯ä»¥ 5. computed ç”¨æ³•ä¸€ï¼šä¼ å…¥ä¸€ä¸ªgetterå‡½æ•°,computedçš„è¿”å›å€¼æ˜¯ä¸€ä¸ªåªè¯»çš„refå¯¹è±¡(ä¸èƒ½ä¿®æ”¹) const fullName = computed(() =&gt; firstName.value + &quot;-&quot; +lastName.value)const changeData = () =&gt; &#123; firstName.value = &quot;james&quot; // å¯ä¿®æ”¹ fullName.value = &quot;yuzi bing&quot; // ä¸å¯ä¿®æ”¹&#125; ç”¨æ³•äºŒï¼šä¼ å…¥ä¸€ä¸ªå¯¹è±¡,å¯¹è±¡åŒ…å« getter/setter,è¿”å›ä¸€ä¸ªå¯è¯»å†™çš„ref å¯¹è±¡ const fullName = computed(&#123; get: () =&gt; firstName.value + &quot;-&quot; +lastName.value, set(newValue) &#123; const names = newValue.split(&#x27; &#x27;) firstName.value = names[0] lastName.value = names[1] &#125;&#125;)const changeData = () =&gt; &#123; fullName.value = &quot;yuzi bing&quot; // å¯ä¿®æ”¹&#125; 6. watchEffect 6.1 watchEffect åŸºæœ¬ä½¿ç”¨ watchEffect ä¼ å…¥çš„å‡½æ•°ä¼šè¢«ç«‹å³æ‰§è¡Œä¸€æ¬¡, å¹¶åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­è‡ªåŠ¨æ”¶é›†ä¾èµ–ï¼ˆç›¸å½“äºä½ åœ¨è¿™ä¸ªå‡½æ•°ä½¿ç”¨äº†ä»€ä¹ˆå˜é‡ï¼Œå®ƒä¼šè‡ªåŠ¨æ”¶é›†åˆ°ï¼‰ åªæœ‰æ”¶é›†çš„ä¾èµ–å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒwatchEffect ä¼ å…¥çš„å‡½æ•°æ‰ä¼šå†æ¬¡æ‰§è¡Œ ä¸‹é¢æ¡ˆä¾‹ä¸­ï¼Œname çš„æ”¹å˜ä¼šè¢«ä¾¦å¬åˆ°ï¼Œè€Œ age ä¸ä¼šè¢«ä¾¦å¬ // watchEffect: è‡ªåŠ¨æ”¶é›†å“åº”å¼çš„ä¾èµ–const name = ref(&quot;jenny&quot;)const age = ref(18)const changeName = () =&gt; name.value = &quot;tony&quot;const changeAge = () =&gt; age.value = 20watchEffect(() =&gt; &#123; console.log(&quot;name:&quot;, name.value);&#125;) 6.2 watchEffect åœæ­¢ä¾¦å¬ å¦‚æœåœ¨å‘ç”ŸæŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›åœæ­¢ä¾¦å¬ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥è·å–watchEffectçš„è¿”å›å€¼å‡½æ•°ï¼Œè°ƒç”¨è¯¥å‡½æ•°å³å¯ const age = ref(18)// watchEffect ä¼šè¿”å›ä¸€ä¸ªå‡½æ•°,ä¾›æˆ‘ä»¬åœæ­¢ä¾¦å¬ä½¿ç”¨const stop = watchEffect(() =&gt; &#123; console.log(&quot;age:&quot;, age.value);&#125;)const changeAge = () =&gt; &#123; age.value++ // æ¡ˆä¾‹ï¼šage åˆ°25çš„æ—¶å€™å°±åœæ­¢ä¾¦å¬ if (age.value &gt; 25) &#123; stop() &#125;&#125; 6.3 watchEffect æ¸…é™¤å‰¯ä½œç”¨ æ¸…é™¤å‰¯ä½œç”¨ï¼Ÿ æ¯”å¦‚æˆ‘ä»¬éœ€è¦åœ¨ä¾¦å¬å™¨ä¸­æ‰§è¡Œç½‘ç»œè¯·æ±‚ï¼Œä½†æ˜¯åœ¨ç½‘ç»œè¯·æ±‚è¿˜æ²¡å®Œæˆä¹‹å‰ï¼Œæˆ‘ä»¬åœæ­¢äº†ä¾¦å¬å™¨æˆ–è€…ä¿®æ”¹äº†æ•°æ®è®©ä¾¦å¬å™¨ä¾¦å¬å‡½æ•°å†æ¬¡æ‰§è¡Œäº†ï¼Œè¿™æ—¶å€™æˆ‘ä»¬åº”è¯¥æ¸…é™¤ä¸Šä¸€æ¬¡çš„å‰¯ä½œç”¨ï¼ˆæ•°æ®æ”¹å˜äº†è¦é‡æ–°å‘é€è¯·æ±‚æˆ–è€…è¯´ä¸éœ€è¦å‘äº†ï¼‰ const stop = watchEffect((onInvalidate) =&gt; &#123; const timer = setTimeout(() =&gt; &#123; console.log(&#x27;ç½‘ç»œè¯·æ±‚æˆåŠŸ~&#x27;); // å®šæ—¶å™¨æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚ &#125;, 2000); // åœ¨ä¼ å…¥çš„å›è°ƒå‡½æ•°ä¸­æ‰§è¡Œä¸€äº›æ¸…é™¤å·¥ä½œ onInvalidate(() =&gt; &#123; clearTimeout(timer) console.log(&#x27;onInvalidate&#x27;); &#125;) console.log(&quot;age:&quot;, age.value);&#125;) 6.4 watchEffect æ‰§è¡Œæ—¶æœº é¦–å…ˆè¡¥å……ä¸€ä¸‹ï¼šåœ¨ setup ä¸­å¦‚ä½•å±äº ref æˆ–è€…å…ƒç´ æˆ–è€…ç»„ä»¶ï¼Ÿ å®šä¹‰ä¸€ä¸ª ref å¯¹è±¡ï¼Œç»‘å®šåˆ°å…ƒç´ æˆ–ç»„ä»¶çš„refå±æ€§ä¸Š &lt;h2 ref=&quot;title&quot;&gt;hello&lt;/h2&gt; // ç»‘å®šåˆ°å…ƒç´ çš„refå±æ€§const title = ref(null) // å®šä¹‰ ref å¯¹è±¡ watchEffect æ‰§è¡Œæ—¶æœº å¦‚æœæˆ‘ä»¬å¸Œæœ›åœ¨å‰¯ä½œç”¨å‡½æ•°ä¸­è·å–å…ƒç´ ï¼Œæˆ‘ä»¬ä¼šå‘ç°æ‰“å°ç»“æœæœ‰ä¸¤ä¸ª watchEffect(() =&gt; &#123; console.log(title.value);&#125;) è¿™æ˜¯å› ä¸º setup å‡½æ•°åœ¨æ‰§è¡Œæ—¶å°±ä¼šç«‹å³æ‰§è¡Œä¼ å…¥çš„å‰¯ä½œç”¨å‡½æ•°ï¼Œè¿™ä¸ªæ—¶å€™ DOM å¹¶æ²¡æœ‰æŒ‚è½½ï¼Œæ‰€ä»¥æ‰“å°ä¸º null å½“ DOM æŒ‚è½½æ—¶ï¼Œä¼šç»™ title çš„ ref å¯¹è±¡èµ‹æ–°çš„å€¼ï¼Œå‰¯ä½œç”¨å‡½æ•°ä¼šå†æ¬¡æ‰§è¡Œ è°ƒæ•´ watchEffect çš„æ‰§è¡Œæ—¶æœº watchEffect(() =&gt; &#123; console.log(title.value);&#125;, &#123; // flush: &quot;pre&quot; // åœ¨å…ƒç´ æŒ‚è½½æˆ–æ›´æ–°ä¹‹å‰æ‰§è¡Œ flush: &quot;post&quot; // å…ƒç´ æŒ‚è½½æ›´æ–°ä¹‹åæ‰§è¡Œ, è¿™æ—¶å€™åªæ‰“å°ä¸€æ¬¡&lt;h2&gt;&lt;/h2&gt;&#125;) 7. watch 7.1 ä¾¦å¬å•ä¸ªæ•°æ®æº ä¾¦å¬ä¸€ä¸ª getter å‡½æ•° const info = reactive(&#123; name: &quot;jenny&quot;, age: 18&#125;)// 1. watchä¾¦å¬æ—¶,ä¼ å…¥ä¸€ä¸ªgetterå‡½æ•°, å…·ä½“ç›‘å¬æŸä¸ªå±æ€§watch(() =&gt; info.name, (newValue, oldValue) =&gt; &#123; console.log(newValue, oldValue); // Tom jenny&#125;)const changeData = () =&gt; &#123; info.name = &quot;Tom&quot;&#125; ç›´æ¥ä¾¦å¬ä¸€ä¸ªå¯å“åº”å¼çš„å¯¹è±¡ï¼Œreactive æˆ– ref ï¼ˆrefæ›´å¸¸ç”¨ï¼‰ // ä¼ å…¥ä¸€ä¸ªå¯å“åº”å¼å¯¹è±¡: reactiveå¯¹è±¡/refå¯¹è±¡const title = ref(&quot;hello&quot;)const info = reactive(&#123; name: &quot;jenny&quot;, age: 18&#125;)watch(info, (newValue, oldValue) =&gt; &#123; console.log(newValue, oldValue); // Proxy &#123;name: &#x27;Tom&#x27;, age: 18&#125;&#125;)watch(title, (newValue, oldValue) =&gt; &#123; console.log(newValue, oldValue); // world hello&#125;)const changeData = () =&gt; &#123; info.name = &quot;Tom&quot; title.value = &quot;world&quot;&#125; 7.2 ä¾¦å¬å¤šä¸ªæ•°æ®æº æ³¨ï¼šå¦‚æœæˆ‘ä»¬å¸Œæœ›ä¾¦å¬ä¸€ä¸ªæ•°ç»„æˆ–è€…å¯¹è±¡ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ä¸€ä¸ªgetterå‡½æ•°ï¼Œå¹¶ä¸”å¯¹å¯å“åº”å¯¹è±¡è¿›è¡Œè§£æ„ (ä¸è§£æ„ä¹Ÿè¡Œ,ä¸è§£æ„n,oå°±æ˜¯ä¸€ä¸ªProxyå¯¹è±¡) const info = reactive(&#123; name: &quot;jenny&quot;, age: 18&#125;)const title = ref(&quot;hello&quot;)// åŒæ—¶ä¾¦å¬å¤šä¸ªæ•°æ®æºwatch([() =&gt; (&#123;...info&#125;), title], ([newInfo, newTitle], [oldInfo, oldTitle]) =&gt; &#123; console.log(newInfo, newTitle, oldInfo, oldTitle); // &#123;name: &#x27;Tom&#x27;, age: 18&#125; &#x27;world&#x27; // &#123;name: &#x27;jenny&#x27;, age: 18&#125; &#x27;hello&#x27;&#125;)const changeData = () =&gt; &#123; info.name = &quot;Tom&quot; title.value = &quot;world&quot;&#125; 7.3 watch çš„é€‰é¡¹ const info = reactive(&#123; name: &quot;jenny&quot;, hobby: &#123; title: &#x27;haha&#x27; &#125;&#125;)watch(() =&gt; (&#123;...info&#125;), (newValue, oldValue) =&gt; &#123; console.log(newValue, oldValue);&#125;, &#123; deep: true, // æ·±åº¦ç›‘å¬ immediate: true // ç«‹å³æ‰§è¡Œä¸€æ¬¡&#125;)const changeData = () =&gt; &#123; // info.name = &quot;Tom&quot; info.hobby.title = &quot;hehe&quot; // å¼€å¯æ·±åº¦ç›‘å¬&#125; 8. ç”Ÿå‘½å‘¨æœŸé’©å­ // åœ¨æŒ‚è½½å¼€å§‹ä¹‹å‰è¢«è°ƒç”¨ï¼šç›¸å…³çš„ render å‡½æ•°é¦–æ¬¡è¢«è°ƒç”¨ã€‚onBeforeMount(() =&gt; &#123;&#125;)// å®ä¾‹æŒ‚è½½å®Œæ¯•åè°ƒç”¨onMounted(() =&gt; &#123;&#125;)// åœ¨æ•°æ®å‘ç”Ÿæ”¹å˜åï¼ŒDOM è¢«æ›´æ–°ä¹‹å‰è¢«è°ƒç”¨ã€‚è¿™é‡Œé€‚åˆåœ¨ç°æœ‰ DOM å°†è¦è¢«æ›´æ–°ä¹‹å‰è®¿é—®å®ƒï¼Œæ¯”å¦‚ç§»é™¤æ‰‹åŠ¨æ·»åŠ çš„äº‹ä»¶ç›‘å¬å™¨ã€‚onBeforeUpdate(() =&gt; &#123;&#125;)// åœ¨æ•°æ®æ›´æ”¹å¯¼è‡´çš„è™šæ‹Ÿ DOM é‡æ–°æ¸²æŸ“å’Œæ›´æ–°å®Œæ¯•ä¹‹åè¢«è°ƒç”¨ã€‚onUpdated(() =&gt; &#123;&#125;)// å¸è½½ç»„ä»¶å®ä¾‹å‰è°ƒç”¨, è¿™ä¸ªé˜¶æ®µ,å®ä¾‹ä»ç„¶æ˜¯å®Œå…¨æ­£å¸¸çš„onBeforeUnmount(() =&gt; &#123;&#125;)// å¸è½½ç»„ä»¶å®ä¾‹åè°ƒç”¨,è°ƒç”¨æ­¤é’©å­æ—¶ï¼Œç»„ä»¶å®ä¾‹çš„æ‰€æœ‰æŒ‡ä»¤éƒ½è¢«è§£é™¤ç»‘å®šï¼Œæ‰€æœ‰äº‹ä»¶ä¾¦å¬å™¨éƒ½è¢«ç§»é™¤ï¼Œæ‰€æœ‰å­ç»„ä»¶å®ä¾‹è¢«å¸è½½ã€‚onUnmounted(() =&gt; &#123;&#125;),// è¢« keep-alive ç¼“å­˜çš„ç»„ä»¶æ¿€æ´»æ—¶è°ƒç”¨ã€‚onActivated(() =&gt; &#123;&#125;)// è¢« keep-alive ç¼“å­˜çš„ç»„ä»¶å¤±æ´»æ—¶è°ƒç”¨ã€‚onDeactivated(()=&gt;&#123;&#125;) 9. Provide å’Œ Inject çˆ¶ç»„ä»¶é€šè¿‡ provide æ¥æä¾›æ•°æ®ï¼ˆå¿…é¡»è¦åœ¨çˆ¶ç»„ä»¶ä¸­ä½¿ç”¨è¿‡å­ç»„ä»¶ï¼Œå»ºç«‹è”ç³»æ‰èƒ½æä¾›æ•°æ®ï¼‰ provide(å±æ€§åï¼Œå±æ€§å€¼) const name = ref(&quot;jenny&quot;)// ç»™åä»£ç»„ä»¶æä¾›å±æ€§æˆ–æ–¹æ³•(ä¸ºäº†ä¸è®©å­ç»„ä»¶éšæ„ä¿®æ”¹çˆ¶ç»„ä»¶çš„æ•°æ®,å¯ä»¥ä½¿ç”¨readonly)provide(&quot;name&quot;, readonly(name)) åä»£ç»„ä»¶å¯ä»¥é€šè¿‡ Inject æ¥æ³¨å…¥éœ€è¦çš„å±æ€§å’Œå¯¹åº”å€¼ inject(è¦æ³¨å…¥çš„å±æ€§å, é»˜è®¤å€¼) ï¼Œé»˜è®¤å€¼å°±æ˜¯å¦‚æœçˆ¶ç»„ä»¶æ²¡æœ‰æä¾›æ”¹æ•°æ®çš„è¯å°±ä½¿ç”¨é»˜è®¤å€¼ const name = inject(&quot;name&quot;) 10. composition API ç»ƒä¹  è‡ªå®šä¹‰ hooks 1. useTitle æ”¹å˜é¡µé¢æ ‡é¢˜ import &#123; ref, watch &#125; from &#x27;vue&#x27;export default function(title = &quot;é»˜è®¤çš„title&quot;) &#123; const titleRef = ref(title) watch(titleRef, (newValue) =&gt; &#123; document.title = newValue &#125;, &#123; immediate: true &#125;) return titleRef&#125; 2. useScrollPosition ç›‘å¬é¡µé¢æ»šåŠ¨ä½ç½® import &#123; ref &#125; from &#x27;vue&#x27;export default function useScrollPosition() &#123; const scrollX = ref(0) const scrollY = ref(0) document.addEventListener(&quot;scroll&quot;, () =&gt; &#123; scrollX.value = window.scrollX scrollY.value = window.scrollY &#125;) return &#123; scrollX, scrollY &#125;&#125; 3. useMousePosition ç›‘å¬é¼ æ ‡ä½ç½® import &#123; ref &#125; from &#x27;vue&#x27;export default function useMousePosition() &#123; const mouseX = ref(0) const mouseY = ref(0) window.addEventListener(&#x27;mousemove&#x27;, (event) =&gt; &#123; mouseX.value = event.pageX mouseY.value = event.pageY &#125;) return &#123; mouseX, mouseY &#125;&#125; 4. useLocalStorage ä½¿ç”¨ localStorage å­˜å‚¨å’Œè·å–æ•°æ® export default function(key, value) &#123; const data = ref(value) // å¦‚æœæœ‰ä¼ value,è¡¨ç¤ºè¦å­˜å‚¨å€¼,å¦åˆ™æ˜¯è·å–å€¼ if (value) &#123; window.localStorage.setItem(key, JSON.stringify(value)) &#125; else &#123; data.value = JSON.parse(window.localStorage.getItem(key)) &#125; watch(data, (newValue) =&gt; &#123; window.localStorage.setItem(key, JSON.stringify(newValue)) &#125;) return data&#125; ä½¿ç”¨ï¼š // åœ¨æµè§ˆå™¨å­˜å–å€¼let data = useLocalStorage(&quot;name&quot;, &quot;jenny&quot;)const changeData = () =&gt; data.value = &quot;hahaha&quot; 5. useCounter import &#123; ref, computed &#125; from &#x27;vue&#x27;;export default function() &#123; const counter = ref(0); const doubleCounter = computed(() =&gt; counter.value * 2); const increment = () =&gt; counter.value++; const decrement = () =&gt; counter.value--; return &#123; counter, doubleCounter, increment, decrement &#125;&#125; 11. è®¤è¯†è‡ªå®šä¹‰æŒ‡ä»¤ 11.1 ç®€å•ä½¿ç”¨ é™¤äº† v-for, v-showï¼Œç­‰æŒ‡ä»¤ï¼ŒVueä¹Ÿå…è®¸æˆ‘ä»¬è‡ªå®šä¹‰æŒ‡ä»¤ è‡ªå®šä¹‰æŒ‡ä»¤åˆ†ä¸ºä¸¤ç§ è‡ªå®šä¹‰å±€éƒ¨æŒ‡ä»¤ï¼šç»„ä»¶ä¸­é€šè¿‡ directives é€‰é¡¹ï¼Œåªèƒ½åœ¨å½“å‰ç»„ä»¶ä¸­ä½¿ç”¨ è‡ªå®šä¹‰å…¨å±€æŒ‡ä»¤ï¼šappçš„ directive æ–¹æ³•ï¼Œå¯ä»¥åœ¨ä»»æ„ç»„ä»¶ä¸­è¢«ä½¿ç”¨ ç®€å•çš„æ¡ˆä¾‹ï¼šå½“æŸä¸ªå…ƒç´ æŒ‚è½½å®Œæˆåå¯ä»¥è‡ªå®šè·å–ç„¦ç‚¹ é»˜è®¤æ–¹å¼çš„å®ç° &lt;template&gt; &lt;div&gt; &lt;input type=&quot;text&quot; ref=&quot;input&quot;&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;import &#123;ref, onMounted&#125; from &#x27;vue&#x27;export default &#123; setup() &#123; const input = ref(null) onMounted(() =&gt; &#123; input.value.focus() &#125;) return &#123; input &#125; &#125;&#125; è‡ªå®šä¹‰å±€éƒ¨æŒ‡ä»¤ v-focus &lt;input type=&quot;text&quot; ref=&quot;input&quot; v-focus&gt;export default &#123; directives: &#123; // è‡ªå®šä¹‰å±æ€§çš„åç§°(è¿™é‡Œä¸éœ€è¦å†™ v-) focus: &#123; mounted(el) &#123; el.focus() &#125; &#125; &#125;,&#125; è‡ªå®šä¹‰å…¨å±€æŒ‡ä»¤ v-focus (main.jsä¸­) app.directive(&quot;focus&quot;, &#123; mounted(el) &#123; el.focus() &#125;&#125;) 11.2 æŒ‡ä»¤çš„ç”Ÿå‘½å‘¨æœŸ ä¸€ä¸ªæŒ‡ä»¤å®šä¹‰çš„å¯¹è±¡ï¼ŒVueæä¾›äº†å¦‚ä¸‹çš„å‡ ä¸ªé’©å­å‡½æ•°ï¼š createdï¼šåœ¨ç»‘å®šå…ƒç´ çš„ attribute æˆ–äº‹ä»¶ç›‘å¬å™¨è¢«åº”ç”¨ä¹‹å‰è°ƒç”¨ï¼› beforeMountï¼šå½“æŒ‡ä»¤ç¬¬ä¸€æ¬¡ç»‘å®šåˆ°å…ƒç´ å¹¶ä¸”åœ¨æŒ‚è½½çˆ¶ç»„ä»¶ä¹‹å‰è°ƒç”¨ mountedï¼šåœ¨ç»‘å®šå…ƒç´ çš„çˆ¶ç»„ä»¶è¢«æŒ‚è½½åè°ƒç”¨ beforeUpdateï¼šåœ¨æ›´æ–°åŒ…å«ç»„ä»¶çš„ VNode ä¹‹å‰è°ƒç”¨ updatedï¼šåœ¨åŒ…å«ç»„ä»¶çš„ VNode åŠå…¶å­ç»„ä»¶çš„ VNode æ›´æ–°åè°ƒç”¨ beforeUnmountï¼šåœ¨å¸è½½ç»‘å®šå…ƒç´ çš„çˆ¶ç»„ä»¶ä¹‹å‰è°ƒç”¨ unmountedï¼šå½“æŒ‡ä»¤ä¸å…ƒç´ è§£é™¤ç»‘å®šä¸”çˆ¶ç»„ä»¶å·²å¸è½½æ—¶ï¼Œåªè°ƒç”¨ä¸€æ¬¡ æŒ‡ä»¤çš„ç”Ÿå‘½å‘¨æœŸå¯ä»¥æ‹¿åˆ°å‡ ä¸ªå‚æ•° app.directive(&quot;focus&quot;, &#123; // el: &lt;input&gt; // bindings: åŒ…å«ä¸€äº›å±æ€§çš„å¯¹è±¡ // vnode: ä¸€ä¸ªçœŸå® DOM å…ƒç´  // preVnode: ä¸Šä¸€ä¸ªè™šæ‹ŸèŠ‚ç‚¹ mounted(el, bindings, vnode, preVnode) &#123; console.log(&quot;focus created&quot;, el, bindings, vnode, preVnode); console.log(bindings.value); // æ‹¿åˆ°ä¼ å…¥çš„å‚æ•° console.log(bindings.modifiers); // æŒ‡ä»¤çš„ä¿®é¥°ç¬¦ el.focus() &#125;&#125;) 11.3 æŒ‡ä»¤çš„å‚æ•°å’Œä¿®é¥°ç¬¦ æŒ‡ä»¤æ¥å—å‚æ•°æˆ–è€…ä¿®é¥°ç¬¦ v-æŒ‡ä»¤å:å‚æ•°å.ä¿®é¥°ç¬¦=&quot;å…·ä½“å€¼&quot;&lt;button v-why:info.aaa.bbb=&quot;&#123;title: &#x27;hello&#x27;, name: &#x27;me&#x27;&#125;&quot;&gt;&lt;/button&gt; 11.4 è‡ªå®šä¹‰æŒ‡ä»¤ç»ƒä¹  è‡ªå®šä¹‰æ—¶é—´æ ¼å¼åŒ–çš„æŒ‡ä»¤ v-format-time import dayjs from &quot;dayjs&quot;;export default function(app) &#123; app.directive(&quot;format-time&quot;, &#123; created(el, bindings) &#123; // é»˜è®¤æ ¼å¼ bindings.formatString = &quot;YYYY-MM-DD HH:mm:ss&quot; // å¦‚æœæœ‰ä¼ å…¥æ ¼å¼çš„å‚æ•°ï¼Œé‚£ä¹ˆä½¿ç”¨ä¼ å…¥çš„æ ¼å¼ if (bindings.value) &#123; bindings.formatString = bindings.value &#125; &#125;, mounted(el, bindings) &#123; const textContent = el.textContent // èŠ‚ç‚¹åŠå…¶åä»£çš„æ–‡æœ¬å†…å®¹ let timestamp = parseInt(textContent) if (textContent.length === 10) &#123; timestamp = timestamp * 1000 // è½¬æˆæ¯«ç§’ &#125; el.textContent = dayjs(timestamp).format(bindings.formatString) &#125;, &#125;)&#125; 12. nextTick å°†å›è°ƒæ¨è¿Ÿåˆ°ä¸‹ä¸€ä¸ª DOM æ›´æ–°å‘¨æœŸä¹‹åæ‰§è¡Œã€‚åœ¨æ›´æ”¹äº†ä¸€äº›æ•°æ®ä»¥ç­‰å¾… DOM æ›´æ–°åç«‹å³ä½¿ç”¨å®ƒ æ¡ˆä¾‹ï¼šå½“messageæ›´æ–°æ—¶ï¼Œæ‹¿åˆ°å®ƒçš„é«˜åº¦ å¦‚æœä¸æ”¾åˆ° nextTickæ‰§è¡Œï¼Œæ‹¿åˆ°çš„å°±æ˜¯æœªæ›´æ–°ä¹‹å‰çš„æ•°æ®ï¼Œæ¯”å¦‚ç¬¬ä¸€æ¬¡ç‚¹æ·»åŠ å†…å®¹ï¼Œè¾“å‡º0 &lt;template&gt; &lt;div&gt; &lt;h2 class=&quot;title&quot; ref=&quot;titleRef&quot;&gt;&#123;&#123;message&#125;&#125;&lt;/h2&gt; &lt;button @click=&quot;addContent&quot;&gt;æ·»åŠ å†…å®¹&lt;/button&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;import &#123; ref, nextTick &#125; from &#x27;vue&#x27;export default &#123; setup() &#123; const message = ref(&quot;&quot;) const titleRef = ref(null) const addContent = () =&gt; &#123; message.value += &quot;å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ&quot; // console.log(titleRef.value.offsetHeight); nextTick(() =&gt; &#123; console.log(titleRef.value.offsetHeight); &#125;) &#125; ... &#125;&#125;&lt;/script&gt; nextTickçš„å›è°ƒå‡½æ•°ä¼šè¢«åŠ å…¥åˆ°å¾®ä»»åŠ¡é˜Ÿåˆ—ä¹‹åï¼Œåœ¨å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼ŒDOMæ›´æ–°å®Œä¹‹åæ‰è½®åˆ°å®ƒæ‰§è¡Œ å…¶ä»–è¡¥å…… 1. renderå‡½æ•° 1.1 è®¤è¯† h å‡½æ•° ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„HTMLéƒ½æ˜¯ç”¨æ¨¡æ¿&lt;template&gt;åˆ›å»ºçš„ï¼Œå¦‚æœåœ¨ä¸€äº›ç‰¹æ®Šçš„åœºæ™¯ï¼ŒçœŸçš„éœ€è¦JavaScriptçš„å®Œå…¨ç¼–ç¨‹èƒ½åŠ›ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥ä½¿ç”¨ æ¸²æŸ“å‡½æ•°ï¼Œå®ƒæ¯”æ¨¡æ¿æ›´æ¥è¿‘ç¼–è¯‘å™¨ Vueåœ¨ç”ŸæˆçœŸå®çš„ DOM ä¹‹å‰ï¼Œä¼šå°†æˆ‘ä»¬çš„èŠ‚ç‚¹è½¬æ¢æˆ VNodeï¼ˆè™šæ‹ŸèŠ‚ç‚¹ï¼‰ï¼Œè€ŒVNodeç»„åˆåœ¨ä¸€èµ·å½¢æˆä¸€æ£µæ ‘ç»“æ„ï¼Œå°±æ˜¯è™šæ‹ŸDOMï¼ˆVDOMï¼‰ ä½ æƒ³å……åˆ†çš„åˆ©ç”¨JavaScriptçš„ç¼–ç¨‹èƒ½åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±æ¥ç¼–å†™ createVNode å‡½æ•°ï¼Œç”Ÿæˆå¯¹åº”çš„ VNode h()å‡½æ•°æ˜¯ä¸€ä¸ªç”¨äºåˆ›å»º VNode çš„å‡½æ•° 1.2 h å‡½æ•°åŸºæœ¬ä½¿ç”¨ h() å‡½æ•°æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼Œï¼ˆæ ‡ç­¾åï¼Œç»„ä»¶åâ€¦ï¼‰ï¼ˆå±æ€§ï¼‰ï¼ˆå­èŠ‚ç‚¹ï¼Œå†…å®¹ï¼‰ h å‡½æ•°å¯ä»¥åœ¨ä¸¤ä¸ªåœ°æ–¹ä½¿ç”¨ï¼Œrender å‡½æ•°é€‰é¡¹ä¸­æˆ–è€… setup å‡½æ•°é€‰é¡¹ä¸­ // render å‡½æ•°é€‰é¡¹ä¸­&lt;script&gt; import &#123; h &#125; from &#x27;vue&#x27; export default &#123; render() &#123; return h(&quot;h2&quot;, &#123;class: &quot;title&quot;&#125;, &quot;Hello Render&quot;) &#125;, &#125;&lt;/script&gt; setup() &#123; return () =&gt; h(&quot;h2&quot;, &#123;class: &quot;title&quot;&#125;, &quot;Hello Render&quot;)&#125; 1.3 h å‡½æ•°å®ç°è®¡æ•°å™¨æ¡ˆä¾‹ import &#123; h &#125; from &#x27;vue&#x27;;export default &#123; data() &#123; return &#123; counter: 0 &#125; &#125;, render() &#123; return h(&quot;div&quot;, &#123;class: &quot;app&quot;&#125;, [ h(&quot;h2&quot;, null, `å½“å‰è®¡æ•°:$&#123;this.counter&#125;`), h(&quot;button&quot;, &#123;onClick: () =&gt; this.counter++&#125;, &quot;+1&quot;), h(&quot;button&quot;, &#123;onClick: () =&gt; this.counter--&#125;, &quot;-1&quot;) ]) &#125;,&#125; 2. jsx åœ¨é¡¹ç›®ä¸­ä½¿ç”¨ jsx éœ€è¦æ·»åŠ å¯¹ jsx çš„æ”¯æŒ å®‰è£…Babelæ”¯æŒVueçš„jsxæ’ä»¶ npm install @vue/babel-plugin-jsx -D åœ¨ babel.config.js é…ç½®æ–‡ä»¶ä¸­é…ç½®æ’ä»¶ module.exports = &#123; plugins: [ &quot;@vue/babel-plugin-jsx&quot; ]&#125; åŸºæœ¬ä½¿ç”¨ï¼šè®¡æ•°å™¨æ¡ˆä¾‹ export default &#123; data() &#123; return &#123; counter: 0 &#125; &#125;, render() &#123; const increment = () =&gt; this.counter++; const decrement = () =&gt; this.counter--; return ( &lt;div&gt; &lt;h2&gt;å½“å‰è®¡æ•°: &#123;this.counter&#125;&lt;/h2&gt; &lt;button onClick=&#123;increment&#125;&gt;+1&lt;/button&gt; &lt;button onClick=&#123;decrement&#125;&gt;-1&lt;/button&gt; &lt;/div&gt; ) &#125;&#125; 3. è®¤è¯† Teleport (å…ˆäº†è§£ä¸€ä¸‹) åœ¨ç»„ä»¶åŒ–å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å°è£…ä¸€ä¸ªç»„ä»¶Aï¼Œåœ¨å¦å¤–ä¸€ä¸ªç»„ä»¶Bä¸­ä½¿ç”¨ï¼Œp é‚£ä¹ˆç»„ä»¶Aä¸­templateçš„å…ƒç´ ï¼Œä¼šè¢«æŒ‚è½½åˆ°ç»„ä»¶Bä¸­templateçš„æŸä¸ªä½ç½®ï¼Œæœ€ç»ˆå½¢æˆä¸€æ£µ DOM æ ‘ç»“æ„ ä½†æ˜¯æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›ç»„ä»¶ä¸æ˜¯æŒ‚è½½åœ¨è¿™ä¸ªç»„ä»¶æ ‘ä¸Šçš„ï¼Œå¯èƒ½æ˜¯ç§»åŠ¨åˆ°Vue appä¹‹å¤–çš„å…¶ä»–ä½ç½®ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥é€šè¿‡teleportå®Œæˆ 4. è®¤è¯† Vue æ’ä»¶ é€šå¸¸æˆ‘ä»¬å‘Vueå…¨å±€æ·»åŠ ä¸€äº›åŠŸèƒ½æ—¶ï¼Œä¼šé‡‡ç”¨æ’ä»¶çš„æ¨¡å¼ï¼Œå®ƒæœ‰ä¸¤ç§ç¼–å†™æ–¹å¼ å¯¹è±¡ç±»å‹ï¼šä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯å¿…é¡»åŒ…å«ä¸€ä¸ª install çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°ä¼šåœ¨å®‰è£…æ’ä»¶æ—¶æ‰§è¡Œ export default &#123; install(app) &#123; // app.config.globalProperties.$name = &quot;hillyee&quot; &#125;&#125; å‡½æ•°ç±»å‹ï¼šä¸€ä¸ªfunctionï¼Œè¿™ä¸ªå‡½æ•°ä¼šåœ¨å®‰è£…æ’ä»¶æ—¶è‡ªåŠ¨æ‰§è¡Œ // plugins_function.jsexport default function(app) &#123; console.log(app);&#125; main.js app.use(pluginsFunction)app.use(pluginsObject)","categories":[{"name":"æ·±å…¥Vue3+Typescriptå­¦ä¹ âš¡","slug":"æ·±å…¥Vue3-Typescriptå­¦ä¹ âš¡","permalink":"https://hillyee.github.io/categories/%E6%B7%B1%E5%85%A5Vue3-Typescript%E5%AD%A6%E4%B9%A0%E2%9A%A1/"}],"tags":[]},{"title":"é¢è¯•é¢˜ â€” JSç¯‡","slug":"é¢è¯•é¢˜â€”JSç¯‡","date":"2022-03-31T01:17:39.000Z","updated":"2022-04-14T02:13:22.300Z","comments":true,"path":"2022/03/31/é¢è¯•é¢˜â€”JSç¯‡/","link":"","permalink":"https://hillyee.github.io/2022/03/31/%E9%9D%A2%E8%AF%95%E9%A2%98%E2%80%94JS%E7%AF%87/","excerpt":"","text":"é¢è¯•é¢˜ â€” JSç¯‡ é—®ï¼šJS åŸå§‹æ•°æ®ç±»å‹æœ‰å“ªäº›ï¼Ÿå¼•ç”¨æ•°æ®ç±»å‹æœ‰å“ªäº›ï¼Ÿ ç­”ï¼šåœ¨JSä¸­,å­˜åœ¨7ä¸­åŸå§‹æ•°æ®ç±»å‹,åˆ†åˆ«æ˜¯ï¼š boolean,null,undefined,number,string,symbol,bigint å¼•ç”¨ç±»å‹ï¼šObject(åŒ…å«æ™®é€šå¯¹è±¡ Object, æ•°ç»„å¯¹è±¡ Array, æ­£åˆ™å¯¹è±¡ RegExp,æ—¥æœŸå¯¹è±¡ Date,æ•°å­—å‡½æ•° Math,å‡½æ•°å¯¹è±¡ Function) Symbolè¡¨ç¤ºç‹¬ä¸€æ— äºŒçš„å€¼ï¼Œä¸»è¦æ˜¯ç”¨æ¥å®šä¹‰å¯¹è±¡çš„å”¯ä¸€å±æ€§å bigint å¯ä»¥è¡¨ç¤ºä»»æ„å¤§å°çš„æ•´æ•° é—®ï¼šè¯·è¯´å‡ºä¸‹é¢ä»£ç çš„è¿è¡Œç»“æœï¼Œå¹¶è§£é‡ŠåŸå›  function test(person) &#123; person.age = 26 person = &#123; name: &#x27;hzj&#x27;, age: 18 &#125; return person&#125;const p1 = &#123; name: &#x27;fyq&#x27;, age: 19&#125;const p2 = test(p1)console.log(p1) // -&gt; &#123;name: &#x27;fyq&#x27;,age: 26&#125;console.log(p2) // -&gt; &#123; name: &#x27;hzj&#x27;,age: 18 &#125; ç­”ï¼šå› ä¸ºåœ¨testå‡½æ•°ä¼ å‚çš„æ—¶å€™ï¼Œå®é™…ä¸Šä¼ é€’çš„æ˜¯p1å¯¹è±¡åœ¨å †ä¸­çš„å†…å­˜åœ°å€å€¼ï¼Œæ‰€ä»¥é€šè¿‡è°ƒç”¨person.age = 26ç¡®å®æ”¹å˜äº†p1çš„å€¼ï¼Œä½†æ˜¯éšåpersonå˜æˆäº†å¦ä¸€å—å†…å­˜ç©ºé—´çš„åœ°å€ï¼Œå¹¶ä¸”åœ¨æœ€åå°†è¿™ä¸ªå†…å­˜ç©ºé—´çš„åœ°å€è¿”å›ï¼Œç„¶åèµ‹å€¼ç»™äº†p2 é—®ï¼šä¸‹é¢ä»£ç çš„è¾“å‡ºç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ(. å’Œ = æ“ä½œç¬¦çš„ä¼˜å…ˆçº§) let a = &#123;n : 1&#125;let b = aa.x = a = &#123;n: 2&#125; console.log(a.x) // undefinedconsole.log(b.x) // &#123;n:2&#125; é¦–å…ˆæˆ‘ä»¬è¦çŸ¥é“ åœ¨jsçš„è¿ç®—ä¸­&quot;.â€œå’Œâ€=â€œè¿ç®—ç¬¦åŒæ—¶å‡ºç°æ—¶ï¼Œä¼šå…ˆæ‰§è¡Œâ€.&quot;è¿ç®— æ‰€ä»¥ a.x = a = {n:2} --&gt; a.x = {n:2} --&gt; a = {n:2} é—®ï¼š0.1+0.2ä¸ºä»€ä¹ˆä¸ç­‰äº0.3ï¼Ÿ ç­”ï¼š(è¿›åˆ¶è½¬æ¢) jsåœ¨åšæ•°å­—è®¡ç®—çš„æ—¶å€™ï¼Œ0.1å’Œ0.2éƒ½ä¼šè¢«è½¬æˆäºŒè¿›åˆ¶åæ— é™å¾ªç¯ï¼Œä½†æ˜¯jsé‡‡ç”¨çš„IEEE 754äºŒè¿›åˆ¶æµ®ç‚¹è¿ç®—ï¼Œæœ€å¤§å¯ä»¥å­˜å‚¨53ä½æœ‰æ•ˆæ•°å­—ï¼Œäºæ˜¯å¤§äº53ä½åé¢çš„ä¼šå…¨éƒ¨æˆªæ‰ï¼Œå°†ä¼šå¯¼è‡´ç²¾åº¦ç¼ºå¤±ã€‚ (å¯¹é˜¶è¿ç®—) ç”±äºæŒ‡æ•°ä½æ•°ä¸ç›¸åŒï¼Œè¿ç®—æ—¶éœ€è¦å¯¹é˜¶è¿ç®—ï¼Œè¿™éƒ¨åˆ†ä¹Ÿå¯èƒ½äº§ç”Ÿç²¾åº¦ç¼ºå¤± https://juejin.cn/post/6940405970954616839 https://juejin.cn/post/6844903680362151950 ä½ çœŸçš„äº†è§£ä½œç”¨åŸŸå—ï¼Ÿ var a = 0,b = 0;function A(a) &#123; A = function (b) &#123; console.log(a + b++) &#125; console.log(a++)&#125;A(1) // 1A(2) // 4 â€˜1â€™.toString()ä¸ºä»€ä¹ˆå¯ä»¥è°ƒç”¨ï¼Ÿ å®é™…ä¸Šè¿™ä¸ªè¯­å¥è¿è¡Œçš„è¿‡ç¨‹ä¸­åšäº†ä»¥ä¸‹å‡ ä»¶äº‹ï¼š var s = new Object(&quot;1&quot;) // ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºObjectå®ä¾‹ã€‚s.toString() // ç¬¬äºŒæ­¥ï¼šè°ƒç”¨å®ä¾‹æ–¹æ³•s = null // ç¬¬ä¸‰æ­¥ï¼šæ‰§è¡Œå®Œæ–¹æ³•ç«‹å³é”€æ¯è¿™ä¸ªå®ä¾‹ åˆ›å»ºObjectå®ä¾‹ã€‚æ³¨æ„ä¸ºä»€ä¹ˆä¸æ˜¯Stringï¼Ÿç”±äºSymbolå’ŒBigIntçš„å‡ºç°ï¼Œå¯¹å®ƒä»¬è°ƒç”¨newéƒ½ä¼šæŠ¥é”™ï¼Œç›®å‰ES6è§„èŒƒä¹Ÿä¸å»ºè®®ç”¨newæ¥åˆ›å»ºåŸºæœ¬ç±»å‹çš„åŒ…è£…ç±» æ•´ä¸ªè¿‡ç¨‹ä½“ç°äº†åŸºæœ¬åŒ…è£…ç±»å‹çš„æ€§è´¨ï¼Œè€ŒåŸºæœ¬åŒ…è£…ç±»å‹æ°æ°å±äºåŸºæœ¬æ•°æ®ç±»å‹ï¼ŒåŒ…æ‹¬Booleanï¼ŒNumberå’ŒString æ•°æ®ç±»å‹çš„åˆ¤æ–­ typeofï¼šèƒ½åˆ¤æ–­æ‰€æœ‰å€¼ç±»å‹ï¼Œå‡½æ•°ã€‚ä¸å¯å¯¹nullã€å¯¹è±¡ã€æ•°ç»„è¿›è¡Œç²¾ç¡®åˆ¤æ–­ï¼Œå› ä¸ºéƒ½è¿”å›object console.log(typeof undefined); // undefinedconsole.log(typeof 2); // numberconsole.log(typeof true); // booleanconsole.log(typeof &quot;str&quot;); // stringconsole.log(typeof Symbol(&quot;foo&quot;)); // symbolconsole.log(typeof 2172141653n); // bigintconsole.log(typeof function () &#123;&#125;); // function// ä¸èƒ½åˆ¤åˆ«console.log(typeof []); // objectconsole.log(typeof &#123;&#125;); // objectconsole.log(typeof null); // object instanceofï¼šå¯ç”¨äºåˆ¤æ–­å¯¹è±¡ç±»å‹ instanceof è¿ç®—ç¬¦ç”¨äºæ£€æµ‹æ„é€ å‡½æ•°çš„ prototype å±æ€§æ˜¯å¦å‡ºç°åœ¨æŸä¸ªå®ä¾‹å¯¹è±¡çš„åŸå‹é“¾ä¸Šã€‚ const Person = function() &#123;&#125;const p1 = new Person() // p1.__proto__ === Person.prototypep1 instanceof Person // true å³Personæ„é€ å‡½æ•°çš„prototypeå‡ºç°åœ¨å®ä¾‹p1çš„åŸå‹é“¾ä¸Švar str1 = &quot;hello&quot;str1 instanceof String // falseï¼ˆstr1ä¸æ˜¯å¯¹è±¡å®ä¾‹ï¼‰var str2 = new String(&quot;hello&quot;)str2 instanceof String // true Object.prototype.toString.call()ï¼šæ‰€æœ‰åŸå§‹æ•°æ®ç±»å‹éƒ½èƒ½åˆ¤æ–­ Object.prototype.toString.call(2); // &quot;[object Number]&quot;Object.prototype.toString.call(&quot;&quot;); // &quot;[object String]&quot;Object.prototype.toString.call(true); // &quot;[object Boolean]&quot;Object.prototype.toString.call(undefined); // &quot;[object Undefined]&quot;Object.prototype.toString.call(null); // &quot;[object Null]&quot;Object.prototype.toString.call(Math); // &quot;[object Math]&quot;Object.prototype.toString.call(&#123;&#125;); // &quot;[object Object]&quot;Object.prototype.toString.call([]); // &quot;[object Array]&quot;Object.prototype.toString.call(function () &#123;&#125;); // &quot;[object Function]&quot; ä¸ºä»€ä¹ˆè¦ç”¨callå»è°ƒç”¨toStringæ–¹æ³•å‘¢ï¼Ÿ å€Ÿç”¨ObjectåŸå‹å¯¹è±¡ä¸Šçš„toStringæ–¹æ³•ï¼Œé€šè¿‡thisç»‘å®šè°ƒç”¨ï¼Œè¿”å›&quot;[object ç±»å‹]&quot; å¦‚ä½•åˆ¤æ–­å˜é‡æ˜¯å¦ä¸ºæ•°ç»„ï¼Ÿ Array.isArray(arr); // truearr.__proto__ === Array.prototype; // truearr instanceof Array; // trueObject.prototype.toString.call(arr); // &quot;[object Array]&quot; == å’Œ === æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ === å«ä¸¥æ ¼ç›¸ç­‰ï¼Œå·¦å³ä¸¤è¾¹ä¸ä»…å€¼è¦ç›¸ç­‰ï¼Œç±»å‹ä¹Ÿè¦ç›¸ç­‰ == å¯¹äºä¸€èˆ¬æƒ…å†µï¼Œåªè¦å€¼ç›¸ç­‰å°±è¿”å› trueï¼Œä½† == è¿˜æ¶‰åŠä¸€äº›ç±»å‹è½¬æ¢ï¼Œè½¬æ¢è§„åˆ™å¦‚ä¸‹ï¼š ä¸¤è¾¹ç±»å‹æ˜¯å¦ç›¸åŒï¼Œç›¸åŒçš„è¯å°±æ¯”è¾ƒå€¼çš„å¤§å°ï¼Œå¦‚ï¼š1==2 false åˆ¤æ–­ä¸¤è¾¹æ˜¯å¦æ˜¯ null å’Œ undefinedï¼Œæ˜¯çš„è¯å°±è¿”å›true ä¸¤è¾¹æ˜¯å¦æ˜¯ String å’Œ Numberï¼Œæ˜¯çš„è¯ï¼Œå°±æŠŠStringç±»å‹è½¬æ¢æˆ Numberï¼Œå†è¿›è¡Œæ¯”è¾ƒ åˆ¤æ–­å…¶ä¸­ä¸€è¾¹æ˜¯å¦æ˜¯ Booleanï¼Œæ˜¯çš„è¯å°±æŠŠBooleanè½¬æ¢æˆNumberï¼Œå†è¿›è¡Œæ¯”è¾ƒ å¦‚æœå…¶ä¸­ä¸€è¾¹ä¸º Objectï¼Œè€Œå¦ä¸€è¾¹ä¸ºStringã€Numberæˆ–Symbolï¼Œä¼šå°†Objectè½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œå†è¿›è¡Œæ¯”è¾ƒ console.log(&#123;a: 1&#125; == true) // falseconsole.log(&#123;a: 1&#125; == &quot;[object Object]&quot;) // true [ ] == ![ ]çš„ç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ [] == ![] // é€»è¾‘è¿ç®—éœ€è¿›è¡Œå¸ƒå°”å€¼è½¬æ¢, [] -&gt; true[] == !true[] == false // false -&gt; 0[] == 0 // [] è½¬æ¢ä¸ºæ•°å€¼ï¼Œç»è¿‡ [].valueOf() --&gt; [] // [].toString -&gt; &quot;&quot; // &quot;&quot;.toNumber() -&gt; 00 == 0 // true å¯¹è±¡è½¬åŸå§‹ç±»å‹æ˜¯æ ¹æ®ä»€ä¹ˆæµç¨‹è¿è¡Œçš„ï¼Ÿ å¯¹è±¡è½¬åŸå§‹ç±»å‹ï¼Œä¼šè°ƒç”¨å†…ç½®çš„ [ToPrimitive] å‡½æ•°ï¼Œå¯¹äºè¯¥å‡½æ•°ï¼Œå…¶é€»è¾‘å¦‚ä¸‹ï¼š Symbol.toPrimitive æ˜¯ä¸€ä¸ªå†…ç½®çš„ Symbol å€¼ï¼Œå®ƒæ˜¯ä½œä¸ºå¯¹è±¡çš„å‡½æ•°å€¼å±æ€§å­˜åœ¨çš„ï¼Œå½“ä¸€ä¸ªå¯¹è±¡è½¬æ¢ä¸ºå¯¹åº”çš„åŸå§‹å€¼æ—¶ï¼Œä¼šè°ƒç”¨æ­¤å‡½æ•°ã€‚ å¦‚æœæœ‰Symbol.toPrimitive()æ–¹æ³•ï¼Œä¼˜å…ˆè°ƒç”¨å†è¿”å› è°ƒç”¨valueOf()ï¼Œå¦‚æœè½¬æ¢åä¸ºåŸå§‹ç±»å‹ï¼Œåˆ™è¿”å›ï¼Œå¦åˆ™ç»§ç»­ è°ƒç”¨toString()ï¼Œå¦‚æœè½¬æ¢åä¸ºåŸå§‹ç±»å‹ï¼Œåˆ™è¿”å› å¦‚æœéƒ½æ²¡æœ‰è¿”å›åŸå§‹ç±»å‹ï¼Œä¼šæŠ¥é”™ var obj = &#123; value: 3, valueOf() &#123; return 4 &#125;, toString() &#123; return &#x27;5&#x27; &#125;, [Symbol.toPrimitive]() &#123; return 6 &#125;&#125;console.log(obj + 1); // 7 å¦‚ä½•è®© if(a == 1 &amp;&amp; a == 2)æ¡ä»¶æˆç«‹ï¼Ÿ å¦‚æœ a æ˜¯å¯¹è±¡ï¼Œåˆ™åœ¨æ‰§è¡Œ == æ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šæ‰§è¡Œ valueOf æ–¹æ³•(æˆ–toString)ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é‡å†™è¯¥æ–¹æ³•è®©æ¡ä»¶æˆç«‹ var a = &#123; value: 0, valueOf: function() &#123; this.value++ return this.value &#125; &#125;console.log(a == 1 &amp;&amp; a == 2); // true è°ˆè°ˆä½ å¯¹é—­åŒ…çš„ç†è§£ ä»€ä¹ˆæ˜¯é—­åŒ…ï¼Ÿ MDNå¯¹JSé—­åŒ…çš„è§£é‡Šï¼š ä¸€ä¸ªå‡½æ•°å’Œå¯¹å…¶å‘¨å›´çŠ¶æ€ï¼ˆlexical environmentï¼Œè¯æ³•ç¯å¢ƒï¼‰çš„å¼•ç”¨æ†ç»‘åœ¨ä¸€èµ·ï¼ˆæˆ–è€…è¯´å‡½æ•°è¢«å¼•ç”¨åŒ…å›´ï¼‰ï¼Œè¿™æ ·çš„ç»„åˆå°±æ˜¯é—­åŒ…ï¼ˆclosureï¼‰ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œé—­åŒ…è®©ä½ å¯ä»¥åœ¨ä¸€ä¸ªå†…å±‚å‡½æ•°ä¸­è®¿é—®åˆ°å…¶å¤–å±‚å‡½æ•°çš„ä½œç”¨åŸŸã€‚ åœ¨JavaScript ä¸­ï¼Œæ¯å½“åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œé—­åŒ…å°±ä¼šåœ¨å‡½æ•°åˆ›å»ºçš„åŒæ—¶è¢«åˆ›å»ºå‡ºæ¥ã€‚ ä¹Ÿå¯ä»¥è¯´ï¼š é—­åŒ…æ˜¯æŒ‡é‚£äº›èƒ½å¤Ÿè®¿é—®è‡ªç”±å˜é‡çš„å‡½æ•°ã€‚è‡ªç”±å˜é‡æ˜¯æŒ‡åœ¨å‡½æ•°ä¸­ä½¿ç”¨çš„ï¼Œä½†æ—¢ä¸æ˜¯å‡½æ•°å‚æ•°ä¹Ÿä¸æ˜¯å‡½æ•°çš„å±€éƒ¨å˜é‡çš„å˜é‡ é—­åŒ… = å‡½æ•° + å‡½æ•°èƒ½å¤Ÿè®¿é—®çš„è‡ªç”±å˜é‡ é—­åŒ…çš„äº§ç”Ÿ åœ¨æŸä¸ªå†…éƒ¨å‡½æ•°çš„æ‰§è¡Œä¸Šä¸‹æ–‡åˆ›å»ºæ—¶ï¼Œä¼šå°†çˆ¶çº§å‡½æ•°çš„æ´»åŠ¨å¯¹è±¡(VO)åŠ åˆ°å†…éƒ¨å‡½æ•°çš„ [[scope]]ä¸­ï¼Œå½¢æˆä½œç”¨åŸŸé“¾ï¼Œæ‰€ä»¥å³ä½¿çˆ¶çº§å‡½æ•°çš„æ‰§è¡Œä¸Šä¸‹æ–‡é”€æ¯ï¼Œä½†æ˜¯å› ä¸ºå…¶æ´»åŠ¨å¯¹è±¡å®é™…ä¸Šè¿˜å­˜å‚¨åœ¨å†…å­˜ä¸­å¯è¢«å†…éƒ¨å‡½æ•°è®¿é—®åˆ°ï¼Œä»è€Œå®ç°äº†é—­åŒ… é—­åŒ…çš„åº”ç”¨ å‡½æ•°ä½œä¸ºå‚æ•°è¢«ä¼ é€’ var a = 1;function foo()&#123; var a = 2; function baz()&#123; console.log(a); &#125; bar(baz);&#125;function bar(fn)&#123; // è¿™å°±æ˜¯é—­åŒ… fn();&#125;foo(); // 2 å‡½æ•°ä½œä¸ºè¿”å›å€¼è¢«è¿”å› function foo() &#123; const a = 100 return function() &#123; console.log(a); &#125;&#125;const fn = foo()const a = 200fn() // 100 é—­åŒ…ï¼šè‡ªç”±å˜é‡çš„æŸ¥æ‰¾ï¼Œæ˜¯åœ¨å‡½æ•°å®šä¹‰çš„åœ°æ–¹ï¼Œå‘ä¸Šçº§ä½œç”¨åŸŸæŸ¥æ‰¾ã€‚ä¸æ˜¯åœ¨æ‰§è¡Œçš„åœ°æ–¹ å¦‚ä½•è§£å†³ä¸‹é¢çš„å¾ªç¯è¾“å‡ºé—®é¢˜ï¼Ÿ for(var i = 1; i &lt;= 5; i ++)&#123; setTimeout(function timer()&#123; console.log(i) &#125;, 0)&#125; ä¸ºä»€ä¹ˆå…¨éƒ¨è¾“å‡º6ï¼Ÿå¦‚ä½•æ”¹è¿›è®©å®ƒè¾“å‡º1,2,3,4,5ï¼Ÿ å› ä¸ºsetTimeoutä¸ºå®ä»»åŠ¡ï¼Œç”±äºJSä¸­å•çº¿ç¨‹eventLoopæœºåˆ¶ï¼Œåœ¨ä¸»çº¿ç¨‹åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œåæ‰å»æ‰§è¡Œå®ä»»åŠ¡ï¼Œå› æ­¤å¾ªç¯ç»“æŸåsetTimeoutä¸­çš„å›è°ƒæ‰ä¾æ¬¡æ‰§è¡Œï¼Œè¾“å‡ºiçš„æ—¶å€™ï¼Œå½“å‰ä½œç”¨åŸŸæ²¡æœ‰ï¼Œå¾€ä¸Šä¸€å±‚æ‰¾ï¼Œå› ä¸ºå¾ªç¯å·²ç»“æŸï¼Œä¸Šå±‚ä½œç”¨åŸŸä¸­çš„iä¸º6ã€‚å› æ­¤ä¼šå…¨éƒ¨è¾“å‡º6 è§£å†³æ–¹æ³•ï¼š åˆ©ç”¨IIFEï¼Œæ¯æ¬¡forå¾ªç¯æ—¶ï¼ŒæŠŠæ­¤æ—¶çš„ i å˜é‡ä¼ é€’åˆ°å®šæ—¶å™¨ä¸­ IIFEï¼ˆ ç«‹å³è°ƒç”¨å‡½æ•°è¡¨è¾¾å¼ï¼‰æ˜¯ä¸€ä¸ªåœ¨å®šä¹‰æ—¶å°±ä¼šç«‹å³æ‰§è¡Œçš„ JavaScript å‡½æ•° for(var i = 1;i &lt;= 5;i++)&#123; (function(j)&#123; setTimeout(function timer()&#123; console.log(j) &#125;, 0) &#125;)(i)&#125; ç»™å®šæ—¶å™¨ä¼ å…¥ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œä½œä¸ºtimerå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‡½æ•°å‚æ•° å®šæ—¶å™¨ä»ç¬¬ä¸‰ä¸ªå‚æ•°å¼€å§‹æ˜¯é™„åŠ å‚æ•°ï¼Œä¸€æ—¦å®šæ—¶å™¨åˆ°æœŸï¼Œå®ƒä»¬ä¼šä½œä¸ºå‚æ•°ä¼ é€’ç»™function for (var i = 1; i &lt;= 5; i++) &#123; setTimeout(function(j) &#123; console.log(j); &#125;, 0, i)&#125; ä½¿ç”¨ES6ä¸­çš„let letæ˜¯å—çº§ä½œç”¨åŸŸï¼Œç”¨letåï¼Œå˜é‡åªåœ¨å®ƒæ‰€åœ¨çš„ä»£ç å—ç”Ÿæ•ˆï¼Œæ²¡æœ‰ä»€ä¹ˆä½œç”¨åŸŸé“¾äº† // i = 1&#123; setTimeout(function timer() &#123; console.log(1); &#125;, 0)&#125;// i = 2&#123; setTimeout(function timer() &#123; console.log(2); &#125;, 0)&#125;// i = 3&#123; setTimeout(function timer() &#123; console.log(3); // 3 &#125;, 0)&#125;... æ‰€ä»¥å¯ä»¥ä¾æ¬¡è¾“å‡º1,2,3,4,5 è°ˆè°ˆä½ å¯¹åŸå‹é“¾çš„ç†è§£ åŸå‹å¯¹è±¡å’Œæ„é€ å‡½æ•°æœ‰ä½•å…³ç³»ï¼Ÿ åœ¨JavaScriptä¸­ï¼Œæ¯å½“å®šä¹‰ä¸€ä¸ªå‡½æ•°æ•°æ®ç±»å‹ï¼ˆæ™®é€šå‡½æ•°ã€ç±»ï¼‰çš„æ—¶å€™ï¼Œè¿™ä¸ªå‡½æ•°å°±ä¼šè‡ªå¸¦ä¸€ä¸ªprototypeå±æ€§ï¼Œè¿™ä¸ªå±æ€§æŒ‡å‘å‡½æ•°çš„åŸå‹å¯¹è±¡ å¦å¤–ï¼Œè¿™ä¸ªåŸå‹å¯¹è±¡ä¼šæœ‰ä¸€ä¸ªconstructorå±æ€§æŒ‡å›å‡½æ•°æœ¬èº« å½“å‡½æ•°è¢«newè°ƒç”¨çš„æ—¶å€™ï¼Œè¿™ä¸ªå‡½æ•°å°±ç§°ä¸ºäº†æ„é€ å‡½æ•° newè°ƒç”¨ä¼šåˆ›å»ºä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼Œè¿™ä¸ªå®ä¾‹å¯¹è±¡ä¼šè‡ªå¸¦ä¸€ä¸ª__proto__å±æ€§ï¼Œè¿™ä¸ªå±æ€§æŒ‡å‘æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ å³o.__proto__ === Foo.prototype æè¿°ä¸€ä¸‹åŸå‹é“¾ï¼Ÿ JavaScriptå¯¹è±¡é€šè¿‡__proto__æŒ‡å‘çˆ¶ç±»åŸå‹å¯¹è±¡ï¼Œç›´åˆ°æŒ‡å‘Objectå¯¹è±¡ä¸ºæ­¢ï¼Œè¿™æ ·å°±å½¢æˆäº†ä¸€ä¸ªåŸå‹æŒ‡å‘çš„é“¾æ¡ï¼Œå³åŸå‹é“¾ åŸå‹é“¾æœ€é¡¶å±‚çš„åŸå‹å¯¹è±¡å°±æ˜¯Objectçš„åŸå‹å¯¹è±¡ å¦å¤–ï¼Œæ£€æŸ¥å¯¹è±¡è‡ªèº«æ˜¯å¦åŒ…å«æŸå±æ€§ï¼Œå¯ä»¥ä½¿ç”¨ hasOwnProperty() ä½¿ç”¨ in çš„è¯ï¼Œå³ä½¿è‡ªèº«æ²¡æœ‰ï¼Œä½†æ˜¯åŸå‹é“¾ä¸­æœ‰ï¼Œä¹Ÿä¼šè¿”å›true ç»¿è‰²ç®­å¤´ï¼ŒåŸå‹é“¾ o.__proto__.__proto__.__proto__ å¸¦ç€æ˜é‡‘çš„å„ç§æ–‡ç« ä¸€èµ·çœ‹,æ‰¾åˆ°è‡ªå·±æƒ³è¦çš„ç­”æ¡ˆ åšäº†ä¸€ä»½å‰ç«¯é¢è¯•å¤ä¹ è®¡åˆ’ï¼Œä¿ç†Ÿï½ é“¾æ¥ï¼šhttps://juejin.cn/post/7061588533214969892 ç¥åä¸‰-åŸç”ŸJSçµé­‚ä¹‹é—®, è¯·é—®ä½ èƒ½æ¥å¾—ä½å‡ ä¸ª é“¾æ¥ï¼šhttps://juejin.cn/post/6844903974378668039 å­—èŠ‚è·³åŠ¨æœ€çˆ±è€ƒçš„å‰ç«¯é¢è¯•é¢˜ï¼šJavaScript åŸºç¡€ é“¾æ¥ï¼šhttps://juejin.cn/post/6934500357091360781 ã€ŒæŸ¥ç¼ºè¡¥æ¼ã€é€ä½  54 é“ JavaScript é¢è¯•é¢˜ é“¾æ¥ï¼šhttps://juejin.cn/post/6854573211443544078#comment","categories":[{"name":"ğŸ˜£é¢è¯•é¢˜-jsç¯‡","slug":"ğŸ˜£é¢è¯•é¢˜-jsç¯‡","permalink":"https://hillyee.github.io/categories/%F0%9F%98%A3%E9%9D%A2%E8%AF%95%E9%A2%98-js%E7%AF%87/"}],"tags":[{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"https://hillyee.github.io/tags/%E9%9D%A2%E8%AF%95/"},{"name":"js","slug":"js","permalink":"https://hillyee.github.io/tags/js/"}]},{"title":"TCPä¸‰æ¬¡æ¡æ‰‹","slug":"TCPä¸‰æ¬¡æ¡æ‰‹","date":"2022-03-30T12:11:13.000Z","updated":"2022-04-01T00:36:00.738Z","comments":true,"path":"2022/03/30/TCPä¸‰æ¬¡æ¡æ‰‹/","link":"","permalink":"https://hillyee.github.io/2022/03/30/TCP%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B/","excerpt":"","text":"1. TCP ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹ ? ï¼ˆé¦–å…ˆï¼Œä¸¤ä¸ªæ¦‚å¿µï¼šSYNï¼šåŒæ­¥æ ‡å¿— ACKï¼šç¡®è®¤æ ‡å¿—ï¼‰ åˆšå¼€å§‹å®¢æˆ·ç«¯å¤„äº Closed çš„çŠ¶æ€ï¼ŒæœåŠ¡ç«¯å¤„äº Listen çŠ¶æ€ã€‚è¿›è¡Œä¸‰æ¬¡æ¡æ‰‹ï¼š ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼Œå®¢æˆ·ç«¯ç»™æœåŠ¡å™¨å‘é€ä¸€ä¸ªSYNæŠ¥æ–‡ï¼Œå¹¶æŒ‡æ˜å®¢æˆ·ç«¯çš„åˆå§‹åŒ–åºåˆ—å· ISNã€‚æ­¤æ—¶å®¢æˆ·ç«¯å¤„äº SYN_SEND çŠ¶æ€ ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼ŒæœåŠ¡å™¨æ”¶åˆ° SYN æŠ¥æ–‡ä¹‹åï¼Œä¼šä»¥è‡ªå·±çš„ SYN æŠ¥æ–‡ä½œä¸ºåº”ç­”ï¼Œå¹¶ä¸”ä¹Ÿæ˜¯æŒ‡å®šäº†è‡ªå·±çš„åˆå§‹åŒ–åºåˆ—å·åºåˆ—å· ISNï¼ŒåŒæ—¶ä¼šæŠŠå®¢æˆ·ç«¯çš„ ISN + 1 ä½œä¸º ACK çš„å€¼ï¼Œè¡¨ç¤ºè‡ªå·±å·²ç»æ”¶åˆ°äº†å®¢æˆ·ç«¯çš„ SYNï¼Œæ­¤æ—¶æœåŠ¡å™¨å¤„äº SYN_REVD çš„çŠ¶æ€ ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼Œå®¢æˆ·ç«¯æ”¶åˆ° SYN æŠ¥æ–‡ä¹‹åï¼Œä¼šå›åº”ä¸€ä¸ª ACK æŠ¥æ–‡ï¼Œä¹Ÿæ˜¯ä¸€æ ·çš„æŠŠæœåŠ¡å™¨çš„ ISN + 1 ä½œä¸º ACK çš„å€¼ï¼Œè¡¨ç¤ºå·²ç»æ”¶åˆ°äº†æœåŠ¡ç«¯çš„ SYN æŠ¥æ–‡ï¼Œæ­¤æ—¶å®¢æˆ·ç«¯å¤„äº established çŠ¶æ€ æœ€åæœåŠ¡å™¨æ”¶åˆ° ACK æŠ¥æ–‡ä¹‹åï¼Œä¹Ÿå¤„äº established çŠ¶æ€ï¼Œæ­¤æ—¶ï¼ŒåŒæ–¹å»ºç«‹è¿æ¥ 2. ä¸ºä»€ä¹ˆéœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿä¸¤æ¬¡ä¸è¡Œå—ï¼Ÿ å…¶å®è¿™æ˜¯ç”± TCP çš„è‡ªèº«ç‰¹ç‚¹å¯é ä¼ è¾“å†³å®šçš„ã€‚ ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼Œå®¢æˆ·ç«¯å‘é€ç½‘ç»œåŒ…ï¼ŒæœåŠ¡ç«¯æ”¶åˆ°äº†ï¼Œè¿™æ ·æœåŠ¡ç«¯å°±èƒ½å¾—å‡ºç»“è®ºï¼šå®¢æˆ·ç«¯çš„å‘é€èƒ½åŠ›ã€æœåŠ¡ç«¯çš„æ¥æ”¶èƒ½åŠ›æ˜¯æ­£å¸¸çš„ ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼ŒæœåŠ¡ç«¯å‘åŒ…ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°äº†ã€‚è¿™æ ·å®¢æˆ·ç«¯å°±èƒ½å¾—å‡ºç»“è®ºï¼šæœåŠ¡ç«¯çš„å‘é€èƒ½åŠ›ã€å®¢æˆ·ç«¯çš„æ¥æ”¶èƒ½åŠ›æ˜¯æ­£å¸¸çš„ã€‚ ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼Œå®¢æˆ·ç«¯å‘åŒ…ï¼ŒæœåŠ¡ç«¯æ”¶åˆ°äº†ã€‚è¿™æ ·æœåŠ¡ç«¯å°±èƒ½å¾—å‡ºç»“è®ºï¼šå®¢æˆ·ç«¯çš„æ¥æ”¶ã€å‘é€èƒ½åŠ›æ­£å¸¸ï¼ŒæœåŠ¡å™¨è‡ªå·±çš„å‘é€ï¼Œæ¥æ”¶èƒ½åŠ›ä¹Ÿæ­£å¸¸ã€‚ 3. (ISN) æ˜¯å›ºå®šçš„å—? ä¸‰æ¬¡æ¡æ‰‹çš„ä¸€ä¸ªé‡è¦åŠŸèƒ½æ˜¯å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯äº¤æ¢ ISN ï¼Œä»¥ä¾¿è®©å¯¹æ–¹çŸ¥é“æ¥ä¸‹æ¥æ¥å—æ•°æ®çš„æ—¶å€™å¦‚ä½•æŒ‰åºåˆ—å·ç»„è£…æ•°æ® å¦‚æœ ISN æ˜¯å›ºå®šçš„ï¼Œæ”»å‡»è€…å¾ˆå®¹æ˜“çŒœå‡ºåç»­çš„ç¡®è®¤å·ï¼Œå› æ­¤ ISN æ˜¯åŠ¨æ€ç”Ÿæˆçš„ 4. ä¸‰æ¬¡æ¡æ‰‹è¿‡ç¨‹ä¸­å¯ä»¥æºå¸¦æ•°æ®å— ç¬¬ä¸‰æ¬¡æ¡æ‰‹çš„æ—¶å€™å¯ä»¥æºå¸¦æ•°æ®ã€‚å› ä¸ºå‡å¦‚ç¬¬ä¸€æ¬¡æ¡æ‰‹å¯ä»¥æºå¸¦æ•°æ®çš„è¯ï¼Œå¦‚æœæœ‰äººè¦æ¶æ„æ”»å‡»æœåŠ¡å™¨ï¼Œé‚£ä»–æ¯æ¬¡éƒ½åœ¨ç¬¬ä¸€æ¬¡æ¡æ‰‹ä¸­çš„ SYN æŠ¥æ–‡ä¸­æ”¾å…¥å¤§é‡çš„æ•°æ®ï¼Œå› ä¸ºæ”»å‡»è€…æ ¹æœ¬å°±ä¸ç†æœåŠ¡å™¨çš„æ¥æ”¶ã€å‘é€èƒ½åŠ›æ˜¯å¦æ­£å¸¸ã€‚ç„¶åç–¯ç‹‚é‡å¤å‘ SYN æŠ¥æ–‡çš„è¯ï¼Œè¿™ä¼šè®©æœåŠ¡å™¨èŠ±è´¹å¾ˆå¤šæ—¶é—´ã€å†…å­˜ç©ºé—´æ¥æ¥æ”¶è¿™äº›æŠ¥æ–‡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç¬¬ä¸€æ¬¡æ¡æ‰‹å¯ä»¥æ”¾æ•°æ®çš„è¯ï¼Œå¯èƒ½ä¼šè®©æœåŠ¡å™¨æ›´åŠ å®¹æ˜“å—åˆ°æ”»å‡»ã€‚ è€Œå¯¹äºç¬¬ä¸‰æ¬¡çš„è¯ï¼Œå®¢æˆ·ç«¯å·²ç»å»ºç«‹èµ·è¿æ¥äº†ï¼Œå¹¶ä¸”ä¹Ÿå·²ç»çŸ¥é“æœåŠ¡å™¨çš„æ¥æ”¶ã€å‘é€èƒ½åŠ›æ˜¯æ­£å¸¸çš„ï¼Œæ‰€ä»¥æºå¸¦æ•°æ®ä¹Ÿæ²¡é—®é¢˜ 5. å››æ¬¡æŒ¥æ‰‹ï¼Ÿä¸ºä»€ä¹ˆè¦å››æ¬¡ï¼Ÿ åˆšå¼€å§‹åŒæ–¹éƒ½å¤„äº established çŠ¶æ€ï¼Œå‡å¦‚æ˜¯å®¢æˆ·ç«¯å…ˆå‘èµ·å…³é—­è¯·æ±‚ï¼Œåˆ™ï¼š åˆšå¼€å§‹åŒæ–¹éƒ½å¤„äºestablishedçŠ¶æ€ï¼Œå‡å¦‚æ˜¯å®¢æˆ·ç«¯å…ˆå‘èµ·å…³é—­è¯·æ±‚ ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ï¼šå®¢æˆ·ç«¯å‘é€ä¸€ä¸ªFINæŠ¥æ–‡ï¼ŒæŠ¥æ–‡ä¸­ä¼šæŒ‡å®šä¸€ä¸ªåºåˆ—å·ã€‚æ­¤æ—¶å®¢æˆ·ç«¯å¤„äºFIN_WAIT1çŠ¶æ€ ç¬¬äºŒæ¬¡æŒ¥æ‰‹ï¼šæœåŠ¡ç«¯æ”¶åˆ°FINä¹‹åï¼Œä¼šå‘é€ACKæŠ¥æ–‡ï¼Œä¸”æŠŠå®¢æˆ·ç«¯çš„åºåˆ—å·å€¼+1ä½œä¸ºACKæŠ¥æ–‡çš„åºåˆ—å·å€¼ï¼Œè¡¨æ˜å·²ç»æ”¶åˆ°å®¢æˆ·ç«¯çš„æŠ¥æ–‡äº†ï¼Œæ­¤æ—¶æœåŠ¡ç«¯å¤„äºCLOSE_WAITçŠ¶æ€ ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹ï¼šå¦‚æœæœåŠ¡ç«¯ä¹Ÿæƒ³æ–­å¼€è¿æ¥äº†ï¼Œå’Œå®¢æˆ·ç«¯çš„ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ä¸€æ ·ï¼Œå‘é€FINæŠ¥æ–‡ï¼Œä¸”æŒ‡å®šä¸€ä¸ªåºåˆ—å·ã€‚æ­¤æ—¶æœåŠ¡ç«¯å¤„äºLAST_ACKçš„çŠ¶æ€ ç¬¬å››æ¬¡æŒ¥æ‰‹ï¼šå®¢æˆ·ç«¯æ”¶åˆ° FIN ä¹‹åï¼Œä¸€æ ·å‘é€ä¸€ä¸ª ACK æŠ¥æ–‡ä½œä¸ºåº”ç­”ï¼Œä¸”æŠŠæœåŠ¡ç«¯çš„åºåˆ—å·å€¼ +1 ä½œä¸ºè‡ªå·± ACK æŠ¥æ–‡çš„åºåˆ—å·å€¼ï¼Œæ­¤æ—¶å®¢æˆ·ç«¯å¤„äº TIME_WAIT çŠ¶æ€ã€‚éœ€è¦è¿‡ä¸€é˜µå­ä»¥ç¡®ä¿æœåŠ¡ç«¯æ”¶åˆ°è‡ªå·±çš„ACKæŠ¥æ–‡ä¹‹åæ‰ä¼šè¿›å…¥CLOSEDçŠ¶æ€ï¼ŒæœåŠ¡ç«¯æ”¶åˆ°ACKæŠ¥æ–‡ä¹‹åï¼Œå°±å¤„äºå…³é—­è¿æ¥äº†ï¼Œå¤„äºCLOSEDçŠ¶æ€ã€‚ 6. SYN æ”»å‡»æ˜¯ä»€ä¹ˆï¼Ÿ æœåŠ¡å™¨ç«¯çš„èµ„æºåˆ†é…æ˜¯åœ¨äºŒæ¬¡æ¡æ‰‹æ—¶åˆ†é…çš„ï¼Œè€Œå®¢æˆ·ç«¯çš„èµ„æºæ˜¯åœ¨å®Œæˆä¸‰æ¬¡æ¡æ‰‹æ—¶åˆ†é…çš„ï¼Œæ‰€ä»¥æœåŠ¡å™¨å®¹æ˜“å—åˆ° SYN æ´ªæ³›æ”»å‡»ã€‚SYN æ”»å‡»å°±æ˜¯ Client åœ¨çŸ­æ—¶é—´å†…ä¼ªé€ å¤§é‡ä¸å­˜åœ¨çš„ IP åœ°å€ï¼Œå¹¶å‘ Server ä¸æ–­åœ°å‘é€ SYN åŒ…ï¼ŒServer åˆ™å›å¤ç¡®è®¤åŒ…ï¼Œå¹¶ç­‰å¾… Client ç¡®è®¤ï¼Œç”±äºæºåœ°å€ä¸å­˜åœ¨ï¼Œå› æ­¤ Server éœ€è¦ä¸æ–­é‡å‘ç›´è‡³è¶…æ—¶ï¼Œè¿™äº›ä¼ªé€ çš„ SYN åŒ…å°†é•¿æ—¶é—´å ç”¨æœªè¿æ¥é˜Ÿåˆ—ï¼Œå¯¼è‡´æ­£å¸¸çš„ SYN è¯·æ±‚å› ä¸ºé˜Ÿåˆ—æ»¡è€Œè¢«ä¸¢å¼ƒï¼Œä»è€Œå¼•èµ·ç½‘ç»œæ‹¥å¡ç”šè‡³ç³»ç»Ÿç˜«ç—ªã€‚ æ£€æµ‹ SYN æ”»å‡»ï¼Ÿ æ£€æµ‹ SYN æ”»å‡»éå¸¸çš„æ–¹ä¾¿ï¼Œå½“ä½ åœ¨æœåŠ¡å™¨ä¸Šçœ‹åˆ°å¤§é‡çš„åŠè¿æ¥çŠ¶æ€æ—¶ï¼Œç‰¹åˆ«æ˜¯æº IP åœ°å€æ˜¯éšæœºçš„ï¼ŒåŸºæœ¬ä¸Šå¯ä»¥æ–­å®šè¿™æ˜¯ä¸€æ¬¡ SYN æ”»å‡»ã€‚ å¸¸è§çš„é˜²å¾¡ SYN æ”»å‡»çš„æ–¹æ³•ï¼Ÿ ç¼©çŸ­è¶…æ—¶æ—¶é—´ å¢åŠ æœ€å¤§åŠè¿æ¥æ•° è¿‡æ»¤ç½‘å…³é˜²æŠ¤ SYN cookiesæŠ€æœ¯ 7. ä»€ä¹ˆæ˜¯åŠè¿æ¥é˜Ÿåˆ—ï¼Ÿ æœåŠ¡å™¨ç¬¬ä¸€æ¬¡æ”¶åˆ°å®¢æˆ·ç«¯çš„ SYN ä¹‹åï¼Œå°±ä¼šå¤„äº SYN_REVD çŠ¶æ€ï¼Œæ­¤æ—¶åŒæ–¹è¿˜æ²¡æœ‰å®Œå…¨å»ºç«‹èµ·è¿æ¥ï¼ŒæœåŠ¡å™¨ä¼šæŠŠæ­¤ç§çŠ¶æ€ä¸‹è¯·æ±‚è¿æ¥æ”¾åœ¨ä¸€ä¸ªé˜Ÿåˆ—é‡Œï¼Œè¿™ç§é˜Ÿåˆ—ç§°ä¹‹ä¸ºåŠè¿æ¥é˜Ÿåˆ—ã€‚","categories":[{"name":"è®¡ç®—æœºç½‘ç»œ","slug":"è®¡ç®—æœºç½‘ç»œ","permalink":"https://hillyee.github.io/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"}],"tags":[{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"https://hillyee.github.io/tags/%E9%9D%A2%E8%AF%95/"}]},{"title":"var_let_conståŒºåˆ«","slug":"var-let-conståŒºåˆ«","date":"2022-03-30T12:08:54.000Z","updated":"2022-03-31T10:46:51.382Z","comments":true,"path":"2022/03/30/var-let-conståŒºåˆ«/","link":"","permalink":"https://hillyee.github.io/2022/03/30/var-let-const%E5%8C%BA%E5%88%AB/","excerpt":"","text":"varã€letã€const ç›¸å…³ varï¼ˆES5ï¼‰let,constï¼ˆES6ï¼‰ 1. ä½œç”¨åŸŸï¼Ÿ ç®€å•æ¥è¯´ï¼Œä½œç”¨åŸŸå°±æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„åœ°ç›˜ï¼Œå¤–å±‚ä½œç”¨åŸŸæ— æ³•è¯»å–å†…å±‚ä½œç”¨åŸŸçš„å˜é‡ï¼Œä½†æ˜¯å†…å±‚ä½œç”¨åŸŸå¯ä»¥è®¿é—®å¤–å±‚ä½œç”¨åŸŸçš„å˜é‡æˆ–è€…å®šä¹‰å¤–å±‚ä½œç”¨åŸŸçš„åŒåå˜é‡ã€‚ 2. var å˜é‡æå‡ï¼Ÿ var ç‰¹ç‚¹ï¼Ÿ æ— è®ºåœ¨å…¨å±€ä½œç”¨åŸŸè¿˜æ˜¯åœ¨å±€éƒ¨ä½œç”¨åŸŸä¸­ï¼Œä½¿ç”¨ var å…³é”®å­—å£°æ˜çš„å˜é‡éƒ½ä¼šè¢«æå‡åˆ°è¯¥ä½œç”¨åŸŸçš„æœ€é¡¶éƒ¨ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„å˜é‡æå‡ åœ¨ä»£ç é¢„ç¼–è¯‘çš„æ—¶å€™ï¼ŒJavaScript å¼•æ“ä¼šè‡ªåŠ¨å°†æ‰€æœ‰ä»£ç é‡Œé¢ä»¥var å…³é”®å­—å£°æ˜çš„è¯­å¥æå‡åˆ°å½“å‰ä½œç”¨åŸŸçš„é¡¶ç«¯ function fn1() &#123; var name = &quot;jack&quot;&#125;// ç­‰ä»·äºfunction fn1() &#123; var name; name = &quot;jack&quot;&#125; console.log(name) // undefinedvar name = &quot;jack&quot; var çš„ç‰¹ç‚¹ å­˜åœ¨å˜é‡æå‡ åœ¨å˜é‡æœªèµ‹å€¼æ—¶ï¼Œå˜é‡ä¸º undefined ä¸€ä¸ªå˜é‡å¯ä»¥å¤šæ¬¡å£°æ˜ï¼Œåé¢çš„å£°æ˜ä¼šè¦†ç›–å‰é¢çš„å£°æ˜ åœ¨å‡½æ•°ä¸­ä½¿ç”¨ var å£°æ˜å˜é‡çš„æ—¶å€™ï¼Œè¯¥å˜é‡æ˜¯å±€éƒ¨çš„ï¼ˆå› ä¸ºåœ¨ä½¿ç”¨ var å£°æ˜å˜é‡æ—¶ï¼Œå˜é‡ä¼šè¢«è‡ªåŠ¨æ·»åŠ åˆ°æœ€æ¥è¿‘çš„ä¸Šä¸‹æ–‡ã€‚åœ¨å‡½æ•°ä¸­ï¼Œæœ€æ¥è¿‘çš„ä¸Šä¸‹æ–‡å°±æ˜¯å‡½æ•°çš„å±€éƒ¨ä¸Šä¸‹æ–‡ï¼‰ function add(num1, num2) &#123; var sum = num1 + num2; return sum&#125;let result = add(10, 20) // 30console.log(sum) // æŠ¥é”™ sum is not defined å¦‚æœå‡½æ•°å†…ä¸ä½¿ç”¨ var å£°æ˜ï¼Œè¯¥å˜é‡æ˜¯å…¨å±€çš„ï¼Œsum è¢«æ·»åŠ åˆ°å…¨å±€ä¸Šä¸‹æ–‡ï¼ˆwindowï¼‰window.sum function add(num1, num2) &#123; sum = num1 + num2; return sum&#125;let result = add(10, 20) // 30console.log(sum) // 30 3. let let ä¸å­˜åœ¨å˜é‡æå‡ï¼Œlet å£°æ˜å˜é‡å‰ï¼Œè¯¥å˜é‡ä¸èƒ½ä½¿ç”¨(æš‚æ—¶æ€§æ­»åŒº) let ä¸ºå—çº§ä½œç”¨åŸŸï¼Œæ‰€æœ‰å¤–é¢çš„è¯­å¥å—è®¿é—®ä¸åˆ° console.log(value) // æŠ¥é”™let value = &#x27;hello&#x27; let ä¸å…è®¸é‡å¤å£°æ˜ï¼Œå¦‚æœåœ¨åŒä¸€ä¸ªä½œç”¨åŸŸä¸­æŸä¸ªå˜é‡å·²ç»å­˜åœ¨ï¼Œå†æ¬¡ä½¿ç”¨ let å…³é”®å­—å£°æ˜çš„è¯ä¼šæŠ¥é”™ 4. const ä¸ let æ²¡ä»€ä¹ˆå¤§ä¸åŒ const å£°æ˜çš„æ˜¯å¸¸é‡ï¼Œå¸¸é‡å°±æ˜¯ä¸€æ—¦å®šä¹‰å®Œå°±ä¸èƒ½ä¿®æ”¹çš„å€¼ã€‚ å¿…é¡»åˆå§‹åŒ–å€¼ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼šconst å˜é‡ä¸èƒ½å†è¢«é‡æ–°èµ‹å€¼ä¸ºå…¶ä»–å¼•ç”¨å€¼ï¼Œä½†å¯¹è±¡çš„é”®ä¸å—é™åˆ¶ ä¹Ÿå°±æ˜¯è¯´ï¼Œå¹¶ä¸æ˜¯å˜é‡çš„å€¼ä¸èƒ½æ”¹åŠ¨ï¼Œè€Œæ˜¯å˜é‡æŒ‡å‘çš„é‚£ä¸ªå†…å­˜åœ°å€ä¸å¾—æ”¹åŠ¨ const obj1 = &#123;&#125;obj1 = &#123;&#125; // æŠ¥é”™ï¼Œä¸èƒ½ç»™å¸¸é‡èµ‹å€¼const obj2 = &#123; name: &quot;jack&quot; &#125;obj2.name = &quot;tony&quot; // æ²¡é—®é¢˜ 5. æš‚æ—¶æ€§æ­»åŒºï¼Ÿ å¦‚æœåŒºå—ä¸­å­˜åœ¨ let å’Œ const å‘½ä»¤ï¼Œä»¥è¿™ä¸ªå‘½ä»¤å£°æ˜çš„å˜é‡ä»ä¸€å¼€å§‹å°±å½¢æˆäº†å°é—­ä½œç”¨åŸŸã€‚å‡¡æ˜¯åœ¨å£°æ˜ä¹‹å‰å°±æ˜¯ç”¨è¿™äº›å˜é‡ï¼Œå°±ä¼šæŠ¥é”™ æ€»ä¹‹ï¼Œåœ¨ä»£ç å—å†…ï¼Œä½¿ç”¨ let å‘½ä»¤å£°æ˜å˜é‡ä¹‹å‰ï¼Œè¯¥å˜é‡éƒ½æ˜¯ä¸å¯ç”¨çš„ã€‚è¿™åœ¨è¯­æ³•ä¸Šï¼Œç§°ä¸º â€œæš‚æ—¶æ€§æ­»åŒºâ€(temporal dead zone ç®€ç§° TDZ ) if (true) &#123; // TDZ å¼€å§‹ tmp = &quot;abc&quot;; console.log(tmp); // æŠ¥é”™ let tmp; // TDZ ç»“æŸ console.log(tmp) tmp = 123; console.log(tmp); // 123&#125; ä¸Šé¢ä»£ç ä¸­ï¼Œåœ¨ let å‘½ä»¤å£°æ˜å˜é‡ tmp ä¹‹å‰ï¼Œéƒ½å±äºå˜é‡ tmp çš„æ­»åŒº 6. åœ¨ for å¾ªç¯ä¸­ä½¿ç”¨ varï¼Œlet çš„åŒºåˆ« for(var i = 0;i&lt;10;i++)&#123; setTimeout(function()&#123; console.log(i) &#125;,100)&#125; // è¾“å‡ºå…¨æ˜¯10// å› ä¸º i æ˜¯å…¨å±€å˜é‡ï¼Œæœ€åè®¿é—®çš„éƒ½æ˜¯å…¨å±€å˜é‡ for(let i = 0;i&lt;10;i++)&#123; setTimeout(function()&#123; console.log(i) &#125;,100)&#125; // 0123456789; // i æ˜¯å±€éƒ¨å˜é‡ï¼Œæ¯æ¬¡å¾ªç¯æ”¹å˜çš„æ˜¯å¯¹å±€éƒ¨å˜é‡èµ‹å€¼","categories":[{"name":"JavaScript","slug":"JavaScript","permalink":"https://hillyee.github.io/categories/JavaScript/"}],"tags":[{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"https://hillyee.github.io/tags/%E9%9D%A2%E8%AF%95/"}]},{"title":"04_å®ç°call_apply_bind","slug":"04_æ‰‹å†™call-apply-bind","date":"2022-03-30T11:49:46.000Z","updated":"2022-04-03T07:40:31.531Z","comments":true,"path":"2022/03/30/04_æ‰‹å†™call-apply-bind/","link":"","permalink":"https://hillyee.github.io/2022/03/30/04_%E6%89%8B%E5%86%99call-apply-bind/","excerpt":"","text":"callã€applyã€bind å®ç° 1. call å®ç° é¦–å…ˆæˆ‘ä»¬è¦çŸ¥é“ç³»ç»Ÿçš„ call æ–¹æ³•ä¸»è¦å®ç°äº†ä»€ä¹ˆ æ‰§è¡Œäº†å‡½æ•° æ”¹å˜äº† this çš„æŒ‡å‘ å…ˆçœ‹ç³»ç»Ÿçš„callæ–¹æ³• function foo() &#123; console.log(&quot;fooå‡½æ•°è¢«æ‰§è¡Œ&quot;, this);&#125;function sum(num1, num2) &#123; console.log(&quot;sumå‡½æ•°è¢«æ‰§è¡Œ&quot;, this); return num1 + num2&#125;// 1. ä¼ å…¥å¯¹è±¡foo.call(&#123;&#125;) // 2. ä¼ å…¥null/undefinedfoo.call(null) // thisè‡ªåŠ¨æ›¿æ¢ä¸ºæŒ‡å‘å…¨å±€å¯¹è±¡// 3. ä¼ å…¥å…¶ä»–ï¼Œå­—ç¬¦ä¸²ï¼Œæ•°å­—ï¼Œå¸ƒå°”å€¼ç­‰ç­‰foo.call(&quot;abc&quot;) // this æŒ‡å‘ç›¸åº”çš„å¯¹è±¡let res = sum.call(&quot;123&quot;, 10,20)console.log(res) // 30 æ¥ä¸‹æ¥æˆ‘ä»¬å¼€å§‹å®ç°è‡ªå·±çš„callï¼ˆä¸»è¦æ˜¯å®ç°æ€è·¯ï¼Œæ²¡æœ‰æŠŠæ‰€æœ‰çš„è¾¹ç¼˜æ¡ä»¶è€ƒè™‘å®Œå…¨ï¼Œä½†æ˜¯åŸºæœ¬éƒ½æœ‰ï¼‰ 1.1 è®©å‡½æ•°æ‰§è¡Œèµ·æ¥ Function.prototype.mycall = function() &#123; let fn = this // thiså°±æ˜¯æˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„å‡½æ•° foo,æŠŠå®ƒä¿å­˜åˆ° fn // æ¥ç€è®©å‡½æ•°æ‰§è¡Œèµ·æ¥ fn() // ä½†æ˜¯è¿™é‡Œæ˜¯ç‹¬ç«‹å‡½æ•°è°ƒç”¨ï¼ŒthisæŒ‡å‘window&#125;foo.mycall() // è¿™é‡Œç›¸å½“äºmycalléšå¼ç»‘å®šäº†foo,å› æ­¤ mycallä¸­çš„thiså°±æ˜¯foo 2.2 æ˜¾å¼ç»‘å®šthis ç°åœ¨æˆ‘ä»¬è¦ç»‘å®šæˆ‘ä»¬æŒ‡å®šçš„this å…ˆçœ‹ç¬¬ä¸€ç§ï¼šfoo.mycall(&#123;name: 'hello'&#125;)ï¼Œç»‘å®šä¸€ä¸ªå¯¹è±¡ Function.prototype.mycall = function(thisArg) &#123; let fn = this // thiså°±æ˜¯æˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„å‡½æ•° foo,æŠŠå®ƒä¿å­˜åˆ° fn // æ¥ç€è°ƒç”¨è¿™ä¸ªå‡½æ•° // æˆ‘ä»¬çš„ç›®çš„æ˜¯è®©å‡½æ•°æ‰§è¡Œçš„æ—¶å€™ç»‘å®šthisArgè¿™ä¸ªå¯¹è±¡æ‰§è¡Œå³thisArg.fn()(éšå¼ç»‘å®š) // ä½†æ˜¯ç°åœ¨ thisArgæ²¡æœ‰ fn è¿™ä¸ªå±æ€§å‘€ï¼Œæ€ä¹ˆè°ƒç”¨å‘¢ // æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç»™thisArgæ·»åŠ ä¸€ä¸ªå±æ€§ fn, å€¼å°±æ˜¯æˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„å‡½æ•° thisArg.fn = fn // ç„¶åå†è°ƒç”¨ thisArg.fn() // ä½†æ˜¯è¿™æ ·æˆ‘ä»¬ä¸å°±è®©thisArgå¤šå‡ºæ¥ä¸€ä¸ªå±æ€§fnäº†å—ï¼Ÿ // æ²¡å…³ç³»ï¼Œå‡½æ•°æ‰§è¡Œå®Œ åˆ æ‰å°±å¥½ delete thisArg.fn&#125; å¦‚æœæˆ‘ä»¬ä¼ å…¥çš„ä¸æ˜¯å¯¹è±¡å‘¢ï¼Ÿé‚£å°±ä¸èƒ½ç»™thisArgæ·»åŠ å±æ€§å•¦ foo.mycall(&quot;123&quot;) Function.prototype.mycall = function(thisArg) &#123; let fn = this // æ‰€ä»¥è¦æŠŠ thisArg è½¬æˆå¯¹è±¡ç±»å‹(Objectæ„é€ å‡½æ•°å¯ä»¥å°†ç»™å®šçš„å€¼åŒ…è£…ä¸ºä¸€ä¸ªæ–°å¯¹è±¡) thisArg = Object(thisArg) thisArg.fn = fn thisArg.fn() delete thisArg.fn&#125; å¦‚æœä¼ å…¥çš„æ˜¯ null / undefined å‘¢ Function.prototype.mycall = function(thisArg) &#123; let fn = this // å¦‚æœthisArgä¼ å…¥çš„æ˜¯ undefined / null, åº”è¯¥è®©å®ƒæŒ‡å‘å…¨å±€å¯¹è±¡ // æ‰€ä»¥æˆ‘ä»¬è¦åšä¸€ä¸ªåˆ¤æ–­ thisArg = (thisArg !== null &amp;&amp; thisArg !== undefined) ? Object(thisArg) : window thisArg.fn = fn thisArg.fn() delete thisArg.fn&#125; 2.3 æ¥ä¸‹æ¥è¦è€ƒè™‘å‚æ•°äº† // restè¿ç®—ç¬¦// ...args ä¼šæŠŠæˆ‘ä»¬ä¼ å…¥çš„å‚æ•°åˆ—è¡¨ç»„åˆåˆ°ä¸€ä¸ªæ•°ç»„ [num1,num2]// ...args ä¹Ÿå¯ä»¥å±•å¼€æ•°ç»„, ç›¸å½“äºå¯¹æ•°ç»„çš„ä¸€ä¸ªéå†Function.prototype.mycall = function(thisArg, ...args) &#123; let fn = this thisArg = (thisArg !== null &amp;&amp; thisArg !== undefined) ? Object(thisArg) : window thisArg.fn = fn // æŠŠå‚æ•°ä¼ å…¥å‡½æ•°ï¼Œå¹¶ç”¨ result æ¥æ”¶å‡½æ•°æ‰§è¡Œå®Œçš„ç»“æœ(ä¾‹å­ä¸­å°±æ˜¯sumå‡½æ•°æ‰§è¡Œå®Œçš„ç»“æœ) let result = thisArg.fn(...args) // ...[num1, num2] --&gt; num1, num2 delete thisArg.fn // æœ€åæŠŠç»“æœè¿”å›å‡ºå» return result&#125; åˆ°æ­¤ï¼ŒåŸºæœ¬çš„callå°±å·²ç»å®ç°äº† æ£€éªŒä¸€ä¸‹å­ foo.mycall(&#123;name: &#x27;hello&#x27;&#125;)foo.mycall(&quot;123&quot;)foo.mycall(undefined)foo.mycall(null)sum.mycall(&#123;name: &quot;hello&quot;&#125;, 10, 20)let res1 = sum.mycall(123, 10, 20)console.log(res1); 2. apply å®ç° è·Ÿ call ç±»ä¼¼ï¼Œåªä¸è¿‡å‚æ•°çš„å¤„ç†æœ‰ä¸åŒ Function.prototype.myapply = function(thisArg, argsArray) &#123; let fn = this thisArg = (thisArg !== null &amp;&amp; thisArg !== undefined) ? Object(thisArg) : window thisArg.fn = fn // æ²¡æœ‰ä¼ argArray,é‚£ä¹ˆargsArrayé»˜è®¤ä¸º undefined,é‚£ä¹ˆå°±ä¸èƒ½ä½¿ç”¨å±•å¼€è¿ç®—ç¬¦äº† // æ‰€ä»¥å¦‚æœæ²¡æœ‰ä¼ å…¥å‚æ•°, é‚£ä¹ˆæŠŠå®ƒåˆå§‹åŒ–ä¸º [], ç©ºæ•°ç»„ä¹Ÿæ˜¯å¯ä»¥å±•å¼€çš„ ...[] argsArray = argsArray || [] let result = thisArg.fn(...argsArray) delete thisArg.fn return result&#125; 3. bind å®ç° bind éœ€è¦æˆ‘ä»¬è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œå¹¶ä¸”è°ƒç”¨ bind çš„æ—¶å€™ä¸éœ€è¦æ‰§è¡Œå‡½æ•° Function.prototype.mybind = function(thisArg, ...args) &#123; var fn = this thisArg = (thisArg !== null &amp;&amp; thisArg !== undefined) ? Object(thisArg) : window function newFn() &#123; thisArg.fn = fn let result = thisArg.fn(...args) delete thisArg.fn // è¿”å›ç»“æœ return result &#125; // bind éœ€è¦è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•° ä½ ä¹Ÿå¯ä»¥ç›´æ¥ return function() &#123;...&#125; return newFn&#125; å¤§ä½“ä¸Šä¹Ÿå·®ä¸å¤šï¼Œä½†æˆ‘ä»¬å¯ä»¥å°±ä¸‹é¢è¿™ç§æƒ…å†µæ”¹è¿›ä¸€ä¸‹ function sum2(num1, num2, num3, num4) &#123; console.log(&quot;sum2å‡½æ•°è¢«æ‰§è¡Œ&quot;, this); return num1 + num2 + num3 + num4&#125;let newSum2 = sum2.mybind(&quot;abc&quot;, 10,20) // ç»‘å®šçš„æ—¶å€™ä¼ å…¥äº†ä¸¤ä¸ªå‚æ•°console.log(newSum2(30,40)); // ä½¿ç”¨æ–°è¿”å›çš„å‡½æ•°çš„æ—¶å€™å†ä¼ å…¥å‰©ä½™çš„å‚æ•° è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å°±éœ€è¦æŠŠä¸¤æ¬¡ä¼ å…¥çš„å‚æ•°åˆå¹¶èµ·æ¥ï¼Œå†è°ƒç”¨ Function.prototype.mybind = function(thisArg, ...args) &#123; var fn = this thisArg = (thisArg !== null &amp;&amp; thisArg !== undefined) ? Object(thisArg) : window function newFn(...newArgs) &#123; // åˆå¹¶ä¼ å…¥çš„å‚æ•° let allArgs = [...args, ...newArgs] thisArg.fn = fn let result = thisArg.fn(...allArgs) delete thisArg.fn // è¿”å›ç»“æœ return result &#125; return newFn&#125; åˆ°æ­¤ï¼ŒåŸºæœ¬çš„bindä¹Ÿå®ç°äº† æœ€åè¯´æ˜ä¸€ä¸‹ï¼Œå®ç°çš„æ€è·¯æ˜¯è¿™æ ·ï¼Œä½†æ˜¯æ–¹æ³•ä¸å”¯ä¸€çš„ï¼Œå¯èƒ½è¿˜æœ‰ä¸€äº›è¾¹è¾¹è§’è§’æ²¡æœ‰è€ƒè™‘åˆ°çš„è¯ï¼Œå¯ä»¥è‡ªå·±æ·»åŠ è¿›å»","categories":[{"name":"ğŸ”«æ·±å…¥JSé«˜çº§è¯­æ³•","slug":"ğŸ”«æ·±å…¥JSé«˜çº§è¯­æ³•","permalink":"https://hillyee.github.io/categories/%F0%9F%94%AB%E6%B7%B1%E5%85%A5JS%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/"}],"tags":[{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"https://hillyee.github.io/tags/%E9%9D%A2%E8%AF%95/"}]},{"title":"03_JSå‡½æ•°çš„thisæŒ‡å‘","slug":"03_JSå‡½æ•°çš„thisæŒ‡å‘","date":"2022-03-30T10:50:46.000Z","updated":"2022-04-04T05:13:14.417Z","comments":true,"path":"2022/03/30/03_JSå‡½æ•°çš„thisæŒ‡å‘/","link":"","permalink":"https://hillyee.github.io/2022/03/30/03_JS%E5%87%BD%E6%95%B0%E7%9A%84this%E6%8C%87%E5%90%91/","excerpt":"","text":"JS å‡½æ•°çš„ this æŒ‡å‘ 1. this åœ¨å…¨å±€ä½œç”¨åŸŸä¸‹çš„æŒ‡å‘ åœ¨æµè§ˆå™¨ä¸­ï¼Œthisåœ¨å…¨å±€ä½œç”¨åŸŸä¸‹æŒ‡å‘ window console.log(this) // windowvar title = &quot;hello&quot;console.log(this.title) // helloconsole.log(window.title) // hello 2. this çš„å››ä¸ªç»‘å®šè§„åˆ™ 2.1 è§„åˆ™ä¸€ï¼šé»˜è®¤ç»‘å®š åœ¨ç‹¬ç«‹å‡½æ•°è°ƒç”¨çš„æƒ…å†µä¸‹ä¼šä½¿ç”¨é»˜è®¤ç»‘å®š ç‹¬ç«‹å‡½æ•°è°ƒç”¨ç®€å•æ¥è¯´å°±æ˜¯å®ƒæ²¡æœ‰ç»‘å®šåˆ°æŸä¸ªå¯¹è±¡ä¸Šè¿›è¡Œè°ƒç”¨ï¼Œç®€å•çœ‹å‡ ä¸ªä¾‹å­ // ä¾‹1function foo() &#123; console.log(this)&#125;foo() // window // ä¾‹2function foo1() &#123; console.log(this);&#125;function foo2() &#123; foo1()&#125;function foo3() &#123; foo2()&#125;foo3() // window // ä¾‹3var obj = &#123; name: &#x27;hello&#x27;, foo: function() &#123; console.log(this); &#125;&#125;var bar = obj.foobar() // window ä»¥ä¸Šçš„å‡½æ•°è°ƒç”¨çš„æ—¶å€™ï¼Œéƒ½æ˜¯æ²¡æœ‰è¢«ç»‘å®šåˆ°å¯¹è±¡ä¸­è°ƒç”¨çš„ï¼Œæ‰€ä»¥ this éƒ½æŒ‡å‘ window 2.2 è§„åˆ™äºŒï¼šéšå¼ç»‘å®š å‡½æ•°é€šè¿‡æŸä¸ªå¯¹è±¡è¿›è¡Œè°ƒç”¨çš„æ—¶å€™ï¼Œè¿™ä¸ªå¯¹è±¡ä¼šè¢« js å¼•æ“ç»‘å®šåˆ°å‡½æ•°ä¸­çš„ this é‡Œ ä¸‹é¢çœ‹å‡ ä¸ªä¾‹å­ï¼š // 1.function foo() &#123; console.log(this);&#125;var obj = &#123; name: &#x27;hello&#x27;, fn: foo&#125;obj.fn() // obj å¯¹è±¡ // 2.var obj1 = &#123; foo: function() &#123; console.log(this); &#125;&#125;var obj2 = &#123; title: &#x27;hello&#x27;, bar: obj1.foo&#125;obj2.bar() // obj2å¯¹è±¡ 2.3 æ˜¾å¼ç»‘å®š åˆ©ç”¨ callï¼Œapplyï¼Œbindæ‰‹åŠ¨æŒ‡å®š this çš„ç»‘å®šï¼Œè¿™ç§æ˜ç¡®çš„ç»‘å®šç§°ä¸ºæ˜¾å¼ç»‘å®š (1) callï¼Œapply callï¼Œapply éƒ½æ˜¯å¯ä»¥è°ƒç”¨å‡½æ•°çš„ fn.call(è‡ªå®šçš„thisæŒ‡å‘ï¼Œå‚æ•°1ï¼Œå‚æ•°2) fn.apply(thisæŒ‡å‘ï¼Œ[å‚æ•°1ï¼Œå‚æ•°2]) ä¸¤è€…çš„åŒºåˆ«åœ¨äºä¼ å‚çš„æ–¹å¼ï¼Œä¸‹é¢ä¾‹å­å¯ä»¥çœ‹å‡ºæ¥ call ä¼ å…¥å‚æ•°åˆ—è¡¨ï¼Œapplyæ˜¯æ•°ç»„ function sum(num1, num2, num3) &#123; console.log(num1 + num2 + num3, this);&#125;var obj = &#123; title: &quot;hello&quot;&#125;sum.call(&quot;123&quot;, 20,30,40) // æ‰‹åŠ¨è®©thisæŒ‡å‘&quot;123&quot;sum.apply(obj, [20,30,40]) // æ‰‹åŠ¨è®©thisæŒ‡å‘obj (2) bind bindä¸ä¼šè°ƒç”¨å‡½æ•°ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚ function sum(num1, num2, num3) &#123; console.log(num1 + num2 + num3, this);&#125;// var obj = &#123;// title: &quot;hello&quot;// &#125;// sum.call(&quot;123&quot;, 20,30,40) // æ‰‹åŠ¨è®©thisæŒ‡å‘&quot;123&quot;// sum.apply(obj, [20,30,40]) // æ‰‹åŠ¨è®©thisæŒ‡å‘objvar newSum = sum.bind(&#x27;aaa&#x27;,10,20,30)newSum() // 60 String &#123;&#x27;aaa&#x27;&#125; å’¦ï¼ŸnewSum ä¸ä¹Ÿæ˜¯ç‹¬ç«‹å‡½æ•°è°ƒç”¨å—ï¼Œæ€ä¹ˆä¸æŒ‡å‘ window äº† è¿™å°±æ˜¯é»˜è®¤ç»‘å®šå’Œæ˜¾å¼ç»‘å®šbindçš„å†²çªï¼Œæ˜¾å¼ç»‘å®šçš„ä¼˜å…ˆçº§æ›´é«˜ï¼ 2.4 newç»‘å®š function Person(name, age) &#123; this.name = name this.age = age // å®é™…ä¸Šè¿™é‡Œæ˜¯ä¼šæŠŠ this è¿”å›å‡ºå»çš„,å³return thisï¼ˆé»˜è®¤ï¼‰ // this = åˆ›å»ºå‡ºæ¥çš„å¯¹è±¡&#125;// new ä¼šåˆ›å»ºä¸€ä¸ªå…¨æ–°çš„å¯¹è±¡var p1 = new Person(&quot;jenny&quot;, 12)var p2 = new Person(&quot;tony&quot;, 15) 3. ä¸€äº›å†…ç½®å‡½æ•°çš„ this ç»‘å®š æœ‰æ—¶å€™æˆ‘ä»¬ä¼šè°ƒç”¨ä¸€äº› JS çš„å†…ç½®å‡½æ•°ï¼Œè¿™äº›å‡½æ•°è¦æ±‚æˆ‘ä»¬ä¼ å…¥å¦å¤–ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”æˆ‘ä»¬ä¸ä¼šè‡ªå·±å»è°ƒç”¨è¿™äº›å‡½æ•°ï¼Œè€Œæ˜¯ JS å†…éƒ¨ä¼šå¸®åŠ©æˆ‘ä»¬æ‰§è¡Œã€‚ è¿™ä¸ªæ—¶å€™ï¼Œthis çš„ç»‘å®šå°±è·Ÿå†…éƒ¨å¸®æˆ‘ä»¬æŒ‡å‘å‡½æ•°çš„æ–¹å¼æœ‰å…³ç³»äº†ã€‚ çœ‹å‡ ä¸ªä¾‹å­å§ 3.1 setTimeout å†…éƒ¨é€šè¿‡ apply è°ƒç”¨å‡½æ•°ï¼Œå¹¶ç»‘å®šäº†thiså¯¹è±¡ï¼Œæ˜¯window setTimeout(function() &#123; console.log(this); // window&#125;, 2000) 3.2 æ•°ç»„çš„å†…ç½®å‡½æ•° forEach é»˜è®¤æƒ…å†µä¸‹ä¼ å…¥çš„å‡½æ•°æ˜¯è‡ªåŠ¨è°ƒç”¨å‡½æ•°ï¼ˆé»˜è®¤ç»‘å®šï¼‰ var names = [&#x27;aaa&#x27;, &#x27;bbb&#x27;,&#x27;ccc&#x27;]names.forEach(function(item) &#123; console.log(this); // ä¸‰æ¬¡ window&#125;) ä¹Ÿå¯ä»¥é€šè¿‡ä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°ï¼Œæ”¹å˜thisæŒ‡å‘ var names = [&#x27;aaa&#x27;, &#x27;bbb&#x27;,&#x27;ccc&#x27;]names.forEach(function(item) &#123; console.log(this); // ä¸‰æ¬¡ &#x27;obj&#x27;&#125;, &#x27;obj&#x27;) 3.3 ç‚¹å‡»äº‹ä»¶ åœ¨å‘ç”Ÿç‚¹å‡»æ—¶ï¼Œå›è°ƒå‡½æ•°è¢«è°ƒç”¨ï¼Œä¼šå°† this ç»‘å®šåˆ°è¯¥å‡½æ•°ä¸­ &lt;div class=&quot;box&quot;&gt; &lt;/div&gt; var box = document.querySelector(&quot;.box&quot;)box.onclick = function() &#123; console.log(this); // boxå¯¹è±¡&#125; æ‰€ä»¥è¯´ï¼ŒæŸäº›å†…ç½®çš„å‡½æ•°ï¼Œæˆ‘ä»¬å¾ˆéš¾ç¡®å®šå®ƒå†…éƒ¨æ˜¯å¦‚ä½•è°ƒç”¨ä¼ å…¥çš„å›è°ƒå‡½æ•°çš„ï¼Œå¯ä»¥è‡ªå·±æµ‹è¯•ä¸€ä¸‹ï¼Œè®°ä¸€ä¸‹ï¼Œçœ‹æºç å½“ç„¶æ›´å¥½å•¦ 4. å‡ ä¸ªè§„åˆ™çš„ä¼˜å…ˆçº§ ä»é«˜åˆ°ä½ï¼šnewç»‘å®š &gt; æ˜¾å¼ç»‘å®š(bind) &gt; éšå¼ç»‘å®š &gt; é»˜è®¤ç»‘å®š newç»‘å®šå’Œcallï¼Œapplyæ˜¯ä¸å…è®¸åŒæ—¶ä½¿ç”¨çš„ï¼Œï¼ˆæ¯•ç«Ÿéƒ½ä¼šè°ƒç”¨å‡½æ•°ï¼‰ï¼Œæ‰€ä»¥ä¸å­˜åœ¨è°çš„ä¼˜å…ˆçº§æ›´é«˜ æ˜¾å¼ç»‘å®šé«˜äºéšå¼ç»‘å®š // æ˜¾å¼ç»‘å®šå’Œéšå¼ç»‘å®šfunction foo() &#123; console.log(this);&#125;var obj = &#123; name: &#x27;obj&#x27;, foo: foo&#125;obj.foo() // obj å¯¹è±¡obj.foo.call(&quot;aaa&quot;) // &#x27;aaa&#x27; new ç»‘å®šé«˜äºéšå¼ç»‘å®š function foo() &#123; console.log(this);&#125;var obj = &#123; name: &#x27;hello&#x27;, foo: foo&#125;new obj.foo() // è¾“å‡º foo å¯¹è±¡è€Œä¸æ˜¯ obj new ç»‘å®šé«˜äºbind function foo() &#123; console.log(this, title);&#125;var obj = &#123; name: &#x27;hello&#x27;&#125;var bar = foo.bind(obj) // æ˜¾å¼ç»‘å®šobjnew bar() // æ‰“å° fooå¯¹è±¡ è€Œä¸æ˜¯ obj 5. ä¸¤ç§ç‰¹æ®Šæƒ…å†µ 5.1 åœ¨æ˜¾å¼ç»‘å®šä¸­ä¼ å…¥ null æˆ– undefined è¿™æ—¶å€™ï¼Œæ˜¾å¼ç»‘å®šä¼šè¢«å¿½ç•¥ï¼Œä½¿ç”¨é»˜è®¤è§„åˆ™ function foo() &#123; console.log(this);&#125;var obj = &#123; name: &quot;hello&quot;, foo: foo&#125;foo.call(obj) // objfoo.call(null) // windowfoo.call(undefined) // window 5.2 é—´æ¥å‡½æ•°å¼•ç”¨ function foo() &#123; console.log(this);&#125;var obj1 = &#123; name: &#x27;obj1&#x27;, foo: foo&#125;var obj2 = &#123; name: &#x27;obj2&#x27;,&#125;// å…ˆæ¥çœ‹ä¸€ä¸‹è¿™ä¸ªèµ‹å€¼çš„ç»“æœ, æ˜¯ foo å‡½æ•°console.log((obj2.foo = obj1.foo)); // fooå‡½æ•°// è¿™ç§å«åšé—´æ¥å‡½æ•°å¼•ç”¨ï¼Œæ˜¯ä¼šæŠŠèµ‹å€¼è¯­å¥å³è¾¹çš„ç»“æœè¿”å›ï¼Œç„¶åç›´æ¥è°ƒç”¨ï¼Œæ˜¯ç‹¬ç«‹å‡½æ•°è°ƒç”¨(obj2.foo = obj1.foo)() // ç›¸å½“äºç›´æ¥è°ƒç”¨ foo å‡½æ•°ï¼Œæ‰€ä»¥æ˜¯é»˜è®¤ç»‘å®šï¼Œè¾“å‡ºwindow 6. ç®­å¤´å‡½æ•°çš„this ç®­å¤´å‡½æ•°ä¸ç»‘å®š thisï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒæ²¡æœ‰è‡ªå·±çš„ thisï¼Œè€Œæ˜¯æ ¹æ®å¤–å±‚ä½œç”¨åŸŸæ¥å†³å®šthis var name = &quot;hello&quot;var foo = () =&gt; &#123; console.log(this); // åœ¨è¿™é‡Œthisçš„å¤–å±‚ä½œç”¨åŸŸå°±æ˜¯ window&#125;var obj = &#123; foo: foo&#125;obj.foo() // windowobj.foo.call(&quot;aaa&quot;) // window å†æ¥çœ‹ä¸€ä¸ªæ¡ˆä¾‹ï¼š ä½¿ç”¨setTimeoutæ¨¡æ‹Ÿä¸€ä¸ªç½‘ç»œè¯·æ±‚ï¼Œå¦‚æœæˆ‘ä»¬æƒ³æŠŠè¿”å›æ¥çš„æ•°æ®ä¿å­˜åˆ° data ä¸­ï¼Œè¯¥æ€ä¹ˆåš var obj = &#123; data: &#x27;&#x27;, getData: function() &#123; setTimeout(() =&gt; &#123; console.log(this); // obj å¯¹è±¡ // è¿™é‡Œçš„ this ä¸æ˜¯åº”è¯¥æŒ‡å‘windowå—ï¼Ÿ // å¦‚æœæˆ‘ä»¬è¿™é‡Œä½¿ç”¨çš„æ˜¯æ™®é€šçš„å‡½æ•° function() &#123;console.log(this)&#125; // é‚£ä¹ˆè¿™ä¸ªå‡½æ•°åœ¨å†…éƒ¨è°ƒç”¨çš„æ—¶å€™ï¼Œä¼šç»‘å®šthisï¼Œå°±æ˜¯window // ä½†æ˜¯æˆ‘ä»¬ä½¿ç”¨äº†ç®­å¤´å‡½æ•°ï¼Œå®ƒä¸ç»‘å®šthisï¼Œä¼šå¾€ä¸Šå±‚ä½œç”¨åŸŸä¸­æ‰¾åˆ°å¯¹åº”çš„this // æ‰€ä»¥æ‰¾åˆ°äº† obj this.data = &#x27;hello&#x27; // --&gt; obj.data = &quot;hello&quot; &#125;, 2000); &#125;&#125;obj.getData() 7. this çš„é¢è¯•é¢˜ å¦‚æœæ¯é¢˜éƒ½ä¼šäº†ï¼Œé‚£ä¹ˆ this ç»‘å®šçš„é—®é¢˜ï¼Œå°±æ˜¯ä½ çš„é€åˆ†é¢˜è€Œä¸æ˜¯é€å‘½é¢˜äº†å“ˆå“ˆå“ˆ å»ºè®®æŠŠæˆ‘çš„ç­”æ¡ˆè·Ÿæ³¨é‡Šéƒ½åˆ æ‰ï¼Œè‡ªå·±ä¸€ç‚¹ç‚¹ç†æ¸…å“¦ é¢˜ä¸€ var name = &quot;window&quot;; // window.name = &quot;window&quot;var person = &#123; name: &quot;person&quot;, sayName: function () &#123; console.log(this.name); &#125;&#125;;function sayName() &#123; var sss = person.sayName; sss(); // window å¾ˆæ˜æ˜¾æ˜¯ç‹¬ç«‹å‡½æ•°è°ƒç”¨,æ²¡æœ‰ä¸ä»»ä½•å¯¹è±¡å…³è” person.sayName(); // person éšå¼ç»‘å®š,ä¸personå…³è” (person.sayName)(); // person åŒä¸Š(åŠ æ‹¬å·åªæ˜¯ä»£è¡¨è¿™æ˜¯ä¸€ä¸ªæ•´ä½“) // console.log((b = person.sayName)); // è¿™é‡Œå®é™…ä¸Šå°±æ˜¯sayNameè¿™ä¸ªå‡½æ•° (b = person.sayName)(); // é—´æ¥å‡½æ•°å¼•ç”¨ï¼Œæ˜¯ç‹¬ç«‹å‡½æ•°è°ƒç”¨, è¾“å‡º window&#125;sayName(); é¢˜äºŒ var name = &#x27;window&#x27;var person1 = &#123; name: &#x27;person1&#x27;, foo1: function () &#123; console.log(this.name) &#125;, foo2: () =&gt; console.log(this.name), foo3: function () &#123; return function () &#123; console.log(this.name) &#125; &#125;, foo4: function () &#123; return () =&gt; &#123; console.log(this.name) &#125; &#125;&#125;var person2 = &#123; name: &#x27;person2&#x27; &#125;// éšå¼ç»‘å®šperson1å¯¹è±¡person1.foo1(); // person1// æ˜¾å¼ç»‘å®šperson2person1.foo1.call(person2); // person2// ç®­å¤´å‡½æ•°ä¸é€‚ç”¨ä»»ä½•è§„åˆ™, å‘ä¸Šå±‚ä½œç”¨åŸŸä¸­æ‰¾thisperson1.foo2(); // windowperson1.foo2.call(person2); // window// person1.foo3()è¿”å›äº†ä¸€ä¸ªå‡½æ•°ï¼Œç„¶åç‹¬ç«‹è°ƒç”¨person1.foo3()(); // window// person1.foo3.call(person2) è¿”å›çš„æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç„¶åç‹¬ç«‹è°ƒç”¨person1.foo3.call(person2)(); // window// person1.foo3()è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œç„¶åæ˜¾å¼ç»‘å®šåˆ° person2person1.foo3().call(person2); // person2// person1.foo4()è¿”å›ä¸€ä¸ªç®­å¤´å‡½æ•°ï¼Œå¾€ä¸Šå±‚ä½œç”¨åŸŸæ‰¾ï¼Œæ‰¾åˆ°foo4ä¸­ç»‘å®šçš„this,æ˜¯ person1person1.foo4()(); // person1// foo4æ˜¾å¼ç»‘å®šåˆ° person2person1.foo4.call(person2)(); // person2// person1.foo4()è¿”å›ç®­å¤´å‡½æ•°ï¼Œå¾€ä¸Šå±‚ä½œç”¨åŸŸæ‰¾person1.foo4().call(person2); // person1 é¢˜ä¸‰ var name = &#x27;window&#x27;function Person (name) &#123; this.name = name this.foo1 = function () &#123; console.log(this.name) &#125;, this.foo2 = () =&gt; console.log(this.name), this.foo3 = function () &#123; return function () &#123; console.log(this.name) &#125; &#125;, this.foo4 = function () &#123; return () =&gt; &#123; console.log(this.name) &#125; &#125;&#125;var person1 = new Person(&#x27;person1&#x27;)var person2 = new Person(&#x27;person2&#x27;)person1.foo1() // person1 éšå¼ç»‘å®šperson1.foo1.call(person2) // person2 æ˜¾å¼ç»‘å®šperson1.foo2() // person1 éšå¼ç»‘å®š// ç®­å¤´å‡½æ•°ä¸é€‚ç”¨æ˜¾å¼ç»‘å®šè§„åˆ™ï¼Œç›´æ¥å‘ä¸Šå±‚ä½œç”¨åŸŸæ‰¾person1.foo2.call(person2) // person1 // person1.foo3() è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨å…¨å±€è°ƒç”¨person1.foo3()() // windowperson1.foo3.call(person2)() // window // åŒç†// person1.foo3() è¿”å›çš„å‡½æ•°ä½¿ç”¨ .call æ˜¾å¼ç»‘å®š person2person1.foo3().call(person2) //person2 // person1.foo4() è¿”å›ä¸€ä¸ªç®­å¤´å‡½æ•°ï¼Œå†è°ƒç”¨ï¼Œå‘ä¸Šå±‚ä½œç”¨åŸŸæ‰¾person1.foo4()() // person1// person1.foo4.call(person2) è¿”å›ç®­å¤´å‡½æ•°ï¼Œå¹¶ä¸”foo4æ˜¾å¼ç»‘å®šthisä¸ºperson2// å†è°ƒç”¨è¿™ä¸ªç®­å¤´å‡½æ•°ï¼Œå‘ä¸Šæ‰¾å°±æ‰¾åˆ° foo4 çš„this ä¸ºperson2person1.foo4.call(person2)() // person2 // person1.foo4() è¿”å›ç®­å¤´å‡½æ•°,ä¸é€‚ç”¨æ˜¾å¼ç»‘å®šï¼Œå‘ä¸Šæ‰¾åˆ° person1// æ³¨æ„è¿™é‡Œè·Ÿä¸Šé¢çš„åŒºåˆ«ï¼Œè¿™é‡Œçš„foo4è°ƒç”¨ä¸æ˜¯.callè°ƒç”¨çš„ï¼Œè€Œæ˜¯.foo4()è¿™æ ·è°ƒç”¨çš„// callæ˜¯æ¥è°ƒç”¨ç®­å¤´å‡½æ•°çš„ï¼Œè€Œç®­å¤´å‡½æ•°ä¸é€‚ç”¨æ˜¾å¼ç»‘å®šï¼Œå‘ä¸Šæ‰¾åˆ°çš„æ˜¯person1person1.foo4().call(person2) // person1 é¢˜å›› var name = &#x27;window&#x27;function Person (name) &#123; this.name = name this.obj = &#123; name: &#x27;obj&#x27;, foo1: function () &#123; return function () &#123; console.log(this.name) &#125; &#125;, foo2: function () &#123; return () =&gt; &#123; console.log(this.name) &#125; &#125; &#125;&#125;var person1 = new Person(&#x27;person1&#x27;)var person2 = new Person(&#x27;person2&#x27;)// person1.obj.foo1()è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨å…¨å±€ä¸­è°ƒç”¨person1.obj.foo1()() // window// person1.obj.foo1.call(person2) è¿”å›ä¸€ä¸ªå‡½æ•° åœ¨å…¨å±€ä¸­è°ƒç”¨person1.obj.foo1.call(person2)() // window// person1.obj.foo1() è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œæ˜¾å¼ç»‘å®šperson2person1.obj.foo1().call(person2) // person2// ç®­å¤´å‡½æ•°è°ƒç”¨ï¼Œå‘ä¸Šæ‰¾åˆ° foo2 ä¸­çš„thisæ˜¯objperson1.obj.foo2()() // obj// foo2è°ƒç”¨çš„æ—¶å€™æ˜¾å¼ç»‘å®šperson2ï¼Œç®­å¤´å‡½æ•°å‘ä¸Šå±‚æ‰¾åˆ°çš„å°±æ˜¯person2person1.obj.foo2.call(person2)() // person2// ç®­å¤´å‡½æ•°ä¸é€‚ç”¨ æ˜¾å¼ç»‘å®šï¼Œå‘ä¸Šæ‰¾æ‰¾åˆ° objperson1.obj.foo2().call(person2) // obj","categories":[{"name":"ğŸ”«æ·±å…¥JSé«˜çº§è¯­æ³•","slug":"ğŸ”«æ·±å…¥JSé«˜çº§è¯­æ³•","permalink":"https://hillyee.github.io/categories/%F0%9F%94%AB%E6%B7%B1%E5%85%A5JS%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/"}],"tags":[{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"https://hillyee.github.io/tags/%E9%9D%A2%E8%AF%95/"}]},{"title":"02_JSå†…å­˜ç®¡ç†å’Œé—­åŒ…","slug":"02_JSå†…å­˜ç®¡ç†å’Œé—­åŒ…","date":"2022-03-30T10:49:50.000Z","updated":"2022-04-03T07:40:20.371Z","comments":true,"path":"2022/03/30/02_JSå†…å­˜ç®¡ç†å’Œé—­åŒ…/","link":"","permalink":"https://hillyee.github.io/2022/03/30/02_JS%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E5%92%8C%E9%97%AD%E5%8C%85/","excerpt":"","text":"ä¸€ã€JS çš„å†…å­˜ç®¡ç† 1. JS çš„å†…å­˜ç®¡ç† JavaScript ä¼šåœ¨å®šä¹‰å˜é‡æ—¶ä¸ºæˆ‘ä»¬åˆ†é…å†…å­˜ å†…å­˜åˆ†é…çš„æ–¹å¼æ˜¯ä¸€æ ·çš„å—ï¼Ÿ JS å¯¹äºåŸºæœ¬æ•°æ®ç±»å‹å†…å­˜çš„åˆ†é…ï¼Œä¼šåœ¨æ‰§è¡Œæ—¶ç›´æ¥åœ¨æ ˆç©ºé—´è¿›è¡Œåˆ†é… JS å¯¹äºå¤æ‚æ•°æ®ç±»å‹å†…å­˜çš„åˆ†é…ï¼Œä¼šåœ¨å †å†…å­˜ä¸­å¼€è¾Ÿä¸€å—ç©ºé—´ï¼Œå¹¶ä¸”å°†è¿™å—ç©ºé—´çš„åœ°å€ä¿å­˜åœ¨æ ˆç©ºé—´ 2. JS çš„åƒåœ¾å›æ”¶ åƒåœ¾å›æ”¶çš„è‹±æ–‡æ˜¯ Garbage Collectionï¼Œç®€ç§° GC å¯¹äºé‚£äº›ä¸å†ä½¿ç”¨çš„å¯¹è±¡ï¼Œæˆ‘ä»¬éƒ½ç§°ä¹‹ä¸ºåƒåœ¾ï¼Œå®ƒéœ€è¦è¢«å›æ”¶ï¼Œä»¥é‡Šæ”¾å‡ºæ›´å¤šçš„å†…å­˜ç©ºé—´ JavaScriptçš„è¿è¡Œç¯å¢ƒ jså¼•æ“éƒ½ä¼šå†…å­˜åƒåœ¾å›æ”¶å™¨ 3. å¸¸è§çš„ä¸¤ä¸ª GC ç®—æ³• GCæ€ä¹ˆçŸ¥é“å“ªäº›å¯¹è±¡æ˜¯ä¸å†ä½¿ç”¨çš„å‘¢ï¼Ÿè¿™é‡Œå°±è¦ç”¨åˆ° GC ç®—æ³•äº† 3.1 å¼•ç”¨è®¡æ•° å½“ä¸€ä¸ªå¯¹è±¡æœ‰ä¸€ä¸ªå¼•ç”¨æŒ‡å‘å®ƒçš„æ—¶å€™ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨å°± +1ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ä¸º 0 æ—¶ï¼Œè¿™ä¸ªå¯¹è±¡å°±å¯ä»¥è¢«å›æ”¶æ‰ ä½†æ˜¯è¿™ä¸ªç®—æ³•æœ‰ä¸€ä¸ªå¾ˆå¤§çš„å¼Šç«¯ï¼Œå°±æ˜¯ä¼šäº§ç”Ÿå¾ªç¯å¼•ç”¨ var obj1 = &#123;friend: obj2&#125;var obj2 = &#123;friend: obj1&#125; 3.2 æ ‡è®°æ¸…é™¤ è¿™ä¸ªç®—æ³•æ˜¯è®¾ç½®ä¸€ä¸ªæ ¹å¯¹è±¡ï¼ˆroot objectï¼‰ï¼Œåƒåœ¾å›æ”¶å™¨ä¼šå®šæœŸä»è¿™ä¸ªæ ¹å¼€å§‹ï¼Œæ‰¾åˆ°æ‰€æœ‰ä»æ ¹å¼€å§‹æœ‰å¼•ç”¨åˆ°çš„å¯¹è±¡ï¼Œå¯¹äºé‚£äº›æ²¡æœ‰å¼•ç”¨åˆ°çš„å¯¹è±¡ï¼Œå°±è®¤ä¸ºæ˜¯ä¸å¯ç”¨çš„å¯¹è±¡ â€‹ å›¾ä¸­ä» A å¼€å§‹æ‰¾ï¼Œæ‰¾åˆ° D çš„æ—¶å€™ç»“æŸï¼ŒM,Nä¸å¯è¾¾ï¼Œè¢«è®¤ä¸ºæ˜¯ä¸å¯ç”¨çš„å¯¹è±¡ è¿™ä¸ªç®—æ³•å¯ä»¥å¾ˆå¥½çš„è§£å†³å¾ªç¯å¼•ç”¨çš„é—®é¢˜ æ³¨ï¼šJS å¼•æ“æ¯”è¾ƒå¹¿æ³›é‡‡ç”¨çš„å°±æ˜¯æ ‡è®°æ¸…é™¤ç®—æ³•ï¼Œå½“ç„¶ç±»ä¼¼äº V8 å¼•æ“ä¸ºäº†è¿›è¡Œæ›´å¥½çš„ä¼˜åŒ–ï¼Œåœ¨ç®—æ³•çš„å®ç°ç»†èŠ‚ä¸Šä¹Ÿä¼šç»“åˆä¸€äº›å…¶ä»–çš„ç®—æ³• äºŒã€JSä¸­çš„é—­åŒ… 1. ä»€ä¹ˆæ˜¯é—­åŒ…ï¼Ÿ JavaScript ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œå¦‚æœå®ƒè®¿é—®äº†å¤–å±‚ä½œç”¨åŸŸçš„å˜é‡ï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°æ˜¯ä¸€ä¸ªé—­åŒ…ã€‚ MDNä¸­çš„ä¸€ä¸ªè§£é‡Šï¼šä¸€ä¸ªå‡½æ•°å’Œå¯¹å…¶å‘¨å›´çŠ¶æ€ï¼ˆlexical environmentï¼Œè¯æ³•ç¯å¢ƒï¼‰çš„å¼•ç”¨æ†ç»‘åœ¨ä¸€èµ·ï¼ˆæˆ–è€…è¯´å‡½æ•°è¢«å¼•ç”¨åŒ…å›´ï¼‰ï¼Œè¿™æ ·çš„ç»„åˆå°±æ˜¯é—­åŒ…ï¼ˆclosureï¼‰ function foo() &#123; var name = &quot;foo&quot; var age = 18 function bar() &#123; console.log(name)// nameè®¿é—®äº†å¤–å±‚ä½œç”¨åŸŸçš„å˜é‡name console.log(age) // ageè®¿é—®äº†å¤–å±‚ä½œç”¨åŸŸçš„å˜é‡age &#125; return bar // è¿”å›ä¸€ä¸ªå‡½æ•°&#125;var fn = foo()fn() 2. é—­åŒ…çš„è®¿é—®è¿‡ç¨‹ ç®€å•æè¿°ä¸Šé¢å‡½æ•°çš„æ‰§è¡Œè¿‡ç¨‹ï¼š 1. GO: &#123;foo:åœ°å€1, fn:undefined&#125;2. æ‰§è¡Œä»£ç ï¼š 2.1 foo():åªè¦æ‰§è¡Œå‡½æ•°ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªå‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ (1)VO: &#123;AOå¯¹è±¡:&#123;name: undefined;age:undefined;bar:åœ°å€2&#125;&#125; scopechain:[VO+parent scopes] (2)å¼€å§‹æ‰§è¡Œä»£ç  &#123;name: &quot;foo&quot;, age:18;&#125; return baråœ°å€2 (3)fooæ‰§è¡Œå®Œæ¯• 2.2 fn: baråœ°å€2 2.3 fn(),å³æ‰§è¡Œ baråœ°å€2ä¸­çš„å‡½æ•°æ‰§è¡Œä½“,åˆ›å»ºbarçš„å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ (1)&#123;AO:&#123;&#125;,scopechain&#125; (2)æ‰§è¡Œä»£ç : console.log(name):åœ¨è‡ªå·±çš„AOä¸­æ‰¾ä¸åˆ°ï¼Œé€šè¿‡ä½œç”¨åŸŸé“¾æ‰¾åˆ°fooçš„AOï¼Œæ‰¾åˆ°name:&quot;foo&quot;,è¾“å‡º &quot;foo&quot; console.log(age)åŒç† (3)fn()æ‰§è¡Œå®Œæ¯•3.æ‰§è¡Œå®Œæ¯•åœ°å€1:fooå‡½æ•°å¯¹è±¡: &#123;parentScope: GO&#125;,&#123;fooå‡½æ•°çš„æ‰§è¡Œä½“&#125;åœ°å€2:barå‡½æ•°å¯¹è±¡: &#123;parentScope: fooçš„AOå¯¹è±¡&#125;,&#123;barå‡½æ•°çš„æ‰§è¡Œä½“&#125; ä½ å¯èƒ½ä¼šæœ‰ç–‘æƒ‘ï¼šfooå‡½æ•°æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œä¸æ˜¯åº”è¯¥å¼¹å‡ºæ ˆå—ï¼Œfooçš„AOå¯¹è±¡ä¸åº”è¯¥è¢«é‡Šæ”¾äº†å—ï¼Ÿæ€ä¹ˆbarè¿˜èƒ½æ‰¾åˆ° nameï¼Œæ‰¾åˆ° age å‘¢ï¼Ÿ çœ‹ä¸‹å›¾ï¼š å¯ä»¥çœ‹åˆ°ï¼Œå½“æˆ‘ä»¬æ‰§è¡Œå®Œ foo å‡½æ•°çš„æ—¶å€™ï¼Œè¿”å›çš„æ˜¯ bar å‡½æ•°(æˆ–è€…è¯´æ˜¯barçš„åœ°å€)ï¼Œç„¶åå› ä¸º fn = foo()ï¼ŒæŠŠè¿™ä¸ªåœ°å€èµ‹å€¼ç»™äº†fnï¼Œå› æ­¤ä¼šå­˜åœ¨ fn æŒ‡å‘ barå‡½æ•°å¯¹è±¡ï¼Œè€Œbarçš„çˆ¶ä½œç”¨åŸŸåˆæŒ‡å‘äº† foo çš„AOå¯¹è±¡ï¼Œå› æ­¤fooçš„AOæ˜¯ä¸ä¼šè¢«é‡Šæ”¾çš„ 3. é—­åŒ…çš„å†…å­˜æ³„æ¼ ä¸ºä»€ä¹ˆæ€»è¯´é—­åŒ…æ˜¯æœ‰å†…å­˜æ³„æ¼çš„å‘¢ï¼Ÿä»€ä¹ˆæ˜¯å†…å­˜æ³„æ¼ï¼Ÿ æ‹¿ä¸Šé¢çš„ä¾‹å­è¯´ï¼Œå¦‚æœåç»­æˆ‘ä»¬ä¸ä¼šå†ç”¨ fooï¼Œbar è¿™äº›å‡½æ•°äº†ï¼Œä½†æ˜¯åœ¨å…¨å±€ä½œç”¨åŸŸä¸‹ fn å˜é‡å¯¹barå‡½æ•°å¯¹è±¡æœ‰å¼•ç”¨ï¼Œè€Œbarçš„ä½œç”¨åŸŸä¸­AOå¯¹fooçš„AOæœ‰å¼•ç”¨ï¼Œæ‰€ä»¥ä¼šé€ æˆè¿™äº›å†…å­˜éƒ½æ˜¯æ— æ³•è¢«é‡Šæ”¾çš„ã€‚ è¿™å°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„å†…å­˜æ³„æ¼ï¼Œå…¶å®å°±æ˜¯åˆšæ‰çš„å¼•ç”¨é“¾ä¸­çš„å¯¹è±¡æ— æ³•é‡Šæ”¾ æ€ä¹ˆè§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ å¾ˆç®€å•ï¼Œè®¾ç½® fn = nullï¼Œå°±ä¸å†å¯¹ bar å‡½æ•°å¯¹è±¡æœ‰å¼•ç”¨ï¼Œé‚£ä¹ˆä»GOå‡ºå‘ï¼Œbaræ˜¯ä¸å¯è¾¾çš„ï¼Œé‚£ä¹ˆå¯¹åº”çš„AOå¯¹è±¡(foo) åŒæ ·ä¹Ÿå°±ä¸å¯è¾¾ã€‚ åœ¨ä¸‹ä¸€æ¬¡ GC çš„çš„æ£€æµ‹ä¸­ï¼Œå®ƒä»¬å°±ä¼šè¢«é”€æ¯æ‰ è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå½¢æˆé—­åŒ…ä¹‹åï¼Œæ˜¯ä¸æ˜¯æ‰€æœ‰çš„å±æ€§éƒ½ä¸ä¼šè¢«é‡Šæ”¾å‘¢ï¼Ÿ è¿˜æ˜¯è¿™ä¸ªä¾‹å­ function foo() &#123; var name = &quot;why&quot; var age = 18 function bar() &#123; console.log(name) // console.log(age) &#125; return bar&#125;var fn = foo()fn() å¦‚æœageä¸ä½¿ç”¨äº†ï¼Œä¼šä¸ä¼šè¢«é”€æ¯æ‰å‘¢ï¼Ÿ ç­”æ¡ˆæ˜¯ä¼šçš„ï¼Œæµ‹è¯•å¦‚ä¸‹ï¼š è¿™æ˜¯å› ä¸º V8 å¼•æ“åšçš„ä¼˜åŒ–ï¼Œå› ä¸ºè§„èŒƒä¸­é—­åŒ…çš„å±æ€§åº”è¯¥æ˜¯ä¸ä¼šè¢«é”€æ¯çš„","categories":[{"name":"ğŸ”«æ·±å…¥JSé«˜çº§è¯­æ³•","slug":"ğŸ”«æ·±å…¥JSé«˜çº§è¯­æ³•","permalink":"https://hillyee.github.io/categories/%F0%9F%94%AB%E6%B7%B1%E5%85%A5JS%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/"}],"tags":[{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"https://hillyee.github.io/tags/%E9%9D%A2%E8%AF%95/"}]},{"title":"01_æ·±å…¥JSè¿è¡ŒåŸç†","slug":"01_æ·±å…¥JSè¿è¡ŒåŸç†","date":"2022-03-30T10:49:46.000Z","updated":"2022-04-10T13:44:11.830Z","comments":true,"path":"2022/03/30/01_æ·±å…¥JSè¿è¡ŒåŸç†/","link":"","permalink":"https://hillyee.github.io/2022/03/30/01_%E6%B7%B1%E5%85%A5JS%E8%BF%90%E8%A1%8C%E5%8E%9F%E7%90%86/","excerpt":"","text":"1. ä»è¾“å…¥ URL åˆ°é¡µé¢å±•ç¤º å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ â€‹ æ€»ä½“åˆ†ä¸ºä»¥ä¸‹è¿‡ç¨‹ï¼š DNS åŸŸåè§£æï¼šå°†åŸŸåè§£ææˆ IP åœ°å€ TCP è¿æ¥ï¼šTCP ä¸‰æ¬¡æ¡æ‰‹ å‘é€ HTTP è¯·æ±‚ æœåŠ¡å™¨å¤„ç†è¯·æ±‚å¹¶è¿”å› HTTP æŠ¥æ–‡ æµè§ˆå™¨è§£ææ¸²æŸ“é¡µé¢ æ–­å¼€è¿æ¥ï¼šTCP å››æ¬¡æŒ¥æ‰‹ 2. æµè§ˆå™¨å·¥ä½œåŸç† åœ¨æµè§ˆå™¨ä¸­è¾“å…¥æŸ¥æ‰¾å†…å®¹ï¼Œæµè§ˆå™¨æ˜¯æ€æ ·å°†é¡µé¢åŠ è½½å‡ºæ¥çš„ï¼Ÿ å¤§è‡´æµç¨‹å¦‚ä¸‹ï¼š é¦–å…ˆï¼Œç”¨æˆ·è¾“å…¥æœåŠ¡å™¨åœ°å€ï¼Œä¸æœåŠ¡å™¨å»ºç«‹è¿æ¥ æœåŠ¡å™¨è¿”å›å¯¹åº”çš„é™æ€èµ„æºï¼ˆindex.htmlï¼‰ ç„¶åæµè§ˆå™¨æ‹¿åˆ° index.html åè¿›è¡Œè§£æ å½“è§£ææ—¶é‡åˆ° css æˆ– js æ–‡ä»¶ï¼Œå°±å‘æœåŠ¡å™¨è¯·æ±‚å¹¶ä¸‹è½½å¯¹åº”çš„ css å’Œ js æ–‡ä»¶ æœ€åæµè§ˆå™¨å¯¹é¡µé¢è¿›è¡Œæ¸²æŸ“ï¼Œæ‰§è¡Œ js ä»£ç  3. æµè§ˆå™¨æ¸²æŸ“è¿‡ç¨‹ HTML Parser å°† HTMLè§£æè½¬æ¢æˆ DOM æ ‘ CSS Parser å°† æ ·å¼è¡¨è½¬æ¢æˆ CSS è§„åˆ™æ ‘ åˆå¹¶ DOM æ ‘å’Œ CSS è§„åˆ™æ ‘ï¼Œç”Ÿæˆ renderï¼ˆæ¸²æŸ“ï¼‰ æ ‘ å¸ƒå±€ render æ ‘ï¼ˆLayoutï¼‰ é€šè¿‡æ¸²æŸ“æ ‘ä¸­æ¸²æŸ“å¯¹è±¡çš„ä¿¡æ¯ï¼Œè®¡ç®—å‡ºæ¯ä¸€ä¸ªæ¸²æŸ“å¯¹è±¡çš„ä½ç½®å’Œå°ºå¯¸ ç»˜åˆ¶ render æ ‘ï¼ˆpaintingï¼‰ï¼Œè¿›è¡Œ Display å±•ç¤º æ³¨æ„å›¾ä¸­é¡¶éƒ¨çš„ç´«è‰² DOM ä¸‰è§’å½¢ï¼Œå®é™…ä¸Šæ˜¯ js å¯¹ DOM çš„ç›¸å…³æ“ä½œã€‚ 4. ä¸€ä¸ªå¼ºå¤§çš„ JavaScript å¼•æ“ â€” V8 å¼•æ“ åœ¨è§£æ HTML çš„è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°äº† JavaScript æ ‡ç­¾ï¼Œè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ ä¼šåœæ­¢è§£æ HTML ï¼Œè€Œå»åŠ è½½å’Œæ‰§è¡Œ JavaScript ä»£ç  é‚£ä¹ˆï¼ŒJavaScript ä»£ç ç”±è°æ¥æ‰§è¡Œå‘¢ï¼Ÿ JavaScript å¼•æ“ é«˜çº§çš„ç¼–ç¨‹è¯­è¨€æœ€ç»ˆéƒ½è¦è½¬æˆæœºå™¨æŒ‡ä»¤æ¥æ‰§è¡Œçš„ï¼Œ æ‰€ä»¥æˆ‘ä»¬éœ€è¦ JavaScript å¼•æ“å¸®åŠ©æˆ‘ä»¬å°† JavaScript ä»£ç ç¿»è¯‘æˆ CPU æŒ‡ä»¤æ¥æ‰§è¡Œ ï¼ˆ1ï¼‰V8 å¼•æ“çš„æ¶æ„ V8 çš„åº•å±‚æ¶æ„ä¸»è¦æœ‰ä¸‰ä¸ªæ ¸å¿ƒæ¨¡å—ï¼ˆParseã€Ignitionã€TurboFanï¼‰ 1. Parseï¼š è¯¥è¿‡ç¨‹ä¸»è¦æ˜¯å¯¹ JavaScript æºä»£ç è¿›è¡Œè¯æ³•åˆ†æå’Œè¯­æ³•åˆ†æã€‚ è¯æ³•åˆ†æï¼šå¯¹ä»£ç ä¸­çš„æ¯ä¸€ä¸ªè¯æ¯ä¸€ä¸ªç¬¦å·è¿›è¡Œè§£æï¼Œæœ€ç»ˆç”Ÿæˆå¾ˆå¤š tokens ä¾‹å¦‚ï¼šå¯¹ const name = â€œcurryâ€ // é¦–å…ˆå¯¹constè¿›è¡Œè§£æï¼Œå› ä¸ºconstä¸ºä¸€ä¸ªå…³é”®å­—ï¼Œæ‰€ä»¥ç±»å‹ä¼šè¢«è®°ä¸ºä¸€ä¸ªå…³é”®è¯ï¼Œå€¼ä¸ºconsttokens: [ &#123; type: &#x27;keyword&#x27;, value: &#x27;const&#x27; &#125;]// æ¥ç€å¯¹nameè¿›è¡Œè§£æï¼Œå› ä¸ºnameä¸ºä¸€ä¸ªæ ‡è¯†ç¬¦ï¼Œæ‰€ä»¥ç±»å‹ä¼šè¢«è®°ä¸ºä¸€ä¸ªæ ‡è¯†ç¬¦ï¼Œå€¼ä¸ºnametokens: [ &#123; type: &#x27;keyword&#x27;, value: &#x27;const&#x27; &#125;, &#123; type: &#x27;identifier&#x27;, value: &#x27;name&#x27; &#125;]// ä»¥æ­¤ç±»æ¨... è¯­æ³•åˆ†æï¼šåœ¨è¯æ³•åˆ†æçš„åŸºç¡€ä¸Šï¼Œæ‹¿åˆ° tokens ä¸­çš„ä¸€ä¸ªä¸ªå¯¹è±¡ï¼Œæ ¹æ®ä¸åŒç±»å‹ï¼Œå†è¿›ä¸€æ­¥åˆ†æå…·ä½“è¯­æ³•ï¼Œæœ€ç»ˆç”Ÿæˆ AST æŠ½è±¡è¯­æ³•æ ‘ å¯ä»¥è¯¦ç»†æŸ¥çœ‹é€šè¿‡ Parse è½¬æ¢åçš„ AST çš„å·¥å…·ï¼šAST Explorer 2. Ignition ä¸€ä¸ªè§£æå™¨ï¼Œå¯ä»¥å°† AST è½¬æ¢æˆ ByteCodeï¼ˆå­—èŠ‚ç ï¼‰ 3. TurboFan ä¸€ä¸ªç¼–è¯‘å™¨ï¼Œå¯ä»¥å°†å­—èŠ‚ç ç¼–è¯‘ä¸º CPU è®¤è¯†çš„æœºå™¨ç  ï¼ˆ2ï¼‰V8 å¼•æ“çš„æ‰§è¡Œè¿‡ç¨‹ Blink å†…æ ¸å°† JS æºç äº¤ç»™ V8 å¼•æ“ Stream è·å–åˆ° JS æºç è¿›è¡Œç¼–ç è½¬æ¢ Scanner è¿›è¡Œè¯æ³•åˆ†æï¼Œå°†ä»£ç è½¬æ¢æˆ tokens Parser å’Œ PreParser Parser ï¼šç›´æ¥è§£æï¼Œå°† tokens è½¬æˆ AST æ ‘ PreParserï¼šé¢„è§£æï¼Œå¯¹ä¸å¿…è¦çš„å‡½æ•°è¿›è¡Œé¢„è§£æï¼Œä¹Ÿå°±æ˜¯åªè§£ææš‚æ—¶éœ€è¦çš„å†…å®¹ï¼Œè€Œåœ¨å‡½æ•°è¢«è°ƒç”¨æ—¶æ‰è¿›è¡Œå‡½æ•°çš„å…¨é‡è§£æ ç”Ÿæˆ AST æ ‘åï¼Œä¼šè¢« Ignition è½¬æˆå­—èŠ‚ç ï¼Œä¹‹åå°±æ˜¯ä»£ç çš„æ‰§è¡Œè¿‡ç¨‹ 5. JavaScript çš„æ‰§è¡Œè¿‡ç¨‹ å‡å¦‚è¦æ‰§è¡Œå¦‚ä¸‹ä»£ç ï¼š var title = &quot;hello&quot;console.log(num1)var num1 = 20var num2 = 30var result = num1 + num2console.log(result) ï¼ˆ1ï¼‰é¦–å…ˆï¼Œä»£ç è¢«è§£æï¼ŒV8 å¼•æ“å†…éƒ¨ä¼šå¸®åŠ©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼šGlobal Objectï¼ˆGOï¼‰ GO å¯ä»¥è®¿é—®æ‰€æœ‰çš„ä½œç”¨åŸŸ é‡Œé¢ä¼šåŒ…å« Dateã€Arrayã€Stringã€setTimeoutç­‰ç­‰ï¼ˆæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥ new Date() ï¼‰ GO è¿˜æœ‰ä¸€ä¸ªwindow å±æ€§æŒ‡å‘è‡ªå·±ï¼ˆæ‰€ä»¥window.window.windowè¿˜æ˜¯æŒ‡å‘ GOè‡ªå·±ï¼‰ ç”¨ä¼ªä»£ç è¡¨ç¤ºä¸ºï¼š var globalObject = &#123; String: ç±», setTimeout: å‡½æ•°, ... window: globalObject&#125; ï¼ˆ2ï¼‰ç„¶åè¿è¡Œä»£ç  é¦–å…ˆæˆ‘ä»¬è¦çŸ¥é“ js å¼•æ“å†…éƒ¨æœ‰ä¸€ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡æ ˆï¼ˆExecution Context Stackï¼Œç®€ç§° ESCï¼‰ï¼Œå®ƒæ˜¯ç”¨äºæ‰§è¡Œä»£ç çš„è°ƒç”¨æ ˆã€‚ ä¸ºäº†å…¨å±€ä»£ç èƒ½å¤Ÿæ­£å¸¸æ‰§è¡Œï¼Œé¦–å…ˆéœ€è¦åˆ›å»ºä¸€ä¸ª**å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡ **ï¼ˆGlobal Execution Contextï¼Œç®€ç§°GECï¼‰ï¼Œå…¨å±€ä»£ç éœ€è¦è¢«æ‰§è¡Œæ—¶æ‰ä¼šåˆ›å»º ç„¶åå…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡ä¼šè¢«æ”¾å…¥æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆä¸­æ‰§è¡Œï¼ŒåŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼š åœ¨ä»£ç æ‰§è¡Œå‰ï¼Œä¼šå°†å…¨å±€å®šä¹‰çš„å˜é‡ï¼Œå‡½æ•°ç­‰åŠ å…¥åˆ° GlobalOject ä¸­ï¼Œä½†æ˜¯å¹¶ä¸ä¼šèµ‹å€¼ï¼ˆä¹Ÿç§°ä¸ºå˜é‡çš„ä½œç”¨åŸŸæå‡ï¼‰ å¼€å§‹ä¾æ¬¡æ‰§è¡Œä»£ç ï¼š title = â€œhelloâ€ // èµ‹å€¼ console.log(num1) // undefined, ä¸ä¼šæŠ¥é”™ num1= 20 â€¦ é‡åˆ°å‡½æ•°å¦‚ä½•æ‰§è¡Œ? å…ˆæ ¹æ®å‡½æ•°ä½“åˆ›å»ºä¸€ä¸ªå‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œå¹¶ä¸”å‹å…¥åˆ°æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆä¸­ï¼ˆEC Stackï¼‰ åœ¨åˆå§‹åŒ– GO çš„æ—¶å€™ï¼Œå‡½æ•°çš„ AO ä¹Ÿæ˜¯ä¼šè¢«åˆå§‹åŒ–çš„ æ¯”å¦‚è¯´ ï¼Œå…¨å±€ä¸­ï¼Œæœ‰function foo() {}ï¼Œä¸€å¼€å§‹åˆå§‹åŒ–GOçš„æ—¶å€™ä»ä¸Šåˆ°ä¸‹æ‰§è¡Œåˆ° foo ä¼šåœ¨å†…å­˜ä¸­åˆ›å»ºfooï¼Œå¹¶ä¸”ä¿å­˜ä½œç”¨åŸŸé“¾åˆ°fooçš„å†…éƒ¨å±æ€§[[scope]]ï¼Œå³ foo.[[scope]] = [ globalContext.VO] ä½œç”¨åŸŸé“¾ï¼Ÿ ç”± VO(å˜é‡å¯¹è±¡ï¼Œåœ¨å‡½æ•°ä¸­å°±æ˜¯ AO å¯¹è±¡)å’Œ çˆ¶çº§ VOç»„æˆï¼ŒæŸ¥æ‰¾æ—¶ä¼šä¸€å±‚å±‚æŸ¥æ‰¾ çœ‹ä¸€ä¸ªä¾‹å­ï¼š var message = &quot;Hello Global&quot;function foo() &#123; console.log(message) // Hello Global&#125;function bar() &#123; var message = &quot;Hello Bar&quot; foo()&#125;bar() æ¯”å¦‚è¯´è¿™é‡Œï¼Œå½“æ‰§è¡Œ foo å‡½æ•°çš„æ—¶å€™ï¼Œ foo çš„ AO ä¸­æ²¡æœ‰messageï¼Œå°±ä¼šå»å®ƒçš„çˆ¶çº§ VO ä¸­æŸ¥æ‰¾ã€‚ä¸€å®šè¦æ³¨æ„ï¼å½“ç¬¬ä¸€æ¬¡ä»£ç è§£æçš„æ—¶å€™ï¼Œ foo çš„å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡å°±å·²ç»ç¡®å®šäº†ï¼Œå…¶ä¸­åŒ…æ‹¬ä¸‰éƒ¨åˆ†ï¼š ç¬¬ä¸€éƒ¨åˆ†ï¼šåœ¨è§£æå‡½æ•°æˆä¸º AST æ ‘ç»“æ„çš„æ—¶å€™ï¼Œä¼šåˆ›å»ºä¸€ä¸ª AOï¼ˆActivationï¼‰ å…¶ä¸­åŒ…å«å½¢å‚ã€argumentsã€å‡½æ•°å®šä¹‰ã€æŒ‡å‘å‡½æ•°å¯¹è±¡æˆ–å®šä¹‰çš„å˜é‡ ç¬¬äºŒéƒ¨åˆ†ï¼šå°±æ˜¯ä½œç”¨åŸŸé“¾ ç¬¬ä¸‰éƒ¨åˆ†ï¼šthis ç»‘å®šçš„å€¼ å› æ­¤ï¼å½“fooåœ¨è‡ªå·±çš„AOæ‰¾ä¸åˆ°messageçš„æ—¶å€™ï¼Œå»çˆ¶çº§ VO æ‰¾ï¼Œè¿™ä¸ªçˆ¶çº§ VO å°±æ˜¯ä¸€å¼€å§‹è§£ææ—¶å€™ä¿å­˜çš„ GOï¼Œæ‰€ä»¥messageä¸º â€œHello Globalâ€ ç®€å•æè¿°ä¸€ä¸‹è¿™ä¸ªè¿‡ç¨‹å§ï¼š(æˆ‘ä¸ä¸“ä¸šçš„è¡¨è¾¾) // åˆå§‹åŒ– GOGO: &#123;window; message:undefined; foo: åœ°å€1; bar: åœ°å€2;&#125;// æ‰§è¡Œä»£ç GO: &#123;window; message:&quot;Hello Global&quot;; foo: åœ°å€1; bar: åœ°å€2;&#125;barå‡½æ•°æ‰§è¡Œ,åˆ›å»ºä¸€ä¸ªå‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡, å…¶ä¸­åŒ…æ‹¬ VOå¯¹è±¡: AO:&#123;message: undefined&#125; ç„¶åå¼€å§‹æ‰§è¡Œ barå‡½æ•° message:&quot;Hello Bar&quot; (èµ‹å€¼) foo() fooå‡½æ•°æ‰§è¡Œï¼Œåˆ›å»ºä¸€ä¸ªfooçš„å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡ å…¶ä¸­åŒ…æ‹¬ï¼šVO: AO: &#123;&#125; ç„¶åå¼€å§‹æ‰§è¡Œä»£ç  console.log(message) å‘ç°è‡ªå·±çš„AOæ²¡æœ‰message,ä¼šå‘ä¸Šæ‰¾ï¼Œå³ä»è‡ªå·±ä¿å­˜çš„çˆ¶çº§VOä¸­æŸ¥æ‰¾ï¼Œæ‰¾åˆ°GOä¸­çš„messageä¸º &quot;Hello Global&quot; (å›¾æ¥æºäºcoderwhy) JSæ‰§è¡Œä¸Šä¸‹æ–‡ï¼šhttps://github.com/mqyqingfeng/Blog/issues/8 å†™çš„æŒºæ¸…æ™°è¯¦ç»†çš„ å‡ é“å¸¸è§çš„ä½œç”¨åŸŸæå‡é¢è¯•é¢˜ï¼š var n = 100function foo() &#123; n = 200&#125;foo()console.log(n) // 200 function foo() &#123; console.log(n) // undefined var n = 200 console.log(n) // 200&#125;var n = 100foo() var a = 100function foo() &#123; console.log(a) // undefined return var a = 200&#125;foo() function foo() &#123; m = 100&#125;foo()console.log(m) // 100 function foo() &#123; var a = b = 10 // =&gt; è½¬æˆä¸‹é¢çš„ä¸¤è¡Œä»£ç  // var a = 10 // b = 10&#125;foo()//console.log(a) // æŠ¥é”™ a is not defined(å› ä¸ºå½“ fooå‡½æ•°æ‰§è¡Œå®Œä¹‹åï¼Œfooçš„å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡å°±ä¼šå¼¹å‡ºæ ˆ(æ²¡å•¦ï¼å“ªé‡Œè¿˜ä¼šæœ‰aå‘¢))console.log(b) // 10","categories":[{"name":"ğŸ”«æ·±å…¥JSé«˜çº§è¯­æ³•","slug":"ğŸ”«æ·±å…¥JSé«˜çº§è¯­æ³•","permalink":"https://hillyee.github.io/categories/%F0%9F%94%AB%E6%B7%B1%E5%85%A5JS%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/"}],"tags":[{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"https://hillyee.github.io/tags/%E9%9D%A2%E8%AF%95/"}]},{"title":"Hello World","slug":"hello-world","date":"2022-03-29T14:25:03.367Z","updated":"2022-03-29T14:25:03.367Z","comments":true,"path":"2022/03/29/hello-world/","link":"","permalink":"https://hillyee.github.io/2022/03/29/hello-world/","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick Start Create a new post $ hexo new &quot;My New Post&quot; More info: Writing Run server $ hexo server More info: Server Generate static files $ hexo generate More info: Generating Deploy to remote sites $ hexo deploy More info: Deployment","categories":[],"tags":[]}],"categories":[{"name":"ğŸ”«æ·±å…¥JSé«˜çº§è¯­æ³•","slug":"ğŸ”«æ·±å…¥JSé«˜çº§è¯­æ³•","permalink":"https://hillyee.github.io/categories/%F0%9F%94%AB%E6%B7%B1%E5%85%A5JS%E9%AB%98%E7%BA%A7%E8%AF%AD%E6%B3%95/"},{"name":"ğŸ˜£é¢è¯•é¢˜-jsç¯‡","slug":"ğŸ˜£é¢è¯•é¢˜-jsç¯‡","permalink":"https://hillyee.github.io/categories/%F0%9F%98%A3%E9%9D%A2%E8%AF%95%E9%A2%98-js%E7%AF%87/"},{"name":"æ·±å…¥Vue3+Typescriptå­¦ä¹ âš¡","slug":"æ·±å…¥Vue3-Typescriptå­¦ä¹ âš¡","permalink":"https://hillyee.github.io/categories/%E6%B7%B1%E5%85%A5Vue3-Typescript%E5%AD%A6%E4%B9%A0%E2%9A%A1/"},{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•ğŸ˜¥","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•ğŸ˜¥","permalink":"https://hillyee.github.io/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%F0%9F%98%A5/"},{"name":"å…¶ä»–","slug":"å…¶ä»–","permalink":"https://hillyee.github.io/categories/%E5%85%B6%E4%BB%96/"},{"name":"JavaScript","slug":"JavaScript","permalink":"https://hillyee.github.io/categories/JavaScript/"},{"name":"è®¡ç®—æœºç½‘ç»œ","slug":"è®¡ç®—æœºç½‘ç»œ","permalink":"https://hillyee.github.io/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"}],"tags":[{"name":"promise","slug":"promise","permalink":"https://hillyee.github.io/tags/promise/"},{"name":"js","slug":"js","permalink":"https://hillyee.github.io/tags/js/"},{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"https://hillyee.github.io/tags/%E9%9D%A2%E8%AF%95/"},{"name":"-TS","slug":"TS","permalink":"https://hillyee.github.io/tags/TS/"},{"name":"ES6","slug":"ES6","permalink":"https://hillyee.github.io/tags/ES6/"},{"name":"vue3","slug":"vue3","permalink":"https://hillyee.github.io/tags/vue3/"},{"name":"vuex","slug":"vuex","permalink":"https://hillyee.github.io/tags/vuex/"},{"name":"ç®—æ³•","slug":"ç®—æ³•","permalink":"https://hillyee.github.io/tags/%E7%AE%97%E6%B3%95/"},{"name":"vueè·¯ç”±","slug":"vueè·¯ç”±","permalink":"https://hillyee.github.io/tags/vue%E8%B7%AF%E7%94%B1/"}]}