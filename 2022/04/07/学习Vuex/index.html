<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>学习Vuex | Hillyee-blog</title><meta name="keywords" content="vue3,vuex"><meta name="author" content="Hillyee"><meta name="copyright" content="Hillyee"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Vuex的状态管理 vuex介绍   什么是状态管理？ 应用程序的各种数据保存到某个位置进行管理    ​	 state：数据	view：最终模块渲染成DOM	actions：修改state的行为事件   复杂的状态管理 多个组件共享状态   Vuex的状态管理 将组件的内部状态抽离出来    Vuex使用单一状态树 SSOT：Single Source of Truth，单一数据源 每个应用仅仅"><meta property="og:type" content="article"><meta property="og:title" content="学习Vuex"><meta property="og:url" content="https://hillyee.github.io/2022/04/07/%E5%AD%A6%E4%B9%A0Vuex/index.html"><meta property="og:site_name" content="Hillyee-blog"><meta property="og:description" content="Vuex的状态管理 vuex介绍   什么是状态管理？ 应用程序的各种数据保存到某个位置进行管理    ​	 state：数据	view：最终模块渲染成DOM	actions：修改state的行为事件   复杂的状态管理 多个组件共享状态   Vuex的状态管理 将组件的内部状态抽离出来    Vuex使用单一状态树 SSOT：Single Source of Truth，单一数据源 每个应用仅仅"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://vuex.vuejs.org/flow.png"><meta property="article:published_time" content="2022-04-07T03:27:35.000Z"><meta property="article:modified_time" content="2022-04-07T04:34:55.638Z"><meta property="article:author" content="Hillyee"><meta property="article:tag" content="vue3"><meta property="article:tag" content="vuex"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://vuex.vuejs.org/flow.png"><link rel="shortcut icon" href="https://img2.baidu.com/it/u=2994714379,3709164052&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=506"><link rel="canonical" href="https://hillyee.github.io/2022/04/07/%E5%AD%A6%E4%B9%A0Vuex/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"search.xml",languages:{hits_empty:"找不到您查询的内容：${query}"}},translate:void 0,noticeOutdate:void 0,highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"",date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:void 0,lightbox:"fancybox",Snackbar:void 0,source:{justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js",css:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css"}},isPhotoFigcaption:!1,islazyload:!1,isAnchor:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"学习Vuex",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2022-04-07 12:34:55"}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0!==o){const a=new Date;o=864e5*o,t={value:t,expiry:a.getTime()+o};localStorage.setItem(e,JSON.stringify(t))}},get:function(e){var t=localStorage.getItem(e);if(t){t=JSON.parse(t);const o=new Date;if(!(o.getTime()>t.expiry))return t.value;localStorage.removeItem(e)}}},e.getScript=a=>new Promise((t,e)=>{const o=document.createElement("script");o.src=a,o.async=!0,o.onerror=e,o.onload=o.onreadystatechange=function(){var e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(o.onload=o.onreadystatechange=null,t())},document.head.appendChild(o)}),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};e=saveToLocal.get("theme"),"dark"===e?activateDarkMode():"light"===e&&activateLightMode(),e=saveToLocal.get("aside-status");void 0!==e&&("hide"===e?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><meta name="generator" content="Hexo 6.1.0"><link rel="alternate" href="/atom.xml" title="Hillyee-blog" type="application/atom+xml"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://img0.baidu.com/it/u=752629441,1211736544&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=500&amp;h=500" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">19</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 🙆首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fas fa-list"></i><span> 🐹目录</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 🙈分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 🐱标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 🐌时间轴</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 🥩关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(https://vuex.vuejs.org/flow.png)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Hillyee-blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 🙆首页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fas fa-list"></i><span> 🐹目录</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 🙈分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 🐱标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 🐌时间轴</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 🥩关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">学习Vuex</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-04-07T03:27:35.000Z" title="发表于 2022-04-07 11:27:35">2022-04-07</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-04-07T04:34:55.638Z" title="更新于 2022-04-07 12:34:55">2022-04-07</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%B7%B1%E5%85%A5Vue3-Typescript%E5%AD%A6%E4%B9%A0%E2%9A%A1/">深入Vue3+Typescript学习⚡</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">2.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>12分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="学习Vuex"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="Vuex的状态管理">Vuex的状态管理</h2><h3 id="vuex介绍">vuex介绍</h3><ul><li><p>什么是状态管理？</p><p>应用程序的各种数据保存到某个位置进行管理</p></li></ul><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a797ec53c22b488b8b169c6c80daab85~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" style="zoom:67%"><p>​ state：数据	view：最终模块渲染成DOM	actions：修改state的行为事件</p><ul><li><p>复杂的状态管理</p><p>多个组件共享状态</p></li><li><p>Vuex的状态管理</p><p>将组件的内部状态抽离出来</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a54e89c5272448eb9c1850ee729526cb~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" style="zoom:67%"></li><li><p>Vuex使用单一状态树</p><p>SSOT：Single Source of Truth，单一数据源</p><p>每个应用仅仅包含一个store实例</p></li></ul><h4 id="安装">安装</h4><p><code>npm install vuex@next</code></p><p>使用vuex4.x，需要添加next指定版本</p><h4 id="使用">使用</h4><h4 id="创建store（仓库）">创建store（仓库）</h4><ul><li><p>Vuex和单纯的全局对象有什么区别呢？</p><p>Vuex的状态存储是响应式的</p></li><li><p>不能直接改变store中的状态</p><p>改变store中的状态的唯一途径就是<strong>提交(commit) mutation</strong></p><p>这样方便我们跟踪每一个状态的变化，从而让我们能够通过一些工具帮助我们更好的管理应用的状态</p></li><li><p>具体步骤：</p><ol><li>store/index</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建一个新的store实例</span></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(&#123;</span><br><span class="line">  <span class="title function_">state</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="attr">count</span>: <span class="number">0</span> <span class="comment">// 数据</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">mutations</span>: &#123; <span class="comment">// 方法</span></span><br><span class="line">    <span class="title function_">increment</span>(<span class="params">state</span>) &#123;</span><br><span class="line">       state.<span class="property">counter</span>++</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">decrement</span>(<span class="params">state</span>) &#123;</span><br><span class="line">       state.<span class="property">counter</span>--</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br></pre></td></tr></table></figure><ol start="2"><li>在全局将 store 实例作为插件安装</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;./store/index&#x27;</span></span><br><span class="line"><span class="title function_">createApp</span>(<span class="title class_">App</span>).<span class="title function_">use</span>(store).<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure></li></ul><h3 id="组件中使用store">组件中使用store</h3><h3 id="state">state</h3><p>使用store中的state数据</p><ul><li><p>在模板中使用</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123;$store.state.count&#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>在options api 中使用</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="attr">computed</span>: &#123;</span><br><span class="line">    <span class="title function_">counter</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="property">state</span>.<span class="property">counter</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>在setup中使用</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> store = <span class="title function_">useStore</span>()</span><br><span class="line">    <span class="keyword">const</span> counter = store.<span class="property">state</span>.<span class="property">counter</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h4 id="mapState">mapState</h4><p>如果需要拿state中的多个数据，在可以借助辅助函数 mapState，</p><ul><li><p>setup中使用mapState</p><p>默认情况下，Vuex没有提供非常方便的的使用mapState的方式，所以我们进行了一个函数的封装</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h2&gt;Home: &#123;&#123;sCounter&#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;h2&gt;Home: &#123;&#123;counter&#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;h2&gt;Home: &#123;&#123;name&#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;h2&gt;Home: &#123;&#123;age&#125;&#125;&lt;/h2&gt;</span><br><span class="line">    &lt;h2&gt;Home: &#123;&#123;height&#125;&#125;&lt;/h2&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123; mapState, useStore &#125; from &quot;vuex&quot;</span><br><span class="line">import &#123; computed &#125; from &#x27;vue&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">  // options api使用mapState</span><br><span class="line">  computed: &#123;</span><br><span class="line">    // fullName: function() &#123; return xxx&#125;, </span><br><span class="line">    ...mapState([&quot;counter&quot;, &quot;name&quot;])</span><br><span class="line">  &#125;,</span><br><span class="line">  setup() &#123;</span><br><span class="line">    const store = useStore()</span><br><span class="line">    const sCounter = computed(() =&gt; store.state.counter)</span><br><span class="line"></span><br><span class="line">    // 实际上放入mapState这里拿到的是这样形式的一个个函数</span><br><span class="line">    // &#123;counter: function(), name: function() ...&#125;</span><br><span class="line">    const storeStateFns = mapState([&quot;counter&quot;, &quot;name&quot;, &quot;age&quot;, &quot;height&quot;])</span><br><span class="line">    </span><br><span class="line">    // 封装一个函数转化一下,主要思想是把这一个个的函数放到computed里面</span><br><span class="line">    // 因为computed就是传入一个函数，然后会给我们返回一个ref</span><br><span class="line">    // &#123;counter: ref, age: ref, ...&#125;</span><br><span class="line">    const storeState = &#123;&#125;</span><br><span class="line">    Object.keys(storeStateFns).forEach(fnKey =&gt; &#123;</span><br><span class="line">      // 因为内部的computed取数据的时候是通过this.$store...</span><br><span class="line">      // 但我们这里的fn没有this, undefined.$store 是错的</span><br><span class="line">      // 用bind给每个函数绑定this为一个对象,里面需要有$store这个属性</span><br><span class="line">      // &#123;$store: store&#125;</span><br><span class="line">      const fn = storeStateFns[fnKey].bind(&#123; $store: store&#125;)</span><br><span class="line">      // 然后把函数一个方法computed, 以键值对的方式存储起来</span><br><span class="line">      storeState[fnKey] = computed(fn)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">      </span><br><span class="line">    return &#123;</span><br><span class="line">      sCounter,</span><br><span class="line">      // 最终在这里用展开运算符展开</span><br><span class="line">      ...storeState</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>把函数的封装抽离到 hooks/useState.js</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; computed &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; mapState, useStore &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useState</span>(<span class="params">mapper</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> store = <span class="title function_">useStore</span>()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 获取到对应的对象的functions: &#123;name: function, age: function&#125;</span></span><br><span class="line">  <span class="keyword">const</span> storeStateFns = <span class="title function_">mapState</span>(mapper)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 对数据进行转换</span></span><br><span class="line">  <span class="keyword">const</span> storeState = &#123;&#125;</span><br><span class="line">  <span class="title class_">Object</span>.<span class="title function_">keys</span>(storeStateFns).<span class="title function_">forEach</span>(<span class="function"><span class="params">fnKey</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> fn = storeStateFns[fnKey].<span class="title function_">bind</span>(&#123; <span class="attr">$store</span>: store &#125;)</span><br><span class="line">    storeState[fnKey] = <span class="title function_">computed</span>(fn)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> storeState</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我们在组件使用就会简便很多</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;../hooks/useState&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> storeState = <span class="title function_">useState</span>([<span class="string">&quot;counter&quot;</span>, <span class="string">&quot;name&quot;</span>, <span class="string">&quot;age&quot;</span>, <span class="string">&quot;height&quot;</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 当然也可以是对象形式(想要重命名的时候使用)</span></span><br><span class="line">    <span class="keyword">const</span> storeState2 = <span class="title function_">useState</span>(&#123;</span><br><span class="line">      <span class="attr">sCounter</span>: <span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">counter</span>,</span><br><span class="line">      <span class="attr">sName</span>: <span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">name</span></span><br><span class="line">    &#125;) </span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      ...storeState,</span><br><span class="line">      ...storeState2</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="getters">getters</h3><ul><li><p>getters 的基本使用</p><p>某些属性可能需要经过变化后才使用，（就像store中的计算属性）</p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a5234df35d8b42a3a105bf9573c66885~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" style="zoom:70%"></li><li><p>getters 第二个参数</p><p>getters可以接收第2个参数getters，使用getters本身的属性</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="attr">getters</span>: &#123;</span><br><span class="line">  <span class="title function_">totalPrice</span>(<span class="params">state, getters</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> state.<span class="property">books</span>.<span class="title function_">reduce</span>(<span class="function">(<span class="params">pre, cur</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> pre + cur.<span class="property">count</span> * cur.<span class="property">price</span></span><br><span class="line">    &#125;, <span class="number">0</span>) + <span class="string">&quot; &quot;</span> + getters.<span class="property">myName</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">myName</span>(<span class="params">state</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> state.<span class="property">name</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>getters 的返回函数</p><p>getters中的函数本身，可以返回一个函数，那么在使用的地方相当于可以调用这个函数</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title function_">totalPrice</span>(<span class="params">state</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">price</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> totalPrice = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> book <span class="keyword">of</span> state.<span class="property">books</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (book.<span class="property">price</span> &lt; price) <span class="keyword">continue</span></span><br><span class="line">            totalPrice += book.<span class="property">count</span> * book.<span class="property">price</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> totalPrice</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></li></ul><h4 id="mapGetters">mapGetters</h4><p>与mapState类似</p><ul><li><p>在setup中使用mapGetters</p><p>封装好的 /useGetters</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; computed &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useStore, mapGetters &#125; <span class="keyword">from</span> <span class="string">&quot;vuex&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useGetters</span>(<span class="params">mapper</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> store = <span class="title function_">useStore</span>()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> stateFns = <span class="title function_">mapGetters</span>(mapper)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> state = &#123;&#125;</span><br><span class="line">  <span class="title class_">Object</span>.<span class="title function_">keys</span>(stateFns).<span class="title function_">forEach</span>(<span class="function"><span class="params">fnKey</span> =&gt;</span> &#123;</span><br><span class="line">    state[fnKey] = <span class="title function_">computed</span>(stateFns[fnKey].<span class="title function_">bind</span>(&#123; <span class="attr">$store</span>: store &#125;))</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> state</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> storeGetters = <span class="title function_">useGetters</span>([<span class="string">&quot;nameInfo&quot;</span>, <span class="string">&quot;ageInfo&quot;</span>, <span class="string">&quot;heightInfo&quot;</span>])</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    ...storeGetters</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="封装useMapper">封装useMapper</h3><p>我们发现前面 useState，useGetters的逻辑大部分相同，所以我们可以封装一个新的函数，根据使用的时候的 mapState还是mapGetters 来调用函数</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; computed &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useStore &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// mapFn:使用的mapXXX</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useMapper</span>(<span class="params">mapper, mapFn</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> store = <span class="title function_">useStore</span>()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> storeStateFns = <span class="title function_">mapFn</span>(mapper)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> storeState = &#123;&#125;</span><br><span class="line">  <span class="title class_">Object</span>.<span class="title function_">keys</span>(storeStateFns).<span class="title function_">forEach</span>(<span class="function"><span class="params">fnKey</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> fn = storeStateFns[fnKey].<span class="title function_">bind</span>(&#123; <span class="attr">$store</span>: store &#125;)</span><br><span class="line">    storeState[fnKey] = <span class="title function_">computed</span>(fn)</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">return</span> storeState</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1f546da191e74eb8928f81fab5c259b7~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" style="zoom:80%"><h3 id="Mutations">Mutations</h3><p>更改 Vuex 的store中的状态的唯一方法是提交mutation</p><ul><li><p>mutations 基本使用</p><p>在store中定义方法</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="attr">mutations</span>: &#123;</span><br><span class="line">  <span class="title function_">increment</span>(<span class="params">state</span>) &#123;</span><br><span class="line">    state.<span class="property">counter</span>++</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">decrement</span>(<span class="params">state</span>) &#123;</span><br><span class="line">    state.<span class="property">counter</span>--</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在setup中commit事件，提交的是mutations中的方法</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useStore &#125; <span class="keyword">from</span> <span class="string">&quot;vuex&quot;</span></span><br><span class="line"><span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> store = <span class="title function_">useStore</span>()</span><br><span class="line">    store.<span class="title function_">commit</span>(<span class="string">&quot;increment&quot;</span>, xxx) <span class="comment">// 可以传参数</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>mutation携带数据</p><p>很多时候提交mutation会携带一些数据，在mutation中第二个参数可以接收</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="attr">mutations</span>: &#123;</span><br><span class="line">    <span class="title function_">addNumber</span>(<span class="params">state, payload</span>) &#123;</span><br><span class="line">        state.<span class="property">counter</span> += payload</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>payload也可以是对象类型</p><p>提交的时候：可以用type，指定提交的方法名</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">$store.<span class="title function_">commit</span>(&#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&quot;addNumber&quot;</span>,</span><br><span class="line">    <span class="attr">count</span>: <span class="number">100</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="attr">mutations</span>: &#123;</span><br><span class="line">    <span class="title function_">addNumber</span>(<span class="params">state, payload</span>) &#123;</span><br><span class="line">        state.<span class="property">counter</span> += payload.<span class="property">count</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>mutation 常量类型</p><p>主要是预防粗心的时候，commit的方法名字和mutation定义的方法名不一致</p><ul><li><p>定义常量</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// mutation-types.js</span></span><br><span class="line"><span class="comment">// 定义常量</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="variable constant_">INCREMENT_N</span> = <span class="string">&quot;INCREMENT_N&quot;</span></span><br></pre></td></tr></table></figure></li><li><p>store中使用</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="variable constant_">INCREMENT_N</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;../store/mutation-types&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">createStore</span>(&#123;</span><br><span class="line">  <span class="title function_">state</span>(<span class="params"></span>) &#123;...&#125;,</span><br><span class="line">  <span class="attr">mutations</span>: &#123;</span><br><span class="line">    [<span class="variable constant_">INCREMENT_N</span>](state, payload) &#123;</span><br><span class="line">      state.<span class="property">counter</span> += payload</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></li><li><p>组件中提交事件的时候使用</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="variable constant_">INCREMENT_N</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;../store/mutation-types&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">      ...</span><br><span class="line">      store.<span class="title function_">commit</span>(<span class="variable constant_">INCREMENT_N</span>, <span class="number">10</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><p>mutation重要原则</p><p>mutation 必须是同步函数</p><ul><li>这是因为devtool工具会记录mutation的日记</li><li>每一条mutation被记录，devtools都需要捕捉到前一状态和后一状态的快照</li><li>但是在mutation中执行异步操作，就无法追踪到数据的变化</li><li>所以Vuex的重要原则中要求 mutation必须是同步函数；</li></ul></li></ul><h4 id="mapMutations">mapMutations</h4><p>我们也可以借助于辅助函数，帮助我们快速映射到对应的方法中</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> mutations = <span class="title function_">mapMutations</span>([<span class="string">&quot;increment&quot;</span>, <span class="string">&quot;decrement&quot;</span>])</span><br><span class="line"><span class="keyword">const</span> mutations2 = <span class="title function_">mapMutations</span>(&#123;</span><br><span class="line">    <span class="attr">addNumber</span>: <span class="variable constant_">ADD_NUMBER</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="actions">actions</h3><ul><li><p>action提交mutation</p><ul><li><p>actions 类似于mutations，但是action提交的是mutation，而不是直接变更状态</p></li><li><p>actions 可以包含任意<strong>异步操作</strong></p></li><li><p>actions有一个很重要的参数 <strong>context</strong>，里面有很多属性，我们用的时候除了context.xxx使用，也可以解构出来使用</p></li><li><p>从context获取<strong>commit</strong>方法来提交一个mutation</p></li></ul></li><li><p>actions的分发操作（触发actions中的方法）</p><p>在组件中使用store上的<strong>dispatch</strong>进行分发，并且可以传递参数</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// store.js</span></span><br><span class="line"><span class="attr">mutations</span>: &#123;</span><br><span class="line">    <span class="title function_">increment</span>(<span class="params">state</span>) &#123;</span><br><span class="line">        state.<span class="property">counter</span>++</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">actions</span>: &#123;</span><br><span class="line">    <span class="comment">// 1. 可以接收参数</span></span><br><span class="line">    <span class="title function_">incrementAction</span>(<span class="params">context, payload</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(payload)  <span class="comment">// payload为接收到的参数</span></span><br><span class="line">        <span class="comment">// 模拟异步：1s之后再提交事件</span></span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          context.<span class="title function_">commit</span>(<span class="string">&quot;increment&quot;</span>) <span class="comment">// 提交mutation</span></span><br><span class="line">        &#125;)</span><br><span class="line">	&#125;,</span><br><span class="line">        <span class="comment">// 2. context 的属性</span></span><br><span class="line">    <span class="title function_">decrementAction</span>(<span class="params">&#123; commit, dispatch, state, rootState, getters, rootGetters &#125;</span>) &#123;</span><br><span class="line">      <span class="title function_">commit</span>(<span class="string">&quot;decrement&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 组件的setup中</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">increment</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">   <span class="comment">// 分发actions，并携带参数</span></span><br><span class="line">   store.<span class="title function_">dispatch</span>(<span class="string">&quot;incrementAction&quot;</span>, &#123;<span class="attr">count</span>: <span class="number">100</span>&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>另外，也可以以对象的形式进行分发</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 组件的setup中</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">increment</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  store.<span class="title function_">dispatch</span>(&#123;</span><br><span class="line">     <span class="attr">type</span>: <span class="string">&quot;incrementAction&quot;</span>,</span><br><span class="line">     <span class="attr">count</span>: <span class="number">100</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h4 id="mapActions">mapActions</h4><p>actions 也有对应的辅助函数 mapActions</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 这样用不行..</span></span><br><span class="line"><span class="keyword">const</span> actions = mapActions[<span class="string">&quot;incrementAction&quot;</span>, <span class="string">&quot;decrementAction&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对象写法(重命名)</span></span><br><span class="line"><span class="keyword">const</span> actions2 = <span class="title function_">mapActions</span>(&#123;</span><br><span class="line">  <span class="attr">add</span>: <span class="string">&quot;incrementAction&quot;</span>,</span><br><span class="line">  <span class="attr">sub</span>: <span class="string">&quot;decrementAction&quot;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="actions的异步操作">actions的异步操作</h4><p>actions很多时候是异步的，那么当我们组件派发actions的时候，我们也想收到结果，是请求成功了还是失败了，这时候我们可以在actions对应方法中返回 Promise，并对成功失败做处理</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="attr">actions</span>: &#123;</span><br><span class="line">   <span class="title function_">getHomeMultidata</span>(<span class="params">context</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        axios.<span class="title function_">get</span>(<span class="string">&quot;http://123.207.32.32:8000/home/multidata&quot;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span><br><span class="line">          context.<span class="title function_">commit</span>(<span class="string">&quot;addBannerData&quot;</span>, res.<span class="property">data</span>.<span class="property">data</span>.<span class="property">banner</span>.<span class="property">list</span>)</span><br><span class="line">          <span class="title function_">resolve</span>(<span class="string">&quot;okok&quot;</span>)</span><br><span class="line">        &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="title function_">reject</span>(err)</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;)</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> promise = store.<span class="title function_">dispatch</span>(<span class="string">&quot;getHomeMultidata&quot;</span>)</span><br><span class="line">    promise.<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span><br><span class="line">    &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="module">module</h3><h4 id="module的基本使用">module的基本使用</h4><p>什么是module？</p><ul><li>由于使用单一状态树，应用的所有状态都集中到一个比较大的对象，当应用变得复杂时，store对象就变得相当臃肿，不利于管理</li><li>所以Vuex允许我们将store分模块</li><li>每个模块拥有自己的state，mutation，action，getter，甚至是嵌套子模块</li></ul><p>使用：</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6c755defa77b4c7fa9c8bd2d4a36217c~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" style="zoom:80%"><ul><li>模块内部的mutation和getter的第一个参数state是模块的局部状态对象</li></ul><h4 id="module的命名空间">module的命名空间</h4><p>默认情况下，模块内部的action，mutation仍然是注册在全局的命名空间中的</p><p>如果希望模块具有更高的封装度和复用性，可以在模块中添加<code>namespaced: true</code></p><p>使模块更独立</p><p>之后，当模块被注册后它的所有getter、action及mutation都会自动根据模块注册的路径调整命名</p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/827e0697e09d426699b684bf4bbdc59e~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" style="zoom:67%"><h4 id="module修改或派发根组件">module修改或派发根组件</h4><p>{root: true}</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="attr">actions</span>: &#123;</span><br><span class="line">    <span class="title function_">incrementAction</span>(<span class="params">&#123;commit, dispatch,state&#125;</span>) &#123;</span><br><span class="line">        <span class="title function_">commit</span>(<span class="string">&quot;rootIncrement&quot;</span>, <span class="literal">null</span>, &#123;<span class="attr">root</span>: <span class="literal">true</span>&#125;)</span><br><span class="line">        <span class="title function_">dispatch</span>(<span class="string">&quot;rootIncrementAction&quot;</span>, <span class="literal">null</span>, &#123;<span class="attr">root</span>: <span class="literal">true</span>&#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="module的辅助函数">module的辅助函数</h4><p>写法一：通过完整的模块空间名来查找(不是很推荐使用)</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="attr">computed</span>: &#123;</span><br><span class="line">  ...<span class="title function_">mapState</span>(&#123;</span><br><span class="line">    <span class="attr">homeCounter</span>: <span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">home</span>.<span class="property">homeCounter</span>,</span><br><span class="line">  &#125;),</span><br><span class="line">  ...<span class="title function_">mapGetters</span>(&#123;</span><br><span class="line">    <span class="attr">doubleHomeCounter</span>: <span class="string">&quot;home/doubleHomeCounter&quot;</span>,</span><br><span class="line">  &#125;),</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>写法二：第一个参数写模块名，第二个参数写属性</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="attr">computed</span>: &#123;</span><br><span class="line">   ...<span class="title function_">mapState</span>(<span class="string">&quot;home&quot;</span>, [<span class="string">&quot;homeCounter&quot;</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>写法三：<code>createNamespacedHelpers</code>辅助函数</p><p>创建基于某个命名空间辅助函数。它返回一个对象，对象里有新的绑定在给定命名空间值上的组件绑定辅助函数</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createNamespacedHelpers &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"><span class="keyword">const</span> &#123; mapState, mapGetters&#125; = <span class="title function_">createNamespacedHelpers</span>(<span class="string">&quot;home&quot;</span>)</span><br><span class="line"></span><br><span class="line">...<span class="title function_">mapState</span>([<span class="string">&quot;homeCounter&quot;</span>])</span><br></pre></td></tr></table></figure><p><strong>setup中使用</strong></p><p>修改之前的 hooks，<strong>useState</strong>，<strong>useGetters</strong>，考虑模块的情况</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapState, createNamespacedHelpers&#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useMapper &#125; <span class="keyword">from</span> <span class="string">&#x27;./useMapper&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useState</span>(<span class="params">moduleName, mapper</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> mapperFn = mapState</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> moduleName === <span class="string">&#x27;string&#x27;</span> &amp;&amp; moduleName.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    mapperFn = <span class="title function_">createNamespacedHelpers</span>(moduleName).<span class="property">mapState</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    mapper = moduleName</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">useMapper</span>(mapper, mapperFn)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>// useGetters同理</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapGetters, createNamespacedHelpers &#125; <span class="keyword">from</span> <span class="string">&quot;vuex&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; useMapper &#125; <span class="keyword">from</span> <span class="string">&quot;./useMapper&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useGetters</span>(<span class="params">moduleName, mapper</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> mapperFn = mapGetters</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> moduleName === <span class="string">&#x27;string&#x27;</span> &amp;&amp; moduleName.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    mapperFn = <span class="title function_">createNamespacedHelpers</span>(moduleName).<span class="property">mapGetters</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    mapper = moduleName</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">useMapper</span>(mapper, mapperFn)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title function_">setup</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> state = <span class="title function_">useState</span>([<span class="string">&quot;rootCounter&quot;</span>])</span><br><span class="line">  <span class="keyword">const</span> rootGetters = <span class="title function_">useGetters</span>([<span class="string">&quot;doubleRootCounter&quot;</span>])</span><br><span class="line">  <span class="keyword">const</span> getters = <span class="title function_">useGetters</span>(<span class="string">&quot;home&quot;</span>, [<span class="string">&quot;doubleHomeCounter&quot;</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Hillyee</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://hillyee.github.io/2022/04/07/%E5%AD%A6%E4%B9%A0Vuex/">https://hillyee.github.io/2022/04/07/%E5%AD%A6%E4%B9%A0Vuex/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://hillyee.github.io" target="_blank">Hillyee-blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/vue3/">vue3</a><a class="post-meta__tags" href="/tags/vuex/">vuex</a></div><div class="post_share"><div class="social-share" data-image="https://vuex.vuejs.org/flow.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2022/04/04/%E5%89%8D%E7%AB%AF%E4%BA%BA%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E4%B9%8B%E8%B7%AF/"><img class="next-cover" src="https://img2.baidu.com/it/u=3970879732,527457078&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=440&amp;h=440" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">前端人的数据结构与算法之路</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/03/31/Vue3%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0/" title="Vue3源码学习"><img class="cover" src="https://img0.baidu.com/it/u=3270187559,3770262487&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=281" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2022-04-07</div><div class="title">Vue3源码学习</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Vuex%E7%9A%84%E7%8A%B6%E6%80%81%E7%AE%A1%E7%90%86"><span class="toc-number">1.</span> <span class="toc-text">Vuex的状态管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#vuex%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.1.</span> <span class="toc-text">vuex介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-number">1.1.1.</span> <span class="toc-text">安装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8"><span class="toc-number">1.1.2.</span> <span class="toc-text">使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAstore%EF%BC%88%E4%BB%93%E5%BA%93%EF%BC%89"><span class="toc-number">1.1.3.</span> <span class="toc-text">创建store（仓库）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E4%B8%AD%E4%BD%BF%E7%94%A8store"><span class="toc-number">1.2.</span> <span class="toc-text">组件中使用store</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#state"><span class="toc-number">1.3.</span> <span class="toc-text">state</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#mapState"><span class="toc-number">1.3.1.</span> <span class="toc-text">mapState</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#getters"><span class="toc-number">1.4.</span> <span class="toc-text">getters</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#mapGetters"><span class="toc-number">1.4.1.</span> <span class="toc-text">mapGetters</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%81%E8%A3%85useMapper"><span class="toc-number">1.5.</span> <span class="toc-text">封装useMapper</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mutations"><span class="toc-number">1.6.</span> <span class="toc-text">Mutations</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#mapMutations"><span class="toc-number">1.6.1.</span> <span class="toc-text">mapMutations</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#actions"><span class="toc-number">1.7.</span> <span class="toc-text">actions</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#mapActions"><span class="toc-number">1.7.1.</span> <span class="toc-text">mapActions</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#actions%E7%9A%84%E5%BC%82%E6%AD%A5%E6%93%8D%E4%BD%9C"><span class="toc-number">1.7.2.</span> <span class="toc-text">actions的异步操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#module"><span class="toc-number">1.8.</span> <span class="toc-text">module</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#module%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">1.8.1.</span> <span class="toc-text">module的基本使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#module%E7%9A%84%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4"><span class="toc-number">1.8.2.</span> <span class="toc-text">module的命名空间</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#module%E4%BF%AE%E6%94%B9%E6%88%96%E6%B4%BE%E5%8F%91%E6%A0%B9%E7%BB%84%E4%BB%B6"><span class="toc-number">1.8.3.</span> <span class="toc-text">module修改或派发根组件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#module%E7%9A%84%E8%BE%85%E5%8A%A9%E5%87%BD%E6%95%B0"><span class="toc-number">1.8.4.</span> <span class="toc-text">module的辅助函数</span></a></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-image:url(https://vuex.vuejs.org/flow.png)"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By Hillyee</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">本地搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span> 数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function loadValine(){function n(){new Valine(Object.assign({el:"#vcomment",appId:"K17ybwDJ17Flh4mBOnIeNCUW-gzGzoHsz",appKey:"sshkQAuti4qpWtrTV5y1WEPw",avatar:"monsterid",serverURLs:"",emojiMaps:"",path:window.location.pathname,visitor:!1},null))}"function"==typeof Valine?n():getScript("https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js").then(n)}function loadOtherComment(){loadValine()}setTimeout(loadValine,0)</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>